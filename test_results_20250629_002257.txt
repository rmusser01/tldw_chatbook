TLDW_CHATBOOK TEST RESULTS
Generated at: 2025-06-29 00:22:57
Total duration: 165.61s
================================================================================

OVERALL SUMMARY
Total tests: 1031
Passed: 808
Failed: 126
Skipped: 42
Errors: 55

DETAILED RESULTS BY DIRECTORY
================================================================================

Directory: Utils
Duration: 4.31s
Passed: 32, Failed: 0, Skipped: 0, Errors: 0

================================================================================

Directory: DB
Duration: 2.18s
Passed: 69, Failed: 0, Skipped: 0, Errors: 0

================================================================================

Directory: Web_Scraping
Duration: 10.77s
Passed: 64, Failed: 0, Skipped: 0, Errors: 0

================================================================================

Directory: ChaChaNotesDB
Duration: 3.06s
Passed: 57, Failed: 0, Skipped: 0, Errors: 0

================================================================================

Directory: Media_DB
Duration: 5.03s
Passed: 46, Failed: 6, Skipped: 0, Errors: 0

Failures:

1. 2025-06-29 00:20:36.128 | ERROR    | tldw_chatbook.DB.Sync_Client:_load_sync_state:76 - Error loading sync state from /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmplepn4fvj.json: Expecting value: line 1 column 1 (char 0). Starting from scratch.
2025-06-29 00:20:36.128 | DEBUG    | tldw_chatbook.DB.Sync_Client:_save_sync_state:94 - Saved sync state to /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmplepn4fvj.json: {'last_local_log_id_sent': 0, 'last_server_log_id_processed': 0}
2025-06-29 00:20:36.128 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:55 - ClientSyncEngine initialized for client 'client_test_integration'.
2025-06-29 00:20:36.128 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:56 -   DB Path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8p4l823x.db
2025-06-29 00:20:36.128 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:57 -   Server URL: http://localhost:53289
2025-06-29 00:20:36.128 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:58 -   Initial State: Last Sent=0, Last Processed=0
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:20:36.128 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'test_keyword' UUID 05c1997c-ac84-45c9-9501-fba8707a2c19
_________ TestClientSyncEngineIntegration.test_conflict_resolution_lww _________
Tests/Media_DB/test_sync_client_integration.py:276: in test_conflict_resolution_lww
    client2_engine._pull_and_apply_server_changes()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'ClientSyncEngine' object has no attribute '_pull_and_apply_server_changes'. Did you mean: '_pull_and_apply_remote_changes'?
---------------------------- Captured stderr setup -----------------------------
----------------------------------------

2. 2025-06-29 00:20:36.637 | ERROR    | tldw_chatbook.DB.Sync_Client:_load_sync_state:76 - Error loading sync state from /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpx_rr1np1.json: Expecting value: line 1 column 1 (char 0). Starting from scratch.
2025-06-29 00:20:36.637 | DEBUG    | tldw_chatbook.DB.Sync_Client:_save_sync_state:94 - Saved sync state to /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpx_rr1np1.json: {'last_local_log_id_sent': 0, 'last_server_log_id_processed': 0}
2025-06-29 00:20:36.637 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:55 - ClientSyncEngine initialized for client 'client_test_integration'.
2025-06-29 00:20:36.637 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:56 -   DB Path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp0i4ez0qd.db
2025-06-29 00:20:36.637 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:57 -   Server URL: http://localhost:53290
2025-06-29 00:20:36.637 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:58 -   Initial State: Last Sent=0, Last Processed=0
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:20:36.638 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'original' UUID 40b656ef-ca5e-492a-b57f-42c0fe17fe9c
2025-06-29 00:20:36.638 | DEBUG    | tldw_chatbook.DB.Sync_Client:_push_local_changes:131 - Checking for local changes since log ID 0
2025-06-29 00:20:36.638 | INFO     | tldw_chatbook.DB.Sync_Client:_push_local_changes:145 - Found 1 local changes to push.
2025-06-29 00:20:36.638 | DEBUG    | tldw_chatbook.DB.Sync_Client:_push_local_changes:159 - Posting 1 changes to http://localhost:53290/sync/send
----------------------------------------

3. 2025-06-29 00:20:36.641 | ERROR    | tldw_chatbook.DB.Sync_Client:_push_local_changes:179 - HTTP error pushing changes: Unknown - No response body
----------------------------------------

4. 2025-06-29 00:20:36.647 | ERROR    | tldw_chatbook.DB.Sync_Client:_load_sync_state:76 - Error loading sync state from /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp4rsdb62e.json: Expecting value: line 1 column 1 (char 0). Starting from scratch.
2025-06-29 00:20:36.647 | DEBUG    | tldw_chatbook.DB.Sync_Client:_save_sync_state:94 - Saved sync state to /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp4rsdb62e.json: {'last_local_log_id_sent': 0, 'last_server_log_id_processed': 0}
2025-06-29 00:20:36.647 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:55 - ClientSyncEngine initialized for client 'client2'.
2025-06-29 00:20:36.647 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:56 -   DB Path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpzns6p_5f.db
2025-06-29 00:20:36.647 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:57 -   Server URL: http://localhost:53290
2025-06-29 00:20:36.647 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:58 -   Initial State: Last Sent=0, Last Processed=0
___________ TestClientSyncEngineIntegration.test_sync_with_deletions ___________
Tests/Media_DB/test_sync_client_integration.py:309: in test_sync_with_deletions
    entities = create_test_entities(client_db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Tests/Media_DB/test_sync_client_integration.py:197: in create_test_entities
    media_id = db.insert_media_item(
               ^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'MediaDatabase' object has no attribute 'insert_media_item'
---------------------------- Captured stderr setup -----------------------------
----------------------------------------

5. 2025-06-29 00:20:37.152 | ERROR    | tldw_chatbook.DB.Sync_Client:_load_sync_state:76 - Error loading sync state from /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmplh_qojwu.json: Expecting value: line 1 column 1 (char 0). Starting from scratch.
2025-06-29 00:20:37.153 | DEBUG    | tldw_chatbook.DB.Sync_Client:_save_sync_state:94 - Saved sync state to /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmplh_qojwu.json: {'last_local_log_id_sent': 0, 'last_server_log_id_processed': 0}
2025-06-29 00:20:37.153 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:55 - ClientSyncEngine initialized for client 'client_test_integration'.
2025-06-29 00:20:37.153 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:56 -   DB Path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp09iafk4t.db
2025-06-29 00:20:37.153 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:57 -   Server URL: http://localhost:53292
2025-06-29 00:20:37.153 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:58 -   Initial State: Last Sent=0, Last Processed=0
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:20:37.153 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'test_keyword' UUID 96b40a61-ec0f-442a-9bf2-f75a457d6683
_________ TestClientSyncEngineIntegration.test_network_error_handling __________
.venv/lib/python3.12/site-packages/urllib3/util/url.py:434: in parse_url
    raise LocationParseError(url)
E   urllib3.exceptions.LocationParseError: Failed to parse: http://localhost:99999/sync/send
----------------------------------------

6. 2025-06-29 00:20:37.661 | ERROR    | tldw_chatbook.DB.Sync_Client:_load_sync_state:76 - Error loading sync state from /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpti12rq2j.json: Expecting value: line 1 column 1 (char 0). Starting from scratch.
2025-06-29 00:20:37.661 | DEBUG    | tldw_chatbook.DB.Sync_Client:_save_sync_state:94 - Saved sync state to /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpti12rq2j.json: {'last_local_log_id_sent': 0, 'last_server_log_id_processed': 0}
2025-06-29 00:20:37.661 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:55 - ClientSyncEngine initialized for client 'test_client'.
2025-06-29 00:20:37.661 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:56 -   DB Path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpmvrw60xb.db
2025-06-29 00:20:37.661 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:57 -   Server URL: http://localhost:99999
2025-06-29 00:20:37.661 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:58 -   Initial State: Last Sent=0, Last Processed=0
2025-06-29 00:20:37.661 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'test' UUID 72411297-6df9-4acb-aff4-f812f0aadf55
2025-06-29 00:20:37.661 | DEBUG    | tldw_chatbook.DB.Sync_Client:_push_local_changes:131 - Checking for local changes since log ID 0
2025-06-29 00:20:37.661 | INFO     | tldw_chatbook.DB.Sync_Client:_push_local_changes:145 - Found 1 local changes to push.
2025-06-29 00:20:37.661 | DEBUG    | tldw_chatbook.DB.Sync_Client:_push_local_changes:159 - Posting 1 changes to http://localhost:99999/sync/send
__________ TestClientSyncEngineIntegration.test_idempotent_operations __________
Tests/Media_DB/test_sync_client_integration.py:404: in test_idempotent_operations
    client2_engine._pull_and_apply_server_changes()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'ClientSyncEngine' object has no attribute '_pull_and_apply_server_changes'. Did you mean: '_pull_and_apply_remote_changes'?
---------------------------- Captured stderr setup -----------------------------
----------------------------------------

7. 2025-06-29 00:20:37.700 | ERROR    | tldw_chatbook.DB.Sync_Client:_load_sync_state:76 - Error loading sync state from /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp44wtybky.json: Expecting value: line 1 column 1 (char 0). Starting from scratch.
2025-06-29 00:20:37.700 | DEBUG    | tldw_chatbook.DB.Sync_Client:_save_sync_state:94 - Saved sync state to /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp44wtybky.json: {'last_local_log_id_sent': 0, 'last_server_log_id_processed': 0}
2025-06-29 00:20:37.700 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:55 - ClientSyncEngine initialized for client 'client_test_integration'.
2025-06-29 00:20:37.700 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:56 -   DB Path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpzm6ya54_.db
2025-06-29 00:20:37.700 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:57 -   Server URL: http://localhost:53293
2025-06-29 00:20:37.700 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:58 -   Initial State: Last Sent=0, Last Processed=0
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:20:37.700 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'idempotent_test' UUID 6b43a29b-5f3e-4d86-abf2-71e269aa0ac9
2025-06-29 00:20:37.700 | DEBUG    | tldw_chatbook.DB.Sync_Client:_push_local_changes:131 - Checking for local changes since log ID 0
2025-06-29 00:20:37.700 | INFO     | tldw_chatbook.DB.Sync_Client:_push_local_changes:145 - Found 1 local changes to push.
2025-06-29 00:20:37.700 | DEBUG    | tldw_chatbook.DB.Sync_Client:_push_local_changes:159 - Posting 1 changes to http://localhost:53293/sync/send
----------------------------------------

8. 2025-06-29 00:20:37.702 | ERROR    | tldw_chatbook.DB.Sync_Client:_push_local_changes:179 - HTTP error pushing changes: Unknown - No response body
2025-06-29 00:20:37.702 | DEBUG    | tldw_chatbook.DB.Sync_Client:_push_local_changes:131 - Checking for local changes since log ID 0
2025-06-29 00:20:37.702 | INFO     | tldw_chatbook.DB.Sync_Client:_push_local_changes:145 - Found 1 local changes to push.
2025-06-29 00:20:37.702 | DEBUG    | tldw_chatbook.DB.Sync_Client:_push_local_changes:159 - Posting 1 changes to http://localhost:53293/sync/send
----------------------------------------

9. 2025-06-29 00:20:37.702 | ERROR    | tldw_chatbook.DB.Sync_Client:_push_local_changes:179 - HTTP error pushing changes: Unknown - No response body
2025-06-29 00:20:37.702 | DEBUG    | tldw_chatbook.DB.Sync_Client:_push_local_changes:131 - Checking for local changes since log ID 0
2025-06-29 00:20:37.703 | INFO     | tldw_chatbook.DB.Sync_Client:_push_local_changes:145 - Found 1 local changes to push.
2025-06-29 00:20:37.703 | DEBUG    | tldw_chatbook.DB.Sync_Client:_push_local_changes:159 - Posting 1 changes to http://localhost:53293/sync/send
----------------------------------------

10. 2025-06-29 00:20:37.703 | ERROR    | tldw_chatbook.DB.Sync_Client:_push_local_changes:179 - HTTP error pushing changes: Unknown - No response body
----------------------------------------

11. 2025-06-29 00:20:37.709 | ERROR    | tldw_chatbook.DB.Sync_Client:_load_sync_state:76 - Error loading sync state from /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpff8_flnd.json: Expecting value: line 1 column 1 (char 0). Starting from scratch.
2025-06-29 00:20:37.709 | DEBUG    | tldw_chatbook.DB.Sync_Client:_save_sync_state:94 - Saved sync state to /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpff8_flnd.json: {'last_local_log_id_sent': 0, 'last_server_log_id_processed': 0}
2025-06-29 00:20:37.709 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:55 - ClientSyncEngine initialized for client 'client2'.
2025-06-29 00:20:37.709 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:56 -   DB Path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpjhv8asag.db
2025-06-29 00:20:37.709 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:57 -   Server URL: http://localhost:53293
2025-06-29 00:20:37.709 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:58 -   Initial State: Last Sent=0, Last Processed=0
_______________ TestSyncEnginePerformance.test_large_batch_sync ________________
Tests/Media_DB/test_sync_client_integration.py:438: in test_large_batch_sync
    assert len(MockSyncServer.server_logs) == num_items
E   assert 0 == 100
E    +  where 0 = len([])
E    +    where [] = MockSyncServer.server_logs
---------------------------- Captured stderr setup -----------------------------
----------------------------------------

12. 2025-06-29 00:20:38.213 | ERROR    | tldw_chatbook.DB.Sync_Client:_load_sync_state:76 - Error loading sync state from /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp_gwkmkpz.json: Expecting value: line 1 column 1 (char 0). Starting from scratch.
2025-06-29 00:20:38.213 | DEBUG    | tldw_chatbook.DB.Sync_Client:_save_sync_state:94 - Saved sync state to /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp_gwkmkpz.json: {'last_local_log_id_sent': 0, 'last_server_log_id_processed': 0}
2025-06-29 00:20:38.213 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:55 - ClientSyncEngine initialized for client 'client_test_integration'.
2025-06-29 00:20:38.213 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:56 -   DB Path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpn_ouvsgd.db
2025-06-29 00:20:38.213 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:57 -   Server URL: http://localhost:53297
2025-06-29 00:20:38.213 | INFO     | tldw_chatbook.DB.Sync_Client:__init__:58 -   Initial State: Last Sent=0, Last Processed=0
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:20:38.214 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_0' UUID 461540e7-9c58-4627-bb38-e5d7aa13d230
2025-06-29 00:20:38.214 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_1' UUID 4cc778cd-ba54-45a8-b17b-7e435ddb9012
2025-06-29 00:20:38.214 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_2' UUID d4a74588-cd2c-481a-90c8-2c75ac7b2929
2025-06-29 00:20:38.214 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_3' UUID f4d82a16-bec6-4b53-9555-958b625e5f8c
2025-06-29 00:20:38.215 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_4' UUID 705d39dc-faa9-4094-93d3-d94aac617493
2025-06-29 00:20:38.215 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_5' UUID dc326cdb-f90c-413c-a0d4-7362ce885407
2025-06-29 00:20:38.215 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_6' UUID d5ce9e4c-bfdc-4c19-a791-6cd87e5f3fd3
2025-06-29 00:20:38.215 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_7' UUID 1742c0c2-dc7f-40ea-9d6c-709d549261ea
2025-06-29 00:20:38.215 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_8' UUID c39d7e87-3a8c-4fd7-8003-e0627d47c5d2
2025-06-29 00:20:38.216 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_9' UUID a5ec7cfd-4598-4f99-a8aa-3d5fda828096
2025-06-29 00:20:38.216 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_10' UUID 5bb36926-b1b6-433b-a7e6-ea776795db9d
2025-06-29 00:20:38.216 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_11' UUID e9be1c76-864c-4cb9-a222-7e6e461aac4d
2025-06-29 00:20:38.216 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_12' UUID 6040f48b-2505-4e4e-864d-7ff3fc836a79
2025-06-29 00:20:38.216 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_13' UUID 5f6508f4-9250-4264-bdc6-40a01a7413b6
2025-06-29 00:20:38.216 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_14' UUID e7a50cce-3893-4ee5-919d-713c0ea58c81
2025-06-29 00:20:38.217 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_15' UUID e6966ed5-5adc-4ba0-a28a-a525264f74c4
2025-06-29 00:20:38.217 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_16' UUID fd8ba2f6-049f-4e8c-a52b-96388155e557
2025-06-29 00:20:38.217 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_17' UUID 844ddc63-23f9-46ba-ace5-cb50b5bf47c2
2025-06-29 00:20:38.217 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_18' UUID 8c5dc27f-983b-4fe8-8b2b-7d1fb59d83b2
2025-06-29 00:20:38.217 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_19' UUID d5216587-3446-44dd-a729-bceef4c50fc2
2025-06-29 00:20:38.217 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_20' UUID 3564be1d-0a83-4669-8642-6017b82ba522
2025-06-29 00:20:38.218 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_21' UUID 56271a25-edbb-4f43-9d08-c74c3f099da7
2025-06-29 00:20:38.218 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_22' UUID 18ab14f5-0121-4e1f-96a9-027768d87250
2025-06-29 00:20:38.218 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_23' UUID b119d143-bad1-4930-bf11-8c06a98798c2
2025-06-29 00:20:38.218 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_24' UUID 4c036f45-fc04-4516-9768-72a0706f0024
2025-06-29 00:20:38.218 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_25' UUID 85f96519-16d3-4a10-a22b-afab0eb6084f
2025-06-29 00:20:38.218 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_26' UUID 795eabeb-8c10-4f7f-a1e1-22ff9a402ce0
2025-06-29 00:20:38.219 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_27' UUID f6991de2-eb67-4e66-9c68-e8996cbc3752
2025-06-29 00:20:38.219 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_28' UUID d4df81f2-321f-40b7-a4fd-b6c2fe0d4e3b
2025-06-29 00:20:38.219 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_29' UUID 2829ec50-7273-4214-8667-ed1658818537
2025-06-29 00:20:38.219 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_30' UUID b9c9c033-1f75-4938-a2a1-f32b6436b153
2025-06-29 00:20:38.219 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_31' UUID 8d1c2f77-e804-47a4-a1c5-c7ca6d41a1e0
2025-06-29 00:20:38.219 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_32' UUID 7296079d-3afc-4f08-921f-cce4eb16f580
2025-06-29 00:20:38.220 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_33' UUID cb421ef4-30d3-49cf-9925-b539eb110b7b
2025-06-29 00:20:38.220 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_34' UUID 291ad881-edda-42ca-8dcf-9e7744e85e82
2025-06-29 00:20:38.220 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_35' UUID 9af2a96f-db77-417a-aaa8-36f87aa2c58d
2025-06-29 00:20:38.220 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_36' UUID 77e8ccdf-18a0-47e3-b434-eac9cb5c10ae
2025-06-29 00:20:38.220 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_37' UUID 13c0af89-545a-4dee-8110-295d70e89c1d
2025-06-29 00:20:38.220 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_38' UUID d895d186-34ad-45e3-a1b6-4daca81c1d7e
2025-06-29 00:20:38.221 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_39' UUID 6a0445ff-d51f-455c-8e02-61d8d9c90ccd
2025-06-29 00:20:38.221 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_40' UUID dc394a80-de1e-441e-b736-0ffb69213772
2025-06-29 00:20:38.221 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_41' UUID 26bdd19e-54cb-4ae0-a07c-c9cd492e4464
2025-06-29 00:20:38.221 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_42' UUID 9d88c0da-2e52-4143-94a6-5f8e4b911033
2025-06-29 00:20:38.221 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_43' UUID d6c28f44-b23d-42e4-b88a-a000d1191e19
2025-06-29 00:20:38.222 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_44' UUID 5f74366d-cafe-41c9-81a4-b3453e4e9bf7
2025-06-29 00:20:38.222 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_45' UUID 0043cee4-ee42-4a8e-a576-f5840a2c45fe
2025-06-29 00:20:38.222 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_46' UUID 04485dab-8cc9-4125-93da-16e3ad2aab9a
2025-06-29 00:20:38.222 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_47' UUID 4d004333-e4fd-4724-8bb2-6e7573b84d56
2025-06-29 00:20:38.223 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_48' UUID eabba1ac-c6ab-402a-a799-2c6e2c2be3ff
2025-06-29 00:20:38.223 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_49' UUID 9c214848-1250-4a22-8266-05bc26c8d69d
2025-06-29 00:20:38.223 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_50' UUID 2780376e-910a-429c-8441-71503ceab749
2025-06-29 00:20:38.223 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_51' UUID d1870c7b-53b5-4b72-9321-24b91fb11ab7
2025-06-29 00:20:38.223 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_52' UUID 9636ffb3-5d9c-4060-92ca-addafbd63cd3
2025-06-29 00:20:38.223 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_53' UUID fba0a8a1-86bf-4796-b505-514772f72ccd
2025-06-29 00:20:38.224 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_54' UUID 8a3e7532-0719-4c9a-bddb-33967c48ddab
2025-06-29 00:20:38.224 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_55' UUID 34514431-5010-4c86-be3b-6f2b0a986642
2025-06-29 00:20:38.224 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_56' UUID 64c70dc5-25fb-4823-b09e-0e2bdbb94b1d
2025-06-29 00:20:38.224 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_57' UUID a3687f72-a0ee-4237-9f62-dbf312391233
2025-06-29 00:20:38.224 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_58' UUID 56314aa5-17f3-4346-b789-570ecbaf10e6
2025-06-29 00:20:38.224 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_59' UUID 2c5bf980-20c5-4ccd-a7d4-904a6a61f325
2025-06-29 00:20:38.224 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_60' UUID 8289077f-9861-488d-909a-90ee869959d2
2025-06-29 00:20:38.224 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_61' UUID 78c77347-e505-447a-924e-4e101b12a981
2025-06-29 00:20:38.225 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_62' UUID 868959f9-195f-42e9-8446-8499f4bf9dc1
2025-06-29 00:20:38.225 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_63' UUID 7d1cffa9-a17c-43f7-9e60-c9b0938b05b2
2025-06-29 00:20:38.225 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_64' UUID 92e7bedf-c5d2-46c3-9747-339d469f35a1
2025-06-29 00:20:38.225 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_65' UUID 0251d17a-fa65-4f4b-8003-5f88b2d8704c
2025-06-29 00:20:38.225 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_66' UUID bb5f78a7-fb8b-4a98-adbc-c1564c6caff6
2025-06-29 00:20:38.225 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_67' UUID 5201ea12-2145-44a9-a19d-9e165c9b8980
2025-06-29 00:20:38.225 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_68' UUID 5f76995c-a963-4cc7-b6c8-c482bd351e81
2025-06-29 00:20:38.225 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_69' UUID 403b2edf-d5c3-44a0-a3c1-ddaf558e4ca2
2025-06-29 00:20:38.226 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_70' UUID c52451be-ae1b-4aea-9dce-5ec9ed2c9df8
2025-06-29 00:20:38.226 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_71' UUID da6c498b-82dc-4afd-ab23-55d31358920b
2025-06-29 00:20:38.226 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_72' UUID c8915ce1-f922-49e7-abaa-c330421c4543
2025-06-29 00:20:38.226 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_73' UUID 8b228ccf-3bd1-43f1-b255-adf7c81a3221
2025-06-29 00:20:38.226 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_74' UUID e3c52d6d-ff78-4502-880e-9e3a8b79821a
2025-06-29 00:20:38.226 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_75' UUID ed22ec71-e4d5-4e54-bec6-759055a2f34e
2025-06-29 00:20:38.226 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_76' UUID e97682a8-142f-41f3-89d8-2fd68360515d
2025-06-29 00:20:38.226 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_77' UUID 863a78fe-1f42-4cbe-b121-e61135e447fb
2025-06-29 00:20:38.227 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_78' UUID 24a9bc73-4e0f-448f-accb-51e9d4c44487
2025-06-29 00:20:38.227 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_79' UUID 44d6900e-d698-489c-8efb-ae076f9c501a
2025-06-29 00:20:38.227 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_80' UUID 69253866-bfd2-480d-bb39-4d08f7228d0e
2025-06-29 00:20:38.227 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_81' UUID bb929384-4196-4851-a3f4-7a856bf1a5bd
2025-06-29 00:20:38.227 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_82' UUID 04859e0b-7162-49ef-b021-bb02ac9c851c
2025-06-29 00:20:38.227 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_83' UUID e5e7a2d2-f096-43ef-bcfb-498a594da09d
2025-06-29 00:20:38.227 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_84' UUID 5f312138-bdbd-482c-a3a5-f14901100fb9
2025-06-29 00:20:38.227 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_85' UUID aa02e1f1-21c1-48dd-a126-f72aa07c041a
2025-06-29 00:20:38.228 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_86' UUID d700c7e4-58a8-43c2-b5cb-1a69ca3d752e
2025-06-29 00:20:38.228 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_87' UUID fc3965d9-dbe8-4828-a754-fbe8e9f0e588
2025-06-29 00:20:38.228 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_88' UUID 3f5f4904-c1bd-4bc3-afa9-2cf5aa74fd71
2025-06-29 00:20:38.228 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_89' UUID 78dc3d04-0c05-44cd-8425-014c1e55b9c9
2025-06-29 00:20:38.228 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_90' UUID 3ad41129-f8b7-4ed7-9276-d39bda1c7987
2025-06-29 00:20:38.228 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_91' UUID 3f06a365-1ee2-4499-8f38-e20f8492fb23
2025-06-29 00:20:38.228 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_92' UUID b9d1ed6f-bdbc-48df-9120-65c6e4bcc8fd
2025-06-29 00:20:38.228 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_93' UUID 47f2b757-e4d4-4677-ac4a-39016f03b646
2025-06-29 00:20:38.228 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_94' UUID 02c0420f-705c-4e8c-94f3-1aac3e0097ba
2025-06-29 00:20:38.229 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_95' UUID 557e7ebd-33ea-4b28-8427-0356152c7a84
2025-06-29 00:20:38.229 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_96' UUID c401730a-b202-4983-9267-c03199e29c5c
2025-06-29 00:20:38.229 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_97' UUID 51447704-69e9-4e0a-bd99-d9797ace8e48
2025-06-29 00:20:38.229 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_98' UUID d0efd796-0755-4dfa-8368-07a6babc218b
2025-06-29 00:20:38.229 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'keyword_99' UUID a19c8d9c-f72c-4b7e-b068-ea769e6fdce3
2025-06-29 00:20:38.229 | DEBUG    | tldw_chatbook.DB.Sync_Client:_push_local_changes:131 - Checking for local changes since log ID 0
2025-06-29 00:20:38.229 | INFO     | tldw_chatbook.DB.Sync_Client:_push_local_changes:145 - Found 50 local changes to push.
2025-06-29 00:20:38.229 | DEBUG    | tldw_chatbook.DB.Sync_Client:_push_local_changes:159 - Posting 50 changes to http://localhost:53297/sync/send
----------------------------------------

13. 2025-06-29 00:20:38.231 | ERROR    | tldw_chatbook.DB.Sync_Client:_push_local_changes:179 - HTTP error pushing changes: Unknown - No response body
=============================== warnings summary ===============================
.venv/lib/python3.12/site-packages/_hypothesis_pytestplugin.py:461
  /Users/appledev/Working/tldw_chatbook_dev/.venv/lib/python3.12/site-packages/_hypothesis_pytestplugin.py:461: UserWarning: Skipping collection of '.hypothesis' directory - this usually means you've explicitly set the `norecursedirs` pytest config option, replacing rather than extending the default ignores.
    warnings.warn(
----------------------------------------

14. FAILED Tests/Media_DB/test_sync_client_integration.py::TestClientSyncEngineIntegration::test_push_pull_basic_flow
----------------------------------------

15. FAILED Tests/Media_DB/test_sync_client_integration.py::TestClientSyncEngineIntegration::test_conflict_resolution_lww
----------------------------------------

16. FAILED Tests/Media_DB/test_sync_client_integration.py::TestClientSyncEngineIntegration::test_sync_with_deletions
----------------------------------------

17. FAILED Tests/Media_DB/test_sync_client_integration.py::TestClientSyncEngineIntegration::test_network_error_handling
----------------------------------------

18. FAILED Tests/Media_DB/test_sync_client_integration.py::TestClientSyncEngineIntegration::test_idempotent_operations
----------------------------------------

19. FAILED Tests/Media_DB/test_sync_client_integration.py::TestSyncEnginePerformance::test_large_batch_sync
6 failed, 46 passed, 1 warning in 4.78s
----------------------------------------

20. Tests/Media_DB/test_sync_client_integration.py::TestClientSyncEngineIntegration::test_push_pull_basic_flow: Tests/Media_DB/test_sync_client_integration.py:219: in test_push_pull_basic_flow
    entities = create_test_entities(client_db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Tests/Media_DB/test_sync_client_integration.py:197: in create_test_entities
    media_id = db.insert_media_item(
               ^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'MediaDatabase' object has no attribute 'insert_media_item'
----------------------------------------

21. Tests/Media_DB/test_sync_client_integration.py::TestClientSyncEngineIntegration::test_conflict_resolution_lww: Tests/Media_DB/test_sync_client_integration.py:276: in test_conflict_resolution_lww
    client2_engine._pull_and_apply_server_changes()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'ClientSyncEngine' object has no attribute '_pull_and_apply_server_changes'. Did you mean: '_pull_and_apply_remote_changes'?
----------------------------------------

22. Tests/Media_DB/test_sync_client_integration.py::TestClientSyncEngineIntegration::test_sync_with_deletions: Tests/Media_DB/test_sync_client_integration.py:309: in test_sync_with_deletions
    entities = create_test_entities(client_db)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Tests/Media_DB/test_sync_client_integration.py:197: in create_test_entities
    media_id = db.insert_media_item(
               ^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'MediaDatabase' object has no attribute 'insert_media_item'
----------------------------------------

23. Tests/Media_DB/test_sync_client_integration.py::TestClientSyncEngineIntegration::test_network_error_handling: .venv/lib/python3.12/site-packages/urllib3/util/url.py:434: in parse_url
    raise LocationParseError(url)
E   urllib3.exceptions.LocationParseError: Failed to parse: http://localhost:99999/sync/send

The above exception was the direct cause of the following exception:
.venv/lib/python3.12/site-packages/requests/models.py:433: in prepare_url
    scheme, auth, host, port, path, query, fragment = parse_url(url)
                                                      ^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/urllib3/util/url.py:449: in parse_url
    raise LocationParseError(source_url) from e
E   urllib3.exceptions.LocationParseError: Failed to parse: http://localhost:99999/sync/send

During handling of the above exception, another exception occurred:
Tests/Media_DB/test_sync_client_integration.py:361: in test_network_error_handling
    engine._push_local_changes()
tldw_chatbook/DB/Sync_Client.py:166: in _push_local_changes
    response = requests.post(full_url, json=payload, headers=headers, timeout=45)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/requests/api.py:115: in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/requests/api.py:59: in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/requests/sessions.py:575: in request
    prep = self.prepare_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/requests/sessions.py:484: in prepare_request
    p.prepare(
.venv/lib/python3.12/site-packages/requests/models.py:367: in prepare
    self.prepare_url(url, params)
.venv/lib/python3.12/site-packages/requests/models.py:435: in prepare_url
    raise InvalidURL(*e.args)
E   requests.exceptions.InvalidURL: Failed to parse: http://localhost:99999/sync/send
----------------------------------------

24. Tests/Media_DB/test_sync_client_integration.py::TestClientSyncEngineIntegration::test_idempotent_operations: Tests/Media_DB/test_sync_client_integration.py:404: in test_idempotent_operations
    client2_engine._pull_and_apply_server_changes()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'ClientSyncEngine' object has no attribute '_pull_and_apply_server_changes'. Did you mean: '_pull_and_apply_remote_changes'?
----------------------------------------

25. Tests/Media_DB/test_sync_client_integration.py::TestSyncEnginePerformance::test_large_batch_sync: Tests/Media_DB/test_sync_client_integration.py:438: in test_large_batch_sync
    assert len(MockSyncServer.server_logs) == num_items
E   assert 0 == 100
E    +  where 0 = len([])
E    +    where [] = MockSyncServer.server_logs
----------------------------------------

================================================================================

Directory: Prompts_DB
Duration: 0.62s
Passed: 19, Failed: 0, Skipped: 0, Errors: 0

================================================================================

Directory: Character_Chat
Duration: 0.48s
Passed: 14, Failed: 0, Skipped: 0, Errors: 0

================================================================================

Directory: Chat
Duration: 50.18s
Passed: 58, Failed: 7, Skipped: 39, Errors: 9

Failures:

1. ==================================== ERRORS ====================================
----------------------------------------

2. _____________ ERROR at teardown of test_media_search_initial_state _____________
Tests/Chat/test_chat_sidebar_media_search.py:102: in real_app_media_test
    app.chachanotes_db.close()
    ^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'CharactersRAGDB' object has no attribute 'close'
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:20:45,398 [DEBUG] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

3. 2025-06-29 00:20:45,398 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

4. 2025-06-29 00:20:45,398 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

5. 2025-06-29 00:20:45,398 [ERROR] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:20:45.399 | INFO     | tldw_chatbook.config:load_settings:207 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:45.399 | INFO     | tldw_chatbook.config:load_settings:208 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:45.399 | INFO     | tldw_chatbook.config:load_settings:217 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:20:45.399 | WARNING  | tldw_chatbook.config:load_settings:223 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:20:45.399 | INFO     | tldw_chatbook.config:load_settings:232 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:45.400 | INFO     | tldw_chatbook.config:load_settings:237 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:45.401 | INFO     | tldw_chatbook.config:load_settings:252 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:20:45.401 | INFO     | tldw_chatbook.app:__init__:973 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:20:45.401 | INFO     | tldw_chatbook.app:__init__:980 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:20:45.401 | INFO     | tldw_chatbook.app:__init__:981 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:20:45,401 [INFO] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:20:45,401 [INFO] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:20:45.401 | INFO     | tldw_chatbook.app:__init__:990 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

6. 2025-06-29 00:20:45,401 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

7. 2025-06-29 00:20:45,401 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:20:45,401 [DEBUG] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:20:45.401 | INFO     | tldw_chatbook.config:load_settings:207 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:45.401 | INFO     | tldw_chatbook.config:load_settings:208 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:45.401 | INFO     | tldw_chatbook.config:load_settings:217 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:20:45.401 | WARNING  | tldw_chatbook.config:load_settings:223 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:20:45.401 | INFO     | tldw_chatbook.config:load_settings:232 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:45.403 | INFO     | tldw_chatbook.config:load_settings:237 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:45.403 | INFO     | tldw_chatbook.config:load_settings:252 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:20:45,403 [INFO] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:20:45,404 [INFO] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:20:45.404 | INFO     | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:105 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:20:45.404 | INFO     | tldw_chatbook.DB.Prompts_DB:__init__:251 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:20:45.404 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_get_thread_connection:317 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:20:45.404 | INFO     | tldw_chatbook.DB.Prompts_DB:_initialize_schema:518 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:20:45.404 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_initialize_schema:521 - Database schema is up to date.
2025-06-29 00:20:45.404 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_initialize_schema:525 - Verified FTS tables exist.
2025-06-29 00:20:45.404 | DEBUG    | tldw_chatbook.DB.Prompts_DB:__init__:281 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:20:45.404 | INFO     | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:110 - Prompts Interop Library initialized successfully.
2025-06-29 00:20:45,404 [INFO] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:20:45,404 [INFO] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:20:45,404 [DEBUG] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:20:45,404 [INFO] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:20:45,404 [DEBUG] root:750 - Database schema is up to date.
2025-06-29 00:20:45,404 [DEBUG] root:755 - Verified FTS tables exist.
2025-06-29 00:20:45,404 [DEBUG] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:20:45.404 | INFO     | tldw_chatbook.app:__init__:1057 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:20:45.404 | DEBUG    | tldw_chatbook.app:__init__:1059 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x16b64e090>
2025-06-29 00:20:45.404 | DEBUG    | tldw_chatbook.app:__init__:1061 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:20:45.404 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:get_distinct_media_types:3417 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:20:45,404 [DEBUG] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:20:45.404 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:get_distinct_media_types:3431 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:20:45.404 | INFO     | tldw_chatbook.app:__init__:1075 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

8. 2025-06-29 00:20:45,405 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

9. 2025-06-29 00:20:45,405 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:20:45.405 | DEBUG    | tldw_chatbook.app:__init__:1089 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:20:45.405 | DEBUG    | tldw_chatbook.app:__init__:1090 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:20:45,405 [INFO] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:20:45,405 [INFO] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

10. 2025-06-29 00:20:45,405 [ERROR] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:20:45.405 | INFO     | tldw_chatbook.app:__init__:1133 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:20:45.405 | INFO     | tldw_chatbook.app:__init__:1134 - Total initialization time: 0.007 seconds
2025-06-29 00:20:45.405 | INFO     | tldw_chatbook.app:__init__:1138 -   basic_init: 0.002s (33.8%)
2025-06-29 00:20:45.405 | INFO     | tldw_chatbook.app:__init__:1138 -   attribute_init: 0.000s (0.2%)
2025-06-29 00:20:45.405 | INFO     | tldw_chatbook.app:__init__:1138 -   notes_service_init: 0.000s (2.8%)
2025-06-29 00:20:45.405 | INFO     | tldw_chatbook.app:__init__:1138 -   providers_models: 0.002s (35.4%)
2025-06-29 00:20:45.405 | INFO     | tldw_chatbook.app:__init__:1138 -   prompts_service_init: 0.000s (6.0%)
2025-06-29 00:20:45.405 | INFO     | tldw_chatbook.app:__init__:1138 -   media_db_init: 0.001s (7.7%)
2025-06-29 00:20:45.405 | INFO     | tldw_chatbook.app:__init__:1139 - ==============================
----------------------------------------

11. 2025-06-29 00:20:45,405 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

12. 2025-06-29 00:20:45,405 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:20:45,405 [INFO] root:444 - Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/media.db [Client ID: test_client_id]
2025-06-29 00:20:45,405 [DEBUG] root:510 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/media.db [Client: test_client_id, Thread: MainThread]
2025-06-29 00:20:45,405 [INFO] root:747 - Checking DB schema. Current version: 0. Code supports: 1
2025-06-29 00:20:45,405 [INFO] root:680 - Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/media.db...
2025-06-29 00:20:45,405 [DEBUG] root:647 - Started transaction.
2025-06-29 00:20:45,405 [DEBUG] root:694 - [Schema V1] Applying Core Schema + Version Update...
2025-06-29 00:20:45,410 [DEBUG] root:696 - [Schema V1] Core Schema script (incl. version update) executed.
2025-06-29 00:20:45,410 [DEBUG] root:707 - [Schema V1] Media table structure validated successfully.
2025-06-29 00:20:45,410 [DEBUG] root:719 - [Schema V1] Version check inside transaction confirmed version is 1.
2025-06-29 00:20:45,410 [DEBUG] root:652 - Committed transaction.
2025-06-29 00:20:45,410 [INFO] root:722 - [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/media.db.
2025-06-29 00:20:45,410 [DEBUG] root:726 - [Schema V1] Applying FTS Tables...
2025-06-29 00:20:45,410 [INFO] root:729 - [Schema V1] FTS Tables created successfully.
2025-06-29 00:20:45,410 [INFO] root:771 - Database schema initialized/migrated to version 1.
2025-06-29 00:20:45,410 [DEBUG] root:474 - Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/media.db
2025-06-29 00:20:45.411 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:__init__:992 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:20:45.411 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1051 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:20:45.411 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__enter__:4087 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:20:45.411 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1403 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:20:45.411 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1322 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/chachanotes.db...
2025-06-29 00:20:45.417 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1326 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:20:45.417 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1332 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/chachanotes.db.
2025-06-29 00:20:45.417 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1357 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/chachanotes.db...
2025-06-29 00:20:45.423 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1361 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:20:45.423 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1369 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/chachanotes.db.
2025-06-29 00:20:45.423 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1432 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:20:45.423 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__exit__:4114 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:20:45.423 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__init__:996 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/chachanotes.db
2025-06-29 00:20:45,423 [INFO] root:1899 - add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
2025-06-29 00:20:45,423 [DEBUG] root:647 - Started transaction.
2025-06-29 00:20:45,423 [DEBUG] root:891 - Logged sync event: Media 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3 create v1 at 2025-06-29T07:20:45.423Z
2025-06-29 00:20:45,423 [DEBUG] root:919 - FTS update for media 1: sanitized content - null bytes replaced
2025-06-29 00:20:45,423 [DEBUG] root:924 - Updated FTS (insert or replace) for Media ID 1
2025-06-29 00:20:45.423 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword ',' UUID e9e4c5a5-1c9c-4e40-9964-9b64adc72e59
2025-06-29 00:20:45,423 [DEBUG] root:891 - Logged sync event: Keywords e9e4c5a5-1c9c-4e40-9964-9b64adc72e59 create v1 at 2025-06-29T07:20:45.423Z
2025-06-29 00:20:45,423 [DEBUG] root:973 - Updated FTS (insert or replace) for Keyword ID 1
2025-06-29 00:20:45.424 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'e' UUID 5b154acd-8bbc-47d3-a828-633564a0251c
2025-06-29 00:20:45,424 [DEBUG] root:891 - Logged sync event: Keywords 5b154acd-8bbc-47d3-a828-633564a0251c create v1 at 2025-06-29T07:20:45.424Z
2025-06-29 00:20:45,424 [DEBUG] root:973 - Updated FTS (insert or replace) for Keyword ID 2
2025-06-29 00:20:45.424 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'n' UUID 881db5e4-1679-4931-a03d-a2b127167e1f
2025-06-29 00:20:45,424 [DEBUG] root:891 - Logged sync event: Keywords 881db5e4-1679-4931-a03d-a2b127167e1f create v1 at 2025-06-29T07:20:45.424Z
2025-06-29 00:20:45,424 [DEBUG] root:973 - Updated FTS (insert or replace) for Keyword ID 3
2025-06-29 00:20:45.424 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'o' UUID ee947180-f867-4f48-aba9-07296cf66b65
2025-06-29 00:20:45,424 [DEBUG] root:891 - Logged sync event: Keywords ee947180-f867-4f48-aba9-07296cf66b65 create v1 at 2025-06-29T07:20:45.424Z
2025-06-29 00:20:45,424 [DEBUG] root:973 - Updated FTS (insert or replace) for Keyword ID 4
2025-06-29 00:20:45.424 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 's' UUID dbaee9aa-1ad7-4b01-bc67-1193fb5a447c
2025-06-29 00:20:45,424 [DEBUG] root:891 - Logged sync event: Keywords dbaee9aa-1ad7-4b01-bc67-1193fb5a447c create v1 at 2025-06-29T07:20:45.424Z
2025-06-29 00:20:45,424 [DEBUG] root:973 - Updated FTS (insert or replace) for Keyword ID 5
2025-06-29 00:20:45.424 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 't' UUID cdb786e3-da94-41db-9af5-628548482261
2025-06-29 00:20:45,424 [DEBUG] root:891 - Logged sync event: Keywords cdb786e3-da94-41db-9af5-628548482261 create v1 at 2025-06-29T07:20:45.424Z
2025-06-29 00:20:45,424 [DEBUG] root:973 - Updated FTS (insert or replace) for Keyword ID 6
2025-06-29 00:20:45,424 [DEBUG] root:891 - Logged sync event: MediaKeywords 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3_e9e4c5a5-1c9c-4e40-9964-9b64adc72e59 link v1 at 2025-06-29T07:20:45.424Z
2025-06-29 00:20:45,424 [DEBUG] root:891 - Logged sync event: MediaKeywords 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3_5b154acd-8bbc-47d3-a828-633564a0251c link v1 at 2025-06-29T07:20:45.424Z
2025-06-29 00:20:45,424 [DEBUG] root:891 - Logged sync event: MediaKeywords 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3_881db5e4-1679-4931-a03d-a2b127167e1f link v1 at 2025-06-29T07:20:45.424Z
2025-06-29 00:20:45,424 [DEBUG] root:891 - Logged sync event: MediaKeywords 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3_ee947180-f867-4f48-aba9-07296cf66b65 link v1 at 2025-06-29T07:20:45.424Z
2025-06-29 00:20:45,424 [DEBUG] root:891 - Logged sync event: MediaKeywords 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3_dbaee9aa-1ad7-4b01-bc67-1193fb5a447c link v1 at 2025-06-29T07:20:45.424Z
2025-06-29 00:20:45,424 [DEBUG] root:891 - Logged sync event: MediaKeywords 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3_cdb786e3-da94-41db-9af5-628548482261 link v1 at 2025-06-29T07:20:45.424Z
2025-06-29 00:20:45.424 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:update_keywords_for_media:2303 - Keywords updated media 1. Added: 6, Removed: 0.
2025-06-29 00:20:45.424 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:create_document_version:2187 - Creating document version 1 for media ID 1, UUID 1d3af87f-9644-42f1-aef2-ea0abb8392df
2025-06-29 00:20:45,424 [DEBUG] root:891 - Logged sync event: DocumentVersions 1d3af87f-9644-42f1-aef2-ea0abb8392df create v1 at 2025-06-29T07:20:45.424Z
2025-06-29 00:20:45,424 [DEBUG] root:652 - Committed transaction.
2025-06-29 00:20:45,424 [INFO] root:1899 - add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
2025-06-29 00:20:45,425 [DEBUG] root:647 - Started transaction.
2025-06-29 00:20:45,425 [DEBUG] root:891 - Logged sync event: Media f3823f31-33b3-4569-8752-e87098f6f169 create v1 at 2025-06-29T07:20:45.425Z
2025-06-29 00:20:45,425 [DEBUG] root:919 - FTS update for media 2: sanitized content - null bytes replaced
2025-06-29 00:20:45,425 [DEBUG] root:924 - Updated FTS (insert or replace) for Media ID 2
2025-06-29 00:20:45.425 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1464 - Keyword ',' already active.
2025-06-29 00:20:45.425 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1464 - Keyword 'e' already active.
2025-06-29 00:20:45.425 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1464 - Keyword 'o' already active.
2025-06-29 00:20:45.425 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1464 - Keyword 's' already active.
2025-06-29 00:20:45.425 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1464 - Keyword 't' already active.
2025-06-29 00:20:45.425 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'w' UUID cf4b0e67-bd96-4983-932e-4ec04740187d
2025-06-29 00:20:45,425 [DEBUG] root:891 - Logged sync event: Keywords cf4b0e67-bd96-4983-932e-4ec04740187d create v1 at 2025-06-29T07:20:45.425Z
2025-06-29 00:20:45,425 [DEBUG] root:973 - Updated FTS (insert or replace) for Keyword ID 7
2025-06-29 00:20:45,425 [DEBUG] root:891 - Logged sync event: MediaKeywords f3823f31-33b3-4569-8752-e87098f6f169_e9e4c5a5-1c9c-4e40-9964-9b64adc72e59 link v1 at 2025-06-29T07:20:45.425Z
2025-06-29 00:20:45,425 [DEBUG] root:891 - Logged sync event: MediaKeywords f3823f31-33b3-4569-8752-e87098f6f169_5b154acd-8bbc-47d3-a828-633564a0251c link v1 at 2025-06-29T07:20:45.425Z
2025-06-29 00:20:45,425 [DEBUG] root:891 - Logged sync event: MediaKeywords f3823f31-33b3-4569-8752-e87098f6f169_ee947180-f867-4f48-aba9-07296cf66b65 link v1 at 2025-06-29T07:20:45.425Z
2025-06-29 00:20:45,425 [DEBUG] root:891 - Logged sync event: MediaKeywords f3823f31-33b3-4569-8752-e87098f6f169_dbaee9aa-1ad7-4b01-bc67-1193fb5a447c link v1 at 2025-06-29T07:20:45.425Z
2025-06-29 00:20:45,425 [DEBUG] root:891 - Logged sync event: MediaKeywords f3823f31-33b3-4569-8752-e87098f6f169_cdb786e3-da94-41db-9af5-628548482261 link v1 at 2025-06-29T07:20:45.425Z
2025-06-29 00:20:45,425 [DEBUG] root:891 - Logged sync event: MediaKeywords f3823f31-33b3-4569-8752-e87098f6f169_cf4b0e67-bd96-4983-932e-4ec04740187d link v1 at 2025-06-29T07:20:45.425Z
2025-06-29 00:20:45.425 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:update_keywords_for_media:2303 - Keywords updated media 2. Added: 6, Removed: 0.
2025-06-29 00:20:45.425 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:create_document_version:2187 - Creating document version 1 for media ID 2, UUID c0335d15-8c38-43e7-892e-64b4c074b02c
2025-06-29 00:20:45,425 [DEBUG] root:891 - Logged sync event: DocumentVersions c0335d15-8c38-43e7-892e-64b4c074b02c create v1 at 2025-06-29T07:20:45.425Z
2025-06-29 00:20:45,425 [DEBUG] root:652 - Committed transaction.
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

13. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

14. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

15. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
----------------------------------------

16. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

17. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
----------------------------------------

18. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

19. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

20. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
----------------------------------------

21. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

22. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/media.db [Client ID: test_client_id]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/media.db [Client: test_client_id, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 0. Code supports: 1
INFO     root:Client_Media_DB_v2.py:680 Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/media.db...
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:694 [Schema V1] Applying Core Schema + Version Update...
DEBUG    root:Client_Media_DB_v2.py:696 [Schema V1] Core Schema script (incl. version update) executed.
DEBUG    root:Client_Media_DB_v2.py:707 [Schema V1] Media table structure validated successfully.
DEBUG    root:Client_Media_DB_v2.py:719 [Schema V1] Version check inside transaction confirmed version is 1.
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:722 [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/media.db.
DEBUG    root:Client_Media_DB_v2.py:726 [Schema V1] Applying FTS Tables...
INFO     root:Client_Media_DB_v2.py:729 [Schema V1] FTS Tables created successfully.
INFO     root:Client_Media_DB_v2.py:771 Database schema initialized/migrated to version 1.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/media.db
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3 create v1 at 2025-06-29T07:20:45.423Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 1: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 1
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords e9e4c5a5-1c9c-4e40-9964-9b64adc72e59 create v1 at 2025-06-29T07:20:45.423Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 1
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 5b154acd-8bbc-47d3-a828-633564a0251c create v1 at 2025-06-29T07:20:45.424Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 2
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 881db5e4-1679-4931-a03d-a2b127167e1f create v1 at 2025-06-29T07:20:45.424Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 3
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords ee947180-f867-4f48-aba9-07296cf66b65 create v1 at 2025-06-29T07:20:45.424Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 4
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords dbaee9aa-1ad7-4b01-bc67-1193fb5a447c create v1 at 2025-06-29T07:20:45.424Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 5
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords cdb786e3-da94-41db-9af5-628548482261 create v1 at 2025-06-29T07:20:45.424Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 6
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3_e9e4c5a5-1c9c-4e40-9964-9b64adc72e59 link v1 at 2025-06-29T07:20:45.424Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3_5b154acd-8bbc-47d3-a828-633564a0251c link v1 at 2025-06-29T07:20:45.424Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3_881db5e4-1679-4931-a03d-a2b127167e1f link v1 at 2025-06-29T07:20:45.424Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3_ee947180-f867-4f48-aba9-07296cf66b65 link v1 at 2025-06-29T07:20:45.424Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3_dbaee9aa-1ad7-4b01-bc67-1193fb5a447c link v1 at 2025-06-29T07:20:45.424Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3_cdb786e3-da94-41db-9af5-628548482261 link v1 at 2025-06-29T07:20:45.424Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions 1d3af87f-9644-42f1-aef2-ea0abb8392df create v1 at 2025-06-29T07:20:45.424Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media f3823f31-33b3-4569-8752-e87098f6f169 create v1 at 2025-06-29T07:20:45.425Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 2: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 2
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords cf4b0e67-bd96-4983-932e-4ec04740187d create v1 at 2025-06-29T07:20:45.425Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 7
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords f3823f31-33b3-4569-8752-e87098f6f169_e9e4c5a5-1c9c-4e40-9964-9b64adc72e59 link v1 at 2025-06-29T07:20:45.425Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords f3823f31-33b3-4569-8752-e87098f6f169_5b154acd-8bbc-47d3-a828-633564a0251c link v1 at 2025-06-29T07:20:45.425Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords f3823f31-33b3-4569-8752-e87098f6f169_ee947180-f867-4f48-aba9-07296cf66b65 link v1 at 2025-06-29T07:20:45.425Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords f3823f31-33b3-4569-8752-e87098f6f169_dbaee9aa-1ad7-4b01-bc67-1193fb5a447c link v1 at 2025-06-29T07:20:45.425Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords f3823f31-33b3-4569-8752-e87098f6f169_cdb786e3-da94-41db-9af5-628548482261 link v1 at 2025-06-29T07:20:45.425Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords f3823f31-33b3-4569-8752-e87098f6f169_cf4b0e67-bd96-4983-932e-4ec04740187d link v1 at 2025-06-29T07:20:45.425Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions c0335d15-8c38-43e7-892e-64b4c074b02c create v1 at 2025-06-29T07:20:45.425Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:20:45,450 [DEBUG] root:1289 - App composing UI...
2025-06-29 00:20:45.451 | DEBUG    | tldw_chatbook.UI.Chat_Window:__init__:44 - ChatWindow initialized.
2025-06-29 00:20:45.451 | DEBUG    | tldw_chatbook.UI.Conv_Char_Window:__init__:37 - CCPWindow initialized.
2025-06-29 00:20:45.451 | DEBUG    | tldw_chatbook.UI.Ingest_Window:__init__:49 - IngestWindow initialized.
----------------------------------------

23. 2025-06-29 00:20:45,451 [ERROR] root:99 - Failed to log histogram app_compose_duration_seconds: No label names were set when constructing histogram:app_compose_duration_seconds
2025-06-29 00:20:45,451 [DEBUG] root:1329 - App compose finished in 0.001 seconds
----------------------------------------

24. 2025-06-29 00:20:45,451 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

25. 2025-06-29 00:20:45,451 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:20:45.461 | DEBUG    | tldw_chatbook.UI.Chat_Window:compose:101 - Composing ChatWindow UI
2025-06-29 00:20:45.461 | INFO     | tldw_chatbook.config:load_settings:207 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:45.461 | INFO     | tldw_chatbook.config:load_settings:208 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:45.461 | INFO     | tldw_chatbook.config:load_settings:217 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:20:45.461 | WARNING  | tldw_chatbook.config:load_settings:223 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:20:45.461 | INFO     | tldw_chatbook.config:load_settings:232 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:45.462 | INFO     | tldw_chatbook.config:load_settings:237 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:45.463 | INFO     | tldw_chatbook.config:load_settings:252 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:20:45,463 [INFO] root:42 - Sidebar chat: Received providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:20:45.468 | DEBUG    | tldw_chatbook.UI.Chat_Window:compose:128 - 'respond-for-me-button' composed.
2025-06-29 00:20:45.468 | DEBUG    | tldw_chatbook.app:watch_current_chat_is_ephemeral:1912 - Chat ephemeral state changed to: True
2025-06-29 00:20:45,471 [DEBUG] root:355 - Character sidebar (id='chat-right-sidebar', prefix='chat') created with ephemeral state: True
2025-06-29 00:20:45.472 | DEBUG    | tldw_chatbook.UI.Conv_Char_Window:compose:40 - Composing CCPWindow UI
2025-06-29 00:20:45.473 | DEBUG    | tldw_chatbook.UI.Conv_Char_Window:compose:70 - Composing center pane
2025-06-29 00:20:45.476 | DEBUG    | tldw_chatbook.UI.Conv_Char_Window:compose:190 - Composing right pane
2025-06-29 00:20:45.489 | DEBUG    | tldw_chatbook.Utils.optional_deps:check_dependency:51 - ✅ numpy dependency found. Feature 'numpy' is enabled.
2025-06-29 00:20:45.489 | DEBUG    | tldw_chatbook.Utils.optional_deps:check_dependency:51 - ✅ torch dependency found. Feature 'torch' is enabled.
2025-06-29 00:20:45.489 | DEBUG    | tldw_chatbook.Utils.optional_deps:check_dependency:51 - ✅ transformers dependency found. Feature 'transformers' is enabled.
2025-06-29 00:20:45.489 | DEBUG    | tldw_chatbook.Utils.optional_deps:check_dependency:51 - ✅ sentence_transformers dependency found. Feature 'sentence_transformers' is enabled.
2025-06-29 00:20:45.628 | DEBUG    | tldw_chatbook.UI.SearchRAGWindow:_load_recent_search_history:1213 - Loaded 0 recent search queries
2025-06-29 00:20:45.632 | DEBUG    | tldw_chatbook.UI.Ingest_Window:compose:233 - Composing IngestWindow UI
2025-06-29 00:20:45,685 [INFO] root:25 - MetricsScreen initialized. Log path: /tmp/app_metrics.log
2025-06-29 00:20:45,713 [INFO] root:76 - MetricsScreen composing. Current metrics: {}
2025-06-29 00:20:45,713 [WARNING] root:79 - MetricsScreen compose: self.metrics is unexpectedly empty at compose time.
2025-06-29 00:20:45,713 [INFO] root:93 - MetricsScreen compose finished.
2025-06-29 00:20:46,300 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,301 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,302 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,302 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,306 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,306 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,307 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,307 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,307 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,307 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,310 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,310 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,310 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,529 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,310 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,310 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,323 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,342 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,502 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,521 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,533 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,533 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,310 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,537 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,543 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,562 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,585 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,604 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,617 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,633 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,640 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,643 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:46,659 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,681 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,681 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,685 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,690 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,696 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [INFO] root:29 - MetricsScreen on_mount: Calling load_metrics.
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,643 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:46,643 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [INFO] root:45 - Attempting to load metrics from: /tmp/app_metrics.log
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,675 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
----------------------------------------

26. 2025-06-29 00:20:46,698 [ERROR] root:68 - MetricsScreen: Log file not found at /tmp/app_metrics.log.
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,699 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,699 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,699 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,699 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,699 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,699 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,699 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46.822 | INFO     | tldw_chatbook.UI.Coding_Window:on_mount:88 - CodingWindow on_mount: UI composed
2025-06-29 00:20:46,699 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,699 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:46,711 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:46,711 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,729 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,744 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,886 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,779 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,794 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,804 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,822 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,833 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:46,850 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:46,866 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,876 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,760 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,887 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,908 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,921 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,934 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:46,946 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:46,963 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,972 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,973 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,979 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,985 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,986 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:47.007 | DEBUG    | tldw_chatbook.UI.LLM_Management_Window:on_mount:33 - LLMManagementWindow.on_mount called
2025-06-29 00:20:46,986 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:46,986 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,990 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,996 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,996 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:47,007 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:47,010 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:47,010 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:47,010 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:47.011 | INFO     | tldw_chatbook.UI.Evals_Window:on_mount:449 - EvalsWindow on_mount: UI composed
2025-06-29 00:20:47,010 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:47,010 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:47,011 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:47,011 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:47,011 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:47,011 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:47,011 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:47,011 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:47,011 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:47,011 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:47,011 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:47,011 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 3, False
----------------------------------------

27. 2025-06-29 00:20:47.014 | ERROR    | tldw_chatbook.UI.Evals_Window:on_mount:463 - Error initializing evaluation system: cannot import name 'EvaluationOrchestrator' from 'tldw_chatbook.Evals' (/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Evals/__init__.py)
2025-06-29 00:20:47,055 [DEBUG] chromadb.config:359 - Starting component System
2025-06-29 00:20:47,055 [DEBUG] chromadb.config:359 - Starting component Posthog
2025-06-29 00:20:47.059 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /Users/appledev/.local/share/tldw_cli/chromadb
2025-06-29 00:20:47.060 | INFO     | tldw_chatbook.RAG_Search.Services.cache_service:_load_persistent_caches:252 - Loaded 0 embeddings from persistent cache
2025-06-29 00:20:47.061 | INFO     | tldw_chatbook.UI.SearchWindow:on_mount:143 - SearchWindow.on_mount: Setting and initializing initial active sub-tab.
2025-06-29 00:20:47.063 | DEBUG    | tldw_chatbook.UI.SearchWindow:on_mount:147 - SearchWindow.on_mount: Setting view search-view-rag-chat display to False
2025-06-29 00:20:47.063 | DEBUG    | tldw_chatbook.UI.SearchWindow:on_mount:147 - SearchWindow.on_mount: Setting view search-view-rag-management display to False
2025-06-29 00:20:47.063 | DEBUG    | tldw_chatbook.UI.SearchWindow:on_mount:147 - SearchWindow.on_mount: Setting view search-view-embeddings-creation display to False
2025-06-29 00:20:47.063 | DEBUG    | tldw_chatbook.UI.SearchWindow:on_mount:147 - SearchWindow.on_mount: Setting view search-view-embeddings-management display to False
2025-06-29 00:20:47.063 | DEBUG    | tldw_chatbook.UI.SearchWindow:on_mount:147 - SearchWindow.on_mount: Setting view search-view-web-search display to False
2025-06-29 00:20:47.063 | DEBUG    | tldw_chatbook.UI.SearchWindow:on_mount:158 - SearchWindow.on_mount: Initial active sub-tab set to search-view-embeddings-creation
2025-06-29 00:20:47.063 | DEBUG    | tldw_chatbook.UI.SearchWindow:on_mount:164 - SearchWindow.on_mount: Added active class to nav button search-nav-embeddings-creation
2025-06-29 00:20:47.064 | DEBUG    | tldw_chatbook.UI.SearchWindow:on_mount:171 - SearchWindow.on_mount: Set display=True for active view search-view-embeddings-creation
2025-06-29 00:20:47.064 | INFO     | tldw_chatbook.UI.SearchWindow:on_mount:176 - SearchWindow.on_mount: Initializing view search-view-embeddings-creation
2025-06-29 00:20:47.064 | INFO     | tldw_chatbook.UI.SearchWindow:_initialize_embeddings_creation_view:809 - Initializing Embeddings Creation view.
2025-06-29 00:20:47.068 | DEBUG    | tldw_chatbook.UI.SearchWindow:on_creation_provider_select_changed:510 - Creation provider select changed to: huggingface
2025-06-29 00:20:47.069 | DEBUG    | tldw_chatbook.UI.SearchWindow:on_creation_model_select_changed:518 - Creation model select changed to: e5-small-v2 for provider: huggingface
2025-06-29 00:20:47.071 | DEBUG    | tldw_chatbook.UI.SearchWindow:_update_creation_provider_specific_inputs_visibility:551 - Provider specific inputs visibility updated. Custom HF: False, Local API URL: False (Value: '', Disabled: False)
2025-06-29 00:20:47,073 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,073 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,073 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,073 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,073 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,073 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,073 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,073 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,073 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,073 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,077 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,077 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,077 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,077 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,077 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,077 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,077 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,077 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,077 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,077 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,079 [INFO] root:137 - --- _setup_logging START (from Logging_Config.py) ---
2025-06-29 00:20:47,079 [INFO] root:145 - Loguru: All pre-existing sinks removed.
2025-06-29 00:20:47,082 [INFO] root:168 - Loguru: Configured to forward its messages to standard Python logging system.
INFO: _setup_logging: Removed 7 pre-existing handler(s) from root logger.
INFO: _setup_logging: Root logger level set to DEBUG
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
------------------------------ Captured log call -------------------------------
DEBUG    root:app.py:1289 App composing UI...
----------------------------------------

28. ERROR    root:metrics.py:99 Failed to log histogram app_compose_duration_seconds: No label names were set when constructing histogram:app_compose_duration_seconds
DEBUG    root:app.py:1329 App compose finished in 0.001 seconds
----------------------------------------

29. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

30. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:settings_sidebar.py:42 Sidebar chat: Received providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
DEBUG    root:chat_right_sidebar.py:355 Character sidebar (id='chat-right-sidebar', prefix='chat') created with ephemeral state: True
INFO     root:Stats_screen.py:25 MetricsScreen initialized. Log path: /tmp/app_metrics.log
INFO     root:Stats_screen.py:76 MetricsScreen composing. Current metrics: {}
WARNING  root:Stats_screen.py:79 MetricsScreen compose: self.metrics is unexpectedly empty at compose time.
INFO     root:Stats_screen.py:93 MetricsScreen compose finished.
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:29 MetricsScreen on_mount: Calling load_metrics.
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:45 Attempting to load metrics from: /tmp/app_metrics.log
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
----------------------------------------

31. ERROR    root:Stats_screen.py:68 MetricsScreen: Log file not found at /tmp/app_metrics.log.
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    chromadb.config:config.py:359 Starting component System
DEBUG    chromadb.config:config.py:359 Starting component Posthog
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Logging_Config.py:137 --- _setup_logging START (from Logging_Config.py) ---
INFO     root:Logging_Config.py:145 Loguru: All pre-existing sinks removed.
INFO     root:Logging_Config.py:168 Loguru: Configured to forward its messages to standard Python logging system.
--------------------------- Captured stderr teardown ---------------------------
2025-06-29 00:20:49 [DEBUG   ] root:535 - Closed connection for thread MainThread.
---------------------------- Captured log teardown -----------------------------
DEBUG    root:Client_Media_DB_v2.py:535 Closed connection for thread MainThread.
----------------------------------------

32. _____________ ERROR at teardown of test_media_search_functionality _____________
Tests/Chat/test_chat_sidebar_media_search.py:102: in real_app_media_test
    app.chachanotes_db.close()
    ^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'CharactersRAGDB' object has no attribute 'close'
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:20:49 [DEBUG   ] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

33. 2025-06-29 00:20:49 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

34. 2025-06-29 00:20:49 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

35. 2025-06-29 00:20:49 [ERROR   ] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:20:49 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

36. 2025-06-29 00:20:49 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

37. 2025-06-29 00:20:49 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:20:49 [DEBUG   ] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:20:49 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:20:49 [INFO    ] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:20:49 [INFO    ] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:20:49 [WARNING ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Database schema is up to date.
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Verified FTS tables exist.
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts Interop Library initialized successfully.
2025-06-29 00:20:49 [INFO    ] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:20:49 [INFO    ] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:20:49 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:20:49 [INFO    ] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:20:49 [DEBUG   ] root:750 - Database schema is up to date.
2025-06-29 00:20:49 [DEBUG   ] root:755 - Verified FTS tables exist.
2025-06-29 00:20:49 [DEBUG   ] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x16b333bc0>
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:20:49 [DEBUG   ] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

38. 2025-06-29 00:20:49 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

39. 2025-06-29 00:20:49 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:20:49 [INFO    ] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:20:49 [INFO    ] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

40. 2025-06-29 00:20:49 [ERROR   ] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 - Total initialization time: 0.008 seconds
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 -   basic_init: 0.002s (29.5%)
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 -   attribute_init: 0.000s (0.2%)
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 -   notes_service_init: 0.000s (3.0%)
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 -   providers_models: 0.003s (41.2%)
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 -   prompts_service_init: 0.001s (8.3%)
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 -   media_db_init: 0.001s (7.8%)
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 - ==============================
----------------------------------------

41. 2025-06-29 00:20:49 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

42. 2025-06-29 00:20:49 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:20:49 [INFO    ] root:444 - Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/media.db [Client ID: test_client_id]
2025-06-29 00:20:49 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/media.db [Client: test_client_id, Thread: MainThread]
2025-06-29 00:20:49 [INFO    ] root:747 - Checking DB schema. Current version: 0. Code supports: 1
2025-06-29 00:20:49 [INFO    ] root:680 - Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/media.db...
2025-06-29 00:20:49 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:20:49 [DEBUG   ] root:694 - [Schema V1] Applying Core Schema + Version Update...
2025-06-29 00:20:49 [DEBUG   ] root:696 - [Schema V1] Core Schema script (incl. version update) executed.
2025-06-29 00:20:49 [DEBUG   ] root:707 - [Schema V1] Media table structure validated successfully.
2025-06-29 00:20:49 [DEBUG   ] root:719 - [Schema V1] Version check inside transaction confirmed version is 1.
2025-06-29 00:20:49 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:20:49 [INFO    ] root:722 - [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/media.db.
2025-06-29 00:20:49 [DEBUG   ] root:726 - [Schema V1] Applying FTS Tables...
2025-06-29 00:20:49 [INFO    ] root:729 - [Schema V1] FTS Tables created successfully.
2025-06-29 00:20:49 [INFO    ] root:771 - Database schema initialized/migrated to version 1.
2025-06-29 00:20:49 [DEBUG   ] root:474 - Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/media.db
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db...
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db.
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db...
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db.
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db
2025-06-29 00:20:49 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
2025-06-29 00:20:49 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: Media a36cad3b-ae23-40c7-8b1d-475a865de69a create v1 at 2025-06-29T07:20:49.330Z
2025-06-29 00:20:49 [DEBUG   ] root:919 - FTS update for media 1: sanitized content - null bytes replaced
2025-06-29 00:20:49 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 1
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword ',' UUID a2cf38aa-98e5-4781-ae9c-46c8e711d64b
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: Keywords a2cf38aa-98e5-4781-ae9c-46c8e711d64b create v1 at 2025-06-29T07:20:49.330Z
2025-06-29 00:20:49 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 1
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'e' UUID b7b53f48-0a13-43a0-959c-fb656fd99a1d
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: Keywords b7b53f48-0a13-43a0-959c-fb656fd99a1d create v1 at 2025-06-29T07:20:49.330Z
2025-06-29 00:20:49 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 2
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'n' UUID b2e1e8f9-b8c1-462e-998e-ff7d5930ac75
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: Keywords b2e1e8f9-b8c1-462e-998e-ff7d5930ac75 create v1 at 2025-06-29T07:20:49.331Z
2025-06-29 00:20:49 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 3
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'o' UUID ef048d9f-655e-4f32-83f4-13336b6dd2c8
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: Keywords ef048d9f-655e-4f32-83f4-13336b6dd2c8 create v1 at 2025-06-29T07:20:49.331Z
2025-06-29 00:20:49 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 4
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 's' UUID 1c938651-6ba2-41d3-b43c-064e1f55781a
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: Keywords 1c938651-6ba2-41d3-b43c-064e1f55781a create v1 at 2025-06-29T07:20:49.331Z
2025-06-29 00:20:49 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 5
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 't' UUID cab1aa15-8908-4230-a193-0888c77eac33
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: Keywords cab1aa15-8908-4230-a193-0888c77eac33 create v1 at 2025-06-29T07:20:49.331Z
2025-06-29 00:20:49 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 6
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: MediaKeywords a36cad3b-ae23-40c7-8b1d-475a865de69a_a2cf38aa-98e5-4781-ae9c-46c8e711d64b link v1 at 2025-06-29T07:20:49.331Z
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: MediaKeywords a36cad3b-ae23-40c7-8b1d-475a865de69a_b7b53f48-0a13-43a0-959c-fb656fd99a1d link v1 at 2025-06-29T07:20:49.331Z
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: MediaKeywords a36cad3b-ae23-40c7-8b1d-475a865de69a_b2e1e8f9-b8c1-462e-998e-ff7d5930ac75 link v1 at 2025-06-29T07:20:49.331Z
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: MediaKeywords a36cad3b-ae23-40c7-8b1d-475a865de69a_ef048d9f-655e-4f32-83f4-13336b6dd2c8 link v1 at 2025-06-29T07:20:49.331Z
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: MediaKeywords a36cad3b-ae23-40c7-8b1d-475a865de69a_1c938651-6ba2-41d3-b43c-064e1f55781a link v1 at 2025-06-29T07:20:49.331Z
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: MediaKeywords a36cad3b-ae23-40c7-8b1d-475a865de69a_cab1aa15-8908-4230-a193-0888c77eac33 link v1 at 2025-06-29T07:20:49.331Z
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 1. Added: 6, Removed: 0.
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 1, UUID daeb75e6-8abd-44fc-a39c-db19e4eb2ddf
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: DocumentVersions daeb75e6-8abd-44fc-a39c-db19e4eb2ddf create v1 at 2025-06-29T07:20:49.331Z
2025-06-29 00:20:49 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:20:49 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
2025-06-29 00:20:49 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: Media 31c3322c-44be-4b5f-8608-b1cbe236f6f4 create v1 at 2025-06-29T07:20:49.332Z
2025-06-29 00:20:49 [DEBUG   ] root:919 - FTS update for media 2: sanitized content - null bytes replaced
2025-06-29 00:20:49 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 2
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword ',' already active.
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'e' already active.
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'o' already active.
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 's' already active.
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 't' already active.
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'w' UUID 10a37140-1e6c-4a0f-a8b2-d0182fcb7400
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: Keywords 10a37140-1e6c-4a0f-a8b2-d0182fcb7400 create v1 at 2025-06-29T07:20:49.332Z
2025-06-29 00:20:49 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 7
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 31c3322c-44be-4b5f-8608-b1cbe236f6f4_a2cf38aa-98e5-4781-ae9c-46c8e711d64b link v1 at 2025-06-29T07:20:49.332Z
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 31c3322c-44be-4b5f-8608-b1cbe236f6f4_b7b53f48-0a13-43a0-959c-fb656fd99a1d link v1 at 2025-06-29T07:20:49.332Z
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 31c3322c-44be-4b5f-8608-b1cbe236f6f4_ef048d9f-655e-4f32-83f4-13336b6dd2c8 link v1 at 2025-06-29T07:20:49.332Z
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 31c3322c-44be-4b5f-8608-b1cbe236f6f4_1c938651-6ba2-41d3-b43c-064e1f55781a link v1 at 2025-06-29T07:20:49.332Z
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 31c3322c-44be-4b5f-8608-b1cbe236f6f4_cab1aa15-8908-4230-a193-0888c77eac33 link v1 at 2025-06-29T07:20:49.332Z
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 31c3322c-44be-4b5f-8608-b1cbe236f6f4_10a37140-1e6c-4a0f-a8b2-d0182fcb7400 link v1 at 2025-06-29T07:20:49.332Z
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 2. Added: 6, Removed: 0.
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 2, UUID ec3a2beb-2743-4d7f-8d3b-4b5881afaad7
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: DocumentVersions ec3a2beb-2743-4d7f-8d3b-4b5881afaad7 create v1 at 2025-06-29T07:20:49.332Z
2025-06-29 00:20:49 [DEBUG   ] root:652 - Committed transaction.
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

43. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

44. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

45. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     tldw_chatbook.app:Logging_Config.py:160 Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

46. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

47. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
WARNING  tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Checking DB schema. Current: 1, Code supports: 1
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Database schema is up to date.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Verified FTS tables exist.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts Interop Library initialized successfully.
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x16b333bc0>
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Found 3 distinct media types: ['article', 'podcast', 'video']
INFO     tldw_chatbook.app:Logging_Config.py:160 App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

48. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

49. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

50. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
INFO     tldw_chatbook.app:Logging_Config.py:160 === STARTUP TIMING SUMMARY ===
INFO     tldw_chatbook.app:Logging_Config.py:160 Total initialization time: 0.008 seconds
INFO     tldw_chatbook.app:Logging_Config.py:160   basic_init: 0.002s (29.5%)
INFO     tldw_chatbook.app:Logging_Config.py:160   attribute_init: 0.000s (0.2%)
INFO     tldw_chatbook.app:Logging_Config.py:160   notes_service_init: 0.000s (3.0%)
INFO     tldw_chatbook.app:Logging_Config.py:160   providers_models: 0.003s (41.2%)
INFO     tldw_chatbook.app:Logging_Config.py:160   prompts_service_init: 0.001s (8.3%)
INFO     tldw_chatbook.app:Logging_Config.py:160   media_db_init: 0.001s (7.8%)
INFO     tldw_chatbook.app:Logging_Config.py:160 ==============================
----------------------------------------

51. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

52. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/media.db [Client ID: test_client_id]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/media.db [Client: test_client_id, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 0. Code supports: 1
INFO     root:Client_Media_DB_v2.py:680 Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/media.db...
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:694 [Schema V1] Applying Core Schema + Version Update...
DEBUG    root:Client_Media_DB_v2.py:696 [Schema V1] Core Schema script (incl. version update) executed.
DEBUG    root:Client_Media_DB_v2.py:707 [Schema V1] Media table structure validated successfully.
DEBUG    root:Client_Media_DB_v2.py:719 [Schema V1] Version check inside transaction confirmed version is 1.
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:722 [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/media.db.
DEBUG    root:Client_Media_DB_v2.py:726 [Schema V1] Applying FTS Tables...
INFO     root:Client_Media_DB_v2.py:729 [Schema V1] FTS Tables created successfully.
INFO     root:Client_Media_DB_v2.py:771 Database schema initialized/migrated to version 1.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/media.db
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db [Client ID: test_user]
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db (Journal: wal) for thread 8705548032
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction started (outermost) on thread 8705548032.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Full schema script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction (outermost) committed successfully on thread 8705548032.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media a36cad3b-ae23-40c7-8b1d-475a865de69a create v1 at 2025-06-29T07:20:49.330Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 1: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword ',' UUID a2cf38aa-98e5-4781-ae9c-46c8e711d64b
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords a2cf38aa-98e5-4781-ae9c-46c8e711d64b create v1 at 2025-06-29T07:20:49.330Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'e' UUID b7b53f48-0a13-43a0-959c-fb656fd99a1d
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords b7b53f48-0a13-43a0-959c-fb656fd99a1d create v1 at 2025-06-29T07:20:49.330Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 2
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'n' UUID b2e1e8f9-b8c1-462e-998e-ff7d5930ac75
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords b2e1e8f9-b8c1-462e-998e-ff7d5930ac75 create v1 at 2025-06-29T07:20:49.331Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 3
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'o' UUID ef048d9f-655e-4f32-83f4-13336b6dd2c8
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords ef048d9f-655e-4f32-83f4-13336b6dd2c8 create v1 at 2025-06-29T07:20:49.331Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 4
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 's' UUID 1c938651-6ba2-41d3-b43c-064e1f55781a
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 1c938651-6ba2-41d3-b43c-064e1f55781a create v1 at 2025-06-29T07:20:49.331Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 5
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 't' UUID cab1aa15-8908-4230-a193-0888c77eac33
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords cab1aa15-8908-4230-a193-0888c77eac33 create v1 at 2025-06-29T07:20:49.331Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 6
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords a36cad3b-ae23-40c7-8b1d-475a865de69a_a2cf38aa-98e5-4781-ae9c-46c8e711d64b link v1 at 2025-06-29T07:20:49.331Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords a36cad3b-ae23-40c7-8b1d-475a865de69a_b7b53f48-0a13-43a0-959c-fb656fd99a1d link v1 at 2025-06-29T07:20:49.331Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords a36cad3b-ae23-40c7-8b1d-475a865de69a_b2e1e8f9-b8c1-462e-998e-ff7d5930ac75 link v1 at 2025-06-29T07:20:49.331Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords a36cad3b-ae23-40c7-8b1d-475a865de69a_ef048d9f-655e-4f32-83f4-13336b6dd2c8 link v1 at 2025-06-29T07:20:49.331Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords a36cad3b-ae23-40c7-8b1d-475a865de69a_1c938651-6ba2-41d3-b43c-064e1f55781a link v1 at 2025-06-29T07:20:49.331Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords a36cad3b-ae23-40c7-8b1d-475a865de69a_cab1aa15-8908-4230-a193-0888c77eac33 link v1 at 2025-06-29T07:20:49.331Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 1. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 1, UUID daeb75e6-8abd-44fc-a39c-db19e4eb2ddf
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions daeb75e6-8abd-44fc-a39c-db19e4eb2ddf create v1 at 2025-06-29T07:20:49.331Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media 31c3322c-44be-4b5f-8608-b1cbe236f6f4 create v1 at 2025-06-29T07:20:49.332Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 2: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 2
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword ',' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'e' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'o' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 's' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 't' already active.
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'w' UUID 10a37140-1e6c-4a0f-a8b2-d0182fcb7400
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 10a37140-1e6c-4a0f-a8b2-d0182fcb7400 create v1 at 2025-06-29T07:20:49.332Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 7
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 31c3322c-44be-4b5f-8608-b1cbe236f6f4_a2cf38aa-98e5-4781-ae9c-46c8e711d64b link v1 at 2025-06-29T07:20:49.332Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 31c3322c-44be-4b5f-8608-b1cbe236f6f4_b7b53f48-0a13-43a0-959c-fb656fd99a1d link v1 at 2025-06-29T07:20:49.332Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 31c3322c-44be-4b5f-8608-b1cbe236f6f4_ef048d9f-655e-4f32-83f4-13336b6dd2c8 link v1 at 2025-06-29T07:20:49.332Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 31c3322c-44be-4b5f-8608-b1cbe236f6f4_1c938651-6ba2-41d3-b43c-064e1f55781a link v1 at 2025-06-29T07:20:49.332Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 31c3322c-44be-4b5f-8608-b1cbe236f6f4_cab1aa15-8908-4230-a193-0888c77eac33 link v1 at 2025-06-29T07:20:49.332Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 31c3322c-44be-4b5f-8608-b1cbe236f6f4_10a37140-1e6c-4a0f-a8b2-d0182fcb7400 link v1 at 2025-06-29T07:20:49.332Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 2. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 2, UUID ec3a2beb-2743-4d7f-8d3b-4b5881afaad7
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions ec3a2beb-2743-4d7f-8d3b-4b5881afaad7 create v1 at 2025-06-29T07:20:49.332Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO: _setup_logging: Removed 5 pre-existing handler(s) from root logger.
INFO: _setup_logging: Root logger level set to DEBUG
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
------------------------------ Captured log call -------------------------------
DEBUG    root:app.py:1289 App composing UI...
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 ChatWindow initialized.
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 CCPWindow initialized.
DEBUG    tldw_chatbook.UI.Ingest_Window:Logging_Config.py:160 IngestWindow initialized.
----------------------------------------

53. ERROR    root:metrics.py:99 Failed to log histogram app_compose_duration_seconds: No label names were set when constructing histogram:app_compose_duration_seconds
DEBUG    root:app.py:1329 App compose finished in 0.001 seconds
----------------------------------------

54. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

55. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 Composing ChatWindow UI
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:settings_sidebar.py:42 Sidebar chat: Received providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 'respond-for-me-button' composed.
DEBUG    tldw_chatbook.app:Logging_Config.py:160 Chat ephemeral state changed to: True
DEBUG    root:chat_right_sidebar.py:355 Character sidebar (id='chat-right-sidebar', prefix='chat') created with ephemeral state: True
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing CCPWindow UI
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing center pane
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing right pane
DEBUG    tldw_chatbook.UI.SearchRAGWindow:Logging_Config.py:160 Loaded 0 recent search queries
DEBUG    tldw_chatbook.UI.Ingest_Window:Logging_Config.py:160 Composing IngestWindow UI
INFO     root:Stats_screen.py:25 MetricsScreen initialized. Log path: /tmp/app_metrics.log
INFO     root:Stats_screen.py:76 MetricsScreen composing. Current metrics: {}
WARNING  root:Stats_screen.py:79 MetricsScreen compose: self.metrics is unexpectedly empty at compose time.
INFO     root:Stats_screen.py:93 MetricsScreen compose finished.
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:29 MetricsScreen on_mount: Calling load_metrics.
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:45 Attempting to load metrics from: /tmp/app_metrics.log
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
----------------------------------------

56. ERROR    root:Stats_screen.py:68 MetricsScreen: Log file not found at /tmp/app_metrics.log.
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     tldw_chatbook.UI.Coding_Window:Logging_Config.py:160 CodingWindow on_mount: UI composed
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    tldw_chatbook.UI.LLM_Management_Window:Logging_Config.py:160 LLMManagementWindow.on_mount called
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 3, False
INFO     tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 EvalsWindow on_mount: UI composed
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
----------------------------------------

57. ERROR    tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 Error initializing evaluation system: cannot import name 'EvaluationOrchestrator' from 'tldw_chatbook.Evals' (/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Evals/__init__.py)
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=4,level=0,tokens=6), 4, 5, False
INFO     tldw_chatbook.RAG_Search.Services.embeddings_service:Logging_Config.py:160 ChromaDB initialized at /Users/appledev/.local/share/tldw_cli/chromadb
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting and initializing initial active sub-tab.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-chat display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-creation display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-web-search display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initial active sub-tab set to search-view-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Added active class to nav button search-nav-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Set display=True for active view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initializing view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Initializing Embeddings Creation view.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation provider select changed to: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation model select changed to: e5-small-v2 for provider: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Provider specific inputs visibility updated. Custom HF: False, Local API URL: False (Value: '', Disabled: False)
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Logging_Config.py:137 --- _setup_logging START (from Logging_Config.py) ---
INFO     root:Logging_Config.py:145 Loguru: All pre-existing sinks removed.
INFO     root:Logging_Config.py:168 Loguru: Configured to forward its messages to standard Python logging system.
--------------------------- Captured stderr teardown ---------------------------
2025-06-29 00:20:54 [DEBUG   ] root:535 - Closed connection for thread MainThread.
---------------------------- Captured log teardown -----------------------------
DEBUG    root:Client_Media_DB_v2.py:535 Closed connection for thread MainThread.
----------------------------------------

58. _______________ ERROR at teardown of test_media_load_for_review ________________
Tests/Chat/test_chat_sidebar_media_search.py:102: in real_app_media_test
    app.chachanotes_db.close()
    ^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'CharactersRAGDB' object has no attribute 'close'
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:20:54 [DEBUG   ] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

59. 2025-06-29 00:20:54 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

60. 2025-06-29 00:20:54 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

61. 2025-06-29 00:20:54 [ERROR   ] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:20:54 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

62. 2025-06-29 00:20:54 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

63. 2025-06-29 00:20:54 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:20:54 [DEBUG   ] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:20:54 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:20:54 [INFO    ] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:20:54 [INFO    ] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:20:54 [WARNING ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Database schema is up to date.
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Verified FTS tables exist.
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts Interop Library initialized successfully.
2025-06-29 00:20:54 [INFO    ] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:20:54 [INFO    ] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:20:54 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:20:54 [INFO    ] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:20:54 [DEBUG   ] root:750 - Database schema is up to date.
2025-06-29 00:20:54 [DEBUG   ] root:755 - Verified FTS tables exist.
2025-06-29 00:20:54 [DEBUG   ] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x173d01010>
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:20:54 [DEBUG   ] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

64. 2025-06-29 00:20:54 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

65. 2025-06-29 00:20:54 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:20:54 [INFO    ] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:20:54 [INFO    ] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

66. 2025-06-29 00:20:54 [ERROR   ] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 - Total initialization time: 0.007 seconds
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 -   basic_init: 0.003s (35.5%)
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 -   attribute_init: 0.000s (0.3%)
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 -   notes_service_init: 0.000s (3.5%)
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 -   providers_models: 0.002s (33.4%)
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 -   prompts_service_init: 0.001s (7.5%)
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 -   media_db_init: 0.001s (8.0%)
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 - ==============================
----------------------------------------

67. 2025-06-29 00:20:54 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

68. 2025-06-29 00:20:54 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:20:54 [INFO    ] root:444 - Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/media.db [Client ID: test_client_id]
2025-06-29 00:20:54 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/media.db [Client: test_client_id, Thread: MainThread]
2025-06-29 00:20:54 [INFO    ] root:747 - Checking DB schema. Current version: 0. Code supports: 1
2025-06-29 00:20:54 [INFO    ] root:680 - Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/media.db...
2025-06-29 00:20:54 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:20:54 [DEBUG   ] root:694 - [Schema V1] Applying Core Schema + Version Update...
2025-06-29 00:20:54 [DEBUG   ] root:696 - [Schema V1] Core Schema script (incl. version update) executed.
2025-06-29 00:20:54 [DEBUG   ] root:707 - [Schema V1] Media table structure validated successfully.
2025-06-29 00:20:54 [DEBUG   ] root:719 - [Schema V1] Version check inside transaction confirmed version is 1.
2025-06-29 00:20:54 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:20:54 [INFO    ] root:722 - [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/media.db.
2025-06-29 00:20:54 [DEBUG   ] root:726 - [Schema V1] Applying FTS Tables...
2025-06-29 00:20:54 [INFO    ] root:729 - [Schema V1] FTS Tables created successfully.
2025-06-29 00:20:54 [INFO    ] root:771 - Database schema initialized/migrated to version 1.
2025-06-29 00:20:54 [DEBUG   ] root:474 - Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/media.db
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db...
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db.
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db...
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db.
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db
2025-06-29 00:20:54 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
2025-06-29 00:20:54 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: Media 77fbe291-e393-40f9-807f-9f57dca84761 create v1 at 2025-06-29T07:20:54.110Z
2025-06-29 00:20:54 [DEBUG   ] root:919 - FTS update for media 1: sanitized content - null bytes replaced
2025-06-29 00:20:54 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 1
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword ',' UUID 84bc64a0-e6f7-4953-aea0-ff60ea8ab557
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: Keywords 84bc64a0-e6f7-4953-aea0-ff60ea8ab557 create v1 at 2025-06-29T07:20:54.110Z
2025-06-29 00:20:54 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 1
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'e' UUID daf09c57-9e73-4853-bac5-ae18b53bc39c
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: Keywords daf09c57-9e73-4853-bac5-ae18b53bc39c create v1 at 2025-06-29T07:20:54.110Z
2025-06-29 00:20:54 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 2
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'n' UUID 40c773c5-3211-40cc-a3f2-292ffd316eae
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: Keywords 40c773c5-3211-40cc-a3f2-292ffd316eae create v1 at 2025-06-29T07:20:54.110Z
2025-06-29 00:20:54 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 3
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'o' UUID 1bcdb818-ac52-4512-87d0-b0058bc1e1f5
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: Keywords 1bcdb818-ac52-4512-87d0-b0058bc1e1f5 create v1 at 2025-06-29T07:20:54.110Z
2025-06-29 00:20:54 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 4
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 's' UUID 3bcebd97-d6d7-4f67-b070-0dfe3724278e
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: Keywords 3bcebd97-d6d7-4f67-b070-0dfe3724278e create v1 at 2025-06-29T07:20:54.110Z
2025-06-29 00:20:54 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 5
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 't' UUID b9b73be4-f236-49c3-ad4e-2518b872e63f
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: Keywords b9b73be4-f236-49c3-ad4e-2518b872e63f create v1 at 2025-06-29T07:20:54.110Z
2025-06-29 00:20:54 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 6
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 77fbe291-e393-40f9-807f-9f57dca84761_84bc64a0-e6f7-4953-aea0-ff60ea8ab557 link v1 at 2025-06-29T07:20:54.110Z
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 77fbe291-e393-40f9-807f-9f57dca84761_daf09c57-9e73-4853-bac5-ae18b53bc39c link v1 at 2025-06-29T07:20:54.111Z
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 77fbe291-e393-40f9-807f-9f57dca84761_40c773c5-3211-40cc-a3f2-292ffd316eae link v1 at 2025-06-29T07:20:54.111Z
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 77fbe291-e393-40f9-807f-9f57dca84761_1bcdb818-ac52-4512-87d0-b0058bc1e1f5 link v1 at 2025-06-29T07:20:54.111Z
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 77fbe291-e393-40f9-807f-9f57dca84761_3bcebd97-d6d7-4f67-b070-0dfe3724278e link v1 at 2025-06-29T07:20:54.111Z
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 77fbe291-e393-40f9-807f-9f57dca84761_b9b73be4-f236-49c3-ad4e-2518b872e63f link v1 at 2025-06-29T07:20:54.111Z
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 1. Added: 6, Removed: 0.
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 1, UUID 7c156a3f-79fe-48cc-94c6-8410b94310ad
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: DocumentVersions 7c156a3f-79fe-48cc-94c6-8410b94310ad create v1 at 2025-06-29T07:20:54.111Z
2025-06-29 00:20:54 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:20:54 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
2025-06-29 00:20:54 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: Media faac2309-162d-4c49-8b63-5054f69495ec create v1 at 2025-06-29T07:20:54.111Z
2025-06-29 00:20:54 [DEBUG   ] root:919 - FTS update for media 2: sanitized content - null bytes replaced
2025-06-29 00:20:54 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 2
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword ',' already active.
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'e' already active.
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'o' already active.
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 's' already active.
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 't' already active.
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'w' UUID eaaad038-6543-44be-a266-bfaa62ebb65e
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: Keywords eaaad038-6543-44be-a266-bfaa62ebb65e create v1 at 2025-06-29T07:20:54.112Z
2025-06-29 00:20:54 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 7
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: MediaKeywords faac2309-162d-4c49-8b63-5054f69495ec_84bc64a0-e6f7-4953-aea0-ff60ea8ab557 link v1 at 2025-06-29T07:20:54.112Z
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: MediaKeywords faac2309-162d-4c49-8b63-5054f69495ec_daf09c57-9e73-4853-bac5-ae18b53bc39c link v1 at 2025-06-29T07:20:54.112Z
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: MediaKeywords faac2309-162d-4c49-8b63-5054f69495ec_1bcdb818-ac52-4512-87d0-b0058bc1e1f5 link v1 at 2025-06-29T07:20:54.112Z
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: MediaKeywords faac2309-162d-4c49-8b63-5054f69495ec_3bcebd97-d6d7-4f67-b070-0dfe3724278e link v1 at 2025-06-29T07:20:54.112Z
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: MediaKeywords faac2309-162d-4c49-8b63-5054f69495ec_b9b73be4-f236-49c3-ad4e-2518b872e63f link v1 at 2025-06-29T07:20:54.112Z
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: MediaKeywords faac2309-162d-4c49-8b63-5054f69495ec_eaaad038-6543-44be-a266-bfaa62ebb65e link v1 at 2025-06-29T07:20:54.112Z
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 2. Added: 6, Removed: 0.
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 2, UUID b36d6986-85be-46ae-9d18-41a97bbcb339
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: DocumentVersions b36d6986-85be-46ae-9d18-41a97bbcb339 create v1 at 2025-06-29T07:20:54.112Z
2025-06-29 00:20:54 [DEBUG   ] root:652 - Committed transaction.
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

69. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

70. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

71. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     tldw_chatbook.app:Logging_Config.py:160 Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

72. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

73. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
WARNING  tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Checking DB schema. Current: 1, Code supports: 1
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Database schema is up to date.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Verified FTS tables exist.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts Interop Library initialized successfully.
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x173d01010>
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Found 3 distinct media types: ['article', 'podcast', 'video']
INFO     tldw_chatbook.app:Logging_Config.py:160 App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

74. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

75. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

76. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
INFO     tldw_chatbook.app:Logging_Config.py:160 === STARTUP TIMING SUMMARY ===
INFO     tldw_chatbook.app:Logging_Config.py:160 Total initialization time: 0.007 seconds
INFO     tldw_chatbook.app:Logging_Config.py:160   basic_init: 0.003s (35.5%)
INFO     tldw_chatbook.app:Logging_Config.py:160   attribute_init: 0.000s (0.3%)
INFO     tldw_chatbook.app:Logging_Config.py:160   notes_service_init: 0.000s (3.5%)
INFO     tldw_chatbook.app:Logging_Config.py:160   providers_models: 0.002s (33.4%)
INFO     tldw_chatbook.app:Logging_Config.py:160   prompts_service_init: 0.001s (7.5%)
INFO     tldw_chatbook.app:Logging_Config.py:160   media_db_init: 0.001s (8.0%)
INFO     tldw_chatbook.app:Logging_Config.py:160 ==============================
----------------------------------------

77. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

78. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/media.db [Client ID: test_client_id]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/media.db [Client: test_client_id, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 0. Code supports: 1
INFO     root:Client_Media_DB_v2.py:680 Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/media.db...
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:694 [Schema V1] Applying Core Schema + Version Update...
DEBUG    root:Client_Media_DB_v2.py:696 [Schema V1] Core Schema script (incl. version update) executed.
DEBUG    root:Client_Media_DB_v2.py:707 [Schema V1] Media table structure validated successfully.
DEBUG    root:Client_Media_DB_v2.py:719 [Schema V1] Version check inside transaction confirmed version is 1.
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:722 [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/media.db.
DEBUG    root:Client_Media_DB_v2.py:726 [Schema V1] Applying FTS Tables...
INFO     root:Client_Media_DB_v2.py:729 [Schema V1] FTS Tables created successfully.
INFO     root:Client_Media_DB_v2.py:771 Database schema initialized/migrated to version 1.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/media.db
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db [Client ID: test_user]
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db (Journal: wal) for thread 8705548032
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction started (outermost) on thread 8705548032.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Full schema script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction (outermost) committed successfully on thread 8705548032.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media 77fbe291-e393-40f9-807f-9f57dca84761 create v1 at 2025-06-29T07:20:54.110Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 1: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword ',' UUID 84bc64a0-e6f7-4953-aea0-ff60ea8ab557
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 84bc64a0-e6f7-4953-aea0-ff60ea8ab557 create v1 at 2025-06-29T07:20:54.110Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'e' UUID daf09c57-9e73-4853-bac5-ae18b53bc39c
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords daf09c57-9e73-4853-bac5-ae18b53bc39c create v1 at 2025-06-29T07:20:54.110Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 2
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'n' UUID 40c773c5-3211-40cc-a3f2-292ffd316eae
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 40c773c5-3211-40cc-a3f2-292ffd316eae create v1 at 2025-06-29T07:20:54.110Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 3
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'o' UUID 1bcdb818-ac52-4512-87d0-b0058bc1e1f5
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 1bcdb818-ac52-4512-87d0-b0058bc1e1f5 create v1 at 2025-06-29T07:20:54.110Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 4
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 's' UUID 3bcebd97-d6d7-4f67-b070-0dfe3724278e
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 3bcebd97-d6d7-4f67-b070-0dfe3724278e create v1 at 2025-06-29T07:20:54.110Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 5
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 't' UUID b9b73be4-f236-49c3-ad4e-2518b872e63f
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords b9b73be4-f236-49c3-ad4e-2518b872e63f create v1 at 2025-06-29T07:20:54.110Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 6
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 77fbe291-e393-40f9-807f-9f57dca84761_84bc64a0-e6f7-4953-aea0-ff60ea8ab557 link v1 at 2025-06-29T07:20:54.110Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 77fbe291-e393-40f9-807f-9f57dca84761_daf09c57-9e73-4853-bac5-ae18b53bc39c link v1 at 2025-06-29T07:20:54.111Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 77fbe291-e393-40f9-807f-9f57dca84761_40c773c5-3211-40cc-a3f2-292ffd316eae link v1 at 2025-06-29T07:20:54.111Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 77fbe291-e393-40f9-807f-9f57dca84761_1bcdb818-ac52-4512-87d0-b0058bc1e1f5 link v1 at 2025-06-29T07:20:54.111Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 77fbe291-e393-40f9-807f-9f57dca84761_3bcebd97-d6d7-4f67-b070-0dfe3724278e link v1 at 2025-06-29T07:20:54.111Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 77fbe291-e393-40f9-807f-9f57dca84761_b9b73be4-f236-49c3-ad4e-2518b872e63f link v1 at 2025-06-29T07:20:54.111Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 1. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 1, UUID 7c156a3f-79fe-48cc-94c6-8410b94310ad
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions 7c156a3f-79fe-48cc-94c6-8410b94310ad create v1 at 2025-06-29T07:20:54.111Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media faac2309-162d-4c49-8b63-5054f69495ec create v1 at 2025-06-29T07:20:54.111Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 2: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 2
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword ',' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'e' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'o' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 's' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 't' already active.
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'w' UUID eaaad038-6543-44be-a266-bfaa62ebb65e
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords eaaad038-6543-44be-a266-bfaa62ebb65e create v1 at 2025-06-29T07:20:54.112Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 7
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords faac2309-162d-4c49-8b63-5054f69495ec_84bc64a0-e6f7-4953-aea0-ff60ea8ab557 link v1 at 2025-06-29T07:20:54.112Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords faac2309-162d-4c49-8b63-5054f69495ec_daf09c57-9e73-4853-bac5-ae18b53bc39c link v1 at 2025-06-29T07:20:54.112Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords faac2309-162d-4c49-8b63-5054f69495ec_1bcdb818-ac52-4512-87d0-b0058bc1e1f5 link v1 at 2025-06-29T07:20:54.112Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords faac2309-162d-4c49-8b63-5054f69495ec_3bcebd97-d6d7-4f67-b070-0dfe3724278e link v1 at 2025-06-29T07:20:54.112Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords faac2309-162d-4c49-8b63-5054f69495ec_b9b73be4-f236-49c3-ad4e-2518b872e63f link v1 at 2025-06-29T07:20:54.112Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords faac2309-162d-4c49-8b63-5054f69495ec_eaaad038-6543-44be-a266-bfaa62ebb65e link v1 at 2025-06-29T07:20:54.112Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 2. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 2, UUID b36d6986-85be-46ae-9d18-41a97bbcb339
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions b36d6986-85be-46ae-9d18-41a97bbcb339 create v1 at 2025-06-29T07:20:54.112Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
----------------------------- Captured stderr call -----------------------------
----------------------------------------

79. !!! CRITICAL ERROR in RichLog processor: Event loop is closed
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/queues.py", line 158, in get
    await getter
GeneratorExit
----------------------------------------

80. ERROR    root:metrics.py:99 Failed to log histogram app_compose_duration_seconds: No label names were set when constructing histogram:app_compose_duration_seconds
DEBUG    root:app.py:1329 App compose finished in 0.001 seconds
----------------------------------------

81. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

82. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 Composing ChatWindow UI
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:settings_sidebar.py:42 Sidebar chat: Received providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 'respond-for-me-button' composed.
DEBUG    tldw_chatbook.app:Logging_Config.py:160 Chat ephemeral state changed to: True
DEBUG    root:chat_right_sidebar.py:355 Character sidebar (id='chat-right-sidebar', prefix='chat') created with ephemeral state: True
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing CCPWindow UI
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing center pane
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing right pane
DEBUG    tldw_chatbook.UI.SearchRAGWindow:Logging_Config.py:160 Loaded 0 recent search queries
DEBUG    tldw_chatbook.UI.Ingest_Window:Logging_Config.py:160 Composing IngestWindow UI
INFO     root:Stats_screen.py:25 MetricsScreen initialized. Log path: /tmp/app_metrics.log
INFO     root:Stats_screen.py:76 MetricsScreen composing. Current metrics: {}
WARNING  root:Stats_screen.py:79 MetricsScreen compose: self.metrics is unexpectedly empty at compose time.
INFO     root:Stats_screen.py:93 MetricsScreen compose finished.
----------------------------------------

83. ERROR    asyncio:base_events.py:1833 Task was destroyed but it is pending!
task: <Task pending name='RichLogProcessor' coro=<RichLogHandler._process_log_queue() running at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Logging_Config.py:78> wait_for=<Future pending cb=[Task.task_wakeup()]>>
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:29 MetricsScreen on_mount: Calling load_metrics.
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:45 Attempting to load metrics from: /tmp/app_metrics.log
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
----------------------------------------

84. ERROR    root:Stats_screen.py:68 MetricsScreen: Log file not found at /tmp/app_metrics.log.
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 5, False
INFO     tldw_chatbook.UI.Coding_Window:Logging_Config.py:160 CodingWindow on_mount: UI composed
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    tldw_chatbook.UI.LLM_Management_Window:Logging_Config.py:160 LLMManagementWindow.on_mount called
INFO     tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 EvalsWindow on_mount: UI composed
----------------------------------------

85. ERROR    tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 Error initializing evaluation system: cannot import name 'EvaluationOrchestrator' from 'tldw_chatbook.Evals' (/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Evals/__init__.py)
INFO     tldw_chatbook.RAG_Search.Services.embeddings_service:Logging_Config.py:160 ChromaDB initialized at /Users/appledev/.local/share/tldw_cli/chromadb
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting and initializing initial active sub-tab.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-chat display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-creation display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-web-search display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initial active sub-tab set to search-view-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Added active class to nav button search-nav-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Set display=True for active view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initializing view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Initializing Embeddings Creation view.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation provider select changed to: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation model select changed to: e5-small-v2 for provider: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Provider specific inputs visibility updated. Custom HF: False, Local API URL: False (Value: '', Disabled: False)
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Logging_Config.py:137 --- _setup_logging START (from Logging_Config.py) ---
INFO     root:Logging_Config.py:145 Loguru: All pre-existing sinks removed.
INFO     root:Logging_Config.py:168 Loguru: Configured to forward its messages to standard Python logging system.
--------------------------- Captured stderr teardown ---------------------------
2025-06-29 00:20:58 [DEBUG   ] root:535 - Closed connection for thread MainThread.
---------------------------- Captured log teardown -----------------------------
DEBUG    root:Client_Media_DB_v2.py:535 Closed connection for thread MainThread.
----------------------------------------

86. _ ERROR at teardown of test_media_copy_buttons[chat-media-copy-title-button-title-Title copied to clipboard.] _
Tests/Chat/test_chat_sidebar_media_search.py:102: in real_app_media_test
    app.chachanotes_db.close()
    ^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'CharactersRAGDB' object has no attribute 'close'
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:20:58 [DEBUG   ] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

87. 2025-06-29 00:20:58 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

88. 2025-06-29 00:20:58 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

89. 2025-06-29 00:20:58 [ERROR   ] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:20:58 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

90. 2025-06-29 00:20:58 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

91. 2025-06-29 00:20:58 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:20:58 [DEBUG   ] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:20:58 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:20:58 [INFO    ] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:20:58 [INFO    ] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:20:58 [WARNING ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Database schema is up to date.
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Verified FTS tables exist.
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts Interop Library initialized successfully.
2025-06-29 00:20:58 [INFO    ] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:20:58 [INFO    ] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:20:58 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:20:58 [INFO    ] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:20:58 [DEBUG   ] root:750 - Database schema is up to date.
2025-06-29 00:20:58 [DEBUG   ] root:755 - Verified FTS tables exist.
2025-06-29 00:20:58 [DEBUG   ] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x17d7964b0>
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:20:58 [DEBUG   ] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

92. 2025-06-29 00:20:58 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

93. 2025-06-29 00:20:58 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:20:58 [INFO    ] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:20:58 [INFO    ] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

94. 2025-06-29 00:20:58 [ERROR   ] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 - Total initialization time: 0.007 seconds
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 -   basic_init: 0.002s (34.0%)
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 -   attribute_init: 0.000s (0.2%)
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 -   notes_service_init: 0.000s (3.6%)
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 -   providers_models: 0.002s (33.8%)
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 -   prompts_service_init: 0.001s (8.3%)
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 -   media_db_init: 0.001s (8.4%)
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 - ==============================
----------------------------------------

95. 2025-06-29 00:20:58 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

96. 2025-06-29 00:20:58 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:20:58 [INFO    ] root:444 - Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/media.db [Client ID: test_client_id]
2025-06-29 00:20:58 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/media.db [Client: test_client_id, Thread: MainThread]
2025-06-29 00:20:58 [INFO    ] root:747 - Checking DB schema. Current version: 0. Code supports: 1
2025-06-29 00:20:58 [INFO    ] root:680 - Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/media.db...
2025-06-29 00:20:58 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:20:58 [DEBUG   ] root:694 - [Schema V1] Applying Core Schema + Version Update...
2025-06-29 00:20:58 [DEBUG   ] root:696 - [Schema V1] Core Schema script (incl. version update) executed.
2025-06-29 00:20:58 [DEBUG   ] root:707 - [Schema V1] Media table structure validated successfully.
2025-06-29 00:20:58 [DEBUG   ] root:719 - [Schema V1] Version check inside transaction confirmed version is 1.
2025-06-29 00:20:58 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:20:58 [INFO    ] root:722 - [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/media.db.
2025-06-29 00:20:58 [DEBUG   ] root:726 - [Schema V1] Applying FTS Tables...
2025-06-29 00:20:58 [INFO    ] root:729 - [Schema V1] FTS Tables created successfully.
2025-06-29 00:20:58 [INFO    ] root:771 - Database schema initialized/migrated to version 1.
2025-06-29 00:20:58 [DEBUG   ] root:474 - Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/media.db
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db...
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db.
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db...
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db.
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db
2025-06-29 00:20:58 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
2025-06-29 00:20:58 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: Media 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a create v1 at 2025-06-29T07:20:58.972Z
2025-06-29 00:20:58 [DEBUG   ] root:919 - FTS update for media 1: sanitized content - null bytes replaced
2025-06-29 00:20:58 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 1
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword ',' UUID 94dc1f63-b568-4d25-8520-e14cb1d12a15
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: Keywords 94dc1f63-b568-4d25-8520-e14cb1d12a15 create v1 at 2025-06-29T07:20:58.972Z
2025-06-29 00:20:58 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 1
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'e' UUID a505853b-38da-41b4-abbb-2143a2a068e8
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: Keywords a505853b-38da-41b4-abbb-2143a2a068e8 create v1 at 2025-06-29T07:20:58.972Z
2025-06-29 00:20:58 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 2
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'n' UUID cc9be1ab-5045-4e86-b371-0c525b8690e9
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: Keywords cc9be1ab-5045-4e86-b371-0c525b8690e9 create v1 at 2025-06-29T07:20:58.973Z
2025-06-29 00:20:58 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 3
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'o' UUID f4ca4805-96f2-4e53-8415-d2d554e4cb41
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: Keywords f4ca4805-96f2-4e53-8415-d2d554e4cb41 create v1 at 2025-06-29T07:20:58.973Z
2025-06-29 00:20:58 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 4
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 's' UUID 356a359c-0101-47d2-9c32-e7a5b3d06c1e
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: Keywords 356a359c-0101-47d2-9c32-e7a5b3d06c1e create v1 at 2025-06-29T07:20:58.973Z
2025-06-29 00:20:58 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 5
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 't' UUID 89b9ce1e-a9e0-41c3-9c07-b9c9fcdf590e
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: Keywords 89b9ce1e-a9e0-41c3-9c07-b9c9fcdf590e create v1 at 2025-06-29T07:20:58.973Z
2025-06-29 00:20:58 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 6
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a_94dc1f63-b568-4d25-8520-e14cb1d12a15 link v1 at 2025-06-29T07:20:58.973Z
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a_a505853b-38da-41b4-abbb-2143a2a068e8 link v1 at 2025-06-29T07:20:58.973Z
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a_cc9be1ab-5045-4e86-b371-0c525b8690e9 link v1 at 2025-06-29T07:20:58.973Z
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a_f4ca4805-96f2-4e53-8415-d2d554e4cb41 link v1 at 2025-06-29T07:20:58.973Z
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a_356a359c-0101-47d2-9c32-e7a5b3d06c1e link v1 at 2025-06-29T07:20:58.973Z
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a_89b9ce1e-a9e0-41c3-9c07-b9c9fcdf590e link v1 at 2025-06-29T07:20:58.973Z
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 1. Added: 6, Removed: 0.
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 1, UUID 74d4c346-784b-4ae3-94b6-c61edbd20de1
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: DocumentVersions 74d4c346-784b-4ae3-94b6-c61edbd20de1 create v1 at 2025-06-29T07:20:58.973Z
2025-06-29 00:20:58 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:20:58 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
2025-06-29 00:20:58 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: Media d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c create v1 at 2025-06-29T07:20:58.974Z
2025-06-29 00:20:58 [DEBUG   ] root:919 - FTS update for media 2: sanitized content - null bytes replaced
2025-06-29 00:20:58 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 2
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword ',' already active.
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'e' already active.
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'o' already active.
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 's' already active.
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 't' already active.
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'w' UUID 9988fa45-c9a5-4279-9762-fe0263525ab3
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: Keywords 9988fa45-c9a5-4279-9762-fe0263525ab3 create v1 at 2025-06-29T07:20:58.974Z
2025-06-29 00:20:58 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 7
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c_94dc1f63-b568-4d25-8520-e14cb1d12a15 link v1 at 2025-06-29T07:20:58.974Z
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c_a505853b-38da-41b4-abbb-2143a2a068e8 link v1 at 2025-06-29T07:20:58.974Z
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c_f4ca4805-96f2-4e53-8415-d2d554e4cb41 link v1 at 2025-06-29T07:20:58.974Z
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c_356a359c-0101-47d2-9c32-e7a5b3d06c1e link v1 at 2025-06-29T07:20:58.974Z
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c_89b9ce1e-a9e0-41c3-9c07-b9c9fcdf590e link v1 at 2025-06-29T07:20:58.974Z
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c_9988fa45-c9a5-4279-9762-fe0263525ab3 link v1 at 2025-06-29T07:20:58.974Z
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 2. Added: 6, Removed: 0.
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 2, UUID 7b4ea68b-d2da-4b5d-b3cf-d3b14404f002
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: DocumentVersions 7b4ea68b-d2da-4b5d-b3cf-d3b14404f002 create v1 at 2025-06-29T07:20:58.974Z
2025-06-29 00:20:58 [DEBUG   ] root:652 - Committed transaction.
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

97. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

98. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

99. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     tldw_chatbook.app:Logging_Config.py:160 Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

100. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

101. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
WARNING  tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Checking DB schema. Current: 1, Code supports: 1
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Database schema is up to date.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Verified FTS tables exist.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts Interop Library initialized successfully.
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x17d7964b0>
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Found 3 distinct media types: ['article', 'podcast', 'video']
INFO     tldw_chatbook.app:Logging_Config.py:160 App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

102. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

103. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

104. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
INFO     tldw_chatbook.app:Logging_Config.py:160 === STARTUP TIMING SUMMARY ===
INFO     tldw_chatbook.app:Logging_Config.py:160 Total initialization time: 0.007 seconds
INFO     tldw_chatbook.app:Logging_Config.py:160   basic_init: 0.002s (34.0%)
INFO     tldw_chatbook.app:Logging_Config.py:160   attribute_init: 0.000s (0.2%)
INFO     tldw_chatbook.app:Logging_Config.py:160   notes_service_init: 0.000s (3.6%)
INFO     tldw_chatbook.app:Logging_Config.py:160   providers_models: 0.002s (33.8%)
INFO     tldw_chatbook.app:Logging_Config.py:160   prompts_service_init: 0.001s (8.3%)
INFO     tldw_chatbook.app:Logging_Config.py:160   media_db_init: 0.001s (8.4%)
INFO     tldw_chatbook.app:Logging_Config.py:160 ==============================
----------------------------------------

105. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

106. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/media.db [Client ID: test_client_id]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/media.db [Client: test_client_id, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 0. Code supports: 1
INFO     root:Client_Media_DB_v2.py:680 Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/media.db...
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:694 [Schema V1] Applying Core Schema + Version Update...
DEBUG    root:Client_Media_DB_v2.py:696 [Schema V1] Core Schema script (incl. version update) executed.
DEBUG    root:Client_Media_DB_v2.py:707 [Schema V1] Media table structure validated successfully.
DEBUG    root:Client_Media_DB_v2.py:719 [Schema V1] Version check inside transaction confirmed version is 1.
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:722 [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/media.db.
DEBUG    root:Client_Media_DB_v2.py:726 [Schema V1] Applying FTS Tables...
INFO     root:Client_Media_DB_v2.py:729 [Schema V1] FTS Tables created successfully.
INFO     root:Client_Media_DB_v2.py:771 Database schema initialized/migrated to version 1.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/media.db
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db [Client ID: test_user]
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db (Journal: wal) for thread 8705548032
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction started (outermost) on thread 8705548032.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Full schema script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction (outermost) committed successfully on thread 8705548032.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a create v1 at 2025-06-29T07:20:58.972Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 1: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword ',' UUID 94dc1f63-b568-4d25-8520-e14cb1d12a15
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 94dc1f63-b568-4d25-8520-e14cb1d12a15 create v1 at 2025-06-29T07:20:58.972Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'e' UUID a505853b-38da-41b4-abbb-2143a2a068e8
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords a505853b-38da-41b4-abbb-2143a2a068e8 create v1 at 2025-06-29T07:20:58.972Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 2
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'n' UUID cc9be1ab-5045-4e86-b371-0c525b8690e9
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords cc9be1ab-5045-4e86-b371-0c525b8690e9 create v1 at 2025-06-29T07:20:58.973Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 3
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'o' UUID f4ca4805-96f2-4e53-8415-d2d554e4cb41
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords f4ca4805-96f2-4e53-8415-d2d554e4cb41 create v1 at 2025-06-29T07:20:58.973Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 4
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 's' UUID 356a359c-0101-47d2-9c32-e7a5b3d06c1e
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 356a359c-0101-47d2-9c32-e7a5b3d06c1e create v1 at 2025-06-29T07:20:58.973Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 5
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 't' UUID 89b9ce1e-a9e0-41c3-9c07-b9c9fcdf590e
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 89b9ce1e-a9e0-41c3-9c07-b9c9fcdf590e create v1 at 2025-06-29T07:20:58.973Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 6
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a_94dc1f63-b568-4d25-8520-e14cb1d12a15 link v1 at 2025-06-29T07:20:58.973Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a_a505853b-38da-41b4-abbb-2143a2a068e8 link v1 at 2025-06-29T07:20:58.973Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a_cc9be1ab-5045-4e86-b371-0c525b8690e9 link v1 at 2025-06-29T07:20:58.973Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a_f4ca4805-96f2-4e53-8415-d2d554e4cb41 link v1 at 2025-06-29T07:20:58.973Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a_356a359c-0101-47d2-9c32-e7a5b3d06c1e link v1 at 2025-06-29T07:20:58.973Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a_89b9ce1e-a9e0-41c3-9c07-b9c9fcdf590e link v1 at 2025-06-29T07:20:58.973Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 1. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 1, UUID 74d4c346-784b-4ae3-94b6-c61edbd20de1
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions 74d4c346-784b-4ae3-94b6-c61edbd20de1 create v1 at 2025-06-29T07:20:58.973Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c create v1 at 2025-06-29T07:20:58.974Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 2: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 2
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword ',' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'e' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'o' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 's' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 't' already active.
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'w' UUID 9988fa45-c9a5-4279-9762-fe0263525ab3
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 9988fa45-c9a5-4279-9762-fe0263525ab3 create v1 at 2025-06-29T07:20:58.974Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 7
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c_94dc1f63-b568-4d25-8520-e14cb1d12a15 link v1 at 2025-06-29T07:20:58.974Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c_a505853b-38da-41b4-abbb-2143a2a068e8 link v1 at 2025-06-29T07:20:58.974Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c_f4ca4805-96f2-4e53-8415-d2d554e4cb41 link v1 at 2025-06-29T07:20:58.974Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c_356a359c-0101-47d2-9c32-e7a5b3d06c1e link v1 at 2025-06-29T07:20:58.974Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c_89b9ce1e-a9e0-41c3-9c07-b9c9fcdf590e link v1 at 2025-06-29T07:20:58.974Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c_9988fa45-c9a5-4279-9762-fe0263525ab3 link v1 at 2025-06-29T07:20:58.974Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 2. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 2, UUID 7b4ea68b-d2da-4b5d-b3cf-d3b14404f002
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions 7b4ea68b-d2da-4b5d-b3cf-d3b14404f002 create v1 at 2025-06-29T07:20:58.974Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
----------------------------- Captured stderr call -----------------------------
----------------------------------------

107. !!! CRITICAL ERROR in RichLog processor: Event loop is closed
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/queues.py", line 158, in get
    await getter
GeneratorExit
----------------------------------------

108. ERROR    root:metrics.py:99 Failed to log histogram app_compose_duration_seconds: No label names were set when constructing histogram:app_compose_duration_seconds
DEBUG    root:app.py:1329 App compose finished in 0.001 seconds
----------------------------------------

109. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

110. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 Composing ChatWindow UI
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:settings_sidebar.py:42 Sidebar chat: Received providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 'respond-for-me-button' composed.
DEBUG    tldw_chatbook.app:Logging_Config.py:160 Chat ephemeral state changed to: True
DEBUG    root:chat_right_sidebar.py:355 Character sidebar (id='chat-right-sidebar', prefix='chat') created with ephemeral state: True
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing CCPWindow UI
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing center pane
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing right pane
DEBUG    tldw_chatbook.UI.SearchRAGWindow:Logging_Config.py:160 Loaded 0 recent search queries
DEBUG    tldw_chatbook.UI.Ingest_Window:Logging_Config.py:160 Composing IngestWindow UI
----------------------------------------

111. ERROR    asyncio:base_events.py:1833 Task was destroyed but it is pending!
task: <Task pending name='RichLogProcessor' coro=<RichLogHandler._process_log_queue() running at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Logging_Config.py:78> wait_for=<Future pending cb=[Task.task_wakeup()]>>
INFO     root:Stats_screen.py:25 MetricsScreen initialized. Log path: /tmp/app_metrics.log
INFO     root:Stats_screen.py:76 MetricsScreen composing. Current metrics: {}
WARNING  root:Stats_screen.py:79 MetricsScreen compose: self.metrics is unexpectedly empty at compose time.
INFO     root:Stats_screen.py:93 MetricsScreen compose finished.
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:29 MetricsScreen on_mount: Calling load_metrics.
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:45 Attempting to load metrics from: /tmp/app_metrics.log
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
----------------------------------------

112. ERROR    root:Stats_screen.py:68 MetricsScreen: Log file not found at /tmp/app_metrics.log.
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     tldw_chatbook.UI.Coding_Window:Logging_Config.py:160 CodingWindow on_mount: UI composed
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    tldw_chatbook.UI.LLM_Management_Window:Logging_Config.py:160 LLMManagementWindow.on_mount called
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
INFO     tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 EvalsWindow on_mount: UI composed
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=4,level=0,tokens=6), 4, 5, False
----------------------------------------

113. ERROR    tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 Error initializing evaluation system: cannot import name 'EvaluationOrchestrator' from 'tldw_chatbook.Evals' (/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Evals/__init__.py)
INFO     tldw_chatbook.RAG_Search.Services.embeddings_service:Logging_Config.py:160 ChromaDB initialized at /Users/appledev/.local/share/tldw_cli/chromadb
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting and initializing initial active sub-tab.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-chat display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-creation display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-web-search display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initial active sub-tab set to search-view-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Added active class to nav button search-nav-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Set display=True for active view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initializing view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Initializing Embeddings Creation view.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation provider select changed to: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation model select changed to: e5-small-v2 for provider: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Provider specific inputs visibility updated. Custom HF: False, Local API URL: False (Value: '', Disabled: False)
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Logging_Config.py:137 --- _setup_logging START (from Logging_Config.py) ---
INFO     root:Logging_Config.py:145 Loguru: All pre-existing sinks removed.
INFO     root:Logging_Config.py:168 Loguru: Configured to forward its messages to standard Python logging system.
--------------------------- Captured stderr teardown ---------------------------
2025-06-29 00:21:04 [DEBUG   ] root:535 - Closed connection for thread MainThread.
---------------------------- Captured log teardown -----------------------------
DEBUG    root:Client_Media_DB_v2.py:535 Closed connection for thread MainThread.
----------------------------------------

114. _ ERROR at teardown of test_media_copy_buttons[chat-media-copy-content-button-content-Content copied to clipboard.] _
Tests/Chat/test_chat_sidebar_media_search.py:102: in real_app_media_test
    app.chachanotes_db.close()
    ^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'CharactersRAGDB' object has no attribute 'close'
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:21:04 [DEBUG   ] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

115. 2025-06-29 00:21:04 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

116. 2025-06-29 00:21:04 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

117. 2025-06-29 00:21:04 [ERROR   ] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:04 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

118. 2025-06-29 00:21:04 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

119. 2025-06-29 00:21:04 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:04 [DEBUG   ] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:04 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:04 [INFO    ] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:21:04 [INFO    ] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:21:04 [WARNING ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Database schema is up to date.
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Verified FTS tables exist.
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts Interop Library initialized successfully.
2025-06-29 00:21:04 [INFO    ] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:04 [INFO    ] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:21:04 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:21:04 [INFO    ] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:21:04 [DEBUG   ] root:750 - Database schema is up to date.
2025-06-29 00:21:04 [DEBUG   ] root:755 - Verified FTS tables exist.
2025-06-29 00:21:04 [DEBUG   ] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x17372b530>
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:21:04 [DEBUG   ] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

120. 2025-06-29 00:21:04 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

121. 2025-06-29 00:21:04 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:21:04 [INFO    ] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:21:04 [INFO    ] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

122. 2025-06-29 00:21:04 [ERROR   ] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 - Total initialization time: 0.008 seconds
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 -   basic_init: 0.002s (31.0%)
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 -   attribute_init: 0.000s (0.2%)
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 -   notes_service_init: 0.000s (3.1%)
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 -   providers_models: 0.003s (39.6%)
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 -   prompts_service_init: 0.001s (6.8%)
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 -   media_db_init: 0.001s (7.2%)
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 - ==============================
----------------------------------------

123. 2025-06-29 00:21:04 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

124. 2025-06-29 00:21:04 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:04 [INFO    ] root:444 - Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/media.db [Client ID: test_client_id]
2025-06-29 00:21:04 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/media.db [Client: test_client_id, Thread: MainThread]
2025-06-29 00:21:04 [INFO    ] root:747 - Checking DB schema. Current version: 0. Code supports: 1
2025-06-29 00:21:04 [INFO    ] root:680 - Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/media.db...
2025-06-29 00:21:04 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:04 [DEBUG   ] root:694 - [Schema V1] Applying Core Schema + Version Update...
2025-06-29 00:21:04 [DEBUG   ] root:696 - [Schema V1] Core Schema script (incl. version update) executed.
2025-06-29 00:21:04 [DEBUG   ] root:707 - [Schema V1] Media table structure validated successfully.
2025-06-29 00:21:04 [DEBUG   ] root:719 - [Schema V1] Version check inside transaction confirmed version is 1.
2025-06-29 00:21:04 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:21:04 [INFO    ] root:722 - [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/media.db.
2025-06-29 00:21:04 [DEBUG   ] root:726 - [Schema V1] Applying FTS Tables...
2025-06-29 00:21:04 [INFO    ] root:729 - [Schema V1] FTS Tables created successfully.
2025-06-29 00:21:04 [INFO    ] root:771 - Database schema initialized/migrated to version 1.
2025-06-29 00:21:04 [DEBUG   ] root:474 - Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/media.db
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db...
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db.
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db...
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db.
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db
2025-06-29 00:21:04 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
2025-06-29 00:21:04 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: Media c23ff412-21f0-445e-9133-1c7ef8513eba create v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] root:919 - FTS update for media 1: sanitized content - null bytes replaced
2025-06-29 00:21:04 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 1
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword ',' UUID 52e051c0-1579-4aea-8d87-6d816f6cdaf2
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: Keywords 52e051c0-1579-4aea-8d87-6d816f6cdaf2 create v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 1
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'e' UUID 7f77df9f-ac35-4a30-a32d-04ae4b513e2f
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: Keywords 7f77df9f-ac35-4a30-a32d-04ae4b513e2f create v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 2
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'n' UUID cdff1c03-7907-477c-96fe-4748ffaa5877
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: Keywords cdff1c03-7907-477c-96fe-4748ffaa5877 create v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 3
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'o' UUID b3016a6b-47f9-47c2-8299-afcdc0b3af50
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: Keywords b3016a6b-47f9-47c2-8299-afcdc0b3af50 create v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 4
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 's' UUID a94f9149-5c57-478b-b088-5ec01aa3f513
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: Keywords a94f9149-5c57-478b-b088-5ec01aa3f513 create v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 5
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 't' UUID 8c5da421-bf9f-40aa-baa7-402e2f59a57f
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: Keywords 8c5da421-bf9f-40aa-baa7-402e2f59a57f create v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 6
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: MediaKeywords c23ff412-21f0-445e-9133-1c7ef8513eba_52e051c0-1579-4aea-8d87-6d816f6cdaf2 link v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: MediaKeywords c23ff412-21f0-445e-9133-1c7ef8513eba_7f77df9f-ac35-4a30-a32d-04ae4b513e2f link v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: MediaKeywords c23ff412-21f0-445e-9133-1c7ef8513eba_cdff1c03-7907-477c-96fe-4748ffaa5877 link v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: MediaKeywords c23ff412-21f0-445e-9133-1c7ef8513eba_b3016a6b-47f9-47c2-8299-afcdc0b3af50 link v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: MediaKeywords c23ff412-21f0-445e-9133-1c7ef8513eba_a94f9149-5c57-478b-b088-5ec01aa3f513 link v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: MediaKeywords c23ff412-21f0-445e-9133-1c7ef8513eba_8c5da421-bf9f-40aa-baa7-402e2f59a57f link v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 1. Added: 6, Removed: 0.
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 1, UUID de0d60d0-be2b-4ccf-a698-e1126efe510c
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: DocumentVersions de0d60d0-be2b-4ccf-a698-e1126efe510c create v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:21:04 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
2025-06-29 00:21:04 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: Media 693f810c-fb44-43d9-ae80-c5a82acc52d5 create v1 at 2025-06-29T07:21:04.276Z
2025-06-29 00:21:04 [DEBUG   ] root:919 - FTS update for media 2: sanitized content - null bytes replaced
2025-06-29 00:21:04 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 2
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword ',' already active.
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'e' already active.
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'o' already active.
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 's' already active.
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 't' already active.
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'w' UUID f55537f5-d786-410a-a5c6-b98b69f9f159
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: Keywords f55537f5-d786-410a-a5c6-b98b69f9f159 create v1 at 2025-06-29T07:21:04.276Z
2025-06-29 00:21:04 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 7
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 693f810c-fb44-43d9-ae80-c5a82acc52d5_52e051c0-1579-4aea-8d87-6d816f6cdaf2 link v1 at 2025-06-29T07:21:04.276Z
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 693f810c-fb44-43d9-ae80-c5a82acc52d5_7f77df9f-ac35-4a30-a32d-04ae4b513e2f link v1 at 2025-06-29T07:21:04.276Z
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 693f810c-fb44-43d9-ae80-c5a82acc52d5_b3016a6b-47f9-47c2-8299-afcdc0b3af50 link v1 at 2025-06-29T07:21:04.276Z
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 693f810c-fb44-43d9-ae80-c5a82acc52d5_a94f9149-5c57-478b-b088-5ec01aa3f513 link v1 at 2025-06-29T07:21:04.276Z
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 693f810c-fb44-43d9-ae80-c5a82acc52d5_8c5da421-bf9f-40aa-baa7-402e2f59a57f link v1 at 2025-06-29T07:21:04.276Z
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 693f810c-fb44-43d9-ae80-c5a82acc52d5_f55537f5-d786-410a-a5c6-b98b69f9f159 link v1 at 2025-06-29T07:21:04.276Z
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 2. Added: 6, Removed: 0.
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 2, UUID ae0f63c5-1d5c-4e77-bd65-6992be99b49e
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: DocumentVersions ae0f63c5-1d5c-4e77-bd65-6992be99b49e create v1 at 2025-06-29T07:21:04.276Z
2025-06-29 00:21:04 [DEBUG   ] root:652 - Committed transaction.
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

125. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

126. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

127. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     tldw_chatbook.app:Logging_Config.py:160 Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

128. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

129. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
WARNING  tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Checking DB schema. Current: 1, Code supports: 1
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Database schema is up to date.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Verified FTS tables exist.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts Interop Library initialized successfully.
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x17372b530>
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Found 3 distinct media types: ['article', 'podcast', 'video']
INFO     tldw_chatbook.app:Logging_Config.py:160 App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

130. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

131. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

132. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
INFO     tldw_chatbook.app:Logging_Config.py:160 === STARTUP TIMING SUMMARY ===
INFO     tldw_chatbook.app:Logging_Config.py:160 Total initialization time: 0.008 seconds
INFO     tldw_chatbook.app:Logging_Config.py:160   basic_init: 0.002s (31.0%)
INFO     tldw_chatbook.app:Logging_Config.py:160   attribute_init: 0.000s (0.2%)
INFO     tldw_chatbook.app:Logging_Config.py:160   notes_service_init: 0.000s (3.1%)
INFO     tldw_chatbook.app:Logging_Config.py:160   providers_models: 0.003s (39.6%)
INFO     tldw_chatbook.app:Logging_Config.py:160   prompts_service_init: 0.001s (6.8%)
INFO     tldw_chatbook.app:Logging_Config.py:160   media_db_init: 0.001s (7.2%)
INFO     tldw_chatbook.app:Logging_Config.py:160 ==============================
----------------------------------------

133. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

134. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/media.db [Client ID: test_client_id]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/media.db [Client: test_client_id, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 0. Code supports: 1
INFO     root:Client_Media_DB_v2.py:680 Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/media.db...
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:694 [Schema V1] Applying Core Schema + Version Update...
DEBUG    root:Client_Media_DB_v2.py:696 [Schema V1] Core Schema script (incl. version update) executed.
DEBUG    root:Client_Media_DB_v2.py:707 [Schema V1] Media table structure validated successfully.
DEBUG    root:Client_Media_DB_v2.py:719 [Schema V1] Version check inside transaction confirmed version is 1.
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:722 [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/media.db.
DEBUG    root:Client_Media_DB_v2.py:726 [Schema V1] Applying FTS Tables...
INFO     root:Client_Media_DB_v2.py:729 [Schema V1] FTS Tables created successfully.
INFO     root:Client_Media_DB_v2.py:771 Database schema initialized/migrated to version 1.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/media.db
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db [Client ID: test_user]
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db (Journal: wal) for thread 8705548032
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction started (outermost) on thread 8705548032.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Full schema script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction (outermost) committed successfully on thread 8705548032.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media c23ff412-21f0-445e-9133-1c7ef8513eba create v1 at 2025-06-29T07:21:04.275Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 1: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword ',' UUID 52e051c0-1579-4aea-8d87-6d816f6cdaf2
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 52e051c0-1579-4aea-8d87-6d816f6cdaf2 create v1 at 2025-06-29T07:21:04.275Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'e' UUID 7f77df9f-ac35-4a30-a32d-04ae4b513e2f
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 7f77df9f-ac35-4a30-a32d-04ae4b513e2f create v1 at 2025-06-29T07:21:04.275Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 2
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'n' UUID cdff1c03-7907-477c-96fe-4748ffaa5877
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords cdff1c03-7907-477c-96fe-4748ffaa5877 create v1 at 2025-06-29T07:21:04.275Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 3
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'o' UUID b3016a6b-47f9-47c2-8299-afcdc0b3af50
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords b3016a6b-47f9-47c2-8299-afcdc0b3af50 create v1 at 2025-06-29T07:21:04.275Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 4
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 's' UUID a94f9149-5c57-478b-b088-5ec01aa3f513
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords a94f9149-5c57-478b-b088-5ec01aa3f513 create v1 at 2025-06-29T07:21:04.275Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 5
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 't' UUID 8c5da421-bf9f-40aa-baa7-402e2f59a57f
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 8c5da421-bf9f-40aa-baa7-402e2f59a57f create v1 at 2025-06-29T07:21:04.275Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 6
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords c23ff412-21f0-445e-9133-1c7ef8513eba_52e051c0-1579-4aea-8d87-6d816f6cdaf2 link v1 at 2025-06-29T07:21:04.275Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords c23ff412-21f0-445e-9133-1c7ef8513eba_7f77df9f-ac35-4a30-a32d-04ae4b513e2f link v1 at 2025-06-29T07:21:04.275Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords c23ff412-21f0-445e-9133-1c7ef8513eba_cdff1c03-7907-477c-96fe-4748ffaa5877 link v1 at 2025-06-29T07:21:04.275Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords c23ff412-21f0-445e-9133-1c7ef8513eba_b3016a6b-47f9-47c2-8299-afcdc0b3af50 link v1 at 2025-06-29T07:21:04.275Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords c23ff412-21f0-445e-9133-1c7ef8513eba_a94f9149-5c57-478b-b088-5ec01aa3f513 link v1 at 2025-06-29T07:21:04.275Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords c23ff412-21f0-445e-9133-1c7ef8513eba_8c5da421-bf9f-40aa-baa7-402e2f59a57f link v1 at 2025-06-29T07:21:04.275Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 1. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 1, UUID de0d60d0-be2b-4ccf-a698-e1126efe510c
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions de0d60d0-be2b-4ccf-a698-e1126efe510c create v1 at 2025-06-29T07:21:04.275Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media 693f810c-fb44-43d9-ae80-c5a82acc52d5 create v1 at 2025-06-29T07:21:04.276Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 2: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 2
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword ',' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'e' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'o' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 's' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 't' already active.
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'w' UUID f55537f5-d786-410a-a5c6-b98b69f9f159
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords f55537f5-d786-410a-a5c6-b98b69f9f159 create v1 at 2025-06-29T07:21:04.276Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 7
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 693f810c-fb44-43d9-ae80-c5a82acc52d5_52e051c0-1579-4aea-8d87-6d816f6cdaf2 link v1 at 2025-06-29T07:21:04.276Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 693f810c-fb44-43d9-ae80-c5a82acc52d5_7f77df9f-ac35-4a30-a32d-04ae4b513e2f link v1 at 2025-06-29T07:21:04.276Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 693f810c-fb44-43d9-ae80-c5a82acc52d5_b3016a6b-47f9-47c2-8299-afcdc0b3af50 link v1 at 2025-06-29T07:21:04.276Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 693f810c-fb44-43d9-ae80-c5a82acc52d5_a94f9149-5c57-478b-b088-5ec01aa3f513 link v1 at 2025-06-29T07:21:04.276Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 693f810c-fb44-43d9-ae80-c5a82acc52d5_8c5da421-bf9f-40aa-baa7-402e2f59a57f link v1 at 2025-06-29T07:21:04.276Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 693f810c-fb44-43d9-ae80-c5a82acc52d5_f55537f5-d786-410a-a5c6-b98b69f9f159 link v1 at 2025-06-29T07:21:04.276Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 2. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 2, UUID ae0f63c5-1d5c-4e77-bd65-6992be99b49e
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions ae0f63c5-1d5c-4e77-bd65-6992be99b49e create v1 at 2025-06-29T07:21:04.276Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
----------------------------- Captured stderr call -----------------------------
----------------------------------------

135. !!! CRITICAL ERROR in RichLog processor: Event loop is closed
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/queues.py", line 158, in get
    await getter
GeneratorExit
----------------------------------------

136. ERROR    root:metrics.py:99 Failed to log histogram app_compose_duration_seconds: No label names were set when constructing histogram:app_compose_duration_seconds
DEBUG    root:app.py:1329 App compose finished in 0.001 seconds
----------------------------------------

137. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

138. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 Composing ChatWindow UI
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:settings_sidebar.py:42 Sidebar chat: Received providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 'respond-for-me-button' composed.
DEBUG    tldw_chatbook.app:Logging_Config.py:160 Chat ephemeral state changed to: True
DEBUG    root:chat_right_sidebar.py:355 Character sidebar (id='chat-right-sidebar', prefix='chat') created with ephemeral state: True
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing CCPWindow UI
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing center pane
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing right pane
DEBUG    tldw_chatbook.UI.SearchRAGWindow:Logging_Config.py:160 Loaded 0 recent search queries
DEBUG    tldw_chatbook.UI.Ingest_Window:Logging_Config.py:160 Composing IngestWindow UI
INFO     root:Stats_screen.py:25 MetricsScreen initialized. Log path: /tmp/app_metrics.log
INFO     root:Stats_screen.py:76 MetricsScreen composing. Current metrics: {}
WARNING  root:Stats_screen.py:79 MetricsScreen compose: self.metrics is unexpectedly empty at compose time.
INFO     root:Stats_screen.py:93 MetricsScreen compose finished.
----------------------------------------

139. ERROR    asyncio:base_events.py:1833 Task was destroyed but it is pending!
task: <Task pending name='RichLogProcessor' coro=<RichLogHandler._process_log_queue() running at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Logging_Config.py:78> wait_for=<Future pending cb=[Task.task_wakeup()]>>
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:29 MetricsScreen on_mount: Calling load_metrics.
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:45 Attempting to load metrics from: /tmp/app_metrics.log
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
----------------------------------------

140. ERROR    root:Stats_screen.py:68 MetricsScreen: Log file not found at /tmp/app_metrics.log.
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
INFO     tldw_chatbook.UI.Coding_Window:Logging_Config.py:160 CodingWindow on_mount: UI composed
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    tldw_chatbook.UI.LLM_Management_Window:Logging_Config.py:160 LLMManagementWindow.on_mount called
INFO     tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 EvalsWindow on_mount: UI composed
----------------------------------------

141. ERROR    tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 Error initializing evaluation system: cannot import name 'EvaluationOrchestrator' from 'tldw_chatbook.Evals' (/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Evals/__init__.py)
INFO     tldw_chatbook.RAG_Search.Services.embeddings_service:Logging_Config.py:160 ChromaDB initialized at /Users/appledev/.local/share/tldw_cli/chromadb
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting and initializing initial active sub-tab.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-chat display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-creation display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-web-search display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initial active sub-tab set to search-view-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Added active class to nav button search-nav-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Set display=True for active view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initializing view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Initializing Embeddings Creation view.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation provider select changed to: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation model select changed to: e5-small-v2 for provider: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Provider specific inputs visibility updated. Custom HF: False, Local API URL: False (Value: '', Disabled: False)
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Logging_Config.py:137 --- _setup_logging START (from Logging_Config.py) ---
INFO     root:Logging_Config.py:145 Loguru: All pre-existing sinks removed.
INFO     root:Logging_Config.py:168 Loguru: Configured to forward its messages to standard Python logging system.
--------------------------- Captured stderr teardown ---------------------------
2025-06-29 00:21:09 [DEBUG   ] root:535 - Closed connection for thread MainThread.
---------------------------- Captured log teardown -----------------------------
DEBUG    root:Client_Media_DB_v2.py:535 Closed connection for thread MainThread.
----------------------------------------

142. _ ERROR at teardown of test_media_copy_buttons[chat-media-copy-author-button-author-Author copied to clipboard.] _
Tests/Chat/test_chat_sidebar_media_search.py:102: in real_app_media_test
    app.chachanotes_db.close()
    ^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'CharactersRAGDB' object has no attribute 'close'
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:21:09 [DEBUG   ] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

143. 2025-06-29 00:21:09 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

144. 2025-06-29 00:21:09 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

145. 2025-06-29 00:21:09 [ERROR   ] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:09 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

146. 2025-06-29 00:21:09 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

147. 2025-06-29 00:21:09 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:09 [DEBUG   ] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:09 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:09 [INFO    ] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:21:09 [INFO    ] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:21:09 [WARNING ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Database schema is up to date.
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Verified FTS tables exist.
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts Interop Library initialized successfully.
2025-06-29 00:21:09 [INFO    ] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:09 [INFO    ] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:21:09 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:21:09 [INFO    ] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:21:09 [DEBUG   ] root:750 - Database schema is up to date.
2025-06-29 00:21:09 [DEBUG   ] root:755 - Verified FTS tables exist.
2025-06-29 00:21:09 [DEBUG   ] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x17a84a390>
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:21:09 [DEBUG   ] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

148. 2025-06-29 00:21:09 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

149. 2025-06-29 00:21:09 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:21:09 [INFO    ] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:21:09 [INFO    ] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

150. 2025-06-29 00:21:09 [ERROR   ] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 - Total initialization time: 0.007 seconds
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 -   basic_init: 0.003s (35.6%)
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 -   attribute_init: 0.000s (0.3%)
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 -   notes_service_init: 0.000s (3.5%)
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 -   providers_models: 0.002s (33.4%)
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 -   prompts_service_init: 0.001s (7.4%)
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 -   media_db_init: 0.001s (8.1%)
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 - ==============================
----------------------------------------

151. 2025-06-29 00:21:09 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

152. 2025-06-29 00:21:09 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:09 [INFO    ] root:444 - Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/media.db [Client ID: test_client_id]
2025-06-29 00:21:09 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/media.db [Client: test_client_id, Thread: MainThread]
2025-06-29 00:21:09 [INFO    ] root:747 - Checking DB schema. Current version: 0. Code supports: 1
2025-06-29 00:21:09 [INFO    ] root:680 - Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/media.db...
2025-06-29 00:21:09 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:09 [DEBUG   ] root:694 - [Schema V1] Applying Core Schema + Version Update...
2025-06-29 00:21:09 [DEBUG   ] root:696 - [Schema V1] Core Schema script (incl. version update) executed.
2025-06-29 00:21:09 [DEBUG   ] root:707 - [Schema V1] Media table structure validated successfully.
2025-06-29 00:21:09 [DEBUG   ] root:719 - [Schema V1] Version check inside transaction confirmed version is 1.
2025-06-29 00:21:09 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:21:09 [INFO    ] root:722 - [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/media.db.
2025-06-29 00:21:09 [DEBUG   ] root:726 - [Schema V1] Applying FTS Tables...
2025-06-29 00:21:09 [INFO    ] root:729 - [Schema V1] FTS Tables created successfully.
2025-06-29 00:21:09 [INFO    ] root:771 - Database schema initialized/migrated to version 1.
2025-06-29 00:21:09 [DEBUG   ] root:474 - Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/media.db
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db...
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db.
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db...
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db.
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db
2025-06-29 00:21:09 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
2025-06-29 00:21:09 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: Media 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d create v1 at 2025-06-29T07:21:09.397Z
2025-06-29 00:21:09 [DEBUG   ] root:919 - FTS update for media 1: sanitized content - null bytes replaced
2025-06-29 00:21:09 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 1
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword ',' UUID f7105a4a-b3f4-48ea-a111-47146caf3cfd
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: Keywords f7105a4a-b3f4-48ea-a111-47146caf3cfd create v1 at 2025-06-29T07:21:09.397Z
2025-06-29 00:21:09 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 1
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'e' UUID b55e4055-a9cd-4d67-bbc3-4964127b056b
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: Keywords b55e4055-a9cd-4d67-bbc3-4964127b056b create v1 at 2025-06-29T07:21:09.397Z
2025-06-29 00:21:09 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 2
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'n' UUID 4961962d-7736-4528-bbe3-f2ab26ac1e4f
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: Keywords 4961962d-7736-4528-bbe3-f2ab26ac1e4f create v1 at 2025-06-29T07:21:09.397Z
2025-06-29 00:21:09 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 3
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'o' UUID b48718c9-4fd8-4654-ab69-7ef0c47639c3
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: Keywords b48718c9-4fd8-4654-ab69-7ef0c47639c3 create v1 at 2025-06-29T07:21:09.397Z
2025-06-29 00:21:09 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 4
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 's' UUID 07f8fa02-a47e-4480-b094-b77a1bcd08b4
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: Keywords 07f8fa02-a47e-4480-b094-b77a1bcd08b4 create v1 at 2025-06-29T07:21:09.397Z
2025-06-29 00:21:09 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 5
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 't' UUID 8e9c7ebe-2d88-4a9f-9e29-07269728d5fb
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: Keywords 8e9c7ebe-2d88-4a9f-9e29-07269728d5fb create v1 at 2025-06-29T07:21:09.398Z
2025-06-29 00:21:09 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 6
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d_f7105a4a-b3f4-48ea-a111-47146caf3cfd link v1 at 2025-06-29T07:21:09.398Z
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d_b55e4055-a9cd-4d67-bbc3-4964127b056b link v1 at 2025-06-29T07:21:09.398Z
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d_4961962d-7736-4528-bbe3-f2ab26ac1e4f link v1 at 2025-06-29T07:21:09.398Z
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d_b48718c9-4fd8-4654-ab69-7ef0c47639c3 link v1 at 2025-06-29T07:21:09.398Z
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d_07f8fa02-a47e-4480-b094-b77a1bcd08b4 link v1 at 2025-06-29T07:21:09.398Z
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d_8e9c7ebe-2d88-4a9f-9e29-07269728d5fb link v1 at 2025-06-29T07:21:09.398Z
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 1. Added: 6, Removed: 0.
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 1, UUID 13733f43-067e-4c27-a4fb-d38bd499de80
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: DocumentVersions 13733f43-067e-4c27-a4fb-d38bd499de80 create v1 at 2025-06-29T07:21:09.398Z
2025-06-29 00:21:09 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:21:09 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
2025-06-29 00:21:09 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: Media 442c8b47-a677-4734-8fc1-2feaf4ee4150 create v1 at 2025-06-29T07:21:09.398Z
2025-06-29 00:21:09 [DEBUG   ] root:919 - FTS update for media 2: sanitized content - null bytes replaced
2025-06-29 00:21:09 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 2
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword ',' already active.
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'e' already active.
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'o' already active.
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 's' already active.
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 't' already active.
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'w' UUID 88fed234-2c95-4b7f-aedf-a108ab6e1908
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: Keywords 88fed234-2c95-4b7f-aedf-a108ab6e1908 create v1 at 2025-06-29T07:21:09.399Z
2025-06-29 00:21:09 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 7
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 442c8b47-a677-4734-8fc1-2feaf4ee4150_f7105a4a-b3f4-48ea-a111-47146caf3cfd link v1 at 2025-06-29T07:21:09.399Z
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 442c8b47-a677-4734-8fc1-2feaf4ee4150_b55e4055-a9cd-4d67-bbc3-4964127b056b link v1 at 2025-06-29T07:21:09.399Z
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 442c8b47-a677-4734-8fc1-2feaf4ee4150_b48718c9-4fd8-4654-ab69-7ef0c47639c3 link v1 at 2025-06-29T07:21:09.399Z
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 442c8b47-a677-4734-8fc1-2feaf4ee4150_07f8fa02-a47e-4480-b094-b77a1bcd08b4 link v1 at 2025-06-29T07:21:09.399Z
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 442c8b47-a677-4734-8fc1-2feaf4ee4150_8e9c7ebe-2d88-4a9f-9e29-07269728d5fb link v1 at 2025-06-29T07:21:09.399Z
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 442c8b47-a677-4734-8fc1-2feaf4ee4150_88fed234-2c95-4b7f-aedf-a108ab6e1908 link v1 at 2025-06-29T07:21:09.399Z
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 2. Added: 6, Removed: 0.
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 2, UUID 811002ca-abf1-492d-9221-840c1075afde
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: DocumentVersions 811002ca-abf1-492d-9221-840c1075afde create v1 at 2025-06-29T07:21:09.399Z
2025-06-29 00:21:09 [DEBUG   ] root:652 - Committed transaction.
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

153. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

154. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

155. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     tldw_chatbook.app:Logging_Config.py:160 Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

156. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

157. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
WARNING  tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Checking DB schema. Current: 1, Code supports: 1
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Database schema is up to date.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Verified FTS tables exist.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts Interop Library initialized successfully.
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x17a84a390>
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Found 3 distinct media types: ['article', 'podcast', 'video']
INFO     tldw_chatbook.app:Logging_Config.py:160 App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

158. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

159. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

160. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
INFO     tldw_chatbook.app:Logging_Config.py:160 === STARTUP TIMING SUMMARY ===
INFO     tldw_chatbook.app:Logging_Config.py:160 Total initialization time: 0.007 seconds
INFO     tldw_chatbook.app:Logging_Config.py:160   basic_init: 0.003s (35.6%)
INFO     tldw_chatbook.app:Logging_Config.py:160   attribute_init: 0.000s (0.3%)
INFO     tldw_chatbook.app:Logging_Config.py:160   notes_service_init: 0.000s (3.5%)
INFO     tldw_chatbook.app:Logging_Config.py:160   providers_models: 0.002s (33.4%)
INFO     tldw_chatbook.app:Logging_Config.py:160   prompts_service_init: 0.001s (7.4%)
INFO     tldw_chatbook.app:Logging_Config.py:160   media_db_init: 0.001s (8.1%)
INFO     tldw_chatbook.app:Logging_Config.py:160 ==============================
----------------------------------------

161. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

162. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/media.db [Client ID: test_client_id]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/media.db [Client: test_client_id, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 0. Code supports: 1
INFO     root:Client_Media_DB_v2.py:680 Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/media.db...
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:694 [Schema V1] Applying Core Schema + Version Update...
DEBUG    root:Client_Media_DB_v2.py:696 [Schema V1] Core Schema script (incl. version update) executed.
DEBUG    root:Client_Media_DB_v2.py:707 [Schema V1] Media table structure validated successfully.
DEBUG    root:Client_Media_DB_v2.py:719 [Schema V1] Version check inside transaction confirmed version is 1.
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:722 [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/media.db.
DEBUG    root:Client_Media_DB_v2.py:726 [Schema V1] Applying FTS Tables...
INFO     root:Client_Media_DB_v2.py:729 [Schema V1] FTS Tables created successfully.
INFO     root:Client_Media_DB_v2.py:771 Database schema initialized/migrated to version 1.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/media.db
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db [Client ID: test_user]
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db (Journal: wal) for thread 8705548032
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction started (outermost) on thread 8705548032.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Full schema script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction (outermost) committed successfully on thread 8705548032.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d create v1 at 2025-06-29T07:21:09.397Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 1: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword ',' UUID f7105a4a-b3f4-48ea-a111-47146caf3cfd
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords f7105a4a-b3f4-48ea-a111-47146caf3cfd create v1 at 2025-06-29T07:21:09.397Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'e' UUID b55e4055-a9cd-4d67-bbc3-4964127b056b
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords b55e4055-a9cd-4d67-bbc3-4964127b056b create v1 at 2025-06-29T07:21:09.397Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 2
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'n' UUID 4961962d-7736-4528-bbe3-f2ab26ac1e4f
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 4961962d-7736-4528-bbe3-f2ab26ac1e4f create v1 at 2025-06-29T07:21:09.397Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 3
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'o' UUID b48718c9-4fd8-4654-ab69-7ef0c47639c3
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords b48718c9-4fd8-4654-ab69-7ef0c47639c3 create v1 at 2025-06-29T07:21:09.397Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 4
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 's' UUID 07f8fa02-a47e-4480-b094-b77a1bcd08b4
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 07f8fa02-a47e-4480-b094-b77a1bcd08b4 create v1 at 2025-06-29T07:21:09.397Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 5
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 't' UUID 8e9c7ebe-2d88-4a9f-9e29-07269728d5fb
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 8e9c7ebe-2d88-4a9f-9e29-07269728d5fb create v1 at 2025-06-29T07:21:09.398Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 6
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d_f7105a4a-b3f4-48ea-a111-47146caf3cfd link v1 at 2025-06-29T07:21:09.398Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d_b55e4055-a9cd-4d67-bbc3-4964127b056b link v1 at 2025-06-29T07:21:09.398Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d_4961962d-7736-4528-bbe3-f2ab26ac1e4f link v1 at 2025-06-29T07:21:09.398Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d_b48718c9-4fd8-4654-ab69-7ef0c47639c3 link v1 at 2025-06-29T07:21:09.398Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d_07f8fa02-a47e-4480-b094-b77a1bcd08b4 link v1 at 2025-06-29T07:21:09.398Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d_8e9c7ebe-2d88-4a9f-9e29-07269728d5fb link v1 at 2025-06-29T07:21:09.398Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 1. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 1, UUID 13733f43-067e-4c27-a4fb-d38bd499de80
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions 13733f43-067e-4c27-a4fb-d38bd499de80 create v1 at 2025-06-29T07:21:09.398Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media 442c8b47-a677-4734-8fc1-2feaf4ee4150 create v1 at 2025-06-29T07:21:09.398Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 2: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 2
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword ',' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'e' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'o' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 's' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 't' already active.
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'w' UUID 88fed234-2c95-4b7f-aedf-a108ab6e1908
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 88fed234-2c95-4b7f-aedf-a108ab6e1908 create v1 at 2025-06-29T07:21:09.399Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 7
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 442c8b47-a677-4734-8fc1-2feaf4ee4150_f7105a4a-b3f4-48ea-a111-47146caf3cfd link v1 at 2025-06-29T07:21:09.399Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 442c8b47-a677-4734-8fc1-2feaf4ee4150_b55e4055-a9cd-4d67-bbc3-4964127b056b link v1 at 2025-06-29T07:21:09.399Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 442c8b47-a677-4734-8fc1-2feaf4ee4150_b48718c9-4fd8-4654-ab69-7ef0c47639c3 link v1 at 2025-06-29T07:21:09.399Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 442c8b47-a677-4734-8fc1-2feaf4ee4150_07f8fa02-a47e-4480-b094-b77a1bcd08b4 link v1 at 2025-06-29T07:21:09.399Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 442c8b47-a677-4734-8fc1-2feaf4ee4150_8e9c7ebe-2d88-4a9f-9e29-07269728d5fb link v1 at 2025-06-29T07:21:09.399Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 442c8b47-a677-4734-8fc1-2feaf4ee4150_88fed234-2c95-4b7f-aedf-a108ab6e1908 link v1 at 2025-06-29T07:21:09.399Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 2. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 2, UUID 811002ca-abf1-492d-9221-840c1075afde
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions 811002ca-abf1-492d-9221-840c1075afde create v1 at 2025-06-29T07:21:09.399Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
----------------------------- Captured stderr call -----------------------------
----------------------------------------

163. !!! CRITICAL ERROR in RichLog processor: Event loop is closed
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/queues.py", line 158, in get
    await getter
GeneratorExit
----------------------------------------

164. ERROR    root:metrics.py:99 Failed to log histogram app_compose_duration_seconds: No label names were set when constructing histogram:app_compose_duration_seconds
DEBUG    root:app.py:1329 App compose finished in 0.001 seconds
----------------------------------------

165. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

166. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 Composing ChatWindow UI
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:settings_sidebar.py:42 Sidebar chat: Received providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 'respond-for-me-button' composed.
DEBUG    tldw_chatbook.app:Logging_Config.py:160 Chat ephemeral state changed to: True
DEBUG    root:chat_right_sidebar.py:355 Character sidebar (id='chat-right-sidebar', prefix='chat') created with ephemeral state: True
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing CCPWindow UI
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing center pane
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing right pane
DEBUG    tldw_chatbook.UI.SearchRAGWindow:Logging_Config.py:160 Loaded 0 recent search queries
DEBUG    tldw_chatbook.UI.Ingest_Window:Logging_Config.py:160 Composing IngestWindow UI
----------------------------------------

167. ERROR    asyncio:base_events.py:1833 Task was destroyed but it is pending!
task: <Task pending name='RichLogProcessor' coro=<RichLogHandler._process_log_queue() running at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Logging_Config.py:78> wait_for=<Future pending cb=[Task.task_wakeup()]>>
INFO     root:Stats_screen.py:25 MetricsScreen initialized. Log path: /tmp/app_metrics.log
INFO     root:Stats_screen.py:76 MetricsScreen composing. Current metrics: {}
WARNING  root:Stats_screen.py:79 MetricsScreen compose: self.metrics is unexpectedly empty at compose time.
INFO     root:Stats_screen.py:93 MetricsScreen compose finished.
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:29 MetricsScreen on_mount: Calling load_metrics.
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:45 Attempting to load metrics from: /tmp/app_metrics.log
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
----------------------------------------

168. ERROR    root:Stats_screen.py:68 MetricsScreen: Log file not found at /tmp/app_metrics.log.
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     tldw_chatbook.UI.Coding_Window:Logging_Config.py:160 CodingWindow on_mount: UI composed
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    tldw_chatbook.UI.LLM_Management_Window:Logging_Config.py:160 LLMManagementWindow.on_mount called
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 5, False
INFO     tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 EvalsWindow on_mount: UI composed
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 5, False
----------------------------------------

169. ERROR    tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 Error initializing evaluation system: cannot import name 'EvaluationOrchestrator' from 'tldw_chatbook.Evals' (/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Evals/__init__.py)
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=4,level=0,tokens=6), 4, 5, False
INFO     tldw_chatbook.RAG_Search.Services.embeddings_service:Logging_Config.py:160 ChromaDB initialized at /Users/appledev/.local/share/tldw_cli/chromadb
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting and initializing initial active sub-tab.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-chat display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-creation display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-web-search display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initial active sub-tab set to search-view-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Added active class to nav button search-nav-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Set display=True for active view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initializing view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Initializing Embeddings Creation view.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation provider select changed to: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation model select changed to: e5-small-v2 for provider: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Provider specific inputs visibility updated. Custom HF: False, Local API URL: False (Value: '', Disabled: False)
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Logging_Config.py:137 --- _setup_logging START (from Logging_Config.py) ---
INFO     root:Logging_Config.py:145 Loguru: All pre-existing sinks removed.
INFO     root:Logging_Config.py:168 Loguru: Configured to forward its messages to standard Python logging system.
--------------------------- Captured stderr teardown ---------------------------
2025-06-29 00:21:14 [DEBUG   ] root:535 - Closed connection for thread MainThread.
---------------------------- Captured log teardown -----------------------------
DEBUG    root:Client_Media_DB_v2.py:535 Closed connection for thread MainThread.
----------------------------------------

170. _ ERROR at teardown of test_media_copy_buttons[chat-media-copy-url-button-url-URL copied to clipboard.] _
Tests/Chat/test_chat_sidebar_media_search.py:102: in real_app_media_test
    app.chachanotes_db.close()
    ^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'CharactersRAGDB' object has no attribute 'close'
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:21:14 [DEBUG   ] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

171. 2025-06-29 00:21:14 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

172. 2025-06-29 00:21:14 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

173. 2025-06-29 00:21:14 [ERROR   ] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:14 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

174. 2025-06-29 00:21:14 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

175. 2025-06-29 00:21:14 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:14 [DEBUG   ] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:14 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:14 [INFO    ] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:21:14 [INFO    ] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:21:14 [WARNING ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Database schema is up to date.
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Verified FTS tables exist.
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts Interop Library initialized successfully.
2025-06-29 00:21:14 [INFO    ] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:14 [INFO    ] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:21:14 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:21:14 [INFO    ] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:21:14 [DEBUG   ] root:750 - Database schema is up to date.
2025-06-29 00:21:14 [DEBUG   ] root:755 - Verified FTS tables exist.
2025-06-29 00:21:14 [DEBUG   ] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x173ddc320>
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:21:14 [DEBUG   ] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

176. 2025-06-29 00:21:14 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

177. 2025-06-29 00:21:14 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:21:14 [INFO    ] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:21:14 [INFO    ] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

178. 2025-06-29 00:21:14 [ERROR   ] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 - Total initialization time: 0.007 seconds
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 -   basic_init: 0.002s (34.4%)
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 -   attribute_init: 0.000s (0.2%)
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 -   notes_service_init: 0.000s (3.5%)
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 -   providers_models: 0.002s (34.2%)
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 -   prompts_service_init: 0.001s (8.0%)
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 -   media_db_init: 0.001s (8.2%)
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 - ==============================
----------------------------------------

179. 2025-06-29 00:21:14 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

180. 2025-06-29 00:21:14 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:14 [INFO    ] root:444 - Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/media.db [Client ID: test_client_id]
2025-06-29 00:21:14 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/media.db [Client: test_client_id, Thread: MainThread]
2025-06-29 00:21:14 [INFO    ] root:747 - Checking DB schema. Current version: 0. Code supports: 1
2025-06-29 00:21:14 [INFO    ] root:680 - Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/media.db...
2025-06-29 00:21:14 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:14 [DEBUG   ] root:694 - [Schema V1] Applying Core Schema + Version Update...
2025-06-29 00:21:14 [DEBUG   ] root:696 - [Schema V1] Core Schema script (incl. version update) executed.
2025-06-29 00:21:14 [DEBUG   ] root:707 - [Schema V1] Media table structure validated successfully.
2025-06-29 00:21:14 [DEBUG   ] root:719 - [Schema V1] Version check inside transaction confirmed version is 1.
2025-06-29 00:21:14 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:21:14 [INFO    ] root:722 - [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/media.db.
2025-06-29 00:21:14 [DEBUG   ] root:726 - [Schema V1] Applying FTS Tables...
2025-06-29 00:21:14 [INFO    ] root:729 - [Schema V1] FTS Tables created successfully.
2025-06-29 00:21:14 [INFO    ] root:771 - Database schema initialized/migrated to version 1.
2025-06-29 00:21:14 [DEBUG   ] root:474 - Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/media.db
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db...
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db.
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db...
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db.
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db
2025-06-29 00:21:14 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
2025-06-29 00:21:14 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: Media d0ae62c9-c645-402f-8f64-155d8c1181c4 create v1 at 2025-06-29T07:21:14.716Z
2025-06-29 00:21:14 [DEBUG   ] root:919 - FTS update for media 1: sanitized content - null bytes replaced
2025-06-29 00:21:14 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 1
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword ',' UUID 5b51a3b6-c9f4-4c95-9bd0-688bd80b33de
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: Keywords 5b51a3b6-c9f4-4c95-9bd0-688bd80b33de create v1 at 2025-06-29T07:21:14.716Z
2025-06-29 00:21:14 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 1
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'e' UUID f51ec32f-c4d1-44ae-b7e1-3d67f250bd94
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: Keywords f51ec32f-c4d1-44ae-b7e1-3d67f250bd94 create v1 at 2025-06-29T07:21:14.716Z
2025-06-29 00:21:14 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 2
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'n' UUID 48c21cc0-d6e2-43b3-8bea-2bb9c31fa5f2
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: Keywords 48c21cc0-d6e2-43b3-8bea-2bb9c31fa5f2 create v1 at 2025-06-29T07:21:14.716Z
2025-06-29 00:21:14 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 3
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'o' UUID 0f4b6e61-a43f-429d-aef7-494178f91216
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: Keywords 0f4b6e61-a43f-429d-aef7-494178f91216 create v1 at 2025-06-29T07:21:14.716Z
2025-06-29 00:21:14 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 4
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 's' UUID c0b35983-08f1-4028-aedd-a7309d4a178d
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: Keywords c0b35983-08f1-4028-aedd-a7309d4a178d create v1 at 2025-06-29T07:21:14.717Z
2025-06-29 00:21:14 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 5
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 't' UUID 28282833-66d0-4ffb-b499-0df65f7103f1
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: Keywords 28282833-66d0-4ffb-b499-0df65f7103f1 create v1 at 2025-06-29T07:21:14.717Z
2025-06-29 00:21:14 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 6
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d0ae62c9-c645-402f-8f64-155d8c1181c4_5b51a3b6-c9f4-4c95-9bd0-688bd80b33de link v1 at 2025-06-29T07:21:14.717Z
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d0ae62c9-c645-402f-8f64-155d8c1181c4_f51ec32f-c4d1-44ae-b7e1-3d67f250bd94 link v1 at 2025-06-29T07:21:14.717Z
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d0ae62c9-c645-402f-8f64-155d8c1181c4_48c21cc0-d6e2-43b3-8bea-2bb9c31fa5f2 link v1 at 2025-06-29T07:21:14.717Z
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d0ae62c9-c645-402f-8f64-155d8c1181c4_0f4b6e61-a43f-429d-aef7-494178f91216 link v1 at 2025-06-29T07:21:14.717Z
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d0ae62c9-c645-402f-8f64-155d8c1181c4_c0b35983-08f1-4028-aedd-a7309d4a178d link v1 at 2025-06-29T07:21:14.717Z
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d0ae62c9-c645-402f-8f64-155d8c1181c4_28282833-66d0-4ffb-b499-0df65f7103f1 link v1 at 2025-06-29T07:21:14.717Z
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 1. Added: 6, Removed: 0.
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 1, UUID 7d67bb0b-9692-45bd-a441-821f22bb2601
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: DocumentVersions 7d67bb0b-9692-45bd-a441-821f22bb2601 create v1 at 2025-06-29T07:21:14.717Z
2025-06-29 00:21:14 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:21:14 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
2025-06-29 00:21:14 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: Media a7eb3cd6-4255-4caa-8ed3-c205a1f92275 create v1 at 2025-06-29T07:21:14.717Z
2025-06-29 00:21:14 [DEBUG   ] root:919 - FTS update for media 2: sanitized content - null bytes replaced
2025-06-29 00:21:14 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 2
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword ',' already active.
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'e' already active.
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'o' already active.
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 's' already active.
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 't' already active.
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'w' UUID cb5c345e-c1b1-40a7-a742-6738b2075840
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: Keywords cb5c345e-c1b1-40a7-a742-6738b2075840 create v1 at 2025-06-29T07:21:14.718Z
2025-06-29 00:21:14 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 7
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: MediaKeywords a7eb3cd6-4255-4caa-8ed3-c205a1f92275_5b51a3b6-c9f4-4c95-9bd0-688bd80b33de link v1 at 2025-06-29T07:21:14.718Z
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: MediaKeywords a7eb3cd6-4255-4caa-8ed3-c205a1f92275_f51ec32f-c4d1-44ae-b7e1-3d67f250bd94 link v1 at 2025-06-29T07:21:14.718Z
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: MediaKeywords a7eb3cd6-4255-4caa-8ed3-c205a1f92275_0f4b6e61-a43f-429d-aef7-494178f91216 link v1 at 2025-06-29T07:21:14.718Z
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: MediaKeywords a7eb3cd6-4255-4caa-8ed3-c205a1f92275_c0b35983-08f1-4028-aedd-a7309d4a178d link v1 at 2025-06-29T07:21:14.718Z
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: MediaKeywords a7eb3cd6-4255-4caa-8ed3-c205a1f92275_28282833-66d0-4ffb-b499-0df65f7103f1 link v1 at 2025-06-29T07:21:14.718Z
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: MediaKeywords a7eb3cd6-4255-4caa-8ed3-c205a1f92275_cb5c345e-c1b1-40a7-a742-6738b2075840 link v1 at 2025-06-29T07:21:14.718Z
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 2. Added: 6, Removed: 0.
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 2, UUID c0a4e5d7-e06a-4f59-9fb6-019ae58a0d5e
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: DocumentVersions c0a4e5d7-e06a-4f59-9fb6-019ae58a0d5e create v1 at 2025-06-29T07:21:14.718Z
2025-06-29 00:21:14 [DEBUG   ] root:652 - Committed transaction.
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

181. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

182. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

183. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     tldw_chatbook.app:Logging_Config.py:160 Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

184. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

185. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
WARNING  tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Checking DB schema. Current: 1, Code supports: 1
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Database schema is up to date.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Verified FTS tables exist.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts Interop Library initialized successfully.
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x173ddc320>
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Found 3 distinct media types: ['article', 'podcast', 'video']
INFO     tldw_chatbook.app:Logging_Config.py:160 App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

186. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

187. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

188. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
INFO     tldw_chatbook.app:Logging_Config.py:160 === STARTUP TIMING SUMMARY ===
INFO     tldw_chatbook.app:Logging_Config.py:160 Total initialization time: 0.007 seconds
INFO     tldw_chatbook.app:Logging_Config.py:160   basic_init: 0.002s (34.4%)
INFO     tldw_chatbook.app:Logging_Config.py:160   attribute_init: 0.000s (0.2%)
INFO     tldw_chatbook.app:Logging_Config.py:160   notes_service_init: 0.000s (3.5%)
INFO     tldw_chatbook.app:Logging_Config.py:160   providers_models: 0.002s (34.2%)
INFO     tldw_chatbook.app:Logging_Config.py:160   prompts_service_init: 0.001s (8.0%)
INFO     tldw_chatbook.app:Logging_Config.py:160   media_db_init: 0.001s (8.2%)
INFO     tldw_chatbook.app:Logging_Config.py:160 ==============================
----------------------------------------

189. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

190. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/media.db [Client ID: test_client_id]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/media.db [Client: test_client_id, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 0. Code supports: 1
INFO     root:Client_Media_DB_v2.py:680 Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/media.db...
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:694 [Schema V1] Applying Core Schema + Version Update...
DEBUG    root:Client_Media_DB_v2.py:696 [Schema V1] Core Schema script (incl. version update) executed.
DEBUG    root:Client_Media_DB_v2.py:707 [Schema V1] Media table structure validated successfully.
DEBUG    root:Client_Media_DB_v2.py:719 [Schema V1] Version check inside transaction confirmed version is 1.
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:722 [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/media.db.
DEBUG    root:Client_Media_DB_v2.py:726 [Schema V1] Applying FTS Tables...
INFO     root:Client_Media_DB_v2.py:729 [Schema V1] FTS Tables created successfully.
INFO     root:Client_Media_DB_v2.py:771 Database schema initialized/migrated to version 1.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/media.db
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db [Client ID: test_user]
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db (Journal: wal) for thread 8705548032
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction started (outermost) on thread 8705548032.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Full schema script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction (outermost) committed successfully on thread 8705548032.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media d0ae62c9-c645-402f-8f64-155d8c1181c4 create v1 at 2025-06-29T07:21:14.716Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 1: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword ',' UUID 5b51a3b6-c9f4-4c95-9bd0-688bd80b33de
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 5b51a3b6-c9f4-4c95-9bd0-688bd80b33de create v1 at 2025-06-29T07:21:14.716Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'e' UUID f51ec32f-c4d1-44ae-b7e1-3d67f250bd94
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords f51ec32f-c4d1-44ae-b7e1-3d67f250bd94 create v1 at 2025-06-29T07:21:14.716Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 2
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'n' UUID 48c21cc0-d6e2-43b3-8bea-2bb9c31fa5f2
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 48c21cc0-d6e2-43b3-8bea-2bb9c31fa5f2 create v1 at 2025-06-29T07:21:14.716Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 3
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'o' UUID 0f4b6e61-a43f-429d-aef7-494178f91216
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 0f4b6e61-a43f-429d-aef7-494178f91216 create v1 at 2025-06-29T07:21:14.716Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 4
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 's' UUID c0b35983-08f1-4028-aedd-a7309d4a178d
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords c0b35983-08f1-4028-aedd-a7309d4a178d create v1 at 2025-06-29T07:21:14.717Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 5
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 't' UUID 28282833-66d0-4ffb-b499-0df65f7103f1
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 28282833-66d0-4ffb-b499-0df65f7103f1 create v1 at 2025-06-29T07:21:14.717Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 6
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d0ae62c9-c645-402f-8f64-155d8c1181c4_5b51a3b6-c9f4-4c95-9bd0-688bd80b33de link v1 at 2025-06-29T07:21:14.717Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d0ae62c9-c645-402f-8f64-155d8c1181c4_f51ec32f-c4d1-44ae-b7e1-3d67f250bd94 link v1 at 2025-06-29T07:21:14.717Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d0ae62c9-c645-402f-8f64-155d8c1181c4_48c21cc0-d6e2-43b3-8bea-2bb9c31fa5f2 link v1 at 2025-06-29T07:21:14.717Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d0ae62c9-c645-402f-8f64-155d8c1181c4_0f4b6e61-a43f-429d-aef7-494178f91216 link v1 at 2025-06-29T07:21:14.717Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d0ae62c9-c645-402f-8f64-155d8c1181c4_c0b35983-08f1-4028-aedd-a7309d4a178d link v1 at 2025-06-29T07:21:14.717Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d0ae62c9-c645-402f-8f64-155d8c1181c4_28282833-66d0-4ffb-b499-0df65f7103f1 link v1 at 2025-06-29T07:21:14.717Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 1. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 1, UUID 7d67bb0b-9692-45bd-a441-821f22bb2601
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions 7d67bb0b-9692-45bd-a441-821f22bb2601 create v1 at 2025-06-29T07:21:14.717Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media a7eb3cd6-4255-4caa-8ed3-c205a1f92275 create v1 at 2025-06-29T07:21:14.717Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 2: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 2
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword ',' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'e' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'o' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 's' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 't' already active.
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'w' UUID cb5c345e-c1b1-40a7-a742-6738b2075840
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords cb5c345e-c1b1-40a7-a742-6738b2075840 create v1 at 2025-06-29T07:21:14.718Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 7
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords a7eb3cd6-4255-4caa-8ed3-c205a1f92275_5b51a3b6-c9f4-4c95-9bd0-688bd80b33de link v1 at 2025-06-29T07:21:14.718Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords a7eb3cd6-4255-4caa-8ed3-c205a1f92275_f51ec32f-c4d1-44ae-b7e1-3d67f250bd94 link v1 at 2025-06-29T07:21:14.718Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords a7eb3cd6-4255-4caa-8ed3-c205a1f92275_0f4b6e61-a43f-429d-aef7-494178f91216 link v1 at 2025-06-29T07:21:14.718Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords a7eb3cd6-4255-4caa-8ed3-c205a1f92275_c0b35983-08f1-4028-aedd-a7309d4a178d link v1 at 2025-06-29T07:21:14.718Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords a7eb3cd6-4255-4caa-8ed3-c205a1f92275_28282833-66d0-4ffb-b499-0df65f7103f1 link v1 at 2025-06-29T07:21:14.718Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords a7eb3cd6-4255-4caa-8ed3-c205a1f92275_cb5c345e-c1b1-40a7-a742-6738b2075840 link v1 at 2025-06-29T07:21:14.718Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 2. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 2, UUID c0a4e5d7-e06a-4f59-9fb6-019ae58a0d5e
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions c0a4e5d7-e06a-4f59-9fb6-019ae58a0d5e create v1 at 2025-06-29T07:21:14.718Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
----------------------------- Captured stderr call -----------------------------
----------------------------------------

191. !!! CRITICAL ERROR in RichLog processor: Event loop is closed
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/queues.py", line 158, in get
    await getter
GeneratorExit
----------------------------------------

192. ERROR    root:metrics.py:99 Failed to log histogram app_compose_duration_seconds: No label names were set when constructing histogram:app_compose_duration_seconds
DEBUG    root:app.py:1329 App compose finished in 0.001 seconds
----------------------------------------

193. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

194. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 Composing ChatWindow UI
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:settings_sidebar.py:42 Sidebar chat: Received providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 'respond-for-me-button' composed.
DEBUG    tldw_chatbook.app:Logging_Config.py:160 Chat ephemeral state changed to: True
DEBUG    root:chat_right_sidebar.py:355 Character sidebar (id='chat-right-sidebar', prefix='chat') created with ephemeral state: True
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing CCPWindow UI
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing center pane
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing right pane
DEBUG    tldw_chatbook.UI.SearchRAGWindow:Logging_Config.py:160 Loaded 0 recent search queries
DEBUG    tldw_chatbook.UI.Ingest_Window:Logging_Config.py:160 Composing IngestWindow UI
INFO     root:Stats_screen.py:25 MetricsScreen initialized. Log path: /tmp/app_metrics.log
INFO     root:Stats_screen.py:76 MetricsScreen composing. Current metrics: {}
WARNING  root:Stats_screen.py:79 MetricsScreen compose: self.metrics is unexpectedly empty at compose time.
INFO     root:Stats_screen.py:93 MetricsScreen compose finished.
----------------------------------------

195. ERROR    asyncio:base_events.py:1833 Task was destroyed but it is pending!
task: <Task pending name='RichLogProcessor' coro=<RichLogHandler._process_log_queue() running at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Logging_Config.py:78> wait_for=<Future pending cb=[Task.task_wakeup()]>>
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:29 MetricsScreen on_mount: Calling load_metrics.
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:45 Attempting to load metrics from: /tmp/app_metrics.log
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 3, False
----------------------------------------

196. ERROR    root:Stats_screen.py:68 MetricsScreen: Log file not found at /tmp/app_metrics.log.
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 5, False
INFO     tldw_chatbook.UI.Coding_Window:Logging_Config.py:160 CodingWindow on_mount: UI composed
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    tldw_chatbook.UI.LLM_Management_Window:Logging_Config.py:160 LLMManagementWindow.on_mount called
INFO     tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 EvalsWindow on_mount: UI composed
----------------------------------------

197. ERROR    tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 Error initializing evaluation system: cannot import name 'EvaluationOrchestrator' from 'tldw_chatbook.Evals' (/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Evals/__init__.py)
INFO     tldw_chatbook.RAG_Search.Services.embeddings_service:Logging_Config.py:160 ChromaDB initialized at /Users/appledev/.local/share/tldw_cli/chromadb
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting and initializing initial active sub-tab.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-chat display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-creation display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-web-search display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initial active sub-tab set to search-view-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Added active class to nav button search-nav-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Set display=True for active view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initializing view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Initializing Embeddings Creation view.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation provider select changed to: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation model select changed to: e5-small-v2 for provider: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Provider specific inputs visibility updated. Custom HF: False, Local API URL: False (Value: '', Disabled: False)
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Logging_Config.py:137 --- _setup_logging START (from Logging_Config.py) ---
INFO     root:Logging_Config.py:145 Loguru: All pre-existing sinks removed.
INFO     root:Logging_Config.py:168 Loguru: Configured to forward its messages to standard Python logging system.
--------------------------- Captured stderr teardown ---------------------------
2025-06-29 00:21:19 [DEBUG   ] root:535 - Closed connection for thread MainThread.
---------------------------- Captured log teardown -----------------------------
DEBUG    root:Client_Media_DB_v2.py:535 Closed connection for thread MainThread.
----------------------------------------

198. _____ ERROR at teardown of test_media_review_clearing_on_new_empty_search ______
Tests/Chat/test_chat_sidebar_media_search.py:102: in real_app_media_test
    app.chachanotes_db.close()
    ^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'CharactersRAGDB' object has no attribute 'close'
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:21:19 [DEBUG   ] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

199. 2025-06-29 00:21:19 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

200. 2025-06-29 00:21:19 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

201. 2025-06-29 00:21:19 [ERROR   ] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:19 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

202. 2025-06-29 00:21:19 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

203. 2025-06-29 00:21:19 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:19 [DEBUG   ] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:19 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:19 [INFO    ] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:21:19 [INFO    ] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:21:19 [WARNING ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Database schema is up to date.
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Verified FTS tables exist.
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts Interop Library initialized successfully.
2025-06-29 00:21:19 [INFO    ] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:19 [INFO    ] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:21:19 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:21:19 [INFO    ] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:21:19 [DEBUG   ] root:750 - Database schema is up to date.
2025-06-29 00:21:19 [DEBUG   ] root:755 - Verified FTS tables exist.
2025-06-29 00:21:19 [DEBUG   ] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x1733abe60>
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:21:19 [DEBUG   ] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

204. 2025-06-29 00:21:19 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

205. 2025-06-29 00:21:19 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:21:19 [INFO    ] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:21:19 [INFO    ] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

206. 2025-06-29 00:21:19 [ERROR   ] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 - Total initialization time: 0.007 seconds
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 -   basic_init: 0.002s (33.9%)
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 -   attribute_init: 0.000s (0.2%)
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 -   notes_service_init: 0.000s (3.4%)
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 -   providers_models: 0.002s (34.1%)
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 -   prompts_service_init: 0.001s (7.4%)
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 -   media_db_init: 0.001s (8.1%)
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 - ==============================
----------------------------------------

207. 2025-06-29 00:21:19 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

208. 2025-06-29 00:21:19 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:19 [INFO    ] root:444 - Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/media.db [Client ID: test_client_id]
2025-06-29 00:21:19 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/media.db [Client: test_client_id, Thread: MainThread]
2025-06-29 00:21:19 [INFO    ] root:747 - Checking DB schema. Current version: 0. Code supports: 1
2025-06-29 00:21:19 [INFO    ] root:680 - Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/media.db...
2025-06-29 00:21:19 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:19 [DEBUG   ] root:694 - [Schema V1] Applying Core Schema + Version Update...
2025-06-29 00:21:19 [DEBUG   ] root:696 - [Schema V1] Core Schema script (incl. version update) executed.
2025-06-29 00:21:19 [DEBUG   ] root:707 - [Schema V1] Media table structure validated successfully.
2025-06-29 00:21:19 [DEBUG   ] root:719 - [Schema V1] Version check inside transaction confirmed version is 1.
2025-06-29 00:21:19 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:21:19 [INFO    ] root:722 - [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/media.db.
2025-06-29 00:21:19 [DEBUG   ] root:726 - [Schema V1] Applying FTS Tables...
2025-06-29 00:21:19 [INFO    ] root:729 - [Schema V1] FTS Tables created successfully.
2025-06-29 00:21:19 [INFO    ] root:771 - Database schema initialized/migrated to version 1.
2025-06-29 00:21:19 [DEBUG   ] root:474 - Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/media.db
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db...
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db.
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db...
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db.
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db
2025-06-29 00:21:19 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
2025-06-29 00:21:19 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: Media 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a create v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] root:919 - FTS update for media 1: sanitized content - null bytes replaced
2025-06-29 00:21:19 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 1
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword ',' UUID 053f0f18-10ca-4508-8960-5143d4976b77
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: Keywords 053f0f18-10ca-4508-8960-5143d4976b77 create v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 1
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'e' UUID 2e7a8c97-a66f-4c76-9652-b16af7546098
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: Keywords 2e7a8c97-a66f-4c76-9652-b16af7546098 create v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 2
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'n' UUID cd55f525-73fa-48a1-89c8-dec7d23c1b33
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: Keywords cd55f525-73fa-48a1-89c8-dec7d23c1b33 create v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 3
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'o' UUID cfda6fdb-56a1-4b82-ba75-ecb782eb65eb
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: Keywords cfda6fdb-56a1-4b82-ba75-ecb782eb65eb create v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 4
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 's' UUID 667101a1-b79b-45da-8b1b-aded85d24c28
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: Keywords 667101a1-b79b-45da-8b1b-aded85d24c28 create v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 5
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 't' UUID 67521333-f028-45a5-97fc-da8c89b0cf2b
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: Keywords 67521333-f028-45a5-97fc-da8c89b0cf2b create v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 6
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a_053f0f18-10ca-4508-8960-5143d4976b77 link v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a_2e7a8c97-a66f-4c76-9652-b16af7546098 link v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a_cd55f525-73fa-48a1-89c8-dec7d23c1b33 link v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a_cfda6fdb-56a1-4b82-ba75-ecb782eb65eb link v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a_667101a1-b79b-45da-8b1b-aded85d24c28 link v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a_67521333-f028-45a5-97fc-da8c89b0cf2b link v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 1. Added: 6, Removed: 0.
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 1, UUID 53182787-88d4-45de-8a63-d7de24abb744
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: DocumentVersions 53182787-88d4-45de-8a63-d7de24abb744 create v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:21:19 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
2025-06-29 00:21:19 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: Media 396f47e1-efcd-4b96-847f-a7224ef325d8 create v1 at 2025-06-29T07:21:19.898Z
2025-06-29 00:21:19 [DEBUG   ] root:919 - FTS update for media 2: sanitized content - null bytes replaced
2025-06-29 00:21:19 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 2
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword ',' already active.
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'e' already active.
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'o' already active.
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 's' already active.
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 't' already active.
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'w' UUID 4c31080e-293d-4ea6-ba84-7a47a7200164
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: Keywords 4c31080e-293d-4ea6-ba84-7a47a7200164 create v1 at 2025-06-29T07:21:19.898Z
2025-06-29 00:21:19 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 7
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 396f47e1-efcd-4b96-847f-a7224ef325d8_053f0f18-10ca-4508-8960-5143d4976b77 link v1 at 2025-06-29T07:21:19.898Z
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 396f47e1-efcd-4b96-847f-a7224ef325d8_2e7a8c97-a66f-4c76-9652-b16af7546098 link v1 at 2025-06-29T07:21:19.898Z
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 396f47e1-efcd-4b96-847f-a7224ef325d8_cfda6fdb-56a1-4b82-ba75-ecb782eb65eb link v1 at 2025-06-29T07:21:19.898Z
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 396f47e1-efcd-4b96-847f-a7224ef325d8_667101a1-b79b-45da-8b1b-aded85d24c28 link v1 at 2025-06-29T07:21:19.898Z
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 396f47e1-efcd-4b96-847f-a7224ef325d8_67521333-f028-45a5-97fc-da8c89b0cf2b link v1 at 2025-06-29T07:21:19.898Z
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 396f47e1-efcd-4b96-847f-a7224ef325d8_4c31080e-293d-4ea6-ba84-7a47a7200164 link v1 at 2025-06-29T07:21:19.898Z
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 2. Added: 6, Removed: 0.
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 2, UUID fc6c8542-4d74-422b-bc61-754cb5f0a525
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: DocumentVersions fc6c8542-4d74-422b-bc61-754cb5f0a525 create v1 at 2025-06-29T07:21:19.898Z
2025-06-29 00:21:19 [DEBUG   ] root:652 - Committed transaction.
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

209. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

210. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

211. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     tldw_chatbook.app:Logging_Config.py:160 Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

212. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

213. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
WARNING  tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Checking DB schema. Current: 1, Code supports: 1
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Database schema is up to date.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Verified FTS tables exist.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts Interop Library initialized successfully.
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x1733abe60>
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Found 3 distinct media types: ['article', 'podcast', 'video']
INFO     tldw_chatbook.app:Logging_Config.py:160 App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

214. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

215. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

216. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
INFO     tldw_chatbook.app:Logging_Config.py:160 === STARTUP TIMING SUMMARY ===
INFO     tldw_chatbook.app:Logging_Config.py:160 Total initialization time: 0.007 seconds
INFO     tldw_chatbook.app:Logging_Config.py:160   basic_init: 0.002s (33.9%)
INFO     tldw_chatbook.app:Logging_Config.py:160   attribute_init: 0.000s (0.2%)
INFO     tldw_chatbook.app:Logging_Config.py:160   notes_service_init: 0.000s (3.4%)
INFO     tldw_chatbook.app:Logging_Config.py:160   providers_models: 0.002s (34.1%)
INFO     tldw_chatbook.app:Logging_Config.py:160   prompts_service_init: 0.001s (7.4%)
INFO     tldw_chatbook.app:Logging_Config.py:160   media_db_init: 0.001s (8.1%)
INFO     tldw_chatbook.app:Logging_Config.py:160 ==============================
----------------------------------------

217. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

218. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/media.db [Client ID: test_client_id]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/media.db [Client: test_client_id, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 0. Code supports: 1
INFO     root:Client_Media_DB_v2.py:680 Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/media.db...
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:694 [Schema V1] Applying Core Schema + Version Update...
DEBUG    root:Client_Media_DB_v2.py:696 [Schema V1] Core Schema script (incl. version update) executed.
DEBUG    root:Client_Media_DB_v2.py:707 [Schema V1] Media table structure validated successfully.
DEBUG    root:Client_Media_DB_v2.py:719 [Schema V1] Version check inside transaction confirmed version is 1.
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:722 [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/media.db.
DEBUG    root:Client_Media_DB_v2.py:726 [Schema V1] Applying FTS Tables...
INFO     root:Client_Media_DB_v2.py:729 [Schema V1] FTS Tables created successfully.
INFO     root:Client_Media_DB_v2.py:771 Database schema initialized/migrated to version 1.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/media.db
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db [Client ID: test_user]
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db (Journal: wal) for thread 8705548032
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction started (outermost) on thread 8705548032.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Full schema script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction (outermost) committed successfully on thread 8705548032.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a create v1 at 2025-06-29T07:21:19.897Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 1: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword ',' UUID 053f0f18-10ca-4508-8960-5143d4976b77
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 053f0f18-10ca-4508-8960-5143d4976b77 create v1 at 2025-06-29T07:21:19.897Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'e' UUID 2e7a8c97-a66f-4c76-9652-b16af7546098
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 2e7a8c97-a66f-4c76-9652-b16af7546098 create v1 at 2025-06-29T07:21:19.897Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 2
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'n' UUID cd55f525-73fa-48a1-89c8-dec7d23c1b33
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords cd55f525-73fa-48a1-89c8-dec7d23c1b33 create v1 at 2025-06-29T07:21:19.897Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 3
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'o' UUID cfda6fdb-56a1-4b82-ba75-ecb782eb65eb
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords cfda6fdb-56a1-4b82-ba75-ecb782eb65eb create v1 at 2025-06-29T07:21:19.897Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 4
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 's' UUID 667101a1-b79b-45da-8b1b-aded85d24c28
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 667101a1-b79b-45da-8b1b-aded85d24c28 create v1 at 2025-06-29T07:21:19.897Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 5
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 't' UUID 67521333-f028-45a5-97fc-da8c89b0cf2b
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 67521333-f028-45a5-97fc-da8c89b0cf2b create v1 at 2025-06-29T07:21:19.897Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 6
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a_053f0f18-10ca-4508-8960-5143d4976b77 link v1 at 2025-06-29T07:21:19.897Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a_2e7a8c97-a66f-4c76-9652-b16af7546098 link v1 at 2025-06-29T07:21:19.897Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a_cd55f525-73fa-48a1-89c8-dec7d23c1b33 link v1 at 2025-06-29T07:21:19.897Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a_cfda6fdb-56a1-4b82-ba75-ecb782eb65eb link v1 at 2025-06-29T07:21:19.897Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a_667101a1-b79b-45da-8b1b-aded85d24c28 link v1 at 2025-06-29T07:21:19.897Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a_67521333-f028-45a5-97fc-da8c89b0cf2b link v1 at 2025-06-29T07:21:19.897Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 1. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 1, UUID 53182787-88d4-45de-8a63-d7de24abb744
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions 53182787-88d4-45de-8a63-d7de24abb744 create v1 at 2025-06-29T07:21:19.897Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media 396f47e1-efcd-4b96-847f-a7224ef325d8 create v1 at 2025-06-29T07:21:19.898Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 2: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 2
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword ',' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'e' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'o' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 's' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 't' already active.
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'w' UUID 4c31080e-293d-4ea6-ba84-7a47a7200164
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 4c31080e-293d-4ea6-ba84-7a47a7200164 create v1 at 2025-06-29T07:21:19.898Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 7
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 396f47e1-efcd-4b96-847f-a7224ef325d8_053f0f18-10ca-4508-8960-5143d4976b77 link v1 at 2025-06-29T07:21:19.898Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 396f47e1-efcd-4b96-847f-a7224ef325d8_2e7a8c97-a66f-4c76-9652-b16af7546098 link v1 at 2025-06-29T07:21:19.898Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 396f47e1-efcd-4b96-847f-a7224ef325d8_cfda6fdb-56a1-4b82-ba75-ecb782eb65eb link v1 at 2025-06-29T07:21:19.898Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 396f47e1-efcd-4b96-847f-a7224ef325d8_667101a1-b79b-45da-8b1b-aded85d24c28 link v1 at 2025-06-29T07:21:19.898Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 396f47e1-efcd-4b96-847f-a7224ef325d8_67521333-f028-45a5-97fc-da8c89b0cf2b link v1 at 2025-06-29T07:21:19.898Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 396f47e1-efcd-4b96-847f-a7224ef325d8_4c31080e-293d-4ea6-ba84-7a47a7200164 link v1 at 2025-06-29T07:21:19.898Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 2. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 2, UUID fc6c8542-4d74-422b-bc61-754cb5f0a525
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions fc6c8542-4d74-422b-bc61-754cb5f0a525 create v1 at 2025-06-29T07:21:19.898Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
----------------------------- Captured stderr call -----------------------------
----------------------------------------

219. !!! CRITICAL ERROR in RichLog processor: Event loop is closed
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/queues.py", line 158, in get
    await getter
GeneratorExit
----------------------------------------

220. ERROR    root:metrics.py:99 Failed to log histogram app_compose_duration_seconds: No label names were set when constructing histogram:app_compose_duration_seconds
DEBUG    root:app.py:1329 App compose finished in 0.001 seconds
----------------------------------------

221. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

222. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 Composing ChatWindow UI
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:settings_sidebar.py:42 Sidebar chat: Received providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 'respond-for-me-button' composed.
DEBUG    tldw_chatbook.app:Logging_Config.py:160 Chat ephemeral state changed to: True
DEBUG    root:chat_right_sidebar.py:355 Character sidebar (id='chat-right-sidebar', prefix='chat') created with ephemeral state: True
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing CCPWindow UI
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing center pane
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing right pane
DEBUG    tldw_chatbook.UI.SearchRAGWindow:Logging_Config.py:160 Loaded 0 recent search queries
DEBUG    tldw_chatbook.UI.Ingest_Window:Logging_Config.py:160 Composing IngestWindow UI
----------------------------------------

223. ERROR    asyncio:base_events.py:1833 Task was destroyed but it is pending!
task: <Task pending name='RichLogProcessor' coro=<RichLogHandler._process_log_queue() running at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Logging_Config.py:78> wait_for=<Future pending cb=[Task.task_wakeup()]>>
INFO     root:Stats_screen.py:25 MetricsScreen initialized. Log path: /tmp/app_metrics.log
INFO     root:Stats_screen.py:76 MetricsScreen composing. Current metrics: {}
WARNING  root:Stats_screen.py:79 MetricsScreen compose: self.metrics is unexpectedly empty at compose time.
INFO     root:Stats_screen.py:93 MetricsScreen compose finished.
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:29 MetricsScreen on_mount: Calling load_metrics.
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:45 Attempting to load metrics from: /tmp/app_metrics.log
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
----------------------------------------

224. ERROR    root:Stats_screen.py:68 MetricsScreen: Log file not found at /tmp/app_metrics.log.
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     tldw_chatbook.UI.Coding_Window:Logging_Config.py:160 CodingWindow on_mount: UI composed
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    tldw_chatbook.UI.LLM_Management_Window:Logging_Config.py:160 LLMManagementWindow.on_mount called
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 5, False
INFO     tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 EvalsWindow on_mount: UI composed
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 3, False
----------------------------------------

225. ERROR    tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 Error initializing evaluation system: cannot import name 'EvaluationOrchestrator' from 'tldw_chatbook.Evals' (/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Evals/__init__.py)
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=4,level=0,tokens=6), 4, 5, False
INFO     tldw_chatbook.RAG_Search.Services.embeddings_service:Logging_Config.py:160 ChromaDB initialized at /Users/appledev/.local/share/tldw_cli/chromadb
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting and initializing initial active sub-tab.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-chat display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-creation display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-web-search display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initial active sub-tab set to search-view-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Added active class to nav button search-nav-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Set display=True for active view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initializing view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Initializing Embeddings Creation view.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation provider select changed to: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation model select changed to: e5-small-v2 for provider: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Provider specific inputs visibility updated. Custom HF: False, Local API URL: False (Value: '', Disabled: False)
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Logging_Config.py:137 --- _setup_logging START (from Logging_Config.py) ---
INFO     root:Logging_Config.py:145 Loguru: All pre-existing sinks removed.
INFO     root:Logging_Config.py:168 Loguru: Configured to forward its messages to standard Python logging system.
--------------------------- Captured stderr teardown ---------------------------
2025-06-29 00:21:24 [DEBUG   ] root:535 - Closed connection for thread MainThread.
---------------------------- Captured log teardown -----------------------------
DEBUG    root:Client_Media_DB_v2.py:535 Closed connection for thread MainThread.
----------------------------------------

226. ____________ ERROR at teardown of test_media_search_input_debounced ____________
Tests/Chat/test_chat_sidebar_media_search.py:102: in real_app_media_test
    app.chachanotes_db.close()
    ^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'CharactersRAGDB' object has no attribute 'close'
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:21:24 [DEBUG   ] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

227. 2025-06-29 00:21:24 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

228. 2025-06-29 00:21:24 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

229. 2025-06-29 00:21:24 [ERROR   ] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:24 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

230. 2025-06-29 00:21:24 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

231. 2025-06-29 00:21:24 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:24 [DEBUG   ] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:24 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:24 [INFO    ] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:21:24 [INFO    ] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:21:24 [WARNING ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Database schema is up to date.
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Verified FTS tables exist.
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts Interop Library initialized successfully.
2025-06-29 00:21:24 [INFO    ] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:24 [INFO    ] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:21:24 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:21:24 [INFO    ] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:21:24 [DEBUG   ] root:750 - Database schema is up to date.
2025-06-29 00:21:24 [DEBUG   ] root:755 - Verified FTS tables exist.
2025-06-29 00:21:24 [DEBUG   ] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x16a75e9f0>
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:21:24 [DEBUG   ] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

232. 2025-06-29 00:21:24 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

233. 2025-06-29 00:21:24 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:21:24 [INFO    ] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:21:24 [INFO    ] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

234. 2025-06-29 00:21:24 [ERROR   ] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 - Total initialization time: 0.007 seconds
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 -   basic_init: 0.002s (32.5%)
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 -   attribute_init: 0.000s (0.2%)
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 -   notes_service_init: 0.000s (3.2%)
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 -   providers_models: 0.003s (34.9%)
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 -   prompts_service_init: 0.001s (9.3%)
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 -   media_db_init: 0.001s (8.6%)
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 - ==============================
----------------------------------------

235. 2025-06-29 00:21:24 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

236. 2025-06-29 00:21:24 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:24 [INFO    ] root:444 - Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/media.db [Client ID: test_client_id]
2025-06-29 00:21:24 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/media.db [Client: test_client_id, Thread: MainThread]
2025-06-29 00:21:24 [INFO    ] root:747 - Checking DB schema. Current version: 0. Code supports: 1
2025-06-29 00:21:24 [INFO    ] root:680 - Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/media.db...
2025-06-29 00:21:24 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:24 [DEBUG   ] root:694 - [Schema V1] Applying Core Schema + Version Update...
2025-06-29 00:21:24 [DEBUG   ] root:696 - [Schema V1] Core Schema script (incl. version update) executed.
2025-06-29 00:21:24 [DEBUG   ] root:707 - [Schema V1] Media table structure validated successfully.
2025-06-29 00:21:24 [DEBUG   ] root:719 - [Schema V1] Version check inside transaction confirmed version is 1.
2025-06-29 00:21:24 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:21:24 [INFO    ] root:722 - [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/media.db.
2025-06-29 00:21:24 [DEBUG   ] root:726 - [Schema V1] Applying FTS Tables...
2025-06-29 00:21:24 [INFO    ] root:729 - [Schema V1] FTS Tables created successfully.
2025-06-29 00:21:24 [INFO    ] root:771 - Database schema initialized/migrated to version 1.
2025-06-29 00:21:24 [DEBUG   ] root:474 - Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/media.db
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db...
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db.
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db...
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db.
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db
2025-06-29 00:21:24 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
2025-06-29 00:21:24 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: Media 107d6244-972f-462d-82d7-24ed12bd23c6 create v1 at 2025-06-29T07:21:24.910Z
2025-06-29 00:21:24 [DEBUG   ] root:919 - FTS update for media 1: sanitized content - null bytes replaced
2025-06-29 00:21:24 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 1
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword ',' UUID 097d3372-651a-431f-ab52-9d81af00de7a
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: Keywords 097d3372-651a-431f-ab52-9d81af00de7a create v1 at 2025-06-29T07:21:24.910Z
2025-06-29 00:21:24 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 1
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'e' UUID 4b1bb6ba-5947-4d09-99be-e227fc854ce8
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: Keywords 4b1bb6ba-5947-4d09-99be-e227fc854ce8 create v1 at 2025-06-29T07:21:24.910Z
2025-06-29 00:21:24 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 2
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'n' UUID 9ba8caf0-5fef-43e9-aa7d-7a4c900de1bf
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: Keywords 9ba8caf0-5fef-43e9-aa7d-7a4c900de1bf create v1 at 2025-06-29T07:21:24.910Z
2025-06-29 00:21:24 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 3
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'o' UUID 5a44d1dd-1c8d-455c-b528-8c44bb37f2d6
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: Keywords 5a44d1dd-1c8d-455c-b528-8c44bb37f2d6 create v1 at 2025-06-29T07:21:24.910Z
2025-06-29 00:21:24 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 4
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 's' UUID fb975125-32b5-49a3-aa70-b05b36c68e23
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: Keywords fb975125-32b5-49a3-aa70-b05b36c68e23 create v1 at 2025-06-29T07:21:24.910Z
2025-06-29 00:21:24 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 5
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 't' UUID c04b6189-314c-43b3-859a-eeca18cd19f0
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: Keywords c04b6189-314c-43b3-859a-eeca18cd19f0 create v1 at 2025-06-29T07:21:24.911Z
2025-06-29 00:21:24 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 6
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 107d6244-972f-462d-82d7-24ed12bd23c6_097d3372-651a-431f-ab52-9d81af00de7a link v1 at 2025-06-29T07:21:24.911Z
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 107d6244-972f-462d-82d7-24ed12bd23c6_4b1bb6ba-5947-4d09-99be-e227fc854ce8 link v1 at 2025-06-29T07:21:24.911Z
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 107d6244-972f-462d-82d7-24ed12bd23c6_9ba8caf0-5fef-43e9-aa7d-7a4c900de1bf link v1 at 2025-06-29T07:21:24.911Z
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 107d6244-972f-462d-82d7-24ed12bd23c6_5a44d1dd-1c8d-455c-b528-8c44bb37f2d6 link v1 at 2025-06-29T07:21:24.911Z
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 107d6244-972f-462d-82d7-24ed12bd23c6_fb975125-32b5-49a3-aa70-b05b36c68e23 link v1 at 2025-06-29T07:21:24.911Z
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 107d6244-972f-462d-82d7-24ed12bd23c6_c04b6189-314c-43b3-859a-eeca18cd19f0 link v1 at 2025-06-29T07:21:24.911Z
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 1. Added: 6, Removed: 0.
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 1, UUID d0c053cf-1fcb-44ae-8654-f159513db605
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: DocumentVersions d0c053cf-1fcb-44ae-8654-f159513db605 create v1 at 2025-06-29T07:21:24.911Z
2025-06-29 00:21:24 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:21:24 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
2025-06-29 00:21:24 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: Media d88ca57b-b54a-49db-a6e4-cc235e040343 create v1 at 2025-06-29T07:21:24.911Z
2025-06-29 00:21:24 [DEBUG   ] root:919 - FTS update for media 2: sanitized content - null bytes replaced
2025-06-29 00:21:24 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 2
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword ',' already active.
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'e' already active.
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'o' already active.
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 's' already active.
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 't' already active.
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'w' UUID 8b2d0338-d3f6-4afb-824e-89c34cff2a2b
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: Keywords 8b2d0338-d3f6-4afb-824e-89c34cff2a2b create v1 at 2025-06-29T07:21:24.912Z
2025-06-29 00:21:24 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 7
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d88ca57b-b54a-49db-a6e4-cc235e040343_097d3372-651a-431f-ab52-9d81af00de7a link v1 at 2025-06-29T07:21:24.912Z
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d88ca57b-b54a-49db-a6e4-cc235e040343_4b1bb6ba-5947-4d09-99be-e227fc854ce8 link v1 at 2025-06-29T07:21:24.912Z
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d88ca57b-b54a-49db-a6e4-cc235e040343_5a44d1dd-1c8d-455c-b528-8c44bb37f2d6 link v1 at 2025-06-29T07:21:24.912Z
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d88ca57b-b54a-49db-a6e4-cc235e040343_fb975125-32b5-49a3-aa70-b05b36c68e23 link v1 at 2025-06-29T07:21:24.912Z
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d88ca57b-b54a-49db-a6e4-cc235e040343_c04b6189-314c-43b3-859a-eeca18cd19f0 link v1 at 2025-06-29T07:21:24.912Z
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d88ca57b-b54a-49db-a6e4-cc235e040343_8b2d0338-d3f6-4afb-824e-89c34cff2a2b link v1 at 2025-06-29T07:21:24.912Z
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 2. Added: 6, Removed: 0.
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 2, UUID 97fafe8f-1275-42e3-8510-60ddffd660d7
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: DocumentVersions 97fafe8f-1275-42e3-8510-60ddffd660d7 create v1 at 2025-06-29T07:21:24.912Z
2025-06-29 00:21:24 [DEBUG   ] root:652 - Committed transaction.
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

237. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

238. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

239. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     tldw_chatbook.app:Logging_Config.py:160 Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

240. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

241. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
WARNING  tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Checking DB schema. Current: 1, Code supports: 1
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Database schema is up to date.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Verified FTS tables exist.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts Interop Library initialized successfully.
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x16a75e9f0>
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Found 3 distinct media types: ['article', 'podcast', 'video']
INFO     tldw_chatbook.app:Logging_Config.py:160 App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

242. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

243. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

244. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
INFO     tldw_chatbook.app:Logging_Config.py:160 === STARTUP TIMING SUMMARY ===
INFO     tldw_chatbook.app:Logging_Config.py:160 Total initialization time: 0.007 seconds
INFO     tldw_chatbook.app:Logging_Config.py:160   basic_init: 0.002s (32.5%)
INFO     tldw_chatbook.app:Logging_Config.py:160   attribute_init: 0.000s (0.2%)
INFO     tldw_chatbook.app:Logging_Config.py:160   notes_service_init: 0.000s (3.2%)
INFO     tldw_chatbook.app:Logging_Config.py:160   providers_models: 0.003s (34.9%)
INFO     tldw_chatbook.app:Logging_Config.py:160   prompts_service_init: 0.001s (9.3%)
INFO     tldw_chatbook.app:Logging_Config.py:160   media_db_init: 0.001s (8.6%)
INFO     tldw_chatbook.app:Logging_Config.py:160 ==============================
----------------------------------------

245. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

246. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/media.db [Client ID: test_client_id]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/media.db [Client: test_client_id, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 0. Code supports: 1
INFO     root:Client_Media_DB_v2.py:680 Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/media.db...
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:694 [Schema V1] Applying Core Schema + Version Update...
DEBUG    root:Client_Media_DB_v2.py:696 [Schema V1] Core Schema script (incl. version update) executed.
DEBUG    root:Client_Media_DB_v2.py:707 [Schema V1] Media table structure validated successfully.
DEBUG    root:Client_Media_DB_v2.py:719 [Schema V1] Version check inside transaction confirmed version is 1.
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:722 [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/media.db.
DEBUG    root:Client_Media_DB_v2.py:726 [Schema V1] Applying FTS Tables...
INFO     root:Client_Media_DB_v2.py:729 [Schema V1] FTS Tables created successfully.
INFO     root:Client_Media_DB_v2.py:771 Database schema initialized/migrated to version 1.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/media.db
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db [Client ID: test_user]
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db (Journal: wal) for thread 8705548032
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction started (outermost) on thread 8705548032.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Full schema script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction (outermost) committed successfully on thread 8705548032.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media 107d6244-972f-462d-82d7-24ed12bd23c6 create v1 at 2025-06-29T07:21:24.910Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 1: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword ',' UUID 097d3372-651a-431f-ab52-9d81af00de7a
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 097d3372-651a-431f-ab52-9d81af00de7a create v1 at 2025-06-29T07:21:24.910Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'e' UUID 4b1bb6ba-5947-4d09-99be-e227fc854ce8
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 4b1bb6ba-5947-4d09-99be-e227fc854ce8 create v1 at 2025-06-29T07:21:24.910Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 2
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'n' UUID 9ba8caf0-5fef-43e9-aa7d-7a4c900de1bf
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 9ba8caf0-5fef-43e9-aa7d-7a4c900de1bf create v1 at 2025-06-29T07:21:24.910Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 3
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'o' UUID 5a44d1dd-1c8d-455c-b528-8c44bb37f2d6
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 5a44d1dd-1c8d-455c-b528-8c44bb37f2d6 create v1 at 2025-06-29T07:21:24.910Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 4
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 's' UUID fb975125-32b5-49a3-aa70-b05b36c68e23
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords fb975125-32b5-49a3-aa70-b05b36c68e23 create v1 at 2025-06-29T07:21:24.910Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 5
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 't' UUID c04b6189-314c-43b3-859a-eeca18cd19f0
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords c04b6189-314c-43b3-859a-eeca18cd19f0 create v1 at 2025-06-29T07:21:24.911Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 6
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 107d6244-972f-462d-82d7-24ed12bd23c6_097d3372-651a-431f-ab52-9d81af00de7a link v1 at 2025-06-29T07:21:24.911Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 107d6244-972f-462d-82d7-24ed12bd23c6_4b1bb6ba-5947-4d09-99be-e227fc854ce8 link v1 at 2025-06-29T07:21:24.911Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 107d6244-972f-462d-82d7-24ed12bd23c6_9ba8caf0-5fef-43e9-aa7d-7a4c900de1bf link v1 at 2025-06-29T07:21:24.911Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 107d6244-972f-462d-82d7-24ed12bd23c6_5a44d1dd-1c8d-455c-b528-8c44bb37f2d6 link v1 at 2025-06-29T07:21:24.911Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 107d6244-972f-462d-82d7-24ed12bd23c6_fb975125-32b5-49a3-aa70-b05b36c68e23 link v1 at 2025-06-29T07:21:24.911Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 107d6244-972f-462d-82d7-24ed12bd23c6_c04b6189-314c-43b3-859a-eeca18cd19f0 link v1 at 2025-06-29T07:21:24.911Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 1. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 1, UUID d0c053cf-1fcb-44ae-8654-f159513db605
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions d0c053cf-1fcb-44ae-8654-f159513db605 create v1 at 2025-06-29T07:21:24.911Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media d88ca57b-b54a-49db-a6e4-cc235e040343 create v1 at 2025-06-29T07:21:24.911Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 2: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 2
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword ',' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'e' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'o' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 's' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 't' already active.
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'w' UUID 8b2d0338-d3f6-4afb-824e-89c34cff2a2b
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 8b2d0338-d3f6-4afb-824e-89c34cff2a2b create v1 at 2025-06-29T07:21:24.912Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 7
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d88ca57b-b54a-49db-a6e4-cc235e040343_097d3372-651a-431f-ab52-9d81af00de7a link v1 at 2025-06-29T07:21:24.912Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d88ca57b-b54a-49db-a6e4-cc235e040343_4b1bb6ba-5947-4d09-99be-e227fc854ce8 link v1 at 2025-06-29T07:21:24.912Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d88ca57b-b54a-49db-a6e4-cc235e040343_5a44d1dd-1c8d-455c-b528-8c44bb37f2d6 link v1 at 2025-06-29T07:21:24.912Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d88ca57b-b54a-49db-a6e4-cc235e040343_fb975125-32b5-49a3-aa70-b05b36c68e23 link v1 at 2025-06-29T07:21:24.912Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d88ca57b-b54a-49db-a6e4-cc235e040343_c04b6189-314c-43b3-859a-eeca18cd19f0 link v1 at 2025-06-29T07:21:24.912Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d88ca57b-b54a-49db-a6e4-cc235e040343_8b2d0338-d3f6-4afb-824e-89c34cff2a2b link v1 at 2025-06-29T07:21:24.912Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 2. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 2, UUID 97fafe8f-1275-42e3-8510-60ddffd660d7
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions 97fafe8f-1275-42e3-8510-60ddffd660d7 create v1 at 2025-06-29T07:21:24.912Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
----------------------------- Captured stderr call -----------------------------
----------------------------------------

247. !!! CRITICAL ERROR in RichLog processor: Event loop is closed
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/queues.py", line 158, in get
    await getter
GeneratorExit
----------------------------------------

248. ERROR    root:metrics.py:99 Failed to log histogram app_compose_duration_seconds: No label names were set when constructing histogram:app_compose_duration_seconds
DEBUG    root:app.py:1329 App compose finished in 0.001 seconds
----------------------------------------

249. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

250. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 Composing ChatWindow UI
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:settings_sidebar.py:42 Sidebar chat: Received providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 'respond-for-me-button' composed.
DEBUG    tldw_chatbook.app:Logging_Config.py:160 Chat ephemeral state changed to: True
DEBUG    root:chat_right_sidebar.py:355 Character sidebar (id='chat-right-sidebar', prefix='chat') created with ephemeral state: True
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing CCPWindow UI
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing center pane
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing right pane
DEBUG    tldw_chatbook.UI.SearchRAGWindow:Logging_Config.py:160 Loaded 0 recent search queries
DEBUG    tldw_chatbook.UI.Ingest_Window:Logging_Config.py:160 Composing IngestWindow UI
INFO     root:Stats_screen.py:25 MetricsScreen initialized. Log path: /tmp/app_metrics.log
INFO     root:Stats_screen.py:76 MetricsScreen composing. Current metrics: {}
WARNING  root:Stats_screen.py:79 MetricsScreen compose: self.metrics is unexpectedly empty at compose time.
INFO     root:Stats_screen.py:93 MetricsScreen compose finished.
----------------------------------------

251. ERROR    asyncio:base_events.py:1833 Task was destroyed but it is pending!
task: <Task pending name='RichLogProcessor' coro=<RichLogHandler._process_log_queue() running at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Logging_Config.py:78> wait_for=<Future pending cb=[Task.task_wakeup()]>>
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:29 MetricsScreen on_mount: Calling load_metrics.
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:45 Attempting to load metrics from: /tmp/app_metrics.log
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
----------------------------------------

252. ERROR    root:Stats_screen.py:68 MetricsScreen: Log file not found at /tmp/app_metrics.log.
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     tldw_chatbook.UI.Coding_Window:Logging_Config.py:160 CodingWindow on_mount: UI composed
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    tldw_chatbook.UI.LLM_Management_Window:Logging_Config.py:160 LLMManagementWindow.on_mount called
INFO     tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 EvalsWindow on_mount: UI composed
----------------------------------------

253. ERROR    tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 Error initializing evaluation system: cannot import name 'EvaluationOrchestrator' from 'tldw_chatbook.Evals' (/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Evals/__init__.py)
INFO     tldw_chatbook.RAG_Search.Services.embeddings_service:Logging_Config.py:160 ChromaDB initialized at /Users/appledev/.local/share/tldw_cli/chromadb
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting and initializing initial active sub-tab.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-chat display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-creation display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-web-search display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initial active sub-tab set to search-view-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Added active class to nav button search-nav-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Set display=True for active view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initializing view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Initializing Embeddings Creation view.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation provider select changed to: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation model select changed to: e5-small-v2 for provider: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Provider specific inputs visibility updated. Custom HF: False, Local API URL: False (Value: '', Disabled: False)
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Logging_Config.py:137 --- _setup_logging START (from Logging_Config.py) ---
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Logging_Config.py:145 Loguru: All pre-existing sinks removed.
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Logging_Config.py:168 Loguru: Configured to forward its messages to standard Python logging system.
--------------------------- Captured stderr teardown ---------------------------
2025-06-29 00:21:29 [DEBUG   ] root:535 - Closed connection for thread MainThread.
---------------------------- Captured log teardown -----------------------------
DEBUG    root:Client_Media_DB_v2.py:535 Closed connection for thread MainThread.
=================================== FAILURES ===================================
___________________ test_provider_api_basic_call[koboldcpp] ____________________
.venv/lib/python3.12/site-packages/urllib3/connection.py:198: in _new_conn
    sock = connection.create_connection(
.venv/lib/python3.12/site-packages/urllib3/util/connection.py:85: in create_connection
    raise err
.venv/lib/python3.12/site-packages/urllib3/util/connection.py:73: in create_connection
    sock.connect(sa)
E   ConnectionRefusedError: [Errno 61] Connection refused
----------------------------------------

254. 2025-06-29 00:20:45,092 [ERROR] root:566 - KoboldAI (Native): Request Exception: HTTPConnectionPool(host='localhost', port=5001): Max retries exceeded with url: /api/v1/generate (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x16a64ebd0>: Failed to establish a new connection: [Errno 61] Connection refused'))
Traceback (most recent call last):
  File "/Users/appledev/Working/tldw_chatbook_dev/.venv/lib/python3.12/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/appledev/Working/tldw_chatbook_dev/.venv/lib/python3.12/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/appledev/Working/tldw_chatbook_dev/.venv/lib/python3.12/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 61] Connection refused
----------------------------------------

255. 2025-06-29 00:20:45.095 | ERROR    | tldw_chatbook.Chat.Chat_Functions:chat_api_call:683 - Handler for koboldcpp directly raised: ChatProviderError - Network error calling KoboldAI (Native): HTTPConnectionPool(host='localhost', port=5001): Max retries exceeded with url: /api/v1/generate (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x16a64ebd0>: Failed to establish a new connection: [Errno 61] Connection refused'))
------------------------------ Captured log call -------------------------------
DEBUG    root:LLM_API_Calls_Local.py:440 KoboldAI (Native): Chat request starting...
INFO     root:LLM_API_Calls_Local.py:461 Kobold API model namenot passed and or could not be determined from arguments or configuration.
DEBUG    root:LLM_API_Calls_Local.py:535 KoboldAI (Native): Posting to http://localhost:5001/api/v1/generate. Prompt (first 200 chars): 'Hello! Respond with just 'Hello'....'
DEBUG    root:LLM_API_Calls_Local.py:536 KoboldAI (Native) Payload details: {'prompt': "Hello! Respond with just 'Hello'.", 'max_context_length': 2048, 'temperature': 0.7, 'top_p': 0.9, 'top_k': 50, 'seed': 42}
DEBUG    urllib3.connectionpool:connectionpool.py:241 Starting new HTTP connection (1): localhost:5001
DEBUG    urllib3.util.retry:retry.py:521 Incremented Retry for (url='/api/v1/generate'): Retry(total=0, connect=None, read=None, redirect=None, status=None)
WARNING  urllib3.connectionpool:connectionpool.py:868 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x16a64fc50>: Failed to establish a new connection: [Errno 61] Connection refused')': /api/v1/generate
DEBUG    urllib3.connectionpool:connectionpool.py:241 Starting new HTTP connection (2): localhost:5001
----------------------------------------

256. ERROR    root:LLM_API_Calls_Local.py:566 KoboldAI (Native): Request Exception: HTTPConnectionPool(host='localhost', port=5001): Max retries exceeded with url: /api/v1/generate (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x16a64ebd0>: Failed to establish a new connection: [Errno 61] Connection refused'))
Traceback (most recent call last):
  File "/Users/appledev/Working/tldw_chatbook_dev/.venv/lib/python3.12/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/appledev/Working/tldw_chatbook_dev/.venv/lib/python3.12/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/appledev/Working/tldw_chatbook_dev/.venv/lib/python3.12/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 61] Connection refused
----------------------------------------

257. 2025-06-29 00:20:45,211 [ERROR] root:566 - KoboldAI (Native): Request Exception: HTTPConnectionPool(host='localhost', port=5001): Max retries exceeded with url: /api/v1/generate (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x16a75ecc0>: Failed to establish a new connection: [Errno 61] Connection refused'))
Traceback (most recent call last):
  File "/Users/appledev/Working/tldw_chatbook_dev/.venv/lib/python3.12/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/appledev/Working/tldw_chatbook_dev/.venv/lib/python3.12/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/appledev/Working/tldw_chatbook_dev/.venv/lib/python3.12/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 61] Connection refused
----------------------------------------

258. 2025-06-29 00:20:45.212 | ERROR    | tldw_chatbook.Chat.Chat_Functions:chat_api_call:683 - Handler for koboldcpp directly raised: ChatProviderError - Network error calling KoboldAI (Native): HTTPConnectionPool(host='localhost', port=5001): Max retries exceeded with url: /api/v1/generate (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x16a75ecc0>: Failed to establish a new connection: [Errno 61] Connection refused'))
------------------------------ Captured log call -------------------------------
DEBUG    root:LLM_API_Calls_Local.py:440 KoboldAI (Native): Chat request starting...
INFO     root:LLM_API_Calls_Local.py:461 Kobold API model namenot passed and or could not be determined from arguments or configuration.
WARNING  root:LLM_API_Calls_Local.py:477 KoboldAI (Native): Streaming with /api/v1/generate is often non-standard. Consider using KoboldCpp's OpenAI compatible endpoint (/v1) for reliable streaming. Forcing non-streaming for native.
DEBUG    root:LLM_API_Calls_Local.py:535 KoboldAI (Native): Posting to http://localhost:5001/api/v1/generate. Prompt (first 200 chars): 'Stream three words....'
DEBUG    root:LLM_API_Calls_Local.py:536 KoboldAI (Native) Payload details: {'prompt': 'Stream three words.', 'max_context_length': 2048, 'temperature': 0.7, 'top_p': 0.9, 'top_k': 50, 'seed': 43}
DEBUG    urllib3.connectionpool:connectionpool.py:241 Starting new HTTP connection (1): localhost:5001
DEBUG    urllib3.util.retry:retry.py:521 Incremented Retry for (url='/api/v1/generate'): Retry(total=0, connect=None, read=None, redirect=None, status=None)
WARNING  urllib3.connectionpool:connectionpool.py:868 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<urllib3.connection.HTTPConnection object at 0x16a75e060>: Failed to establish a new connection: [Errno 61] Connection refused')': /api/v1/generate
DEBUG    urllib3.connectionpool:connectionpool.py:241 Starting new HTTP connection (2): localhost:5001
----------------------------------------

259. ERROR    root:LLM_API_Calls_Local.py:566 KoboldAI (Native): Request Exception: HTTPConnectionPool(host='localhost', port=5001): Max retries exceeded with url: /api/v1/generate (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x16a75ecc0>: Failed to establish a new connection: [Errno 61] Connection refused'))
Traceback (most recent call last):
  File "/Users/appledev/Working/tldw_chatbook_dev/.venv/lib/python3.12/site-packages/urllib3/connection.py", line 198, in _new_conn
    sock = connection.create_connection(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/appledev/Working/tldw_chatbook_dev/.venv/lib/python3.12/site-packages/urllib3/util/connection.py", line 85, in create_connection
    raise err
  File "/Users/appledev/Working/tldw_chatbook_dev/.venv/lib/python3.12/site-packages/urllib3/util/connection.py", line 73, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 61] Connection refused
----------------------------------------

260. 2025-06-29 00:20:45,314 [ERROR] root:362 - OpenAI: Unexpected error in chat_with_openai: Unauthorized
Traceback (most recent call last):
  File "/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/LLM_Calls/LLM_API_Calls.py", line 335, in chat_with_openai
    response.raise_for_status()  # Raise HTTPError for 4xx/5xx AFTER retries
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1139, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1143, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1198, in _execute_mock_call
    raise effect
Exception: Unauthorized
----------------------------------------

261. 2025-06-29 00:20:45.317 | ERROR    | tldw_chatbook.Chat.Chat_Functions:chat_api_call:683 - Handler for openai directly raised: ChatProviderError - Unexpected error: Unauthorized
------------------------------ Captured log call -------------------------------
DEBUG    root:LLM_API_Calls.py:207 OpenAI: Using API Key: inval...d-key
DEBUG    root:LLM_API_Calls.py:280 OpenAI Request Payload (excluding messages): {k: v for k, v in payload.items() if k != 'messages'}
DEBUG    root:LLM_API_Calls.py:317 OpenAI: Posting request (non-streaming)
DEBUG    root:LLM_API_Calls.py:334 OpenAI: Full API response status: 401
----------------------------------------

262. ERROR    root:LLM_API_Calls.py:362 OpenAI: Unexpected error in chat_with_openai: Unauthorized
Traceback (most recent call last):
  File "/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/LLM_Calls/LLM_API_Calls.py", line 335, in chat_with_openai
    response.raise_for_status()  # Raise HTTPError for 4xx/5xx AFTER retries
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1139, in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1143, in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py", line 1198, in _execute_mock_call
    raise effect
Exception: Unauthorized
_______________ TestMockedChatAPIs.test_chat_function_with_mock ________________
Tests/Chat/test_chat_mocked_apis.py:175: in test_chat_function_with_mock
    result = chat(
E   TypeError: chat() missing 4 required positional arguments: 'history', 'media_content', 'selected_parts', and 'custom_prompt'
______________ TestMockedChatAPIs.test_provider_parameter_mapping ______________
Tests/Chat/test_chat_mocked_apis.py:207: in test_provider_parameter_mapping
    assert openai_map["temperature"] == "temperature"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
E   KeyError: 'temperature'
____________ TestMockedStreamingAPIs.test_streaming_error_handling _____________
Tests/Chat/test_chat_mocked_apis.py:290: in test_streaming_error_handling
    with pytest.raises(ChatAPIError):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE <class 'tldw_chatbook.Chat.Chat_Deps.ChatAPIError'>
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:20:45.392 | INFO     | tldw_chatbook.Chat.Chat_Functions:chat_api_call:577 - Chat API Call - Routing to endpoint: openai
2025-06-29 00:20:45.392 | METRIC   | tldw_chatbook.Metrics.metrics_logger:_log_metric:47 - Counter 'chat_api_call_attempt': 1
2025-06-29 00:20:45.392 | DEBUG    | tldw_chatbook.Chat.Chat_Functions:chat_api_call:630 - Calling handler chat_with_openai with kwargs: {'api_key': 'key_hidden', 'input_data': <class 'list'>, 'streaming': <class 'bool'>}
2025-06-29 00:20:45.392 | INFO     | tldw_chatbook.config:load_settings:207 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:45.392 | INFO     | tldw_chatbook.config:load_settings:208 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:45.392 | INFO     | tldw_chatbook.config:load_settings:217 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:20:45.392 | WARNING  | tldw_chatbook.config:load_settings:223 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:20:45.392 | INFO     | tldw_chatbook.config:load_settings:232 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:45.394 | INFO     | tldw_chatbook.config:load_settings:237 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:45.395 | INFO     | tldw_chatbook.config:load_settings:252 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:20:45,395 [DEBUG] root:207 - OpenAI: Using API Key: Key Provided
2025-06-29 00:20:45,395 [DEBUG] root:280 - OpenAI Request Payload (excluding messages): {k: v for k, v in payload.items() if k != 'messages'}
2025-06-29 00:20:45,395 [DEBUG] root:285 - OpenAI: Posting request (streaming)
2025-06-29 00:20:45.395 | METRIC   | tldw_chatbook.Metrics.metrics_logger:_log_metric:47 - Histogram 'chat_api_call_duration': 0.0027129650115966797
2025-06-29 00:20:45.395 | METRIC   | tldw_chatbook.Metrics.metrics_logger:_log_metric:47 - Counter 'chat_api_call_success': 1
2025-06-29 00:20:45.395 | DEBUG    | tldw_chatbook.Chat.Chat_Functions:chat_api_call:640 - Debug - Chat API Call - Response: Streaming Generator
----------------------------------------

263. 2025-06-29 00:20:45,395 [ERROR] root:304 - OpenAI: Error during stream iteration: Stream interrupted
Traceback (most recent call last):
  File "/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/LLM_Calls/LLM_API_Calls.py", line 292, in stream_generator
    for line in response.iter_lines(decode_unicode=True):
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/appledev/Working/tldw_chatbook_dev/Tests/Chat/test_chat_mocked_apis.py", line 283, in error_generator
    raise Exception("Stream interrupted")
Exception: Stream interrupted
------------------------------ Captured log call -------------------------------
DEBUG    root:LLM_API_Calls.py:207 OpenAI: Using API Key: Key Provided
DEBUG    root:LLM_API_Calls.py:280 OpenAI Request Payload (excluding messages): {k: v for k, v in payload.items() if k != 'messages'}
DEBUG    root:LLM_API_Calls.py:285 OpenAI: Posting request (streaming)
----------------------------------------

264. ERROR    root:LLM_API_Calls.py:304 OpenAI: Error during stream iteration: Stream interrupted
Traceback (most recent call last):
  File "/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/LLM_Calls/LLM_API_Calls.py", line 292, in stream_generator
    for line in response.iter_lines(decode_unicode=True):
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/appledev/Working/tldw_chatbook_dev/Tests/Chat/test_chat_mocked_apis.py", line 283, in error_generator
    raise Exception("Stream interrupted")
Exception: Stream interrupted
_______________________ test_media_search_initial_state ________________________
Tests/Chat/test_chat_sidebar_media_search.py:125: in test_media_search_initial_state
    collapsible = app.query_one("#chat-media-search-collapsible", Collapsible)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/textual/dom.py:1496: in query_one
    raise NoMatches(f"No nodes match {selector!r} on {self!r}")
E   textual.css.query.NoMatches: No nodes match '#chat-media-search-collapsible' on TldwCli(title='[B][N][S]  tldw CLI', classes={'-dark-mode'}, pseudo_classes={'dark', 'focus'})
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:20:45,398 [DEBUG] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

265. 2025-06-29 00:20:45,398 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

266. 2025-06-29 00:20:45,398 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

267. 2025-06-29 00:20:45,398 [ERROR] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:20:45.399 | INFO     | tldw_chatbook.config:load_settings:207 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:45.399 | INFO     | tldw_chatbook.config:load_settings:208 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:45.399 | INFO     | tldw_chatbook.config:load_settings:217 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:20:45.399 | WARNING  | tldw_chatbook.config:load_settings:223 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:20:45.399 | INFO     | tldw_chatbook.config:load_settings:232 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:45.400 | INFO     | tldw_chatbook.config:load_settings:237 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:45.401 | INFO     | tldw_chatbook.config:load_settings:252 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:20:45.401 | INFO     | tldw_chatbook.app:__init__:973 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:20:45.401 | INFO     | tldw_chatbook.app:__init__:980 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:20:45.401 | INFO     | tldw_chatbook.app:__init__:981 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:20:45,401 [INFO] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:20:45,401 [INFO] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:20:45.401 | INFO     | tldw_chatbook.app:__init__:990 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

268. 2025-06-29 00:20:45,401 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

269. 2025-06-29 00:20:45,401 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:20:45,401 [DEBUG] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:20:45.401 | INFO     | tldw_chatbook.config:load_settings:207 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:45.401 | INFO     | tldw_chatbook.config:load_settings:208 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:45.401 | INFO     | tldw_chatbook.config:load_settings:217 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:20:45.401 | WARNING  | tldw_chatbook.config:load_settings:223 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:20:45.401 | INFO     | tldw_chatbook.config:load_settings:232 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:45.403 | INFO     | tldw_chatbook.config:load_settings:237 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:45.403 | INFO     | tldw_chatbook.config:load_settings:252 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:20:45,403 [INFO] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:20:45,404 [INFO] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:20:45.404 | INFO     | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:105 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:20:45.404 | INFO     | tldw_chatbook.DB.Prompts_DB:__init__:251 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:20:45.404 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_get_thread_connection:317 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:20:45.404 | INFO     | tldw_chatbook.DB.Prompts_DB:_initialize_schema:518 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:20:45.404 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_initialize_schema:521 - Database schema is up to date.
2025-06-29 00:20:45.404 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_initialize_schema:525 - Verified FTS tables exist.
2025-06-29 00:20:45.404 | DEBUG    | tldw_chatbook.DB.Prompts_DB:__init__:281 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:20:45.404 | INFO     | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:110 - Prompts Interop Library initialized successfully.
2025-06-29 00:20:45,404 [INFO] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:20:45,404 [INFO] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:20:45,404 [DEBUG] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:20:45,404 [INFO] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:20:45,404 [DEBUG] root:750 - Database schema is up to date.
2025-06-29 00:20:45,404 [DEBUG] root:755 - Verified FTS tables exist.
2025-06-29 00:20:45,404 [DEBUG] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:20:45.404 | INFO     | tldw_chatbook.app:__init__:1057 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:20:45.404 | DEBUG    | tldw_chatbook.app:__init__:1059 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x16b64e090>
2025-06-29 00:20:45.404 | DEBUG    | tldw_chatbook.app:__init__:1061 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:20:45.404 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:get_distinct_media_types:3417 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:20:45,404 [DEBUG] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:20:45.404 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:get_distinct_media_types:3431 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:20:45.404 | INFO     | tldw_chatbook.app:__init__:1075 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

270. 2025-06-29 00:20:45,405 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

271. 2025-06-29 00:20:45,405 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:20:45.405 | DEBUG    | tldw_chatbook.app:__init__:1089 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:20:45.405 | DEBUG    | tldw_chatbook.app:__init__:1090 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:20:45,405 [INFO] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:20:45,405 [INFO] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

272. 2025-06-29 00:20:45,405 [ERROR] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:20:45.405 | INFO     | tldw_chatbook.app:__init__:1133 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:20:45.405 | INFO     | tldw_chatbook.app:__init__:1134 - Total initialization time: 0.007 seconds
2025-06-29 00:20:45.405 | INFO     | tldw_chatbook.app:__init__:1138 -   basic_init: 0.002s (33.8%)
2025-06-29 00:20:45.405 | INFO     | tldw_chatbook.app:__init__:1138 -   attribute_init: 0.000s (0.2%)
2025-06-29 00:20:45.405 | INFO     | tldw_chatbook.app:__init__:1138 -   notes_service_init: 0.000s (2.8%)
2025-06-29 00:20:45.405 | INFO     | tldw_chatbook.app:__init__:1138 -   providers_models: 0.002s (35.4%)
2025-06-29 00:20:45.405 | INFO     | tldw_chatbook.app:__init__:1138 -   prompts_service_init: 0.000s (6.0%)
2025-06-29 00:20:45.405 | INFO     | tldw_chatbook.app:__init__:1138 -   media_db_init: 0.001s (7.7%)
2025-06-29 00:20:45.405 | INFO     | tldw_chatbook.app:__init__:1139 - ==============================
----------------------------------------

273. 2025-06-29 00:20:45,405 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

274. 2025-06-29 00:20:45,405 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:20:45,405 [INFO] root:444 - Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/media.db [Client ID: test_client_id]
2025-06-29 00:20:45,405 [DEBUG] root:510 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/media.db [Client: test_client_id, Thread: MainThread]
2025-06-29 00:20:45,405 [INFO] root:747 - Checking DB schema. Current version: 0. Code supports: 1
2025-06-29 00:20:45,405 [INFO] root:680 - Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/media.db...
2025-06-29 00:20:45,405 [DEBUG] root:647 - Started transaction.
2025-06-29 00:20:45,405 [DEBUG] root:694 - [Schema V1] Applying Core Schema + Version Update...
2025-06-29 00:20:45,410 [DEBUG] root:696 - [Schema V1] Core Schema script (incl. version update) executed.
2025-06-29 00:20:45,410 [DEBUG] root:707 - [Schema V1] Media table structure validated successfully.
2025-06-29 00:20:45,410 [DEBUG] root:719 - [Schema V1] Version check inside transaction confirmed version is 1.
2025-06-29 00:20:45,410 [DEBUG] root:652 - Committed transaction.
2025-06-29 00:20:45,410 [INFO] root:722 - [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/media.db.
2025-06-29 00:20:45,410 [DEBUG] root:726 - [Schema V1] Applying FTS Tables...
2025-06-29 00:20:45,410 [INFO] root:729 - [Schema V1] FTS Tables created successfully.
2025-06-29 00:20:45,410 [INFO] root:771 - Database schema initialized/migrated to version 1.
2025-06-29 00:20:45,410 [DEBUG] root:474 - Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/media.db
2025-06-29 00:20:45.411 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:__init__:992 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:20:45.411 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1051 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:20:45.411 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__enter__:4087 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:20:45.411 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1403 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:20:45.411 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1322 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/chachanotes.db...
2025-06-29 00:20:45.417 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1326 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:20:45.417 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1332 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/chachanotes.db.
2025-06-29 00:20:45.417 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1357 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/chachanotes.db...
2025-06-29 00:20:45.423 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1361 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:20:45.423 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1369 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/chachanotes.db.
2025-06-29 00:20:45.423 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1432 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:20:45.423 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__exit__:4114 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:20:45.423 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__init__:996 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/chachanotes.db
2025-06-29 00:20:45,423 [INFO] root:1899 - add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
2025-06-29 00:20:45,423 [DEBUG] root:647 - Started transaction.
2025-06-29 00:20:45,423 [DEBUG] root:891 - Logged sync event: Media 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3 create v1 at 2025-06-29T07:20:45.423Z
2025-06-29 00:20:45,423 [DEBUG] root:919 - FTS update for media 1: sanitized content - null bytes replaced
2025-06-29 00:20:45,423 [DEBUG] root:924 - Updated FTS (insert or replace) for Media ID 1
2025-06-29 00:20:45.423 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword ',' UUID e9e4c5a5-1c9c-4e40-9964-9b64adc72e59
2025-06-29 00:20:45,423 [DEBUG] root:891 - Logged sync event: Keywords e9e4c5a5-1c9c-4e40-9964-9b64adc72e59 create v1 at 2025-06-29T07:20:45.423Z
2025-06-29 00:20:45,423 [DEBUG] root:973 - Updated FTS (insert or replace) for Keyword ID 1
2025-06-29 00:20:45.424 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'e' UUID 5b154acd-8bbc-47d3-a828-633564a0251c
2025-06-29 00:20:45,424 [DEBUG] root:891 - Logged sync event: Keywords 5b154acd-8bbc-47d3-a828-633564a0251c create v1 at 2025-06-29T07:20:45.424Z
2025-06-29 00:20:45,424 [DEBUG] root:973 - Updated FTS (insert or replace) for Keyword ID 2
2025-06-29 00:20:45.424 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'n' UUID 881db5e4-1679-4931-a03d-a2b127167e1f
2025-06-29 00:20:45,424 [DEBUG] root:891 - Logged sync event: Keywords 881db5e4-1679-4931-a03d-a2b127167e1f create v1 at 2025-06-29T07:20:45.424Z
2025-06-29 00:20:45,424 [DEBUG] root:973 - Updated FTS (insert or replace) for Keyword ID 3
2025-06-29 00:20:45.424 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'o' UUID ee947180-f867-4f48-aba9-07296cf66b65
2025-06-29 00:20:45,424 [DEBUG] root:891 - Logged sync event: Keywords ee947180-f867-4f48-aba9-07296cf66b65 create v1 at 2025-06-29T07:20:45.424Z
2025-06-29 00:20:45,424 [DEBUG] root:973 - Updated FTS (insert or replace) for Keyword ID 4
2025-06-29 00:20:45.424 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 's' UUID dbaee9aa-1ad7-4b01-bc67-1193fb5a447c
2025-06-29 00:20:45,424 [DEBUG] root:891 - Logged sync event: Keywords dbaee9aa-1ad7-4b01-bc67-1193fb5a447c create v1 at 2025-06-29T07:20:45.424Z
2025-06-29 00:20:45,424 [DEBUG] root:973 - Updated FTS (insert or replace) for Keyword ID 5
2025-06-29 00:20:45.424 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 't' UUID cdb786e3-da94-41db-9af5-628548482261
2025-06-29 00:20:45,424 [DEBUG] root:891 - Logged sync event: Keywords cdb786e3-da94-41db-9af5-628548482261 create v1 at 2025-06-29T07:20:45.424Z
2025-06-29 00:20:45,424 [DEBUG] root:973 - Updated FTS (insert or replace) for Keyword ID 6
2025-06-29 00:20:45,424 [DEBUG] root:891 - Logged sync event: MediaKeywords 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3_e9e4c5a5-1c9c-4e40-9964-9b64adc72e59 link v1 at 2025-06-29T07:20:45.424Z
2025-06-29 00:20:45,424 [DEBUG] root:891 - Logged sync event: MediaKeywords 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3_5b154acd-8bbc-47d3-a828-633564a0251c link v1 at 2025-06-29T07:20:45.424Z
2025-06-29 00:20:45,424 [DEBUG] root:891 - Logged sync event: MediaKeywords 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3_881db5e4-1679-4931-a03d-a2b127167e1f link v1 at 2025-06-29T07:20:45.424Z
2025-06-29 00:20:45,424 [DEBUG] root:891 - Logged sync event: MediaKeywords 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3_ee947180-f867-4f48-aba9-07296cf66b65 link v1 at 2025-06-29T07:20:45.424Z
2025-06-29 00:20:45,424 [DEBUG] root:891 - Logged sync event: MediaKeywords 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3_dbaee9aa-1ad7-4b01-bc67-1193fb5a447c link v1 at 2025-06-29T07:20:45.424Z
2025-06-29 00:20:45,424 [DEBUG] root:891 - Logged sync event: MediaKeywords 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3_cdb786e3-da94-41db-9af5-628548482261 link v1 at 2025-06-29T07:20:45.424Z
2025-06-29 00:20:45.424 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:update_keywords_for_media:2303 - Keywords updated media 1. Added: 6, Removed: 0.
2025-06-29 00:20:45.424 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:create_document_version:2187 - Creating document version 1 for media ID 1, UUID 1d3af87f-9644-42f1-aef2-ea0abb8392df
2025-06-29 00:20:45,424 [DEBUG] root:891 - Logged sync event: DocumentVersions 1d3af87f-9644-42f1-aef2-ea0abb8392df create v1 at 2025-06-29T07:20:45.424Z
2025-06-29 00:20:45,424 [DEBUG] root:652 - Committed transaction.
2025-06-29 00:20:45,424 [INFO] root:1899 - add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
2025-06-29 00:20:45,425 [DEBUG] root:647 - Started transaction.
2025-06-29 00:20:45,425 [DEBUG] root:891 - Logged sync event: Media f3823f31-33b3-4569-8752-e87098f6f169 create v1 at 2025-06-29T07:20:45.425Z
2025-06-29 00:20:45,425 [DEBUG] root:919 - FTS update for media 2: sanitized content - null bytes replaced
2025-06-29 00:20:45,425 [DEBUG] root:924 - Updated FTS (insert or replace) for Media ID 2
2025-06-29 00:20:45.425 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1464 - Keyword ',' already active.
2025-06-29 00:20:45.425 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1464 - Keyword 'e' already active.
2025-06-29 00:20:45.425 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1464 - Keyword 'o' already active.
2025-06-29 00:20:45.425 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1464 - Keyword 's' already active.
2025-06-29 00:20:45.425 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1464 - Keyword 't' already active.
2025-06-29 00:20:45.425 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:add_keyword:1469 - Adding new keyword 'w' UUID cf4b0e67-bd96-4983-932e-4ec04740187d
2025-06-29 00:20:45,425 [DEBUG] root:891 - Logged sync event: Keywords cf4b0e67-bd96-4983-932e-4ec04740187d create v1 at 2025-06-29T07:20:45.425Z
2025-06-29 00:20:45,425 [DEBUG] root:973 - Updated FTS (insert or replace) for Keyword ID 7
2025-06-29 00:20:45,425 [DEBUG] root:891 - Logged sync event: MediaKeywords f3823f31-33b3-4569-8752-e87098f6f169_e9e4c5a5-1c9c-4e40-9964-9b64adc72e59 link v1 at 2025-06-29T07:20:45.425Z
2025-06-29 00:20:45,425 [DEBUG] root:891 - Logged sync event: MediaKeywords f3823f31-33b3-4569-8752-e87098f6f169_5b154acd-8bbc-47d3-a828-633564a0251c link v1 at 2025-06-29T07:20:45.425Z
2025-06-29 00:20:45,425 [DEBUG] root:891 - Logged sync event: MediaKeywords f3823f31-33b3-4569-8752-e87098f6f169_ee947180-f867-4f48-aba9-07296cf66b65 link v1 at 2025-06-29T07:20:45.425Z
2025-06-29 00:20:45,425 [DEBUG] root:891 - Logged sync event: MediaKeywords f3823f31-33b3-4569-8752-e87098f6f169_dbaee9aa-1ad7-4b01-bc67-1193fb5a447c link v1 at 2025-06-29T07:20:45.425Z
2025-06-29 00:20:45,425 [DEBUG] root:891 - Logged sync event: MediaKeywords f3823f31-33b3-4569-8752-e87098f6f169_cdb786e3-da94-41db-9af5-628548482261 link v1 at 2025-06-29T07:20:45.425Z
2025-06-29 00:20:45,425 [DEBUG] root:891 - Logged sync event: MediaKeywords f3823f31-33b3-4569-8752-e87098f6f169_cf4b0e67-bd96-4983-932e-4ec04740187d link v1 at 2025-06-29T07:20:45.425Z
2025-06-29 00:20:45.425 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:update_keywords_for_media:2303 - Keywords updated media 2. Added: 6, Removed: 0.
2025-06-29 00:20:45.425 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:create_document_version:2187 - Creating document version 1 for media ID 2, UUID c0335d15-8c38-43e7-892e-64b4c074b02c
2025-06-29 00:20:45,425 [DEBUG] root:891 - Logged sync event: DocumentVersions c0335d15-8c38-43e7-892e-64b4c074b02c create v1 at 2025-06-29T07:20:45.425Z
2025-06-29 00:20:45,425 [DEBUG] root:652 - Committed transaction.
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

275. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

276. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

277. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
----------------------------------------

278. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

279. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
----------------------------------------

280. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

281. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

282. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
----------------------------------------

283. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

284. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/media.db [Client ID: test_client_id]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/media.db [Client: test_client_id, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 0. Code supports: 1
INFO     root:Client_Media_DB_v2.py:680 Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/media.db...
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:694 [Schema V1] Applying Core Schema + Version Update...
DEBUG    root:Client_Media_DB_v2.py:696 [Schema V1] Core Schema script (incl. version update) executed.
DEBUG    root:Client_Media_DB_v2.py:707 [Schema V1] Media table structure validated successfully.
DEBUG    root:Client_Media_DB_v2.py:719 [Schema V1] Version check inside transaction confirmed version is 1.
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:722 [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/media.db.
DEBUG    root:Client_Media_DB_v2.py:726 [Schema V1] Applying FTS Tables...
INFO     root:Client_Media_DB_v2.py:729 [Schema V1] FTS Tables created successfully.
INFO     root:Client_Media_DB_v2.py:771 Database schema initialized/migrated to version 1.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_initial_stat0/db/media.db
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3 create v1 at 2025-06-29T07:20:45.423Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 1: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 1
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords e9e4c5a5-1c9c-4e40-9964-9b64adc72e59 create v1 at 2025-06-29T07:20:45.423Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 1
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 5b154acd-8bbc-47d3-a828-633564a0251c create v1 at 2025-06-29T07:20:45.424Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 2
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 881db5e4-1679-4931-a03d-a2b127167e1f create v1 at 2025-06-29T07:20:45.424Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 3
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords ee947180-f867-4f48-aba9-07296cf66b65 create v1 at 2025-06-29T07:20:45.424Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 4
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords dbaee9aa-1ad7-4b01-bc67-1193fb5a447c create v1 at 2025-06-29T07:20:45.424Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 5
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords cdb786e3-da94-41db-9af5-628548482261 create v1 at 2025-06-29T07:20:45.424Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 6
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3_e9e4c5a5-1c9c-4e40-9964-9b64adc72e59 link v1 at 2025-06-29T07:20:45.424Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3_5b154acd-8bbc-47d3-a828-633564a0251c link v1 at 2025-06-29T07:20:45.424Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3_881db5e4-1679-4931-a03d-a2b127167e1f link v1 at 2025-06-29T07:20:45.424Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3_ee947180-f867-4f48-aba9-07296cf66b65 link v1 at 2025-06-29T07:20:45.424Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3_dbaee9aa-1ad7-4b01-bc67-1193fb5a447c link v1 at 2025-06-29T07:20:45.424Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 0d1fab6f-9ed9-4ec1-a736-2b3e5a7c2ba3_cdb786e3-da94-41db-9af5-628548482261 link v1 at 2025-06-29T07:20:45.424Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions 1d3af87f-9644-42f1-aef2-ea0abb8392df create v1 at 2025-06-29T07:20:45.424Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media f3823f31-33b3-4569-8752-e87098f6f169 create v1 at 2025-06-29T07:20:45.425Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 2: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 2
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords cf4b0e67-bd96-4983-932e-4ec04740187d create v1 at 2025-06-29T07:20:45.425Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 7
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords f3823f31-33b3-4569-8752-e87098f6f169_e9e4c5a5-1c9c-4e40-9964-9b64adc72e59 link v1 at 2025-06-29T07:20:45.425Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords f3823f31-33b3-4569-8752-e87098f6f169_5b154acd-8bbc-47d3-a828-633564a0251c link v1 at 2025-06-29T07:20:45.425Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords f3823f31-33b3-4569-8752-e87098f6f169_ee947180-f867-4f48-aba9-07296cf66b65 link v1 at 2025-06-29T07:20:45.425Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords f3823f31-33b3-4569-8752-e87098f6f169_dbaee9aa-1ad7-4b01-bc67-1193fb5a447c link v1 at 2025-06-29T07:20:45.425Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords f3823f31-33b3-4569-8752-e87098f6f169_cdb786e3-da94-41db-9af5-628548482261 link v1 at 2025-06-29T07:20:45.425Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords f3823f31-33b3-4569-8752-e87098f6f169_cf4b0e67-bd96-4983-932e-4ec04740187d link v1 at 2025-06-29T07:20:45.425Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions c0335d15-8c38-43e7-892e-64b4c074b02c create v1 at 2025-06-29T07:20:45.425Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:20:45,450 [DEBUG] root:1289 - App composing UI...
2025-06-29 00:20:45.451 | DEBUG    | tldw_chatbook.UI.Chat_Window:__init__:44 - ChatWindow initialized.
2025-06-29 00:20:45.451 | DEBUG    | tldw_chatbook.UI.Conv_Char_Window:__init__:37 - CCPWindow initialized.
2025-06-29 00:20:45.451 | DEBUG    | tldw_chatbook.UI.Ingest_Window:__init__:49 - IngestWindow initialized.
----------------------------------------

285. 2025-06-29 00:20:45,451 [ERROR] root:99 - Failed to log histogram app_compose_duration_seconds: No label names were set when constructing histogram:app_compose_duration_seconds
2025-06-29 00:20:45,451 [DEBUG] root:1329 - App compose finished in 0.001 seconds
----------------------------------------

286. 2025-06-29 00:20:45,451 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

287. 2025-06-29 00:20:45,451 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:20:45.461 | DEBUG    | tldw_chatbook.UI.Chat_Window:compose:101 - Composing ChatWindow UI
2025-06-29 00:20:45.461 | INFO     | tldw_chatbook.config:load_settings:207 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:45.461 | INFO     | tldw_chatbook.config:load_settings:208 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:45.461 | INFO     | tldw_chatbook.config:load_settings:217 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:20:45.461 | WARNING  | tldw_chatbook.config:load_settings:223 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:20:45.461 | INFO     | tldw_chatbook.config:load_settings:232 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:45.462 | INFO     | tldw_chatbook.config:load_settings:237 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:45.463 | INFO     | tldw_chatbook.config:load_settings:252 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:20:45,463 [INFO] root:42 - Sidebar chat: Received providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:20:45.468 | DEBUG    | tldw_chatbook.UI.Chat_Window:compose:128 - 'respond-for-me-button' composed.
2025-06-29 00:20:45.468 | DEBUG    | tldw_chatbook.app:watch_current_chat_is_ephemeral:1912 - Chat ephemeral state changed to: True
2025-06-29 00:20:45,471 [DEBUG] root:355 - Character sidebar (id='chat-right-sidebar', prefix='chat') created with ephemeral state: True
2025-06-29 00:20:45.472 | DEBUG    | tldw_chatbook.UI.Conv_Char_Window:compose:40 - Composing CCPWindow UI
2025-06-29 00:20:45.473 | DEBUG    | tldw_chatbook.UI.Conv_Char_Window:compose:70 - Composing center pane
2025-06-29 00:20:45.476 | DEBUG    | tldw_chatbook.UI.Conv_Char_Window:compose:190 - Composing right pane
2025-06-29 00:20:45.489 | DEBUG    | tldw_chatbook.Utils.optional_deps:check_dependency:51 - ✅ numpy dependency found. Feature 'numpy' is enabled.
2025-06-29 00:20:45.489 | DEBUG    | tldw_chatbook.Utils.optional_deps:check_dependency:51 - ✅ torch dependency found. Feature 'torch' is enabled.
2025-06-29 00:20:45.489 | DEBUG    | tldw_chatbook.Utils.optional_deps:check_dependency:51 - ✅ transformers dependency found. Feature 'transformers' is enabled.
2025-06-29 00:20:45.489 | DEBUG    | tldw_chatbook.Utils.optional_deps:check_dependency:51 - ✅ sentence_transformers dependency found. Feature 'sentence_transformers' is enabled.
2025-06-29 00:20:45.628 | DEBUG    | tldw_chatbook.UI.SearchRAGWindow:_load_recent_search_history:1213 - Loaded 0 recent search queries
2025-06-29 00:20:45.632 | DEBUG    | tldw_chatbook.UI.Ingest_Window:compose:233 - Composing IngestWindow UI
2025-06-29 00:20:45,685 [INFO] root:25 - MetricsScreen initialized. Log path: /tmp/app_metrics.log
2025-06-29 00:20:45,713 [INFO] root:76 - MetricsScreen composing. Current metrics: {}
2025-06-29 00:20:45,713 [WARNING] root:79 - MetricsScreen compose: self.metrics is unexpectedly empty at compose time.
2025-06-29 00:20:45,713 [INFO] root:93 - MetricsScreen compose finished.
2025-06-29 00:20:46,300 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,301 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,302 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,302 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,306 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,306 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,307 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,307 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,307 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,307 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,310 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,310 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,310 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,529 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,310 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,310 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,323 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,342 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,502 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,521 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,533 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,533 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,310 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,537 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,543 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,562 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,585 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,604 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,617 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,633 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,640 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,643 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:46,659 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,681 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,681 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,685 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,690 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,696 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [INFO] root:29 - MetricsScreen on_mount: Calling load_metrics.
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,643 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:46,643 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [INFO] root:45 - Attempting to load metrics from: /tmp/app_metrics.log
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,675 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
----------------------------------------

288. 2025-06-29 00:20:46,698 [ERROR] root:68 - MetricsScreen: Log file not found at /tmp/app_metrics.log.
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:46,698 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,699 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,699 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,699 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,699 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,699 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,699 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,699 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46.822 | INFO     | tldw_chatbook.UI.Coding_Window:on_mount:88 - CodingWindow on_mount: UI composed
2025-06-29 00:20:46,699 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,699 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:46,711 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:46,711 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,729 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,744 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,886 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,779 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,794 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,804 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,822 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,833 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:46,850 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:46,866 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,876 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,760 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,887 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,908 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,921 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,934 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:46,946 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:46,963 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,972 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,973 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,979 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,985 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,986 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:47.007 | DEBUG    | tldw_chatbook.UI.LLM_Management_Window:on_mount:33 - LLMManagementWindow.on_mount called
2025-06-29 00:20:46,986 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:46,986 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,990 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,996 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:46,996 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:47,007 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:47,010 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:47,010 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:47,010 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:47.011 | INFO     | tldw_chatbook.UI.Evals_Window:on_mount:449 - EvalsWindow on_mount: UI composed
2025-06-29 00:20:47,010 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:47,010 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:47,011 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:47,011 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:47,011 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:47,011 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:47,011 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:47,011 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:47,011 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:47,011 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:47,011 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:47,011 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:47,012 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 3, False
----------------------------------------

289. 2025-06-29 00:20:47.014 | ERROR    | tldw_chatbook.UI.Evals_Window:on_mount:463 - Error initializing evaluation system: cannot import name 'EvaluationOrchestrator' from 'tldw_chatbook.Evals' (/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Evals/__init__.py)
2025-06-29 00:20:47,055 [DEBUG] chromadb.config:359 - Starting component System
2025-06-29 00:20:47,055 [DEBUG] chromadb.config:359 - Starting component Posthog
2025-06-29 00:20:47.059 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /Users/appledev/.local/share/tldw_cli/chromadb
2025-06-29 00:20:47.060 | INFO     | tldw_chatbook.RAG_Search.Services.cache_service:_load_persistent_caches:252 - Loaded 0 embeddings from persistent cache
2025-06-29 00:20:47.061 | INFO     | tldw_chatbook.UI.SearchWindow:on_mount:143 - SearchWindow.on_mount: Setting and initializing initial active sub-tab.
2025-06-29 00:20:47.063 | DEBUG    | tldw_chatbook.UI.SearchWindow:on_mount:147 - SearchWindow.on_mount: Setting view search-view-rag-chat display to False
2025-06-29 00:20:47.063 | DEBUG    | tldw_chatbook.UI.SearchWindow:on_mount:147 - SearchWindow.on_mount: Setting view search-view-rag-management display to False
2025-06-29 00:20:47.063 | DEBUG    | tldw_chatbook.UI.SearchWindow:on_mount:147 - SearchWindow.on_mount: Setting view search-view-embeddings-creation display to False
2025-06-29 00:20:47.063 | DEBUG    | tldw_chatbook.UI.SearchWindow:on_mount:147 - SearchWindow.on_mount: Setting view search-view-embeddings-management display to False
2025-06-29 00:20:47.063 | DEBUG    | tldw_chatbook.UI.SearchWindow:on_mount:147 - SearchWindow.on_mount: Setting view search-view-web-search display to False
2025-06-29 00:20:47.063 | DEBUG    | tldw_chatbook.UI.SearchWindow:on_mount:158 - SearchWindow.on_mount: Initial active sub-tab set to search-view-embeddings-creation
2025-06-29 00:20:47.063 | DEBUG    | tldw_chatbook.UI.SearchWindow:on_mount:164 - SearchWindow.on_mount: Added active class to nav button search-nav-embeddings-creation
2025-06-29 00:20:47.064 | DEBUG    | tldw_chatbook.UI.SearchWindow:on_mount:171 - SearchWindow.on_mount: Set display=True for active view search-view-embeddings-creation
2025-06-29 00:20:47.064 | INFO     | tldw_chatbook.UI.SearchWindow:on_mount:176 - SearchWindow.on_mount: Initializing view search-view-embeddings-creation
2025-06-29 00:20:47.064 | INFO     | tldw_chatbook.UI.SearchWindow:_initialize_embeddings_creation_view:809 - Initializing Embeddings Creation view.
2025-06-29 00:20:47.068 | DEBUG    | tldw_chatbook.UI.SearchWindow:on_creation_provider_select_changed:510 - Creation provider select changed to: huggingface
2025-06-29 00:20:47.069 | DEBUG    | tldw_chatbook.UI.SearchWindow:on_creation_model_select_changed:518 - Creation model select changed to: e5-small-v2 for provider: huggingface
2025-06-29 00:20:47.071 | DEBUG    | tldw_chatbook.UI.SearchWindow:_update_creation_provider_specific_inputs_visibility:551 - Provider specific inputs visibility updated. Custom HF: False, Local API URL: False (Value: '', Disabled: False)
2025-06-29 00:20:47,073 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,073 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,073 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,073 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,073 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,073 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,073 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,073 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,073 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,073 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,077 [DEBUG] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,077 [DEBUG] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,077 [DEBUG] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,077 [DEBUG] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,077 [DEBUG] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,077 [DEBUG] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,077 [DEBUG] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,077 [DEBUG] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,077 [DEBUG] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,077 [DEBUG] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:47,079 [INFO] root:137 - --- _setup_logging START (from Logging_Config.py) ---
2025-06-29 00:20:47,079 [INFO] root:145 - Loguru: All pre-existing sinks removed.
2025-06-29 00:20:47,082 [INFO] root:168 - Loguru: Configured to forward its messages to standard Python logging system.
INFO: _setup_logging: Removed 7 pre-existing handler(s) from root logger.
INFO: _setup_logging: Root logger level set to DEBUG
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:48 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
------------------------------ Captured log call -------------------------------
DEBUG    root:app.py:1289 App composing UI...
----------------------------------------

290. ERROR    root:metrics.py:99 Failed to log histogram app_compose_duration_seconds: No label names were set when constructing histogram:app_compose_duration_seconds
DEBUG    root:app.py:1329 App compose finished in 0.001 seconds
----------------------------------------

291. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

292. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:settings_sidebar.py:42 Sidebar chat: Received providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
DEBUG    root:chat_right_sidebar.py:355 Character sidebar (id='chat-right-sidebar', prefix='chat') created with ephemeral state: True
INFO     root:Stats_screen.py:25 MetricsScreen initialized. Log path: /tmp/app_metrics.log
INFO     root:Stats_screen.py:76 MetricsScreen composing. Current metrics: {}
WARNING  root:Stats_screen.py:79 MetricsScreen compose: self.metrics is unexpectedly empty at compose time.
INFO     root:Stats_screen.py:93 MetricsScreen compose finished.
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:29 MetricsScreen on_mount: Calling load_metrics.
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:45 Attempting to load metrics from: /tmp/app_metrics.log
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
----------------------------------------

293. ERROR    root:Stats_screen.py:68 MetricsScreen: Log file not found at /tmp/app_metrics.log.
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    chromadb.config:config.py:359 Starting component System
DEBUG    chromadb.config:config.py:359 Starting component Posthog
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Logging_Config.py:137 --- _setup_logging START (from Logging_Config.py) ---
INFO     root:Logging_Config.py:145 Loguru: All pre-existing sinks removed.
INFO     root:Logging_Config.py:168 Loguru: Configured to forward its messages to standard Python logging system.
_______________________ test_media_search_functionality ________________________
Tests/Chat/test_chat_sidebar_media_search.py:188: in test_media_search_functionality
    assert "Test Media One" in str(label.renderable)
E   AssertionError: assert 'Test Media One' in 'Test Media Two (ID: Unknown ID)'
E    +  where 'Test Media Two (ID: Unknown ID)' = str('Test Media Two (ID: Unknown ID)')
E    +    where 'Test Media Two (ID: Unknown ID)' = Label().renderable
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:20:49 [DEBUG   ] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

294. 2025-06-29 00:20:49 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

295. 2025-06-29 00:20:49 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

296. 2025-06-29 00:20:49 [ERROR   ] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:20:49 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

297. 2025-06-29 00:20:49 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

298. 2025-06-29 00:20:49 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:20:49 [DEBUG   ] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:20:49 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:20:49 [INFO    ] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:20:49 [INFO    ] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:20:49 [WARNING ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Database schema is up to date.
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Verified FTS tables exist.
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts Interop Library initialized successfully.
2025-06-29 00:20:49 [INFO    ] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:20:49 [INFO    ] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:20:49 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:20:49 [INFO    ] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:20:49 [DEBUG   ] root:750 - Database schema is up to date.
2025-06-29 00:20:49 [DEBUG   ] root:755 - Verified FTS tables exist.
2025-06-29 00:20:49 [DEBUG   ] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x16b333bc0>
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:20:49 [DEBUG   ] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

299. 2025-06-29 00:20:49 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

300. 2025-06-29 00:20:49 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:20:49 [INFO    ] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:20:49 [INFO    ] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

301. 2025-06-29 00:20:49 [ERROR   ] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 - Total initialization time: 0.008 seconds
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 -   basic_init: 0.002s (29.5%)
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 -   attribute_init: 0.000s (0.2%)
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 -   notes_service_init: 0.000s (3.0%)
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 -   providers_models: 0.003s (41.2%)
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 -   prompts_service_init: 0.001s (8.3%)
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 -   media_db_init: 0.001s (7.8%)
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.app:160 - ==============================
----------------------------------------

302. 2025-06-29 00:20:49 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

303. 2025-06-29 00:20:49 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:20:49 [INFO    ] root:444 - Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/media.db [Client ID: test_client_id]
2025-06-29 00:20:49 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/media.db [Client: test_client_id, Thread: MainThread]
2025-06-29 00:20:49 [INFO    ] root:747 - Checking DB schema. Current version: 0. Code supports: 1
2025-06-29 00:20:49 [INFO    ] root:680 - Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/media.db...
2025-06-29 00:20:49 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:20:49 [DEBUG   ] root:694 - [Schema V1] Applying Core Schema + Version Update...
2025-06-29 00:20:49 [DEBUG   ] root:696 - [Schema V1] Core Schema script (incl. version update) executed.
2025-06-29 00:20:49 [DEBUG   ] root:707 - [Schema V1] Media table structure validated successfully.
2025-06-29 00:20:49 [DEBUG   ] root:719 - [Schema V1] Version check inside transaction confirmed version is 1.
2025-06-29 00:20:49 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:20:49 [INFO    ] root:722 - [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/media.db.
2025-06-29 00:20:49 [DEBUG   ] root:726 - [Schema V1] Applying FTS Tables...
2025-06-29 00:20:49 [INFO    ] root:729 - [Schema V1] FTS Tables created successfully.
2025-06-29 00:20:49 [INFO    ] root:771 - Database schema initialized/migrated to version 1.
2025-06-29 00:20:49 [DEBUG   ] root:474 - Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/media.db
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db...
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db.
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db...
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db.
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db
2025-06-29 00:20:49 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
2025-06-29 00:20:49 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: Media a36cad3b-ae23-40c7-8b1d-475a865de69a create v1 at 2025-06-29T07:20:49.330Z
2025-06-29 00:20:49 [DEBUG   ] root:919 - FTS update for media 1: sanitized content - null bytes replaced
2025-06-29 00:20:49 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 1
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword ',' UUID a2cf38aa-98e5-4781-ae9c-46c8e711d64b
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: Keywords a2cf38aa-98e5-4781-ae9c-46c8e711d64b create v1 at 2025-06-29T07:20:49.330Z
2025-06-29 00:20:49 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 1
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'e' UUID b7b53f48-0a13-43a0-959c-fb656fd99a1d
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: Keywords b7b53f48-0a13-43a0-959c-fb656fd99a1d create v1 at 2025-06-29T07:20:49.330Z
2025-06-29 00:20:49 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 2
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'n' UUID b2e1e8f9-b8c1-462e-998e-ff7d5930ac75
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: Keywords b2e1e8f9-b8c1-462e-998e-ff7d5930ac75 create v1 at 2025-06-29T07:20:49.331Z
2025-06-29 00:20:49 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 3
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'o' UUID ef048d9f-655e-4f32-83f4-13336b6dd2c8
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: Keywords ef048d9f-655e-4f32-83f4-13336b6dd2c8 create v1 at 2025-06-29T07:20:49.331Z
2025-06-29 00:20:49 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 4
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 's' UUID 1c938651-6ba2-41d3-b43c-064e1f55781a
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: Keywords 1c938651-6ba2-41d3-b43c-064e1f55781a create v1 at 2025-06-29T07:20:49.331Z
2025-06-29 00:20:49 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 5
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 't' UUID cab1aa15-8908-4230-a193-0888c77eac33
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: Keywords cab1aa15-8908-4230-a193-0888c77eac33 create v1 at 2025-06-29T07:20:49.331Z
2025-06-29 00:20:49 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 6
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: MediaKeywords a36cad3b-ae23-40c7-8b1d-475a865de69a_a2cf38aa-98e5-4781-ae9c-46c8e711d64b link v1 at 2025-06-29T07:20:49.331Z
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: MediaKeywords a36cad3b-ae23-40c7-8b1d-475a865de69a_b7b53f48-0a13-43a0-959c-fb656fd99a1d link v1 at 2025-06-29T07:20:49.331Z
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: MediaKeywords a36cad3b-ae23-40c7-8b1d-475a865de69a_b2e1e8f9-b8c1-462e-998e-ff7d5930ac75 link v1 at 2025-06-29T07:20:49.331Z
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: MediaKeywords a36cad3b-ae23-40c7-8b1d-475a865de69a_ef048d9f-655e-4f32-83f4-13336b6dd2c8 link v1 at 2025-06-29T07:20:49.331Z
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: MediaKeywords a36cad3b-ae23-40c7-8b1d-475a865de69a_1c938651-6ba2-41d3-b43c-064e1f55781a link v1 at 2025-06-29T07:20:49.331Z
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: MediaKeywords a36cad3b-ae23-40c7-8b1d-475a865de69a_cab1aa15-8908-4230-a193-0888c77eac33 link v1 at 2025-06-29T07:20:49.331Z
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 1. Added: 6, Removed: 0.
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 1, UUID daeb75e6-8abd-44fc-a39c-db19e4eb2ddf
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: DocumentVersions daeb75e6-8abd-44fc-a39c-db19e4eb2ddf create v1 at 2025-06-29T07:20:49.331Z
2025-06-29 00:20:49 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:20:49 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
2025-06-29 00:20:49 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: Media 31c3322c-44be-4b5f-8608-b1cbe236f6f4 create v1 at 2025-06-29T07:20:49.332Z
2025-06-29 00:20:49 [DEBUG   ] root:919 - FTS update for media 2: sanitized content - null bytes replaced
2025-06-29 00:20:49 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 2
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword ',' already active.
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'e' already active.
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'o' already active.
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 's' already active.
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 't' already active.
2025-06-29 00:20:49 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'w' UUID 10a37140-1e6c-4a0f-a8b2-d0182fcb7400
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: Keywords 10a37140-1e6c-4a0f-a8b2-d0182fcb7400 create v1 at 2025-06-29T07:20:49.332Z
2025-06-29 00:20:49 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 7
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 31c3322c-44be-4b5f-8608-b1cbe236f6f4_a2cf38aa-98e5-4781-ae9c-46c8e711d64b link v1 at 2025-06-29T07:20:49.332Z
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 31c3322c-44be-4b5f-8608-b1cbe236f6f4_b7b53f48-0a13-43a0-959c-fb656fd99a1d link v1 at 2025-06-29T07:20:49.332Z
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 31c3322c-44be-4b5f-8608-b1cbe236f6f4_ef048d9f-655e-4f32-83f4-13336b6dd2c8 link v1 at 2025-06-29T07:20:49.332Z
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 31c3322c-44be-4b5f-8608-b1cbe236f6f4_1c938651-6ba2-41d3-b43c-064e1f55781a link v1 at 2025-06-29T07:20:49.332Z
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 31c3322c-44be-4b5f-8608-b1cbe236f6f4_cab1aa15-8908-4230-a193-0888c77eac33 link v1 at 2025-06-29T07:20:49.332Z
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 31c3322c-44be-4b5f-8608-b1cbe236f6f4_10a37140-1e6c-4a0f-a8b2-d0182fcb7400 link v1 at 2025-06-29T07:20:49.332Z
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 2. Added: 6, Removed: 0.
2025-06-29 00:20:49 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 2, UUID ec3a2beb-2743-4d7f-8d3b-4b5881afaad7
2025-06-29 00:20:49 [DEBUG   ] root:891 - Logged sync event: DocumentVersions ec3a2beb-2743-4d7f-8d3b-4b5881afaad7 create v1 at 2025-06-29T07:20:49.332Z
2025-06-29 00:20:49 [DEBUG   ] root:652 - Committed transaction.
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

304. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

305. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

306. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     tldw_chatbook.app:Logging_Config.py:160 Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

307. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

308. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
WARNING  tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Checking DB schema. Current: 1, Code supports: 1
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Database schema is up to date.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Verified FTS tables exist.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts Interop Library initialized successfully.
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x16b333bc0>
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Found 3 distinct media types: ['article', 'podcast', 'video']
INFO     tldw_chatbook.app:Logging_Config.py:160 App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

309. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

310. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

311. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
INFO     tldw_chatbook.app:Logging_Config.py:160 === STARTUP TIMING SUMMARY ===
INFO     tldw_chatbook.app:Logging_Config.py:160 Total initialization time: 0.008 seconds
INFO     tldw_chatbook.app:Logging_Config.py:160   basic_init: 0.002s (29.5%)
INFO     tldw_chatbook.app:Logging_Config.py:160   attribute_init: 0.000s (0.2%)
INFO     tldw_chatbook.app:Logging_Config.py:160   notes_service_init: 0.000s (3.0%)
INFO     tldw_chatbook.app:Logging_Config.py:160   providers_models: 0.003s (41.2%)
INFO     tldw_chatbook.app:Logging_Config.py:160   prompts_service_init: 0.001s (8.3%)
INFO     tldw_chatbook.app:Logging_Config.py:160   media_db_init: 0.001s (7.8%)
INFO     tldw_chatbook.app:Logging_Config.py:160 ==============================
----------------------------------------

312. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

313. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/media.db [Client ID: test_client_id]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/media.db [Client: test_client_id, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 0. Code supports: 1
INFO     root:Client_Media_DB_v2.py:680 Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/media.db...
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:694 [Schema V1] Applying Core Schema + Version Update...
DEBUG    root:Client_Media_DB_v2.py:696 [Schema V1] Core Schema script (incl. version update) executed.
DEBUG    root:Client_Media_DB_v2.py:707 [Schema V1] Media table structure validated successfully.
DEBUG    root:Client_Media_DB_v2.py:719 [Schema V1] Version check inside transaction confirmed version is 1.
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:722 [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/media.db.
DEBUG    root:Client_Media_DB_v2.py:726 [Schema V1] Applying FTS Tables...
INFO     root:Client_Media_DB_v2.py:729 [Schema V1] FTS Tables created successfully.
INFO     root:Client_Media_DB_v2.py:771 Database schema initialized/migrated to version 1.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/media.db
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db [Client ID: test_user]
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db (Journal: wal) for thread 8705548032
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction started (outermost) on thread 8705548032.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Full schema script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction (outermost) committed successfully on thread 8705548032.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_functionalit0/db/chachanotes.db
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media a36cad3b-ae23-40c7-8b1d-475a865de69a create v1 at 2025-06-29T07:20:49.330Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 1: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword ',' UUID a2cf38aa-98e5-4781-ae9c-46c8e711d64b
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords a2cf38aa-98e5-4781-ae9c-46c8e711d64b create v1 at 2025-06-29T07:20:49.330Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'e' UUID b7b53f48-0a13-43a0-959c-fb656fd99a1d
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords b7b53f48-0a13-43a0-959c-fb656fd99a1d create v1 at 2025-06-29T07:20:49.330Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 2
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'n' UUID b2e1e8f9-b8c1-462e-998e-ff7d5930ac75
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords b2e1e8f9-b8c1-462e-998e-ff7d5930ac75 create v1 at 2025-06-29T07:20:49.331Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 3
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'o' UUID ef048d9f-655e-4f32-83f4-13336b6dd2c8
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords ef048d9f-655e-4f32-83f4-13336b6dd2c8 create v1 at 2025-06-29T07:20:49.331Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 4
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 's' UUID 1c938651-6ba2-41d3-b43c-064e1f55781a
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 1c938651-6ba2-41d3-b43c-064e1f55781a create v1 at 2025-06-29T07:20:49.331Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 5
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 't' UUID cab1aa15-8908-4230-a193-0888c77eac33
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords cab1aa15-8908-4230-a193-0888c77eac33 create v1 at 2025-06-29T07:20:49.331Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 6
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords a36cad3b-ae23-40c7-8b1d-475a865de69a_a2cf38aa-98e5-4781-ae9c-46c8e711d64b link v1 at 2025-06-29T07:20:49.331Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords a36cad3b-ae23-40c7-8b1d-475a865de69a_b7b53f48-0a13-43a0-959c-fb656fd99a1d link v1 at 2025-06-29T07:20:49.331Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords a36cad3b-ae23-40c7-8b1d-475a865de69a_b2e1e8f9-b8c1-462e-998e-ff7d5930ac75 link v1 at 2025-06-29T07:20:49.331Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords a36cad3b-ae23-40c7-8b1d-475a865de69a_ef048d9f-655e-4f32-83f4-13336b6dd2c8 link v1 at 2025-06-29T07:20:49.331Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords a36cad3b-ae23-40c7-8b1d-475a865de69a_1c938651-6ba2-41d3-b43c-064e1f55781a link v1 at 2025-06-29T07:20:49.331Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords a36cad3b-ae23-40c7-8b1d-475a865de69a_cab1aa15-8908-4230-a193-0888c77eac33 link v1 at 2025-06-29T07:20:49.331Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 1. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 1, UUID daeb75e6-8abd-44fc-a39c-db19e4eb2ddf
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions daeb75e6-8abd-44fc-a39c-db19e4eb2ddf create v1 at 2025-06-29T07:20:49.331Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media 31c3322c-44be-4b5f-8608-b1cbe236f6f4 create v1 at 2025-06-29T07:20:49.332Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 2: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 2
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword ',' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'e' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'o' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 's' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 't' already active.
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'w' UUID 10a37140-1e6c-4a0f-a8b2-d0182fcb7400
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 10a37140-1e6c-4a0f-a8b2-d0182fcb7400 create v1 at 2025-06-29T07:20:49.332Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 7
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 31c3322c-44be-4b5f-8608-b1cbe236f6f4_a2cf38aa-98e5-4781-ae9c-46c8e711d64b link v1 at 2025-06-29T07:20:49.332Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 31c3322c-44be-4b5f-8608-b1cbe236f6f4_b7b53f48-0a13-43a0-959c-fb656fd99a1d link v1 at 2025-06-29T07:20:49.332Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 31c3322c-44be-4b5f-8608-b1cbe236f6f4_ef048d9f-655e-4f32-83f4-13336b6dd2c8 link v1 at 2025-06-29T07:20:49.332Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 31c3322c-44be-4b5f-8608-b1cbe236f6f4_1c938651-6ba2-41d3-b43c-064e1f55781a link v1 at 2025-06-29T07:20:49.332Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 31c3322c-44be-4b5f-8608-b1cbe236f6f4_cab1aa15-8908-4230-a193-0888c77eac33 link v1 at 2025-06-29T07:20:49.332Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 31c3322c-44be-4b5f-8608-b1cbe236f6f4_10a37140-1e6c-4a0f-a8b2-d0182fcb7400 link v1 at 2025-06-29T07:20:49.332Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 2. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 2, UUID ec3a2beb-2743-4d7f-8d3b-4b5881afaad7
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions ec3a2beb-2743-4d7f-8d3b-4b5881afaad7 create v1 at 2025-06-29T07:20:49.332Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 3, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:50 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=4,level=0,tokens=6), 4, 5, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO: _setup_logging: Removed 5 pre-existing handler(s) from root logger.
INFO: _setup_logging: Root logger level set to DEBUG
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.code:10 - entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.fence:10 - entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.blockquote:13 - entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.hr:14 - entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.list:102 - entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.reference:10 - entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.html_block:35 - entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.heading:13 - entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.lheading:10 - entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
2025-06-29 00:20:51 [DEBUG   ] markdown_it.rules_block.paragraph:10 - entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
------------------------------ Captured log call -------------------------------
DEBUG    root:app.py:1289 App composing UI...
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 ChatWindow initialized.
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 CCPWindow initialized.
DEBUG    tldw_chatbook.UI.Ingest_Window:Logging_Config.py:160 IngestWindow initialized.
----------------------------------------

314. ERROR    root:metrics.py:99 Failed to log histogram app_compose_duration_seconds: No label names were set when constructing histogram:app_compose_duration_seconds
DEBUG    root:app.py:1329 App compose finished in 0.001 seconds
----------------------------------------

315. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

316. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 Composing ChatWindow UI
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:settings_sidebar.py:42 Sidebar chat: Received providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 'respond-for-me-button' composed.
DEBUG    tldw_chatbook.app:Logging_Config.py:160 Chat ephemeral state changed to: True
DEBUG    root:chat_right_sidebar.py:355 Character sidebar (id='chat-right-sidebar', prefix='chat') created with ephemeral state: True
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing CCPWindow UI
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing center pane
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing right pane
DEBUG    tldw_chatbook.UI.SearchRAGWindow:Logging_Config.py:160 Loaded 0 recent search queries
DEBUG    tldw_chatbook.UI.Ingest_Window:Logging_Config.py:160 Composing IngestWindow UI
INFO     root:Stats_screen.py:25 MetricsScreen initialized. Log path: /tmp/app_metrics.log
INFO     root:Stats_screen.py:76 MetricsScreen composing. Current metrics: {}
WARNING  root:Stats_screen.py:79 MetricsScreen compose: self.metrics is unexpectedly empty at compose time.
INFO     root:Stats_screen.py:93 MetricsScreen compose finished.
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:29 MetricsScreen on_mount: Calling load_metrics.
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:45 Attempting to load metrics from: /tmp/app_metrics.log
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
----------------------------------------

317. ERROR    root:Stats_screen.py:68 MetricsScreen: Log file not found at /tmp/app_metrics.log.
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     tldw_chatbook.UI.Coding_Window:Logging_Config.py:160 CodingWindow on_mount: UI composed
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    tldw_chatbook.UI.LLM_Management_Window:Logging_Config.py:160 LLMManagementWindow.on_mount called
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 3, False
INFO     tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 EvalsWindow on_mount: UI composed
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
----------------------------------------

318. ERROR    tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 Error initializing evaluation system: cannot import name 'EvaluationOrchestrator' from 'tldw_chatbook.Evals' (/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Evals/__init__.py)
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=4,level=0,tokens=6), 4, 5, False
INFO     tldw_chatbook.RAG_Search.Services.embeddings_service:Logging_Config.py:160 ChromaDB initialized at /Users/appledev/.local/share/tldw_cli/chromadb
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting and initializing initial active sub-tab.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-chat display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-creation display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-web-search display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initial active sub-tab set to search-view-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Added active class to nav button search-nav-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Set display=True for active view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initializing view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Initializing Embeddings Creation view.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation provider select changed to: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation model select changed to: e5-small-v2 for provider: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Provider specific inputs visibility updated. Custom HF: False, Local API URL: False (Value: '', Disabled: False)
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Logging_Config.py:137 --- _setup_logging START (from Logging_Config.py) ---
INFO     root:Logging_Config.py:145 Loguru: All pre-existing sinks removed.
INFO     root:Logging_Config.py:168 Loguru: Configured to forward its messages to standard Python logging system.
__________________________ test_media_load_for_review __________________________
Tests/Chat/test_chat_sidebar_media_search.py:233: in test_media_load_for_review
    load_button = app.query_one("#chat-media-load-selected-button", Button)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/textual/dom.py:1496: in query_one
    raise NoMatches(f"No nodes match {selector!r} on {self!r}")
E   textual.css.query.NoMatches: No nodes match '#chat-media-load-selected-button' on TldwCli(title='[B][N][S]  tldw CLI', classes={'-dark-mode'}, pseudo_classes={'dark', 'focus'})
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:20:54 [DEBUG   ] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

319. 2025-06-29 00:20:54 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

320. 2025-06-29 00:20:54 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

321. 2025-06-29 00:20:54 [ERROR   ] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:20:54 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

322. 2025-06-29 00:20:54 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

323. 2025-06-29 00:20:54 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:20:54 [DEBUG   ] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:20:54 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:20:54 [INFO    ] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:20:54 [INFO    ] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:20:54 [WARNING ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Database schema is up to date.
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Verified FTS tables exist.
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts Interop Library initialized successfully.
2025-06-29 00:20:54 [INFO    ] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:20:54 [INFO    ] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:20:54 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:20:54 [INFO    ] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:20:54 [DEBUG   ] root:750 - Database schema is up to date.
2025-06-29 00:20:54 [DEBUG   ] root:755 - Verified FTS tables exist.
2025-06-29 00:20:54 [DEBUG   ] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x173d01010>
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:20:54 [DEBUG   ] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

324. 2025-06-29 00:20:54 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

325. 2025-06-29 00:20:54 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:20:54 [INFO    ] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:20:54 [INFO    ] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

326. 2025-06-29 00:20:54 [ERROR   ] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 - Total initialization time: 0.007 seconds
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 -   basic_init: 0.003s (35.5%)
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 -   attribute_init: 0.000s (0.3%)
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 -   notes_service_init: 0.000s (3.5%)
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 -   providers_models: 0.002s (33.4%)
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 -   prompts_service_init: 0.001s (7.5%)
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 -   media_db_init: 0.001s (8.0%)
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.app:160 - ==============================
----------------------------------------

327. 2025-06-29 00:20:54 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

328. 2025-06-29 00:20:54 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:20:54 [INFO    ] root:444 - Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/media.db [Client ID: test_client_id]
2025-06-29 00:20:54 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/media.db [Client: test_client_id, Thread: MainThread]
2025-06-29 00:20:54 [INFO    ] root:747 - Checking DB schema. Current version: 0. Code supports: 1
2025-06-29 00:20:54 [INFO    ] root:680 - Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/media.db...
2025-06-29 00:20:54 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:20:54 [DEBUG   ] root:694 - [Schema V1] Applying Core Schema + Version Update...
2025-06-29 00:20:54 [DEBUG   ] root:696 - [Schema V1] Core Schema script (incl. version update) executed.
2025-06-29 00:20:54 [DEBUG   ] root:707 - [Schema V1] Media table structure validated successfully.
2025-06-29 00:20:54 [DEBUG   ] root:719 - [Schema V1] Version check inside transaction confirmed version is 1.
2025-06-29 00:20:54 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:20:54 [INFO    ] root:722 - [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/media.db.
2025-06-29 00:20:54 [DEBUG   ] root:726 - [Schema V1] Applying FTS Tables...
2025-06-29 00:20:54 [INFO    ] root:729 - [Schema V1] FTS Tables created successfully.
2025-06-29 00:20:54 [INFO    ] root:771 - Database schema initialized/migrated to version 1.
2025-06-29 00:20:54 [DEBUG   ] root:474 - Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/media.db
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db...
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db.
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db...
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db.
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db
2025-06-29 00:20:54 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
2025-06-29 00:20:54 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: Media 77fbe291-e393-40f9-807f-9f57dca84761 create v1 at 2025-06-29T07:20:54.110Z
2025-06-29 00:20:54 [DEBUG   ] root:919 - FTS update for media 1: sanitized content - null bytes replaced
2025-06-29 00:20:54 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 1
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword ',' UUID 84bc64a0-e6f7-4953-aea0-ff60ea8ab557
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: Keywords 84bc64a0-e6f7-4953-aea0-ff60ea8ab557 create v1 at 2025-06-29T07:20:54.110Z
2025-06-29 00:20:54 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 1
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'e' UUID daf09c57-9e73-4853-bac5-ae18b53bc39c
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: Keywords daf09c57-9e73-4853-bac5-ae18b53bc39c create v1 at 2025-06-29T07:20:54.110Z
2025-06-29 00:20:54 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 2
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'n' UUID 40c773c5-3211-40cc-a3f2-292ffd316eae
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: Keywords 40c773c5-3211-40cc-a3f2-292ffd316eae create v1 at 2025-06-29T07:20:54.110Z
2025-06-29 00:20:54 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 3
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'o' UUID 1bcdb818-ac52-4512-87d0-b0058bc1e1f5
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: Keywords 1bcdb818-ac52-4512-87d0-b0058bc1e1f5 create v1 at 2025-06-29T07:20:54.110Z
2025-06-29 00:20:54 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 4
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 's' UUID 3bcebd97-d6d7-4f67-b070-0dfe3724278e
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: Keywords 3bcebd97-d6d7-4f67-b070-0dfe3724278e create v1 at 2025-06-29T07:20:54.110Z
2025-06-29 00:20:54 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 5
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 't' UUID b9b73be4-f236-49c3-ad4e-2518b872e63f
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: Keywords b9b73be4-f236-49c3-ad4e-2518b872e63f create v1 at 2025-06-29T07:20:54.110Z
2025-06-29 00:20:54 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 6
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 77fbe291-e393-40f9-807f-9f57dca84761_84bc64a0-e6f7-4953-aea0-ff60ea8ab557 link v1 at 2025-06-29T07:20:54.110Z
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 77fbe291-e393-40f9-807f-9f57dca84761_daf09c57-9e73-4853-bac5-ae18b53bc39c link v1 at 2025-06-29T07:20:54.111Z
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 77fbe291-e393-40f9-807f-9f57dca84761_40c773c5-3211-40cc-a3f2-292ffd316eae link v1 at 2025-06-29T07:20:54.111Z
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 77fbe291-e393-40f9-807f-9f57dca84761_1bcdb818-ac52-4512-87d0-b0058bc1e1f5 link v1 at 2025-06-29T07:20:54.111Z
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 77fbe291-e393-40f9-807f-9f57dca84761_3bcebd97-d6d7-4f67-b070-0dfe3724278e link v1 at 2025-06-29T07:20:54.111Z
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 77fbe291-e393-40f9-807f-9f57dca84761_b9b73be4-f236-49c3-ad4e-2518b872e63f link v1 at 2025-06-29T07:20:54.111Z
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 1. Added: 6, Removed: 0.
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 1, UUID 7c156a3f-79fe-48cc-94c6-8410b94310ad
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: DocumentVersions 7c156a3f-79fe-48cc-94c6-8410b94310ad create v1 at 2025-06-29T07:20:54.111Z
2025-06-29 00:20:54 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:20:54 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
2025-06-29 00:20:54 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: Media faac2309-162d-4c49-8b63-5054f69495ec create v1 at 2025-06-29T07:20:54.111Z
2025-06-29 00:20:54 [DEBUG   ] root:919 - FTS update for media 2: sanitized content - null bytes replaced
2025-06-29 00:20:54 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 2
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword ',' already active.
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'e' already active.
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'o' already active.
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 's' already active.
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 't' already active.
2025-06-29 00:20:54 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'w' UUID eaaad038-6543-44be-a266-bfaa62ebb65e
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: Keywords eaaad038-6543-44be-a266-bfaa62ebb65e create v1 at 2025-06-29T07:20:54.112Z
2025-06-29 00:20:54 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 7
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: MediaKeywords faac2309-162d-4c49-8b63-5054f69495ec_84bc64a0-e6f7-4953-aea0-ff60ea8ab557 link v1 at 2025-06-29T07:20:54.112Z
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: MediaKeywords faac2309-162d-4c49-8b63-5054f69495ec_daf09c57-9e73-4853-bac5-ae18b53bc39c link v1 at 2025-06-29T07:20:54.112Z
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: MediaKeywords faac2309-162d-4c49-8b63-5054f69495ec_1bcdb818-ac52-4512-87d0-b0058bc1e1f5 link v1 at 2025-06-29T07:20:54.112Z
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: MediaKeywords faac2309-162d-4c49-8b63-5054f69495ec_3bcebd97-d6d7-4f67-b070-0dfe3724278e link v1 at 2025-06-29T07:20:54.112Z
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: MediaKeywords faac2309-162d-4c49-8b63-5054f69495ec_b9b73be4-f236-49c3-ad4e-2518b872e63f link v1 at 2025-06-29T07:20:54.112Z
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: MediaKeywords faac2309-162d-4c49-8b63-5054f69495ec_eaaad038-6543-44be-a266-bfaa62ebb65e link v1 at 2025-06-29T07:20:54.112Z
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 2. Added: 6, Removed: 0.
2025-06-29 00:20:54 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 2, UUID b36d6986-85be-46ae-9d18-41a97bbcb339
2025-06-29 00:20:54 [DEBUG   ] root:891 - Logged sync event: DocumentVersions b36d6986-85be-46ae-9d18-41a97bbcb339 create v1 at 2025-06-29T07:20:54.112Z
2025-06-29 00:20:54 [DEBUG   ] root:652 - Committed transaction.
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

329. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

330. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

331. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     tldw_chatbook.app:Logging_Config.py:160 Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

332. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

333. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
WARNING  tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Checking DB schema. Current: 1, Code supports: 1
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Database schema is up to date.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Verified FTS tables exist.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts Interop Library initialized successfully.
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x173d01010>
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Found 3 distinct media types: ['article', 'podcast', 'video']
INFO     tldw_chatbook.app:Logging_Config.py:160 App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

334. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

335. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

336. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
INFO     tldw_chatbook.app:Logging_Config.py:160 === STARTUP TIMING SUMMARY ===
INFO     tldw_chatbook.app:Logging_Config.py:160 Total initialization time: 0.007 seconds
INFO     tldw_chatbook.app:Logging_Config.py:160   basic_init: 0.003s (35.5%)
INFO     tldw_chatbook.app:Logging_Config.py:160   attribute_init: 0.000s (0.3%)
INFO     tldw_chatbook.app:Logging_Config.py:160   notes_service_init: 0.000s (3.5%)
INFO     tldw_chatbook.app:Logging_Config.py:160   providers_models: 0.002s (33.4%)
INFO     tldw_chatbook.app:Logging_Config.py:160   prompts_service_init: 0.001s (7.5%)
INFO     tldw_chatbook.app:Logging_Config.py:160   media_db_init: 0.001s (8.0%)
INFO     tldw_chatbook.app:Logging_Config.py:160 ==============================
----------------------------------------

337. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

338. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/media.db [Client ID: test_client_id]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/media.db [Client: test_client_id, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 0. Code supports: 1
INFO     root:Client_Media_DB_v2.py:680 Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/media.db...
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:694 [Schema V1] Applying Core Schema + Version Update...
DEBUG    root:Client_Media_DB_v2.py:696 [Schema V1] Core Schema script (incl. version update) executed.
DEBUG    root:Client_Media_DB_v2.py:707 [Schema V1] Media table structure validated successfully.
DEBUG    root:Client_Media_DB_v2.py:719 [Schema V1] Version check inside transaction confirmed version is 1.
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:722 [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/media.db.
DEBUG    root:Client_Media_DB_v2.py:726 [Schema V1] Applying FTS Tables...
INFO     root:Client_Media_DB_v2.py:729 [Schema V1] FTS Tables created successfully.
INFO     root:Client_Media_DB_v2.py:771 Database schema initialized/migrated to version 1.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/media.db
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db [Client ID: test_user]
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db (Journal: wal) for thread 8705548032
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction started (outermost) on thread 8705548032.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Full schema script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction (outermost) committed successfully on thread 8705548032.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_load_for_review0/db/chachanotes.db
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media 77fbe291-e393-40f9-807f-9f57dca84761 create v1 at 2025-06-29T07:20:54.110Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 1: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword ',' UUID 84bc64a0-e6f7-4953-aea0-ff60ea8ab557
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 84bc64a0-e6f7-4953-aea0-ff60ea8ab557 create v1 at 2025-06-29T07:20:54.110Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'e' UUID daf09c57-9e73-4853-bac5-ae18b53bc39c
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords daf09c57-9e73-4853-bac5-ae18b53bc39c create v1 at 2025-06-29T07:20:54.110Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 2
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'n' UUID 40c773c5-3211-40cc-a3f2-292ffd316eae
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 40c773c5-3211-40cc-a3f2-292ffd316eae create v1 at 2025-06-29T07:20:54.110Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 3
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'o' UUID 1bcdb818-ac52-4512-87d0-b0058bc1e1f5
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 1bcdb818-ac52-4512-87d0-b0058bc1e1f5 create v1 at 2025-06-29T07:20:54.110Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 4
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 's' UUID 3bcebd97-d6d7-4f67-b070-0dfe3724278e
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 3bcebd97-d6d7-4f67-b070-0dfe3724278e create v1 at 2025-06-29T07:20:54.110Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 5
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 't' UUID b9b73be4-f236-49c3-ad4e-2518b872e63f
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords b9b73be4-f236-49c3-ad4e-2518b872e63f create v1 at 2025-06-29T07:20:54.110Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 6
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 77fbe291-e393-40f9-807f-9f57dca84761_84bc64a0-e6f7-4953-aea0-ff60ea8ab557 link v1 at 2025-06-29T07:20:54.110Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 77fbe291-e393-40f9-807f-9f57dca84761_daf09c57-9e73-4853-bac5-ae18b53bc39c link v1 at 2025-06-29T07:20:54.111Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 77fbe291-e393-40f9-807f-9f57dca84761_40c773c5-3211-40cc-a3f2-292ffd316eae link v1 at 2025-06-29T07:20:54.111Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 77fbe291-e393-40f9-807f-9f57dca84761_1bcdb818-ac52-4512-87d0-b0058bc1e1f5 link v1 at 2025-06-29T07:20:54.111Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 77fbe291-e393-40f9-807f-9f57dca84761_3bcebd97-d6d7-4f67-b070-0dfe3724278e link v1 at 2025-06-29T07:20:54.111Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 77fbe291-e393-40f9-807f-9f57dca84761_b9b73be4-f236-49c3-ad4e-2518b872e63f link v1 at 2025-06-29T07:20:54.111Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 1. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 1, UUID 7c156a3f-79fe-48cc-94c6-8410b94310ad
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions 7c156a3f-79fe-48cc-94c6-8410b94310ad create v1 at 2025-06-29T07:20:54.111Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media faac2309-162d-4c49-8b63-5054f69495ec create v1 at 2025-06-29T07:20:54.111Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 2: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 2
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword ',' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'e' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'o' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 's' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 't' already active.
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'w' UUID eaaad038-6543-44be-a266-bfaa62ebb65e
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords eaaad038-6543-44be-a266-bfaa62ebb65e create v1 at 2025-06-29T07:20:54.112Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 7
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords faac2309-162d-4c49-8b63-5054f69495ec_84bc64a0-e6f7-4953-aea0-ff60ea8ab557 link v1 at 2025-06-29T07:20:54.112Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords faac2309-162d-4c49-8b63-5054f69495ec_daf09c57-9e73-4853-bac5-ae18b53bc39c link v1 at 2025-06-29T07:20:54.112Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords faac2309-162d-4c49-8b63-5054f69495ec_1bcdb818-ac52-4512-87d0-b0058bc1e1f5 link v1 at 2025-06-29T07:20:54.112Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords faac2309-162d-4c49-8b63-5054f69495ec_3bcebd97-d6d7-4f67-b070-0dfe3724278e link v1 at 2025-06-29T07:20:54.112Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords faac2309-162d-4c49-8b63-5054f69495ec_b9b73be4-f236-49c3-ad4e-2518b872e63f link v1 at 2025-06-29T07:20:54.112Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords faac2309-162d-4c49-8b63-5054f69495ec_eaaad038-6543-44be-a266-bfaa62ebb65e link v1 at 2025-06-29T07:20:54.112Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 2. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 2, UUID b36d6986-85be-46ae-9d18-41a97bbcb339
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions b36d6986-85be-46ae-9d18-41a97bbcb339 create v1 at 2025-06-29T07:20:54.112Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
----------------------------- Captured stderr call -----------------------------
----------------------------------------

339. !!! CRITICAL ERROR in RichLog processor: Event loop is closed
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/queues.py", line 158, in get
    await getter
GeneratorExit
----------------------------------------

340. ERROR    root:metrics.py:99 Failed to log histogram app_compose_duration_seconds: No label names were set when constructing histogram:app_compose_duration_seconds
DEBUG    root:app.py:1329 App compose finished in 0.001 seconds
----------------------------------------

341. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

342. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 Composing ChatWindow UI
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:settings_sidebar.py:42 Sidebar chat: Received providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 'respond-for-me-button' composed.
DEBUG    tldw_chatbook.app:Logging_Config.py:160 Chat ephemeral state changed to: True
DEBUG    root:chat_right_sidebar.py:355 Character sidebar (id='chat-right-sidebar', prefix='chat') created with ephemeral state: True
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing CCPWindow UI
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing center pane
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing right pane
DEBUG    tldw_chatbook.UI.SearchRAGWindow:Logging_Config.py:160 Loaded 0 recent search queries
DEBUG    tldw_chatbook.UI.Ingest_Window:Logging_Config.py:160 Composing IngestWindow UI
INFO     root:Stats_screen.py:25 MetricsScreen initialized. Log path: /tmp/app_metrics.log
INFO     root:Stats_screen.py:76 MetricsScreen composing. Current metrics: {}
WARNING  root:Stats_screen.py:79 MetricsScreen compose: self.metrics is unexpectedly empty at compose time.
INFO     root:Stats_screen.py:93 MetricsScreen compose finished.
----------------------------------------

343. ERROR    asyncio:base_events.py:1833 Task was destroyed but it is pending!
task: <Task pending name='RichLogProcessor' coro=<RichLogHandler._process_log_queue() running at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Logging_Config.py:78> wait_for=<Future pending cb=[Task.task_wakeup()]>>
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:29 MetricsScreen on_mount: Calling load_metrics.
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:45 Attempting to load metrics from: /tmp/app_metrics.log
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
----------------------------------------

344. ERROR    root:Stats_screen.py:68 MetricsScreen: Log file not found at /tmp/app_metrics.log.
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 5, False
INFO     tldw_chatbook.UI.Coding_Window:Logging_Config.py:160 CodingWindow on_mount: UI composed
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    tldw_chatbook.UI.LLM_Management_Window:Logging_Config.py:160 LLMManagementWindow.on_mount called
INFO     tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 EvalsWindow on_mount: UI composed
----------------------------------------

345. ERROR    tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 Error initializing evaluation system: cannot import name 'EvaluationOrchestrator' from 'tldw_chatbook.Evals' (/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Evals/__init__.py)
INFO     tldw_chatbook.RAG_Search.Services.embeddings_service:Logging_Config.py:160 ChromaDB initialized at /Users/appledev/.local/share/tldw_cli/chromadb
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting and initializing initial active sub-tab.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-chat display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-creation display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-web-search display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initial active sub-tab set to search-view-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Added active class to nav button search-nav-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Set display=True for active view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initializing view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Initializing Embeddings Creation view.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation provider select changed to: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation model select changed to: e5-small-v2 for provider: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Provider specific inputs visibility updated. Custom HF: False, Local API URL: False (Value: '', Disabled: False)
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Logging_Config.py:137 --- _setup_logging START (from Logging_Config.py) ---
INFO     root:Logging_Config.py:145 Loguru: All pre-existing sinks removed.
INFO     root:Logging_Config.py:168 Loguru: Configured to forward its messages to standard Python logging system.
_ test_media_copy_buttons[chat-media-copy-title-button-title-Title copied to clipboard.] _
Tests/Chat/test_chat_sidebar_media_search.py:287: in test_media_copy_buttons
    load_button = app.query_one("#chat-media-load-selected-button", Button)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/textual/dom.py:1496: in query_one
    raise NoMatches(f"No nodes match {selector!r} on {self!r}")
E   textual.css.query.NoMatches: No nodes match '#chat-media-load-selected-button' on TldwCli(title='[B][N][S]  tldw CLI', classes={'-dark-mode'}, pseudo_classes={'dark', 'focus'})
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:20:58 [DEBUG   ] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

346. 2025-06-29 00:20:58 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

347. 2025-06-29 00:20:58 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

348. 2025-06-29 00:20:58 [ERROR   ] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:20:58 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

349. 2025-06-29 00:20:58 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

350. 2025-06-29 00:20:58 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:20:58 [DEBUG   ] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:20:58 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:20:58 [INFO    ] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:20:58 [INFO    ] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:20:58 [WARNING ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Database schema is up to date.
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Verified FTS tables exist.
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts Interop Library initialized successfully.
2025-06-29 00:20:58 [INFO    ] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:20:58 [INFO    ] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:20:58 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:20:58 [INFO    ] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:20:58 [DEBUG   ] root:750 - Database schema is up to date.
2025-06-29 00:20:58 [DEBUG   ] root:755 - Verified FTS tables exist.
2025-06-29 00:20:58 [DEBUG   ] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x17d7964b0>
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:20:58 [DEBUG   ] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

351. 2025-06-29 00:20:58 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

352. 2025-06-29 00:20:58 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:20:58 [INFO    ] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:20:58 [INFO    ] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

353. 2025-06-29 00:20:58 [ERROR   ] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 - Total initialization time: 0.007 seconds
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 -   basic_init: 0.002s (34.0%)
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 -   attribute_init: 0.000s (0.2%)
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 -   notes_service_init: 0.000s (3.6%)
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 -   providers_models: 0.002s (33.8%)
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 -   prompts_service_init: 0.001s (8.3%)
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 -   media_db_init: 0.001s (8.4%)
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.app:160 - ==============================
----------------------------------------

354. 2025-06-29 00:20:58 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

355. 2025-06-29 00:20:58 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:20:58 [INFO    ] root:444 - Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/media.db [Client ID: test_client_id]
2025-06-29 00:20:58 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/media.db [Client: test_client_id, Thread: MainThread]
2025-06-29 00:20:58 [INFO    ] root:747 - Checking DB schema. Current version: 0. Code supports: 1
2025-06-29 00:20:58 [INFO    ] root:680 - Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/media.db...
2025-06-29 00:20:58 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:20:58 [DEBUG   ] root:694 - [Schema V1] Applying Core Schema + Version Update...
2025-06-29 00:20:58 [DEBUG   ] root:696 - [Schema V1] Core Schema script (incl. version update) executed.
2025-06-29 00:20:58 [DEBUG   ] root:707 - [Schema V1] Media table structure validated successfully.
2025-06-29 00:20:58 [DEBUG   ] root:719 - [Schema V1] Version check inside transaction confirmed version is 1.
2025-06-29 00:20:58 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:20:58 [INFO    ] root:722 - [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/media.db.
2025-06-29 00:20:58 [DEBUG   ] root:726 - [Schema V1] Applying FTS Tables...
2025-06-29 00:20:58 [INFO    ] root:729 - [Schema V1] FTS Tables created successfully.
2025-06-29 00:20:58 [INFO    ] root:771 - Database schema initialized/migrated to version 1.
2025-06-29 00:20:58 [DEBUG   ] root:474 - Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/media.db
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db...
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db.
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db...
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db.
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db
2025-06-29 00:20:58 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
2025-06-29 00:20:58 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: Media 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a create v1 at 2025-06-29T07:20:58.972Z
2025-06-29 00:20:58 [DEBUG   ] root:919 - FTS update for media 1: sanitized content - null bytes replaced
2025-06-29 00:20:58 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 1
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword ',' UUID 94dc1f63-b568-4d25-8520-e14cb1d12a15
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: Keywords 94dc1f63-b568-4d25-8520-e14cb1d12a15 create v1 at 2025-06-29T07:20:58.972Z
2025-06-29 00:20:58 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 1
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'e' UUID a505853b-38da-41b4-abbb-2143a2a068e8
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: Keywords a505853b-38da-41b4-abbb-2143a2a068e8 create v1 at 2025-06-29T07:20:58.972Z
2025-06-29 00:20:58 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 2
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'n' UUID cc9be1ab-5045-4e86-b371-0c525b8690e9
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: Keywords cc9be1ab-5045-4e86-b371-0c525b8690e9 create v1 at 2025-06-29T07:20:58.973Z
2025-06-29 00:20:58 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 3
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'o' UUID f4ca4805-96f2-4e53-8415-d2d554e4cb41
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: Keywords f4ca4805-96f2-4e53-8415-d2d554e4cb41 create v1 at 2025-06-29T07:20:58.973Z
2025-06-29 00:20:58 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 4
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 's' UUID 356a359c-0101-47d2-9c32-e7a5b3d06c1e
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: Keywords 356a359c-0101-47d2-9c32-e7a5b3d06c1e create v1 at 2025-06-29T07:20:58.973Z
2025-06-29 00:20:58 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 5
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 't' UUID 89b9ce1e-a9e0-41c3-9c07-b9c9fcdf590e
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: Keywords 89b9ce1e-a9e0-41c3-9c07-b9c9fcdf590e create v1 at 2025-06-29T07:20:58.973Z
2025-06-29 00:20:58 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 6
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a_94dc1f63-b568-4d25-8520-e14cb1d12a15 link v1 at 2025-06-29T07:20:58.973Z
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a_a505853b-38da-41b4-abbb-2143a2a068e8 link v1 at 2025-06-29T07:20:58.973Z
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a_cc9be1ab-5045-4e86-b371-0c525b8690e9 link v1 at 2025-06-29T07:20:58.973Z
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a_f4ca4805-96f2-4e53-8415-d2d554e4cb41 link v1 at 2025-06-29T07:20:58.973Z
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a_356a359c-0101-47d2-9c32-e7a5b3d06c1e link v1 at 2025-06-29T07:20:58.973Z
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a_89b9ce1e-a9e0-41c3-9c07-b9c9fcdf590e link v1 at 2025-06-29T07:20:58.973Z
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 1. Added: 6, Removed: 0.
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 1, UUID 74d4c346-784b-4ae3-94b6-c61edbd20de1
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: DocumentVersions 74d4c346-784b-4ae3-94b6-c61edbd20de1 create v1 at 2025-06-29T07:20:58.973Z
2025-06-29 00:20:58 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:20:58 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
2025-06-29 00:20:58 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: Media d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c create v1 at 2025-06-29T07:20:58.974Z
2025-06-29 00:20:58 [DEBUG   ] root:919 - FTS update for media 2: sanitized content - null bytes replaced
2025-06-29 00:20:58 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 2
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword ',' already active.
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'e' already active.
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'o' already active.
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 's' already active.
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 't' already active.
2025-06-29 00:20:58 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'w' UUID 9988fa45-c9a5-4279-9762-fe0263525ab3
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: Keywords 9988fa45-c9a5-4279-9762-fe0263525ab3 create v1 at 2025-06-29T07:20:58.974Z
2025-06-29 00:20:58 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 7
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c_94dc1f63-b568-4d25-8520-e14cb1d12a15 link v1 at 2025-06-29T07:20:58.974Z
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c_a505853b-38da-41b4-abbb-2143a2a068e8 link v1 at 2025-06-29T07:20:58.974Z
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c_f4ca4805-96f2-4e53-8415-d2d554e4cb41 link v1 at 2025-06-29T07:20:58.974Z
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c_356a359c-0101-47d2-9c32-e7a5b3d06c1e link v1 at 2025-06-29T07:20:58.974Z
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c_89b9ce1e-a9e0-41c3-9c07-b9c9fcdf590e link v1 at 2025-06-29T07:20:58.974Z
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c_9988fa45-c9a5-4279-9762-fe0263525ab3 link v1 at 2025-06-29T07:20:58.974Z
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 2. Added: 6, Removed: 0.
2025-06-29 00:20:58 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 2, UUID 7b4ea68b-d2da-4b5d-b3cf-d3b14404f002
2025-06-29 00:20:58 [DEBUG   ] root:891 - Logged sync event: DocumentVersions 7b4ea68b-d2da-4b5d-b3cf-d3b14404f002 create v1 at 2025-06-29T07:20:58.974Z
2025-06-29 00:20:58 [DEBUG   ] root:652 - Committed transaction.
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

356. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

357. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

358. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     tldw_chatbook.app:Logging_Config.py:160 Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

359. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

360. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
WARNING  tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Checking DB schema. Current: 1, Code supports: 1
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Database schema is up to date.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Verified FTS tables exist.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts Interop Library initialized successfully.
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x17d7964b0>
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Found 3 distinct media types: ['article', 'podcast', 'video']
INFO     tldw_chatbook.app:Logging_Config.py:160 App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

361. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

362. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

363. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
INFO     tldw_chatbook.app:Logging_Config.py:160 === STARTUP TIMING SUMMARY ===
INFO     tldw_chatbook.app:Logging_Config.py:160 Total initialization time: 0.007 seconds
INFO     tldw_chatbook.app:Logging_Config.py:160   basic_init: 0.002s (34.0%)
INFO     tldw_chatbook.app:Logging_Config.py:160   attribute_init: 0.000s (0.2%)
INFO     tldw_chatbook.app:Logging_Config.py:160   notes_service_init: 0.000s (3.6%)
INFO     tldw_chatbook.app:Logging_Config.py:160   providers_models: 0.002s (33.8%)
INFO     tldw_chatbook.app:Logging_Config.py:160   prompts_service_init: 0.001s (8.3%)
INFO     tldw_chatbook.app:Logging_Config.py:160   media_db_init: 0.001s (8.4%)
INFO     tldw_chatbook.app:Logging_Config.py:160 ==============================
----------------------------------------

364. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

365. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/media.db [Client ID: test_client_id]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/media.db [Client: test_client_id, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 0. Code supports: 1
INFO     root:Client_Media_DB_v2.py:680 Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/media.db...
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:694 [Schema V1] Applying Core Schema + Version Update...
DEBUG    root:Client_Media_DB_v2.py:696 [Schema V1] Core Schema script (incl. version update) executed.
DEBUG    root:Client_Media_DB_v2.py:707 [Schema V1] Media table structure validated successfully.
DEBUG    root:Client_Media_DB_v2.py:719 [Schema V1] Version check inside transaction confirmed version is 1.
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:722 [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/media.db.
DEBUG    root:Client_Media_DB_v2.py:726 [Schema V1] Applying FTS Tables...
INFO     root:Client_Media_DB_v2.py:729 [Schema V1] FTS Tables created successfully.
INFO     root:Client_Media_DB_v2.py:771 Database schema initialized/migrated to version 1.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/media.db
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db [Client ID: test_user]
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db (Journal: wal) for thread 8705548032
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction started (outermost) on thread 8705548032.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Full schema script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction (outermost) committed successfully on thread 8705548032.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m0/db/chachanotes.db
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a create v1 at 2025-06-29T07:20:58.972Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 1: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword ',' UUID 94dc1f63-b568-4d25-8520-e14cb1d12a15
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 94dc1f63-b568-4d25-8520-e14cb1d12a15 create v1 at 2025-06-29T07:20:58.972Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'e' UUID a505853b-38da-41b4-abbb-2143a2a068e8
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords a505853b-38da-41b4-abbb-2143a2a068e8 create v1 at 2025-06-29T07:20:58.972Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 2
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'n' UUID cc9be1ab-5045-4e86-b371-0c525b8690e9
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords cc9be1ab-5045-4e86-b371-0c525b8690e9 create v1 at 2025-06-29T07:20:58.973Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 3
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'o' UUID f4ca4805-96f2-4e53-8415-d2d554e4cb41
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords f4ca4805-96f2-4e53-8415-d2d554e4cb41 create v1 at 2025-06-29T07:20:58.973Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 4
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 's' UUID 356a359c-0101-47d2-9c32-e7a5b3d06c1e
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 356a359c-0101-47d2-9c32-e7a5b3d06c1e create v1 at 2025-06-29T07:20:58.973Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 5
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 't' UUID 89b9ce1e-a9e0-41c3-9c07-b9c9fcdf590e
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 89b9ce1e-a9e0-41c3-9c07-b9c9fcdf590e create v1 at 2025-06-29T07:20:58.973Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 6
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a_94dc1f63-b568-4d25-8520-e14cb1d12a15 link v1 at 2025-06-29T07:20:58.973Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a_a505853b-38da-41b4-abbb-2143a2a068e8 link v1 at 2025-06-29T07:20:58.973Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a_cc9be1ab-5045-4e86-b371-0c525b8690e9 link v1 at 2025-06-29T07:20:58.973Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a_f4ca4805-96f2-4e53-8415-d2d554e4cb41 link v1 at 2025-06-29T07:20:58.973Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a_356a359c-0101-47d2-9c32-e7a5b3d06c1e link v1 at 2025-06-29T07:20:58.973Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 2b0fe729-cfb4-494d-9ee8-f4338d0d5b5a_89b9ce1e-a9e0-41c3-9c07-b9c9fcdf590e link v1 at 2025-06-29T07:20:58.973Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 1. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 1, UUID 74d4c346-784b-4ae3-94b6-c61edbd20de1
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions 74d4c346-784b-4ae3-94b6-c61edbd20de1 create v1 at 2025-06-29T07:20:58.973Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c create v1 at 2025-06-29T07:20:58.974Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 2: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 2
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword ',' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'e' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'o' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 's' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 't' already active.
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'w' UUID 9988fa45-c9a5-4279-9762-fe0263525ab3
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 9988fa45-c9a5-4279-9762-fe0263525ab3 create v1 at 2025-06-29T07:20:58.974Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 7
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c_94dc1f63-b568-4d25-8520-e14cb1d12a15 link v1 at 2025-06-29T07:20:58.974Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c_a505853b-38da-41b4-abbb-2143a2a068e8 link v1 at 2025-06-29T07:20:58.974Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c_f4ca4805-96f2-4e53-8415-d2d554e4cb41 link v1 at 2025-06-29T07:20:58.974Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c_356a359c-0101-47d2-9c32-e7a5b3d06c1e link v1 at 2025-06-29T07:20:58.974Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c_89b9ce1e-a9e0-41c3-9c07-b9c9fcdf590e link v1 at 2025-06-29T07:20:58.974Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d7d8f4ef-7caa-4b4f-a4e9-6da99750b39c_9988fa45-c9a5-4279-9762-fe0263525ab3 link v1 at 2025-06-29T07:20:58.974Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 2. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 2, UUID 7b4ea68b-d2da-4b5d-b3cf-d3b14404f002
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions 7b4ea68b-d2da-4b5d-b3cf-d3b14404f002 create v1 at 2025-06-29T07:20:58.974Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
----------------------------- Captured stderr call -----------------------------
----------------------------------------

366. !!! CRITICAL ERROR in RichLog processor: Event loop is closed
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/queues.py", line 158, in get
    await getter
GeneratorExit
----------------------------------------

367. ERROR    root:metrics.py:99 Failed to log histogram app_compose_duration_seconds: No label names were set when constructing histogram:app_compose_duration_seconds
DEBUG    root:app.py:1329 App compose finished in 0.001 seconds
----------------------------------------

368. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

369. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 Composing ChatWindow UI
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:settings_sidebar.py:42 Sidebar chat: Received providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 'respond-for-me-button' composed.
DEBUG    tldw_chatbook.app:Logging_Config.py:160 Chat ephemeral state changed to: True
DEBUG    root:chat_right_sidebar.py:355 Character sidebar (id='chat-right-sidebar', prefix='chat') created with ephemeral state: True
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing CCPWindow UI
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing center pane
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing right pane
DEBUG    tldw_chatbook.UI.SearchRAGWindow:Logging_Config.py:160 Loaded 0 recent search queries
DEBUG    tldw_chatbook.UI.Ingest_Window:Logging_Config.py:160 Composing IngestWindow UI
----------------------------------------

370. ERROR    asyncio:base_events.py:1833 Task was destroyed but it is pending!
task: <Task pending name='RichLogProcessor' coro=<RichLogHandler._process_log_queue() running at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Logging_Config.py:78> wait_for=<Future pending cb=[Task.task_wakeup()]>>
INFO     root:Stats_screen.py:25 MetricsScreen initialized. Log path: /tmp/app_metrics.log
INFO     root:Stats_screen.py:76 MetricsScreen composing. Current metrics: {}
WARNING  root:Stats_screen.py:79 MetricsScreen compose: self.metrics is unexpectedly empty at compose time.
INFO     root:Stats_screen.py:93 MetricsScreen compose finished.
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:29 MetricsScreen on_mount: Calling load_metrics.
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:45 Attempting to load metrics from: /tmp/app_metrics.log
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
----------------------------------------

371. ERROR    root:Stats_screen.py:68 MetricsScreen: Log file not found at /tmp/app_metrics.log.
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     tldw_chatbook.UI.Coding_Window:Logging_Config.py:160 CodingWindow on_mount: UI composed
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    tldw_chatbook.UI.LLM_Management_Window:Logging_Config.py:160 LLMManagementWindow.on_mount called
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
INFO     tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 EvalsWindow on_mount: UI composed
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=4,level=0,tokens=6), 4, 5, False
----------------------------------------

372. ERROR    tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 Error initializing evaluation system: cannot import name 'EvaluationOrchestrator' from 'tldw_chatbook.Evals' (/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Evals/__init__.py)
INFO     tldw_chatbook.RAG_Search.Services.embeddings_service:Logging_Config.py:160 ChromaDB initialized at /Users/appledev/.local/share/tldw_cli/chromadb
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting and initializing initial active sub-tab.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-chat display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-creation display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-web-search display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initial active sub-tab set to search-view-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Added active class to nav button search-nav-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Set display=True for active view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initializing view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Initializing Embeddings Creation view.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation provider select changed to: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation model select changed to: e5-small-v2 for provider: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Provider specific inputs visibility updated. Custom HF: False, Local API URL: False (Value: '', Disabled: False)
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Logging_Config.py:137 --- _setup_logging START (from Logging_Config.py) ---
INFO     root:Logging_Config.py:145 Loguru: All pre-existing sinks removed.
INFO     root:Logging_Config.py:168 Loguru: Configured to forward its messages to standard Python logging system.
_ test_media_copy_buttons[chat-media-copy-content-button-content-Content copied to clipboard.] _
Tests/Chat/test_chat_sidebar_media_search.py:287: in test_media_copy_buttons
    load_button = app.query_one("#chat-media-load-selected-button", Button)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/textual/dom.py:1496: in query_one
    raise NoMatches(f"No nodes match {selector!r} on {self!r}")
E   textual.css.query.NoMatches: No nodes match '#chat-media-load-selected-button' on TldwCli(title='[B][N][S]  tldw CLI', classes={'-dark-mode'}, pseudo_classes={'dark', 'focus'})
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:21:04 [DEBUG   ] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

373. 2025-06-29 00:21:04 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

374. 2025-06-29 00:21:04 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

375. 2025-06-29 00:21:04 [ERROR   ] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:04 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

376. 2025-06-29 00:21:04 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

377. 2025-06-29 00:21:04 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:04 [DEBUG   ] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:04 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:04 [INFO    ] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:21:04 [INFO    ] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:21:04 [WARNING ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Database schema is up to date.
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Verified FTS tables exist.
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts Interop Library initialized successfully.
2025-06-29 00:21:04 [INFO    ] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:04 [INFO    ] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:21:04 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:21:04 [INFO    ] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:21:04 [DEBUG   ] root:750 - Database schema is up to date.
2025-06-29 00:21:04 [DEBUG   ] root:755 - Verified FTS tables exist.
2025-06-29 00:21:04 [DEBUG   ] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x17372b530>
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:21:04 [DEBUG   ] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

378. 2025-06-29 00:21:04 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

379. 2025-06-29 00:21:04 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:21:04 [INFO    ] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:21:04 [INFO    ] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

380. 2025-06-29 00:21:04 [ERROR   ] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 - Total initialization time: 0.008 seconds
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 -   basic_init: 0.002s (31.0%)
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 -   attribute_init: 0.000s (0.2%)
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 -   notes_service_init: 0.000s (3.1%)
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 -   providers_models: 0.003s (39.6%)
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 -   prompts_service_init: 0.001s (6.8%)
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 -   media_db_init: 0.001s (7.2%)
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.app:160 - ==============================
----------------------------------------

381. 2025-06-29 00:21:04 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

382. 2025-06-29 00:21:04 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:04 [INFO    ] root:444 - Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/media.db [Client ID: test_client_id]
2025-06-29 00:21:04 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/media.db [Client: test_client_id, Thread: MainThread]
2025-06-29 00:21:04 [INFO    ] root:747 - Checking DB schema. Current version: 0. Code supports: 1
2025-06-29 00:21:04 [INFO    ] root:680 - Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/media.db...
2025-06-29 00:21:04 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:04 [DEBUG   ] root:694 - [Schema V1] Applying Core Schema + Version Update...
2025-06-29 00:21:04 [DEBUG   ] root:696 - [Schema V1] Core Schema script (incl. version update) executed.
2025-06-29 00:21:04 [DEBUG   ] root:707 - [Schema V1] Media table structure validated successfully.
2025-06-29 00:21:04 [DEBUG   ] root:719 - [Schema V1] Version check inside transaction confirmed version is 1.
2025-06-29 00:21:04 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:21:04 [INFO    ] root:722 - [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/media.db.
2025-06-29 00:21:04 [DEBUG   ] root:726 - [Schema V1] Applying FTS Tables...
2025-06-29 00:21:04 [INFO    ] root:729 - [Schema V1] FTS Tables created successfully.
2025-06-29 00:21:04 [INFO    ] root:771 - Database schema initialized/migrated to version 1.
2025-06-29 00:21:04 [DEBUG   ] root:474 - Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/media.db
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db...
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db.
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db...
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db.
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db
2025-06-29 00:21:04 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
2025-06-29 00:21:04 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: Media c23ff412-21f0-445e-9133-1c7ef8513eba create v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] root:919 - FTS update for media 1: sanitized content - null bytes replaced
2025-06-29 00:21:04 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 1
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword ',' UUID 52e051c0-1579-4aea-8d87-6d816f6cdaf2
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: Keywords 52e051c0-1579-4aea-8d87-6d816f6cdaf2 create v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 1
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'e' UUID 7f77df9f-ac35-4a30-a32d-04ae4b513e2f
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: Keywords 7f77df9f-ac35-4a30-a32d-04ae4b513e2f create v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 2
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'n' UUID cdff1c03-7907-477c-96fe-4748ffaa5877
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: Keywords cdff1c03-7907-477c-96fe-4748ffaa5877 create v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 3
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'o' UUID b3016a6b-47f9-47c2-8299-afcdc0b3af50
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: Keywords b3016a6b-47f9-47c2-8299-afcdc0b3af50 create v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 4
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 's' UUID a94f9149-5c57-478b-b088-5ec01aa3f513
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: Keywords a94f9149-5c57-478b-b088-5ec01aa3f513 create v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 5
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 't' UUID 8c5da421-bf9f-40aa-baa7-402e2f59a57f
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: Keywords 8c5da421-bf9f-40aa-baa7-402e2f59a57f create v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 6
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: MediaKeywords c23ff412-21f0-445e-9133-1c7ef8513eba_52e051c0-1579-4aea-8d87-6d816f6cdaf2 link v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: MediaKeywords c23ff412-21f0-445e-9133-1c7ef8513eba_7f77df9f-ac35-4a30-a32d-04ae4b513e2f link v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: MediaKeywords c23ff412-21f0-445e-9133-1c7ef8513eba_cdff1c03-7907-477c-96fe-4748ffaa5877 link v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: MediaKeywords c23ff412-21f0-445e-9133-1c7ef8513eba_b3016a6b-47f9-47c2-8299-afcdc0b3af50 link v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: MediaKeywords c23ff412-21f0-445e-9133-1c7ef8513eba_a94f9149-5c57-478b-b088-5ec01aa3f513 link v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: MediaKeywords c23ff412-21f0-445e-9133-1c7ef8513eba_8c5da421-bf9f-40aa-baa7-402e2f59a57f link v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 1. Added: 6, Removed: 0.
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 1, UUID de0d60d0-be2b-4ccf-a698-e1126efe510c
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: DocumentVersions de0d60d0-be2b-4ccf-a698-e1126efe510c create v1 at 2025-06-29T07:21:04.275Z
2025-06-29 00:21:04 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:21:04 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
2025-06-29 00:21:04 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: Media 693f810c-fb44-43d9-ae80-c5a82acc52d5 create v1 at 2025-06-29T07:21:04.276Z
2025-06-29 00:21:04 [DEBUG   ] root:919 - FTS update for media 2: sanitized content - null bytes replaced
2025-06-29 00:21:04 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 2
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword ',' already active.
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'e' already active.
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'o' already active.
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 's' already active.
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 't' already active.
2025-06-29 00:21:04 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'w' UUID f55537f5-d786-410a-a5c6-b98b69f9f159
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: Keywords f55537f5-d786-410a-a5c6-b98b69f9f159 create v1 at 2025-06-29T07:21:04.276Z
2025-06-29 00:21:04 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 7
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 693f810c-fb44-43d9-ae80-c5a82acc52d5_52e051c0-1579-4aea-8d87-6d816f6cdaf2 link v1 at 2025-06-29T07:21:04.276Z
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 693f810c-fb44-43d9-ae80-c5a82acc52d5_7f77df9f-ac35-4a30-a32d-04ae4b513e2f link v1 at 2025-06-29T07:21:04.276Z
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 693f810c-fb44-43d9-ae80-c5a82acc52d5_b3016a6b-47f9-47c2-8299-afcdc0b3af50 link v1 at 2025-06-29T07:21:04.276Z
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 693f810c-fb44-43d9-ae80-c5a82acc52d5_a94f9149-5c57-478b-b088-5ec01aa3f513 link v1 at 2025-06-29T07:21:04.276Z
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 693f810c-fb44-43d9-ae80-c5a82acc52d5_8c5da421-bf9f-40aa-baa7-402e2f59a57f link v1 at 2025-06-29T07:21:04.276Z
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 693f810c-fb44-43d9-ae80-c5a82acc52d5_f55537f5-d786-410a-a5c6-b98b69f9f159 link v1 at 2025-06-29T07:21:04.276Z
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 2. Added: 6, Removed: 0.
2025-06-29 00:21:04 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 2, UUID ae0f63c5-1d5c-4e77-bd65-6992be99b49e
2025-06-29 00:21:04 [DEBUG   ] root:891 - Logged sync event: DocumentVersions ae0f63c5-1d5c-4e77-bd65-6992be99b49e create v1 at 2025-06-29T07:21:04.276Z
2025-06-29 00:21:04 [DEBUG   ] root:652 - Committed transaction.
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

383. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

384. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

385. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     tldw_chatbook.app:Logging_Config.py:160 Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

386. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

387. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
WARNING  tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Checking DB schema. Current: 1, Code supports: 1
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Database schema is up to date.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Verified FTS tables exist.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts Interop Library initialized successfully.
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x17372b530>
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Found 3 distinct media types: ['article', 'podcast', 'video']
INFO     tldw_chatbook.app:Logging_Config.py:160 App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

388. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

389. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

390. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
INFO     tldw_chatbook.app:Logging_Config.py:160 === STARTUP TIMING SUMMARY ===
INFO     tldw_chatbook.app:Logging_Config.py:160 Total initialization time: 0.008 seconds
INFO     tldw_chatbook.app:Logging_Config.py:160   basic_init: 0.002s (31.0%)
INFO     tldw_chatbook.app:Logging_Config.py:160   attribute_init: 0.000s (0.2%)
INFO     tldw_chatbook.app:Logging_Config.py:160   notes_service_init: 0.000s (3.1%)
INFO     tldw_chatbook.app:Logging_Config.py:160   providers_models: 0.003s (39.6%)
INFO     tldw_chatbook.app:Logging_Config.py:160   prompts_service_init: 0.001s (6.8%)
INFO     tldw_chatbook.app:Logging_Config.py:160   media_db_init: 0.001s (7.2%)
INFO     tldw_chatbook.app:Logging_Config.py:160 ==============================
----------------------------------------

391. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

392. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/media.db [Client ID: test_client_id]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/media.db [Client: test_client_id, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 0. Code supports: 1
INFO     root:Client_Media_DB_v2.py:680 Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/media.db...
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:694 [Schema V1] Applying Core Schema + Version Update...
DEBUG    root:Client_Media_DB_v2.py:696 [Schema V1] Core Schema script (incl. version update) executed.
DEBUG    root:Client_Media_DB_v2.py:707 [Schema V1] Media table structure validated successfully.
DEBUG    root:Client_Media_DB_v2.py:719 [Schema V1] Version check inside transaction confirmed version is 1.
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:722 [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/media.db.
DEBUG    root:Client_Media_DB_v2.py:726 [Schema V1] Applying FTS Tables...
INFO     root:Client_Media_DB_v2.py:729 [Schema V1] FTS Tables created successfully.
INFO     root:Client_Media_DB_v2.py:771 Database schema initialized/migrated to version 1.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/media.db
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db [Client ID: test_user]
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db (Journal: wal) for thread 8705548032
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction started (outermost) on thread 8705548032.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Full schema script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction (outermost) committed successfully on thread 8705548032.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m1/db/chachanotes.db
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media c23ff412-21f0-445e-9133-1c7ef8513eba create v1 at 2025-06-29T07:21:04.275Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 1: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword ',' UUID 52e051c0-1579-4aea-8d87-6d816f6cdaf2
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 52e051c0-1579-4aea-8d87-6d816f6cdaf2 create v1 at 2025-06-29T07:21:04.275Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'e' UUID 7f77df9f-ac35-4a30-a32d-04ae4b513e2f
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 7f77df9f-ac35-4a30-a32d-04ae4b513e2f create v1 at 2025-06-29T07:21:04.275Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 2
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'n' UUID cdff1c03-7907-477c-96fe-4748ffaa5877
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords cdff1c03-7907-477c-96fe-4748ffaa5877 create v1 at 2025-06-29T07:21:04.275Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 3
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'o' UUID b3016a6b-47f9-47c2-8299-afcdc0b3af50
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords b3016a6b-47f9-47c2-8299-afcdc0b3af50 create v1 at 2025-06-29T07:21:04.275Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 4
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 's' UUID a94f9149-5c57-478b-b088-5ec01aa3f513
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords a94f9149-5c57-478b-b088-5ec01aa3f513 create v1 at 2025-06-29T07:21:04.275Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 5
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 't' UUID 8c5da421-bf9f-40aa-baa7-402e2f59a57f
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 8c5da421-bf9f-40aa-baa7-402e2f59a57f create v1 at 2025-06-29T07:21:04.275Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 6
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords c23ff412-21f0-445e-9133-1c7ef8513eba_52e051c0-1579-4aea-8d87-6d816f6cdaf2 link v1 at 2025-06-29T07:21:04.275Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords c23ff412-21f0-445e-9133-1c7ef8513eba_7f77df9f-ac35-4a30-a32d-04ae4b513e2f link v1 at 2025-06-29T07:21:04.275Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords c23ff412-21f0-445e-9133-1c7ef8513eba_cdff1c03-7907-477c-96fe-4748ffaa5877 link v1 at 2025-06-29T07:21:04.275Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords c23ff412-21f0-445e-9133-1c7ef8513eba_b3016a6b-47f9-47c2-8299-afcdc0b3af50 link v1 at 2025-06-29T07:21:04.275Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords c23ff412-21f0-445e-9133-1c7ef8513eba_a94f9149-5c57-478b-b088-5ec01aa3f513 link v1 at 2025-06-29T07:21:04.275Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords c23ff412-21f0-445e-9133-1c7ef8513eba_8c5da421-bf9f-40aa-baa7-402e2f59a57f link v1 at 2025-06-29T07:21:04.275Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 1. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 1, UUID de0d60d0-be2b-4ccf-a698-e1126efe510c
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions de0d60d0-be2b-4ccf-a698-e1126efe510c create v1 at 2025-06-29T07:21:04.275Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media 693f810c-fb44-43d9-ae80-c5a82acc52d5 create v1 at 2025-06-29T07:21:04.276Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 2: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 2
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword ',' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'e' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'o' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 's' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 't' already active.
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'w' UUID f55537f5-d786-410a-a5c6-b98b69f9f159
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords f55537f5-d786-410a-a5c6-b98b69f9f159 create v1 at 2025-06-29T07:21:04.276Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 7
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 693f810c-fb44-43d9-ae80-c5a82acc52d5_52e051c0-1579-4aea-8d87-6d816f6cdaf2 link v1 at 2025-06-29T07:21:04.276Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 693f810c-fb44-43d9-ae80-c5a82acc52d5_7f77df9f-ac35-4a30-a32d-04ae4b513e2f link v1 at 2025-06-29T07:21:04.276Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 693f810c-fb44-43d9-ae80-c5a82acc52d5_b3016a6b-47f9-47c2-8299-afcdc0b3af50 link v1 at 2025-06-29T07:21:04.276Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 693f810c-fb44-43d9-ae80-c5a82acc52d5_a94f9149-5c57-478b-b088-5ec01aa3f513 link v1 at 2025-06-29T07:21:04.276Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 693f810c-fb44-43d9-ae80-c5a82acc52d5_8c5da421-bf9f-40aa-baa7-402e2f59a57f link v1 at 2025-06-29T07:21:04.276Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 693f810c-fb44-43d9-ae80-c5a82acc52d5_f55537f5-d786-410a-a5c6-b98b69f9f159 link v1 at 2025-06-29T07:21:04.276Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 2. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 2, UUID ae0f63c5-1d5c-4e77-bd65-6992be99b49e
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions ae0f63c5-1d5c-4e77-bd65-6992be99b49e create v1 at 2025-06-29T07:21:04.276Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
----------------------------- Captured stderr call -----------------------------
----------------------------------------

393. !!! CRITICAL ERROR in RichLog processor: Event loop is closed
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/queues.py", line 158, in get
    await getter
GeneratorExit
----------------------------------------

394. ERROR    root:metrics.py:99 Failed to log histogram app_compose_duration_seconds: No label names were set when constructing histogram:app_compose_duration_seconds
DEBUG    root:app.py:1329 App compose finished in 0.001 seconds
----------------------------------------

395. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

396. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 Composing ChatWindow UI
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:settings_sidebar.py:42 Sidebar chat: Received providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 'respond-for-me-button' composed.
DEBUG    tldw_chatbook.app:Logging_Config.py:160 Chat ephemeral state changed to: True
DEBUG    root:chat_right_sidebar.py:355 Character sidebar (id='chat-right-sidebar', prefix='chat') created with ephemeral state: True
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing CCPWindow UI
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing center pane
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing right pane
DEBUG    tldw_chatbook.UI.SearchRAGWindow:Logging_Config.py:160 Loaded 0 recent search queries
DEBUG    tldw_chatbook.UI.Ingest_Window:Logging_Config.py:160 Composing IngestWindow UI
INFO     root:Stats_screen.py:25 MetricsScreen initialized. Log path: /tmp/app_metrics.log
INFO     root:Stats_screen.py:76 MetricsScreen composing. Current metrics: {}
WARNING  root:Stats_screen.py:79 MetricsScreen compose: self.metrics is unexpectedly empty at compose time.
INFO     root:Stats_screen.py:93 MetricsScreen compose finished.
----------------------------------------

397. ERROR    asyncio:base_events.py:1833 Task was destroyed but it is pending!
task: <Task pending name='RichLogProcessor' coro=<RichLogHandler._process_log_queue() running at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Logging_Config.py:78> wait_for=<Future pending cb=[Task.task_wakeup()]>>
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:29 MetricsScreen on_mount: Calling load_metrics.
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:45 Attempting to load metrics from: /tmp/app_metrics.log
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
----------------------------------------

398. ERROR    root:Stats_screen.py:68 MetricsScreen: Log file not found at /tmp/app_metrics.log.
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
INFO     tldw_chatbook.UI.Coding_Window:Logging_Config.py:160 CodingWindow on_mount: UI composed
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    tldw_chatbook.UI.LLM_Management_Window:Logging_Config.py:160 LLMManagementWindow.on_mount called
INFO     tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 EvalsWindow on_mount: UI composed
----------------------------------------

399. ERROR    tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 Error initializing evaluation system: cannot import name 'EvaluationOrchestrator' from 'tldw_chatbook.Evals' (/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Evals/__init__.py)
INFO     tldw_chatbook.RAG_Search.Services.embeddings_service:Logging_Config.py:160 ChromaDB initialized at /Users/appledev/.local/share/tldw_cli/chromadb
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting and initializing initial active sub-tab.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-chat display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-creation display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-web-search display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initial active sub-tab set to search-view-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Added active class to nav button search-nav-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Set display=True for active view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initializing view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Initializing Embeddings Creation view.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation provider select changed to: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation model select changed to: e5-small-v2 for provider: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Provider specific inputs visibility updated. Custom HF: False, Local API URL: False (Value: '', Disabled: False)
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Logging_Config.py:137 --- _setup_logging START (from Logging_Config.py) ---
INFO     root:Logging_Config.py:145 Loguru: All pre-existing sinks removed.
INFO     root:Logging_Config.py:168 Loguru: Configured to forward its messages to standard Python logging system.
_ test_media_copy_buttons[chat-media-copy-author-button-author-Author copied to clipboard.] _
Tests/Chat/test_chat_sidebar_media_search.py:287: in test_media_copy_buttons
    load_button = app.query_one("#chat-media-load-selected-button", Button)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/textual/dom.py:1496: in query_one
    raise NoMatches(f"No nodes match {selector!r} on {self!r}")
E   textual.css.query.NoMatches: No nodes match '#chat-media-load-selected-button' on TldwCli(title='[B][N][S]  tldw CLI', classes={'-dark-mode'}, pseudo_classes={'dark', 'focus'})
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:21:09 [DEBUG   ] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

400. 2025-06-29 00:21:09 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

401. 2025-06-29 00:21:09 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

402. 2025-06-29 00:21:09 [ERROR   ] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:09 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

403. 2025-06-29 00:21:09 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

404. 2025-06-29 00:21:09 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:09 [DEBUG   ] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:09 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:09 [INFO    ] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:21:09 [INFO    ] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:21:09 [WARNING ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Database schema is up to date.
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Verified FTS tables exist.
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts Interop Library initialized successfully.
2025-06-29 00:21:09 [INFO    ] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:09 [INFO    ] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:21:09 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:21:09 [INFO    ] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:21:09 [DEBUG   ] root:750 - Database schema is up to date.
2025-06-29 00:21:09 [DEBUG   ] root:755 - Verified FTS tables exist.
2025-06-29 00:21:09 [DEBUG   ] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x17a84a390>
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:21:09 [DEBUG   ] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

405. 2025-06-29 00:21:09 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

406. 2025-06-29 00:21:09 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:21:09 [INFO    ] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:21:09 [INFO    ] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

407. 2025-06-29 00:21:09 [ERROR   ] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 - Total initialization time: 0.007 seconds
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 -   basic_init: 0.003s (35.6%)
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 -   attribute_init: 0.000s (0.3%)
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 -   notes_service_init: 0.000s (3.5%)
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 -   providers_models: 0.002s (33.4%)
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 -   prompts_service_init: 0.001s (7.4%)
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 -   media_db_init: 0.001s (8.1%)
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.app:160 - ==============================
----------------------------------------

408. 2025-06-29 00:21:09 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

409. 2025-06-29 00:21:09 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:09 [INFO    ] root:444 - Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/media.db [Client ID: test_client_id]
2025-06-29 00:21:09 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/media.db [Client: test_client_id, Thread: MainThread]
2025-06-29 00:21:09 [INFO    ] root:747 - Checking DB schema. Current version: 0. Code supports: 1
2025-06-29 00:21:09 [INFO    ] root:680 - Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/media.db...
2025-06-29 00:21:09 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:09 [DEBUG   ] root:694 - [Schema V1] Applying Core Schema + Version Update...
2025-06-29 00:21:09 [DEBUG   ] root:696 - [Schema V1] Core Schema script (incl. version update) executed.
2025-06-29 00:21:09 [DEBUG   ] root:707 - [Schema V1] Media table structure validated successfully.
2025-06-29 00:21:09 [DEBUG   ] root:719 - [Schema V1] Version check inside transaction confirmed version is 1.
2025-06-29 00:21:09 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:21:09 [INFO    ] root:722 - [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/media.db.
2025-06-29 00:21:09 [DEBUG   ] root:726 - [Schema V1] Applying FTS Tables...
2025-06-29 00:21:09 [INFO    ] root:729 - [Schema V1] FTS Tables created successfully.
2025-06-29 00:21:09 [INFO    ] root:771 - Database schema initialized/migrated to version 1.
2025-06-29 00:21:09 [DEBUG   ] root:474 - Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/media.db
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db...
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db.
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db...
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db.
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db
2025-06-29 00:21:09 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
2025-06-29 00:21:09 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: Media 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d create v1 at 2025-06-29T07:21:09.397Z
2025-06-29 00:21:09 [DEBUG   ] root:919 - FTS update for media 1: sanitized content - null bytes replaced
2025-06-29 00:21:09 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 1
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword ',' UUID f7105a4a-b3f4-48ea-a111-47146caf3cfd
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: Keywords f7105a4a-b3f4-48ea-a111-47146caf3cfd create v1 at 2025-06-29T07:21:09.397Z
2025-06-29 00:21:09 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 1
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'e' UUID b55e4055-a9cd-4d67-bbc3-4964127b056b
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: Keywords b55e4055-a9cd-4d67-bbc3-4964127b056b create v1 at 2025-06-29T07:21:09.397Z
2025-06-29 00:21:09 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 2
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'n' UUID 4961962d-7736-4528-bbe3-f2ab26ac1e4f
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: Keywords 4961962d-7736-4528-bbe3-f2ab26ac1e4f create v1 at 2025-06-29T07:21:09.397Z
2025-06-29 00:21:09 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 3
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'o' UUID b48718c9-4fd8-4654-ab69-7ef0c47639c3
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: Keywords b48718c9-4fd8-4654-ab69-7ef0c47639c3 create v1 at 2025-06-29T07:21:09.397Z
2025-06-29 00:21:09 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 4
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 's' UUID 07f8fa02-a47e-4480-b094-b77a1bcd08b4
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: Keywords 07f8fa02-a47e-4480-b094-b77a1bcd08b4 create v1 at 2025-06-29T07:21:09.397Z
2025-06-29 00:21:09 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 5
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 't' UUID 8e9c7ebe-2d88-4a9f-9e29-07269728d5fb
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: Keywords 8e9c7ebe-2d88-4a9f-9e29-07269728d5fb create v1 at 2025-06-29T07:21:09.398Z
2025-06-29 00:21:09 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 6
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d_f7105a4a-b3f4-48ea-a111-47146caf3cfd link v1 at 2025-06-29T07:21:09.398Z
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d_b55e4055-a9cd-4d67-bbc3-4964127b056b link v1 at 2025-06-29T07:21:09.398Z
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d_4961962d-7736-4528-bbe3-f2ab26ac1e4f link v1 at 2025-06-29T07:21:09.398Z
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d_b48718c9-4fd8-4654-ab69-7ef0c47639c3 link v1 at 2025-06-29T07:21:09.398Z
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d_07f8fa02-a47e-4480-b094-b77a1bcd08b4 link v1 at 2025-06-29T07:21:09.398Z
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d_8e9c7ebe-2d88-4a9f-9e29-07269728d5fb link v1 at 2025-06-29T07:21:09.398Z
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 1. Added: 6, Removed: 0.
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 1, UUID 13733f43-067e-4c27-a4fb-d38bd499de80
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: DocumentVersions 13733f43-067e-4c27-a4fb-d38bd499de80 create v1 at 2025-06-29T07:21:09.398Z
2025-06-29 00:21:09 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:21:09 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
2025-06-29 00:21:09 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: Media 442c8b47-a677-4734-8fc1-2feaf4ee4150 create v1 at 2025-06-29T07:21:09.398Z
2025-06-29 00:21:09 [DEBUG   ] root:919 - FTS update for media 2: sanitized content - null bytes replaced
2025-06-29 00:21:09 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 2
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword ',' already active.
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'e' already active.
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'o' already active.
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 's' already active.
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 't' already active.
2025-06-29 00:21:09 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'w' UUID 88fed234-2c95-4b7f-aedf-a108ab6e1908
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: Keywords 88fed234-2c95-4b7f-aedf-a108ab6e1908 create v1 at 2025-06-29T07:21:09.399Z
2025-06-29 00:21:09 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 7
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 442c8b47-a677-4734-8fc1-2feaf4ee4150_f7105a4a-b3f4-48ea-a111-47146caf3cfd link v1 at 2025-06-29T07:21:09.399Z
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 442c8b47-a677-4734-8fc1-2feaf4ee4150_b55e4055-a9cd-4d67-bbc3-4964127b056b link v1 at 2025-06-29T07:21:09.399Z
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 442c8b47-a677-4734-8fc1-2feaf4ee4150_b48718c9-4fd8-4654-ab69-7ef0c47639c3 link v1 at 2025-06-29T07:21:09.399Z
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 442c8b47-a677-4734-8fc1-2feaf4ee4150_07f8fa02-a47e-4480-b094-b77a1bcd08b4 link v1 at 2025-06-29T07:21:09.399Z
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 442c8b47-a677-4734-8fc1-2feaf4ee4150_8e9c7ebe-2d88-4a9f-9e29-07269728d5fb link v1 at 2025-06-29T07:21:09.399Z
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 442c8b47-a677-4734-8fc1-2feaf4ee4150_88fed234-2c95-4b7f-aedf-a108ab6e1908 link v1 at 2025-06-29T07:21:09.399Z
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 2. Added: 6, Removed: 0.
2025-06-29 00:21:09 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 2, UUID 811002ca-abf1-492d-9221-840c1075afde
2025-06-29 00:21:09 [DEBUG   ] root:891 - Logged sync event: DocumentVersions 811002ca-abf1-492d-9221-840c1075afde create v1 at 2025-06-29T07:21:09.399Z
2025-06-29 00:21:09 [DEBUG   ] root:652 - Committed transaction.
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

410. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

411. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

412. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     tldw_chatbook.app:Logging_Config.py:160 Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

413. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

414. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
WARNING  tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Checking DB schema. Current: 1, Code supports: 1
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Database schema is up to date.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Verified FTS tables exist.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts Interop Library initialized successfully.
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x17a84a390>
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Found 3 distinct media types: ['article', 'podcast', 'video']
INFO     tldw_chatbook.app:Logging_Config.py:160 App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

415. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

416. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

417. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
INFO     tldw_chatbook.app:Logging_Config.py:160 === STARTUP TIMING SUMMARY ===
INFO     tldw_chatbook.app:Logging_Config.py:160 Total initialization time: 0.007 seconds
INFO     tldw_chatbook.app:Logging_Config.py:160   basic_init: 0.003s (35.6%)
INFO     tldw_chatbook.app:Logging_Config.py:160   attribute_init: 0.000s (0.3%)
INFO     tldw_chatbook.app:Logging_Config.py:160   notes_service_init: 0.000s (3.5%)
INFO     tldw_chatbook.app:Logging_Config.py:160   providers_models: 0.002s (33.4%)
INFO     tldw_chatbook.app:Logging_Config.py:160   prompts_service_init: 0.001s (7.4%)
INFO     tldw_chatbook.app:Logging_Config.py:160   media_db_init: 0.001s (8.1%)
INFO     tldw_chatbook.app:Logging_Config.py:160 ==============================
----------------------------------------

418. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

419. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/media.db [Client ID: test_client_id]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/media.db [Client: test_client_id, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 0. Code supports: 1
INFO     root:Client_Media_DB_v2.py:680 Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/media.db...
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:694 [Schema V1] Applying Core Schema + Version Update...
DEBUG    root:Client_Media_DB_v2.py:696 [Schema V1] Core Schema script (incl. version update) executed.
DEBUG    root:Client_Media_DB_v2.py:707 [Schema V1] Media table structure validated successfully.
DEBUG    root:Client_Media_DB_v2.py:719 [Schema V1] Version check inside transaction confirmed version is 1.
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:722 [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/media.db.
DEBUG    root:Client_Media_DB_v2.py:726 [Schema V1] Applying FTS Tables...
INFO     root:Client_Media_DB_v2.py:729 [Schema V1] FTS Tables created successfully.
INFO     root:Client_Media_DB_v2.py:771 Database schema initialized/migrated to version 1.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/media.db
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db [Client ID: test_user]
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db (Journal: wal) for thread 8705548032
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction started (outermost) on thread 8705548032.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Full schema script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction (outermost) committed successfully on thread 8705548032.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m2/db/chachanotes.db
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d create v1 at 2025-06-29T07:21:09.397Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 1: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword ',' UUID f7105a4a-b3f4-48ea-a111-47146caf3cfd
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords f7105a4a-b3f4-48ea-a111-47146caf3cfd create v1 at 2025-06-29T07:21:09.397Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'e' UUID b55e4055-a9cd-4d67-bbc3-4964127b056b
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords b55e4055-a9cd-4d67-bbc3-4964127b056b create v1 at 2025-06-29T07:21:09.397Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 2
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'n' UUID 4961962d-7736-4528-bbe3-f2ab26ac1e4f
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 4961962d-7736-4528-bbe3-f2ab26ac1e4f create v1 at 2025-06-29T07:21:09.397Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 3
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'o' UUID b48718c9-4fd8-4654-ab69-7ef0c47639c3
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords b48718c9-4fd8-4654-ab69-7ef0c47639c3 create v1 at 2025-06-29T07:21:09.397Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 4
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 's' UUID 07f8fa02-a47e-4480-b094-b77a1bcd08b4
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 07f8fa02-a47e-4480-b094-b77a1bcd08b4 create v1 at 2025-06-29T07:21:09.397Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 5
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 't' UUID 8e9c7ebe-2d88-4a9f-9e29-07269728d5fb
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 8e9c7ebe-2d88-4a9f-9e29-07269728d5fb create v1 at 2025-06-29T07:21:09.398Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 6
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d_f7105a4a-b3f4-48ea-a111-47146caf3cfd link v1 at 2025-06-29T07:21:09.398Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d_b55e4055-a9cd-4d67-bbc3-4964127b056b link v1 at 2025-06-29T07:21:09.398Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d_4961962d-7736-4528-bbe3-f2ab26ac1e4f link v1 at 2025-06-29T07:21:09.398Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d_b48718c9-4fd8-4654-ab69-7ef0c47639c3 link v1 at 2025-06-29T07:21:09.398Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d_07f8fa02-a47e-4480-b094-b77a1bcd08b4 link v1 at 2025-06-29T07:21:09.398Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 4796a2fb-9fbe-4ba7-ac25-5f92dbfca64d_8e9c7ebe-2d88-4a9f-9e29-07269728d5fb link v1 at 2025-06-29T07:21:09.398Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 1. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 1, UUID 13733f43-067e-4c27-a4fb-d38bd499de80
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions 13733f43-067e-4c27-a4fb-d38bd499de80 create v1 at 2025-06-29T07:21:09.398Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media 442c8b47-a677-4734-8fc1-2feaf4ee4150 create v1 at 2025-06-29T07:21:09.398Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 2: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 2
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword ',' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'e' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'o' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 's' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 't' already active.
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'w' UUID 88fed234-2c95-4b7f-aedf-a108ab6e1908
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 88fed234-2c95-4b7f-aedf-a108ab6e1908 create v1 at 2025-06-29T07:21:09.399Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 7
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 442c8b47-a677-4734-8fc1-2feaf4ee4150_f7105a4a-b3f4-48ea-a111-47146caf3cfd link v1 at 2025-06-29T07:21:09.399Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 442c8b47-a677-4734-8fc1-2feaf4ee4150_b55e4055-a9cd-4d67-bbc3-4964127b056b link v1 at 2025-06-29T07:21:09.399Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 442c8b47-a677-4734-8fc1-2feaf4ee4150_b48718c9-4fd8-4654-ab69-7ef0c47639c3 link v1 at 2025-06-29T07:21:09.399Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 442c8b47-a677-4734-8fc1-2feaf4ee4150_07f8fa02-a47e-4480-b094-b77a1bcd08b4 link v1 at 2025-06-29T07:21:09.399Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 442c8b47-a677-4734-8fc1-2feaf4ee4150_8e9c7ebe-2d88-4a9f-9e29-07269728d5fb link v1 at 2025-06-29T07:21:09.399Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 442c8b47-a677-4734-8fc1-2feaf4ee4150_88fed234-2c95-4b7f-aedf-a108ab6e1908 link v1 at 2025-06-29T07:21:09.399Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 2. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 2, UUID 811002ca-abf1-492d-9221-840c1075afde
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions 811002ca-abf1-492d-9221-840c1075afde create v1 at 2025-06-29T07:21:09.399Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
----------------------------- Captured stderr call -----------------------------
----------------------------------------

420. !!! CRITICAL ERROR in RichLog processor: Event loop is closed
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/queues.py", line 158, in get
    await getter
GeneratorExit
----------------------------------------

421. ERROR    root:metrics.py:99 Failed to log histogram app_compose_duration_seconds: No label names were set when constructing histogram:app_compose_duration_seconds
DEBUG    root:app.py:1329 App compose finished in 0.001 seconds
----------------------------------------

422. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

423. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 Composing ChatWindow UI
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:settings_sidebar.py:42 Sidebar chat: Received providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 'respond-for-me-button' composed.
DEBUG    tldw_chatbook.app:Logging_Config.py:160 Chat ephemeral state changed to: True
DEBUG    root:chat_right_sidebar.py:355 Character sidebar (id='chat-right-sidebar', prefix='chat') created with ephemeral state: True
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing CCPWindow UI
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing center pane
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing right pane
DEBUG    tldw_chatbook.UI.SearchRAGWindow:Logging_Config.py:160 Loaded 0 recent search queries
DEBUG    tldw_chatbook.UI.Ingest_Window:Logging_Config.py:160 Composing IngestWindow UI
----------------------------------------

424. ERROR    asyncio:base_events.py:1833 Task was destroyed but it is pending!
task: <Task pending name='RichLogProcessor' coro=<RichLogHandler._process_log_queue() running at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Logging_Config.py:78> wait_for=<Future pending cb=[Task.task_wakeup()]>>
INFO     root:Stats_screen.py:25 MetricsScreen initialized. Log path: /tmp/app_metrics.log
INFO     root:Stats_screen.py:76 MetricsScreen composing. Current metrics: {}
WARNING  root:Stats_screen.py:79 MetricsScreen compose: self.metrics is unexpectedly empty at compose time.
INFO     root:Stats_screen.py:93 MetricsScreen compose finished.
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:29 MetricsScreen on_mount: Calling load_metrics.
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:45 Attempting to load metrics from: /tmp/app_metrics.log
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
----------------------------------------

425. ERROR    root:Stats_screen.py:68 MetricsScreen: Log file not found at /tmp/app_metrics.log.
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     tldw_chatbook.UI.Coding_Window:Logging_Config.py:160 CodingWindow on_mount: UI composed
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    tldw_chatbook.UI.LLM_Management_Window:Logging_Config.py:160 LLMManagementWindow.on_mount called
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 5, False
INFO     tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 EvalsWindow on_mount: UI composed
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 5, False
----------------------------------------

426. ERROR    tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 Error initializing evaluation system: cannot import name 'EvaluationOrchestrator' from 'tldw_chatbook.Evals' (/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Evals/__init__.py)
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=4,level=0,tokens=6), 4, 5, False
INFO     tldw_chatbook.RAG_Search.Services.embeddings_service:Logging_Config.py:160 ChromaDB initialized at /Users/appledev/.local/share/tldw_cli/chromadb
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting and initializing initial active sub-tab.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-chat display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-creation display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-web-search display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initial active sub-tab set to search-view-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Added active class to nav button search-nav-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Set display=True for active view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initializing view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Initializing Embeddings Creation view.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation provider select changed to: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation model select changed to: e5-small-v2 for provider: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Provider specific inputs visibility updated. Custom HF: False, Local API URL: False (Value: '', Disabled: False)
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Logging_Config.py:137 --- _setup_logging START (from Logging_Config.py) ---
INFO     root:Logging_Config.py:145 Loguru: All pre-existing sinks removed.
INFO     root:Logging_Config.py:168 Loguru: Configured to forward its messages to standard Python logging system.
_ test_media_copy_buttons[chat-media-copy-url-button-url-URL copied to clipboard.] _
Tests/Chat/test_chat_sidebar_media_search.py:287: in test_media_copy_buttons
    load_button = app.query_one("#chat-media-load-selected-button", Button)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/textual/dom.py:1496: in query_one
    raise NoMatches(f"No nodes match {selector!r} on {self!r}")
E   textual.css.query.NoMatches: No nodes match '#chat-media-load-selected-button' on TldwCli(title='[B][N][S]  tldw CLI', classes={'-dark-mode'}, pseudo_classes={'dark', 'focus'})
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:21:14 [DEBUG   ] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

427. 2025-06-29 00:21:14 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

428. 2025-06-29 00:21:14 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

429. 2025-06-29 00:21:14 [ERROR   ] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:14 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

430. 2025-06-29 00:21:14 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

431. 2025-06-29 00:21:14 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:14 [DEBUG   ] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:14 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:14 [INFO    ] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:21:14 [INFO    ] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:21:14 [WARNING ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Database schema is up to date.
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Verified FTS tables exist.
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts Interop Library initialized successfully.
2025-06-29 00:21:14 [INFO    ] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:14 [INFO    ] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:21:14 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:21:14 [INFO    ] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:21:14 [DEBUG   ] root:750 - Database schema is up to date.
2025-06-29 00:21:14 [DEBUG   ] root:755 - Verified FTS tables exist.
2025-06-29 00:21:14 [DEBUG   ] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x173ddc320>
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:21:14 [DEBUG   ] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

432. 2025-06-29 00:21:14 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

433. 2025-06-29 00:21:14 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:21:14 [INFO    ] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:21:14 [INFO    ] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

434. 2025-06-29 00:21:14 [ERROR   ] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 - Total initialization time: 0.007 seconds
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 -   basic_init: 0.002s (34.4%)
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 -   attribute_init: 0.000s (0.2%)
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 -   notes_service_init: 0.000s (3.5%)
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 -   providers_models: 0.002s (34.2%)
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 -   prompts_service_init: 0.001s (8.0%)
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 -   media_db_init: 0.001s (8.2%)
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.app:160 - ==============================
----------------------------------------

435. 2025-06-29 00:21:14 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

436. 2025-06-29 00:21:14 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:14 [INFO    ] root:444 - Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/media.db [Client ID: test_client_id]
2025-06-29 00:21:14 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/media.db [Client: test_client_id, Thread: MainThread]
2025-06-29 00:21:14 [INFO    ] root:747 - Checking DB schema. Current version: 0. Code supports: 1
2025-06-29 00:21:14 [INFO    ] root:680 - Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/media.db...
2025-06-29 00:21:14 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:14 [DEBUG   ] root:694 - [Schema V1] Applying Core Schema + Version Update...
2025-06-29 00:21:14 [DEBUG   ] root:696 - [Schema V1] Core Schema script (incl. version update) executed.
2025-06-29 00:21:14 [DEBUG   ] root:707 - [Schema V1] Media table structure validated successfully.
2025-06-29 00:21:14 [DEBUG   ] root:719 - [Schema V1] Version check inside transaction confirmed version is 1.
2025-06-29 00:21:14 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:21:14 [INFO    ] root:722 - [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/media.db.
2025-06-29 00:21:14 [DEBUG   ] root:726 - [Schema V1] Applying FTS Tables...
2025-06-29 00:21:14 [INFO    ] root:729 - [Schema V1] FTS Tables created successfully.
2025-06-29 00:21:14 [INFO    ] root:771 - Database schema initialized/migrated to version 1.
2025-06-29 00:21:14 [DEBUG   ] root:474 - Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/media.db
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db...
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db.
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db...
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db.
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db
2025-06-29 00:21:14 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
2025-06-29 00:21:14 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: Media d0ae62c9-c645-402f-8f64-155d8c1181c4 create v1 at 2025-06-29T07:21:14.716Z
2025-06-29 00:21:14 [DEBUG   ] root:919 - FTS update for media 1: sanitized content - null bytes replaced
2025-06-29 00:21:14 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 1
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword ',' UUID 5b51a3b6-c9f4-4c95-9bd0-688bd80b33de
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: Keywords 5b51a3b6-c9f4-4c95-9bd0-688bd80b33de create v1 at 2025-06-29T07:21:14.716Z
2025-06-29 00:21:14 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 1
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'e' UUID f51ec32f-c4d1-44ae-b7e1-3d67f250bd94
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: Keywords f51ec32f-c4d1-44ae-b7e1-3d67f250bd94 create v1 at 2025-06-29T07:21:14.716Z
2025-06-29 00:21:14 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 2
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'n' UUID 48c21cc0-d6e2-43b3-8bea-2bb9c31fa5f2
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: Keywords 48c21cc0-d6e2-43b3-8bea-2bb9c31fa5f2 create v1 at 2025-06-29T07:21:14.716Z
2025-06-29 00:21:14 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 3
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'o' UUID 0f4b6e61-a43f-429d-aef7-494178f91216
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: Keywords 0f4b6e61-a43f-429d-aef7-494178f91216 create v1 at 2025-06-29T07:21:14.716Z
2025-06-29 00:21:14 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 4
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 's' UUID c0b35983-08f1-4028-aedd-a7309d4a178d
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: Keywords c0b35983-08f1-4028-aedd-a7309d4a178d create v1 at 2025-06-29T07:21:14.717Z
2025-06-29 00:21:14 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 5
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 't' UUID 28282833-66d0-4ffb-b499-0df65f7103f1
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: Keywords 28282833-66d0-4ffb-b499-0df65f7103f1 create v1 at 2025-06-29T07:21:14.717Z
2025-06-29 00:21:14 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 6
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d0ae62c9-c645-402f-8f64-155d8c1181c4_5b51a3b6-c9f4-4c95-9bd0-688bd80b33de link v1 at 2025-06-29T07:21:14.717Z
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d0ae62c9-c645-402f-8f64-155d8c1181c4_f51ec32f-c4d1-44ae-b7e1-3d67f250bd94 link v1 at 2025-06-29T07:21:14.717Z
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d0ae62c9-c645-402f-8f64-155d8c1181c4_48c21cc0-d6e2-43b3-8bea-2bb9c31fa5f2 link v1 at 2025-06-29T07:21:14.717Z
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d0ae62c9-c645-402f-8f64-155d8c1181c4_0f4b6e61-a43f-429d-aef7-494178f91216 link v1 at 2025-06-29T07:21:14.717Z
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d0ae62c9-c645-402f-8f64-155d8c1181c4_c0b35983-08f1-4028-aedd-a7309d4a178d link v1 at 2025-06-29T07:21:14.717Z
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d0ae62c9-c645-402f-8f64-155d8c1181c4_28282833-66d0-4ffb-b499-0df65f7103f1 link v1 at 2025-06-29T07:21:14.717Z
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 1. Added: 6, Removed: 0.
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 1, UUID 7d67bb0b-9692-45bd-a441-821f22bb2601
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: DocumentVersions 7d67bb0b-9692-45bd-a441-821f22bb2601 create v1 at 2025-06-29T07:21:14.717Z
2025-06-29 00:21:14 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:21:14 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
2025-06-29 00:21:14 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: Media a7eb3cd6-4255-4caa-8ed3-c205a1f92275 create v1 at 2025-06-29T07:21:14.717Z
2025-06-29 00:21:14 [DEBUG   ] root:919 - FTS update for media 2: sanitized content - null bytes replaced
2025-06-29 00:21:14 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 2
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword ',' already active.
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'e' already active.
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'o' already active.
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 's' already active.
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 't' already active.
2025-06-29 00:21:14 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'w' UUID cb5c345e-c1b1-40a7-a742-6738b2075840
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: Keywords cb5c345e-c1b1-40a7-a742-6738b2075840 create v1 at 2025-06-29T07:21:14.718Z
2025-06-29 00:21:14 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 7
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: MediaKeywords a7eb3cd6-4255-4caa-8ed3-c205a1f92275_5b51a3b6-c9f4-4c95-9bd0-688bd80b33de link v1 at 2025-06-29T07:21:14.718Z
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: MediaKeywords a7eb3cd6-4255-4caa-8ed3-c205a1f92275_f51ec32f-c4d1-44ae-b7e1-3d67f250bd94 link v1 at 2025-06-29T07:21:14.718Z
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: MediaKeywords a7eb3cd6-4255-4caa-8ed3-c205a1f92275_0f4b6e61-a43f-429d-aef7-494178f91216 link v1 at 2025-06-29T07:21:14.718Z
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: MediaKeywords a7eb3cd6-4255-4caa-8ed3-c205a1f92275_c0b35983-08f1-4028-aedd-a7309d4a178d link v1 at 2025-06-29T07:21:14.718Z
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: MediaKeywords a7eb3cd6-4255-4caa-8ed3-c205a1f92275_28282833-66d0-4ffb-b499-0df65f7103f1 link v1 at 2025-06-29T07:21:14.718Z
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: MediaKeywords a7eb3cd6-4255-4caa-8ed3-c205a1f92275_cb5c345e-c1b1-40a7-a742-6738b2075840 link v1 at 2025-06-29T07:21:14.718Z
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 2. Added: 6, Removed: 0.
2025-06-29 00:21:14 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 2, UUID c0a4e5d7-e06a-4f59-9fb6-019ae58a0d5e
2025-06-29 00:21:14 [DEBUG   ] root:891 - Logged sync event: DocumentVersions c0a4e5d7-e06a-4f59-9fb6-019ae58a0d5e create v1 at 2025-06-29T07:21:14.718Z
2025-06-29 00:21:14 [DEBUG   ] root:652 - Committed transaction.
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

437. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

438. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

439. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     tldw_chatbook.app:Logging_Config.py:160 Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

440. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

441. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
WARNING  tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Checking DB schema. Current: 1, Code supports: 1
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Database schema is up to date.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Verified FTS tables exist.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts Interop Library initialized successfully.
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x173ddc320>
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Found 3 distinct media types: ['article', 'podcast', 'video']
INFO     tldw_chatbook.app:Logging_Config.py:160 App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

442. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

443. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

444. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
INFO     tldw_chatbook.app:Logging_Config.py:160 === STARTUP TIMING SUMMARY ===
INFO     tldw_chatbook.app:Logging_Config.py:160 Total initialization time: 0.007 seconds
INFO     tldw_chatbook.app:Logging_Config.py:160   basic_init: 0.002s (34.4%)
INFO     tldw_chatbook.app:Logging_Config.py:160   attribute_init: 0.000s (0.2%)
INFO     tldw_chatbook.app:Logging_Config.py:160   notes_service_init: 0.000s (3.5%)
INFO     tldw_chatbook.app:Logging_Config.py:160   providers_models: 0.002s (34.2%)
INFO     tldw_chatbook.app:Logging_Config.py:160   prompts_service_init: 0.001s (8.0%)
INFO     tldw_chatbook.app:Logging_Config.py:160   media_db_init: 0.001s (8.2%)
INFO     tldw_chatbook.app:Logging_Config.py:160 ==============================
----------------------------------------

445. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

446. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/media.db [Client ID: test_client_id]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/media.db [Client: test_client_id, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 0. Code supports: 1
INFO     root:Client_Media_DB_v2.py:680 Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/media.db...
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:694 [Schema V1] Applying Core Schema + Version Update...
DEBUG    root:Client_Media_DB_v2.py:696 [Schema V1] Core Schema script (incl. version update) executed.
DEBUG    root:Client_Media_DB_v2.py:707 [Schema V1] Media table structure validated successfully.
DEBUG    root:Client_Media_DB_v2.py:719 [Schema V1] Version check inside transaction confirmed version is 1.
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:722 [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/media.db.
DEBUG    root:Client_Media_DB_v2.py:726 [Schema V1] Applying FTS Tables...
INFO     root:Client_Media_DB_v2.py:729 [Schema V1] FTS Tables created successfully.
INFO     root:Client_Media_DB_v2.py:771 Database schema initialized/migrated to version 1.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/media.db
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db [Client ID: test_user]
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db (Journal: wal) for thread 8705548032
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction started (outermost) on thread 8705548032.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Full schema script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction (outermost) committed successfully on thread 8705548032.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_copy_buttons_chat_m3/db/chachanotes.db
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media d0ae62c9-c645-402f-8f64-155d8c1181c4 create v1 at 2025-06-29T07:21:14.716Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 1: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword ',' UUID 5b51a3b6-c9f4-4c95-9bd0-688bd80b33de
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 5b51a3b6-c9f4-4c95-9bd0-688bd80b33de create v1 at 2025-06-29T07:21:14.716Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'e' UUID f51ec32f-c4d1-44ae-b7e1-3d67f250bd94
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords f51ec32f-c4d1-44ae-b7e1-3d67f250bd94 create v1 at 2025-06-29T07:21:14.716Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 2
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'n' UUID 48c21cc0-d6e2-43b3-8bea-2bb9c31fa5f2
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 48c21cc0-d6e2-43b3-8bea-2bb9c31fa5f2 create v1 at 2025-06-29T07:21:14.716Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 3
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'o' UUID 0f4b6e61-a43f-429d-aef7-494178f91216
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 0f4b6e61-a43f-429d-aef7-494178f91216 create v1 at 2025-06-29T07:21:14.716Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 4
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 's' UUID c0b35983-08f1-4028-aedd-a7309d4a178d
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords c0b35983-08f1-4028-aedd-a7309d4a178d create v1 at 2025-06-29T07:21:14.717Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 5
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 't' UUID 28282833-66d0-4ffb-b499-0df65f7103f1
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 28282833-66d0-4ffb-b499-0df65f7103f1 create v1 at 2025-06-29T07:21:14.717Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 6
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d0ae62c9-c645-402f-8f64-155d8c1181c4_5b51a3b6-c9f4-4c95-9bd0-688bd80b33de link v1 at 2025-06-29T07:21:14.717Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d0ae62c9-c645-402f-8f64-155d8c1181c4_f51ec32f-c4d1-44ae-b7e1-3d67f250bd94 link v1 at 2025-06-29T07:21:14.717Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d0ae62c9-c645-402f-8f64-155d8c1181c4_48c21cc0-d6e2-43b3-8bea-2bb9c31fa5f2 link v1 at 2025-06-29T07:21:14.717Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d0ae62c9-c645-402f-8f64-155d8c1181c4_0f4b6e61-a43f-429d-aef7-494178f91216 link v1 at 2025-06-29T07:21:14.717Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d0ae62c9-c645-402f-8f64-155d8c1181c4_c0b35983-08f1-4028-aedd-a7309d4a178d link v1 at 2025-06-29T07:21:14.717Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d0ae62c9-c645-402f-8f64-155d8c1181c4_28282833-66d0-4ffb-b499-0df65f7103f1 link v1 at 2025-06-29T07:21:14.717Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 1. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 1, UUID 7d67bb0b-9692-45bd-a441-821f22bb2601
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions 7d67bb0b-9692-45bd-a441-821f22bb2601 create v1 at 2025-06-29T07:21:14.717Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media a7eb3cd6-4255-4caa-8ed3-c205a1f92275 create v1 at 2025-06-29T07:21:14.717Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 2: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 2
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword ',' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'e' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'o' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 's' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 't' already active.
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'w' UUID cb5c345e-c1b1-40a7-a742-6738b2075840
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords cb5c345e-c1b1-40a7-a742-6738b2075840 create v1 at 2025-06-29T07:21:14.718Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 7
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords a7eb3cd6-4255-4caa-8ed3-c205a1f92275_5b51a3b6-c9f4-4c95-9bd0-688bd80b33de link v1 at 2025-06-29T07:21:14.718Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords a7eb3cd6-4255-4caa-8ed3-c205a1f92275_f51ec32f-c4d1-44ae-b7e1-3d67f250bd94 link v1 at 2025-06-29T07:21:14.718Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords a7eb3cd6-4255-4caa-8ed3-c205a1f92275_0f4b6e61-a43f-429d-aef7-494178f91216 link v1 at 2025-06-29T07:21:14.718Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords a7eb3cd6-4255-4caa-8ed3-c205a1f92275_c0b35983-08f1-4028-aedd-a7309d4a178d link v1 at 2025-06-29T07:21:14.718Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords a7eb3cd6-4255-4caa-8ed3-c205a1f92275_28282833-66d0-4ffb-b499-0df65f7103f1 link v1 at 2025-06-29T07:21:14.718Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords a7eb3cd6-4255-4caa-8ed3-c205a1f92275_cb5c345e-c1b1-40a7-a742-6738b2075840 link v1 at 2025-06-29T07:21:14.718Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 2. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 2, UUID c0a4e5d7-e06a-4f59-9fb6-019ae58a0d5e
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions c0a4e5d7-e06a-4f59-9fb6-019ae58a0d5e create v1 at 2025-06-29T07:21:14.718Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
----------------------------- Captured stderr call -----------------------------
----------------------------------------

447. !!! CRITICAL ERROR in RichLog processor: Event loop is closed
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/queues.py", line 158, in get
    await getter
GeneratorExit
----------------------------------------

448. ERROR    root:metrics.py:99 Failed to log histogram app_compose_duration_seconds: No label names were set when constructing histogram:app_compose_duration_seconds
DEBUG    root:app.py:1329 App compose finished in 0.001 seconds
----------------------------------------

449. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

450. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 Composing ChatWindow UI
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:settings_sidebar.py:42 Sidebar chat: Received providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 'respond-for-me-button' composed.
DEBUG    tldw_chatbook.app:Logging_Config.py:160 Chat ephemeral state changed to: True
DEBUG    root:chat_right_sidebar.py:355 Character sidebar (id='chat-right-sidebar', prefix='chat') created with ephemeral state: True
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing CCPWindow UI
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing center pane
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing right pane
DEBUG    tldw_chatbook.UI.SearchRAGWindow:Logging_Config.py:160 Loaded 0 recent search queries
DEBUG    tldw_chatbook.UI.Ingest_Window:Logging_Config.py:160 Composing IngestWindow UI
INFO     root:Stats_screen.py:25 MetricsScreen initialized. Log path: /tmp/app_metrics.log
INFO     root:Stats_screen.py:76 MetricsScreen composing. Current metrics: {}
WARNING  root:Stats_screen.py:79 MetricsScreen compose: self.metrics is unexpectedly empty at compose time.
INFO     root:Stats_screen.py:93 MetricsScreen compose finished.
----------------------------------------

451. ERROR    asyncio:base_events.py:1833 Task was destroyed but it is pending!
task: <Task pending name='RichLogProcessor' coro=<RichLogHandler._process_log_queue() running at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Logging_Config.py:78> wait_for=<Future pending cb=[Task.task_wakeup()]>>
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:29 MetricsScreen on_mount: Calling load_metrics.
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:45 Attempting to load metrics from: /tmp/app_metrics.log
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 3, False
----------------------------------------

452. ERROR    root:Stats_screen.py:68 MetricsScreen: Log file not found at /tmp/app_metrics.log.
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 5, False
INFO     tldw_chatbook.UI.Coding_Window:Logging_Config.py:160 CodingWindow on_mount: UI composed
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    tldw_chatbook.UI.LLM_Management_Window:Logging_Config.py:160 LLMManagementWindow.on_mount called
INFO     tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 EvalsWindow on_mount: UI composed
----------------------------------------

453. ERROR    tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 Error initializing evaluation system: cannot import name 'EvaluationOrchestrator' from 'tldw_chatbook.Evals' (/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Evals/__init__.py)
INFO     tldw_chatbook.RAG_Search.Services.embeddings_service:Logging_Config.py:160 ChromaDB initialized at /Users/appledev/.local/share/tldw_cli/chromadb
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting and initializing initial active sub-tab.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-chat display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-creation display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-web-search display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initial active sub-tab set to search-view-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Added active class to nav button search-nav-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Set display=True for active view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initializing view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Initializing Embeddings Creation view.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation provider select changed to: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation model select changed to: e5-small-v2 for provider: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Provider specific inputs visibility updated. Custom HF: False, Local API URL: False (Value: '', Disabled: False)
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Logging_Config.py:137 --- _setup_logging START (from Logging_Config.py) ---
INFO     root:Logging_Config.py:145 Loguru: All pre-existing sinks removed.
INFO     root:Logging_Config.py:168 Loguru: Configured to forward its messages to standard Python logging system.
________________ test_media_review_clearing_on_new_empty_search ________________
Tests/Chat/test_chat_sidebar_media_search.py:341: in test_media_review_clearing_on_new_empty_search
    load_button = app.query_one("#chat-media-load-selected-button", Button)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/textual/dom.py:1496: in query_one
    raise NoMatches(f"No nodes match {selector!r} on {self!r}")
E   textual.css.query.NoMatches: No nodes match '#chat-media-load-selected-button' on TldwCli(title='[B][N][S]  tldw CLI', classes={'-dark-mode'}, pseudo_classes={'dark', 'focus'})
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:21:19 [DEBUG   ] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

454. 2025-06-29 00:21:19 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

455. 2025-06-29 00:21:19 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

456. 2025-06-29 00:21:19 [ERROR   ] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:19 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

457. 2025-06-29 00:21:19 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

458. 2025-06-29 00:21:19 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:19 [DEBUG   ] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:19 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:19 [INFO    ] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:21:19 [INFO    ] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:21:19 [WARNING ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Database schema is up to date.
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Verified FTS tables exist.
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts Interop Library initialized successfully.
2025-06-29 00:21:19 [INFO    ] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:19 [INFO    ] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:21:19 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:21:19 [INFO    ] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:21:19 [DEBUG   ] root:750 - Database schema is up to date.
2025-06-29 00:21:19 [DEBUG   ] root:755 - Verified FTS tables exist.
2025-06-29 00:21:19 [DEBUG   ] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x1733abe60>
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:21:19 [DEBUG   ] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

459. 2025-06-29 00:21:19 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

460. 2025-06-29 00:21:19 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:21:19 [INFO    ] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:21:19 [INFO    ] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

461. 2025-06-29 00:21:19 [ERROR   ] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 - Total initialization time: 0.007 seconds
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 -   basic_init: 0.002s (33.9%)
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 -   attribute_init: 0.000s (0.2%)
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 -   notes_service_init: 0.000s (3.4%)
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 -   providers_models: 0.002s (34.1%)
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 -   prompts_service_init: 0.001s (7.4%)
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 -   media_db_init: 0.001s (8.1%)
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.app:160 - ==============================
----------------------------------------

462. 2025-06-29 00:21:19 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

463. 2025-06-29 00:21:19 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:19 [INFO    ] root:444 - Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/media.db [Client ID: test_client_id]
2025-06-29 00:21:19 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/media.db [Client: test_client_id, Thread: MainThread]
2025-06-29 00:21:19 [INFO    ] root:747 - Checking DB schema. Current version: 0. Code supports: 1
2025-06-29 00:21:19 [INFO    ] root:680 - Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/media.db...
2025-06-29 00:21:19 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:19 [DEBUG   ] root:694 - [Schema V1] Applying Core Schema + Version Update...
2025-06-29 00:21:19 [DEBUG   ] root:696 - [Schema V1] Core Schema script (incl. version update) executed.
2025-06-29 00:21:19 [DEBUG   ] root:707 - [Schema V1] Media table structure validated successfully.
2025-06-29 00:21:19 [DEBUG   ] root:719 - [Schema V1] Version check inside transaction confirmed version is 1.
2025-06-29 00:21:19 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:21:19 [INFO    ] root:722 - [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/media.db.
2025-06-29 00:21:19 [DEBUG   ] root:726 - [Schema V1] Applying FTS Tables...
2025-06-29 00:21:19 [INFO    ] root:729 - [Schema V1] FTS Tables created successfully.
2025-06-29 00:21:19 [INFO    ] root:771 - Database schema initialized/migrated to version 1.
2025-06-29 00:21:19 [DEBUG   ] root:474 - Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/media.db
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db...
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db.
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db...
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db.
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db
2025-06-29 00:21:19 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
2025-06-29 00:21:19 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: Media 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a create v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] root:919 - FTS update for media 1: sanitized content - null bytes replaced
2025-06-29 00:21:19 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 1
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword ',' UUID 053f0f18-10ca-4508-8960-5143d4976b77
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: Keywords 053f0f18-10ca-4508-8960-5143d4976b77 create v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 1
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'e' UUID 2e7a8c97-a66f-4c76-9652-b16af7546098
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: Keywords 2e7a8c97-a66f-4c76-9652-b16af7546098 create v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 2
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'n' UUID cd55f525-73fa-48a1-89c8-dec7d23c1b33
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: Keywords cd55f525-73fa-48a1-89c8-dec7d23c1b33 create v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 3
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'o' UUID cfda6fdb-56a1-4b82-ba75-ecb782eb65eb
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: Keywords cfda6fdb-56a1-4b82-ba75-ecb782eb65eb create v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 4
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 's' UUID 667101a1-b79b-45da-8b1b-aded85d24c28
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: Keywords 667101a1-b79b-45da-8b1b-aded85d24c28 create v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 5
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 't' UUID 67521333-f028-45a5-97fc-da8c89b0cf2b
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: Keywords 67521333-f028-45a5-97fc-da8c89b0cf2b create v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 6
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a_053f0f18-10ca-4508-8960-5143d4976b77 link v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a_2e7a8c97-a66f-4c76-9652-b16af7546098 link v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a_cd55f525-73fa-48a1-89c8-dec7d23c1b33 link v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a_cfda6fdb-56a1-4b82-ba75-ecb782eb65eb link v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a_667101a1-b79b-45da-8b1b-aded85d24c28 link v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a_67521333-f028-45a5-97fc-da8c89b0cf2b link v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 1. Added: 6, Removed: 0.
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 1, UUID 53182787-88d4-45de-8a63-d7de24abb744
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: DocumentVersions 53182787-88d4-45de-8a63-d7de24abb744 create v1 at 2025-06-29T07:21:19.897Z
2025-06-29 00:21:19 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:21:19 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
2025-06-29 00:21:19 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: Media 396f47e1-efcd-4b96-847f-a7224ef325d8 create v1 at 2025-06-29T07:21:19.898Z
2025-06-29 00:21:19 [DEBUG   ] root:919 - FTS update for media 2: sanitized content - null bytes replaced
2025-06-29 00:21:19 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 2
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword ',' already active.
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'e' already active.
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'o' already active.
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 's' already active.
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 't' already active.
2025-06-29 00:21:19 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'w' UUID 4c31080e-293d-4ea6-ba84-7a47a7200164
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: Keywords 4c31080e-293d-4ea6-ba84-7a47a7200164 create v1 at 2025-06-29T07:21:19.898Z
2025-06-29 00:21:19 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 7
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 396f47e1-efcd-4b96-847f-a7224ef325d8_053f0f18-10ca-4508-8960-5143d4976b77 link v1 at 2025-06-29T07:21:19.898Z
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 396f47e1-efcd-4b96-847f-a7224ef325d8_2e7a8c97-a66f-4c76-9652-b16af7546098 link v1 at 2025-06-29T07:21:19.898Z
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 396f47e1-efcd-4b96-847f-a7224ef325d8_cfda6fdb-56a1-4b82-ba75-ecb782eb65eb link v1 at 2025-06-29T07:21:19.898Z
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 396f47e1-efcd-4b96-847f-a7224ef325d8_667101a1-b79b-45da-8b1b-aded85d24c28 link v1 at 2025-06-29T07:21:19.898Z
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 396f47e1-efcd-4b96-847f-a7224ef325d8_67521333-f028-45a5-97fc-da8c89b0cf2b link v1 at 2025-06-29T07:21:19.898Z
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 396f47e1-efcd-4b96-847f-a7224ef325d8_4c31080e-293d-4ea6-ba84-7a47a7200164 link v1 at 2025-06-29T07:21:19.898Z
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 2. Added: 6, Removed: 0.
2025-06-29 00:21:19 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 2, UUID fc6c8542-4d74-422b-bc61-754cb5f0a525
2025-06-29 00:21:19 [DEBUG   ] root:891 - Logged sync event: DocumentVersions fc6c8542-4d74-422b-bc61-754cb5f0a525 create v1 at 2025-06-29T07:21:19.898Z
2025-06-29 00:21:19 [DEBUG   ] root:652 - Committed transaction.
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

464. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

465. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

466. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     tldw_chatbook.app:Logging_Config.py:160 Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

467. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

468. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
WARNING  tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Checking DB schema. Current: 1, Code supports: 1
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Database schema is up to date.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Verified FTS tables exist.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts Interop Library initialized successfully.
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x1733abe60>
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Found 3 distinct media types: ['article', 'podcast', 'video']
INFO     tldw_chatbook.app:Logging_Config.py:160 App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

469. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

470. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

471. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
INFO     tldw_chatbook.app:Logging_Config.py:160 === STARTUP TIMING SUMMARY ===
INFO     tldw_chatbook.app:Logging_Config.py:160 Total initialization time: 0.007 seconds
INFO     tldw_chatbook.app:Logging_Config.py:160   basic_init: 0.002s (33.9%)
INFO     tldw_chatbook.app:Logging_Config.py:160   attribute_init: 0.000s (0.2%)
INFO     tldw_chatbook.app:Logging_Config.py:160   notes_service_init: 0.000s (3.4%)
INFO     tldw_chatbook.app:Logging_Config.py:160   providers_models: 0.002s (34.1%)
INFO     tldw_chatbook.app:Logging_Config.py:160   prompts_service_init: 0.001s (7.4%)
INFO     tldw_chatbook.app:Logging_Config.py:160   media_db_init: 0.001s (8.1%)
INFO     tldw_chatbook.app:Logging_Config.py:160 ==============================
----------------------------------------

472. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

473. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/media.db [Client ID: test_client_id]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/media.db [Client: test_client_id, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 0. Code supports: 1
INFO     root:Client_Media_DB_v2.py:680 Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/media.db...
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:694 [Schema V1] Applying Core Schema + Version Update...
DEBUG    root:Client_Media_DB_v2.py:696 [Schema V1] Core Schema script (incl. version update) executed.
DEBUG    root:Client_Media_DB_v2.py:707 [Schema V1] Media table structure validated successfully.
DEBUG    root:Client_Media_DB_v2.py:719 [Schema V1] Version check inside transaction confirmed version is 1.
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:722 [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/media.db.
DEBUG    root:Client_Media_DB_v2.py:726 [Schema V1] Applying FTS Tables...
INFO     root:Client_Media_DB_v2.py:729 [Schema V1] FTS Tables created successfully.
INFO     root:Client_Media_DB_v2.py:771 Database schema initialized/migrated to version 1.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/media.db
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db [Client ID: test_user]
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db (Journal: wal) for thread 8705548032
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction started (outermost) on thread 8705548032.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Full schema script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction (outermost) committed successfully on thread 8705548032.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_review_clearing_on_0/db/chachanotes.db
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a create v1 at 2025-06-29T07:21:19.897Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 1: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword ',' UUID 053f0f18-10ca-4508-8960-5143d4976b77
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 053f0f18-10ca-4508-8960-5143d4976b77 create v1 at 2025-06-29T07:21:19.897Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'e' UUID 2e7a8c97-a66f-4c76-9652-b16af7546098
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 2e7a8c97-a66f-4c76-9652-b16af7546098 create v1 at 2025-06-29T07:21:19.897Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 2
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'n' UUID cd55f525-73fa-48a1-89c8-dec7d23c1b33
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords cd55f525-73fa-48a1-89c8-dec7d23c1b33 create v1 at 2025-06-29T07:21:19.897Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 3
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'o' UUID cfda6fdb-56a1-4b82-ba75-ecb782eb65eb
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords cfda6fdb-56a1-4b82-ba75-ecb782eb65eb create v1 at 2025-06-29T07:21:19.897Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 4
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 's' UUID 667101a1-b79b-45da-8b1b-aded85d24c28
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 667101a1-b79b-45da-8b1b-aded85d24c28 create v1 at 2025-06-29T07:21:19.897Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 5
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 't' UUID 67521333-f028-45a5-97fc-da8c89b0cf2b
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 67521333-f028-45a5-97fc-da8c89b0cf2b create v1 at 2025-06-29T07:21:19.897Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 6
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a_053f0f18-10ca-4508-8960-5143d4976b77 link v1 at 2025-06-29T07:21:19.897Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a_2e7a8c97-a66f-4c76-9652-b16af7546098 link v1 at 2025-06-29T07:21:19.897Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a_cd55f525-73fa-48a1-89c8-dec7d23c1b33 link v1 at 2025-06-29T07:21:19.897Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a_cfda6fdb-56a1-4b82-ba75-ecb782eb65eb link v1 at 2025-06-29T07:21:19.897Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a_667101a1-b79b-45da-8b1b-aded85d24c28 link v1 at 2025-06-29T07:21:19.897Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 4e4d587d-622f-4ea8-9cf4-cfbe9fd0044a_67521333-f028-45a5-97fc-da8c89b0cf2b link v1 at 2025-06-29T07:21:19.897Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 1. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 1, UUID 53182787-88d4-45de-8a63-d7de24abb744
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions 53182787-88d4-45de-8a63-d7de24abb744 create v1 at 2025-06-29T07:21:19.897Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media 396f47e1-efcd-4b96-847f-a7224ef325d8 create v1 at 2025-06-29T07:21:19.898Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 2: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 2
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword ',' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'e' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'o' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 's' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 't' already active.
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'w' UUID 4c31080e-293d-4ea6-ba84-7a47a7200164
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 4c31080e-293d-4ea6-ba84-7a47a7200164 create v1 at 2025-06-29T07:21:19.898Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 7
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 396f47e1-efcd-4b96-847f-a7224ef325d8_053f0f18-10ca-4508-8960-5143d4976b77 link v1 at 2025-06-29T07:21:19.898Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 396f47e1-efcd-4b96-847f-a7224ef325d8_2e7a8c97-a66f-4c76-9652-b16af7546098 link v1 at 2025-06-29T07:21:19.898Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 396f47e1-efcd-4b96-847f-a7224ef325d8_cfda6fdb-56a1-4b82-ba75-ecb782eb65eb link v1 at 2025-06-29T07:21:19.898Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 396f47e1-efcd-4b96-847f-a7224ef325d8_667101a1-b79b-45da-8b1b-aded85d24c28 link v1 at 2025-06-29T07:21:19.898Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 396f47e1-efcd-4b96-847f-a7224ef325d8_67521333-f028-45a5-97fc-da8c89b0cf2b link v1 at 2025-06-29T07:21:19.898Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 396f47e1-efcd-4b96-847f-a7224ef325d8_4c31080e-293d-4ea6-ba84-7a47a7200164 link v1 at 2025-06-29T07:21:19.898Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 2. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 2, UUID fc6c8542-4d74-422b-bc61-754cb5f0a525
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions fc6c8542-4d74-422b-bc61-754cb5f0a525 create v1 at 2025-06-29T07:21:19.898Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
----------------------------- Captured stderr call -----------------------------
----------------------------------------

474. !!! CRITICAL ERROR in RichLog processor: Event loop is closed
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/queues.py", line 158, in get
    await getter
GeneratorExit
----------------------------------------

475. ERROR    root:metrics.py:99 Failed to log histogram app_compose_duration_seconds: No label names were set when constructing histogram:app_compose_duration_seconds
DEBUG    root:app.py:1329 App compose finished in 0.001 seconds
----------------------------------------

476. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

477. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 Composing ChatWindow UI
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:settings_sidebar.py:42 Sidebar chat: Received providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 'respond-for-me-button' composed.
DEBUG    tldw_chatbook.app:Logging_Config.py:160 Chat ephemeral state changed to: True
DEBUG    root:chat_right_sidebar.py:355 Character sidebar (id='chat-right-sidebar', prefix='chat') created with ephemeral state: True
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing CCPWindow UI
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing center pane
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing right pane
DEBUG    tldw_chatbook.UI.SearchRAGWindow:Logging_Config.py:160 Loaded 0 recent search queries
DEBUG    tldw_chatbook.UI.Ingest_Window:Logging_Config.py:160 Composing IngestWindow UI
----------------------------------------

478. ERROR    asyncio:base_events.py:1833 Task was destroyed but it is pending!
task: <Task pending name='RichLogProcessor' coro=<RichLogHandler._process_log_queue() running at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Logging_Config.py:78> wait_for=<Future pending cb=[Task.task_wakeup()]>>
INFO     root:Stats_screen.py:25 MetricsScreen initialized. Log path: /tmp/app_metrics.log
INFO     root:Stats_screen.py:76 MetricsScreen composing. Current metrics: {}
WARNING  root:Stats_screen.py:79 MetricsScreen compose: self.metrics is unexpectedly empty at compose time.
INFO     root:Stats_screen.py:93 MetricsScreen compose finished.
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:29 MetricsScreen on_mount: Calling load_metrics.
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:45 Attempting to load metrics from: /tmp/app_metrics.log
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
----------------------------------------

479. ERROR    root:Stats_screen.py:68 MetricsScreen: Log file not found at /tmp/app_metrics.log.
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     tldw_chatbook.UI.Coding_Window:Logging_Config.py:160 CodingWindow on_mount: UI composed
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    tldw_chatbook.UI.LLM_Management_Window:Logging_Config.py:160 LLMManagementWindow.on_mount called
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 5, False
INFO     tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 EvalsWindow on_mount: UI composed
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 3, False
----------------------------------------

480. ERROR    tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 Error initializing evaluation system: cannot import name 'EvaluationOrchestrator' from 'tldw_chatbook.Evals' (/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Evals/__init__.py)
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=4,level=0,tokens=6), 4, 5, False
INFO     tldw_chatbook.RAG_Search.Services.embeddings_service:Logging_Config.py:160 ChromaDB initialized at /Users/appledev/.local/share/tldw_cli/chromadb
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting and initializing initial active sub-tab.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-chat display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-creation display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-web-search display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initial active sub-tab set to search-view-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Added active class to nav button search-nav-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Set display=True for active view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initializing view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Initializing Embeddings Creation view.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation provider select changed to: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation model select changed to: e5-small-v2 for provider: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Provider specific inputs visibility updated. Custom HF: False, Local API URL: False (Value: '', Disabled: False)
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Logging_Config.py:137 --- _setup_logging START (from Logging_Config.py) ---
INFO     root:Logging_Config.py:145 Loguru: All pre-existing sinks removed.
INFO     root:Logging_Config.py:168 Loguru: Configured to forward its messages to standard Python logging system.
______________________ test_media_search_input_debounced _______________________
Tests/Chat/test_chat_sidebar_media_search.py:399: in test_media_search_input_debounced
    await pilot.type("t")
          ^^^^^^^^^^
E   AttributeError: 'Pilot' object has no attribute 'type'
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:21:24 [DEBUG   ] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

481. 2025-06-29 00:21:24 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

482. 2025-06-29 00:21:24 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

483. 2025-06-29 00:21:24 [ERROR   ] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:24 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

484. 2025-06-29 00:21:24 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

485. 2025-06-29 00:21:24 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:24 [DEBUG   ] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.config:160 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.config:160 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.config:160 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:24 [WARNING ] tldw_chatbook.config:160 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.config:160 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.config:160 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.config:160 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:24 [INFO    ] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:21:24 [INFO    ] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:21:24 [WARNING ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.Prompts_DB:160 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Database schema is up to date.
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - Verified FTS tables exist.
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Prompts_DB:160 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.Prompt_Management.Prompts_Interop:160 - Prompts Interop Library initialized successfully.
2025-06-29 00:21:24 [INFO    ] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:24 [INFO    ] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:21:24 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:21:24 [INFO    ] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:21:24 [DEBUG   ] root:750 - Database schema is up to date.
2025-06-29 00:21:24 [DEBUG   ] root:755 - Verified FTS tables exist.
2025-06-29 00:21:24 [DEBUG   ] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x16a75e9f0>
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:21:24 [DEBUG   ] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

486. 2025-06-29 00:21:24 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

487. 2025-06-29 00:21:24 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.app:160 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:21:24 [INFO    ] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:21:24 [INFO    ] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

488. 2025-06-29 00:21:24 [ERROR   ] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 - Total initialization time: 0.007 seconds
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 -   basic_init: 0.002s (32.5%)
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 -   attribute_init: 0.000s (0.2%)
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 -   notes_service_init: 0.000s (3.2%)
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 -   providers_models: 0.003s (34.9%)
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 -   prompts_service_init: 0.001s (9.3%)
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 -   media_db_init: 0.001s (8.6%)
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.app:160 - ==============================
----------------------------------------

489. 2025-06-29 00:21:24 [ERROR   ] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

490. 2025-06-29 00:21:24 [ERROR   ] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:24 [INFO    ] root:444 - Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/media.db [Client ID: test_client_id]
2025-06-29 00:21:24 [DEBUG   ] root:510 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/media.db [Client: test_client_id, Thread: MainThread]
2025-06-29 00:21:24 [INFO    ] root:747 - Checking DB schema. Current version: 0. Code supports: 1
2025-06-29 00:21:24 [INFO    ] root:680 - Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/media.db...
2025-06-29 00:21:24 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:24 [DEBUG   ] root:694 - [Schema V1] Applying Core Schema + Version Update...
2025-06-29 00:21:24 [DEBUG   ] root:696 - [Schema V1] Core Schema script (incl. version update) executed.
2025-06-29 00:21:24 [DEBUG   ] root:707 - [Schema V1] Media table structure validated successfully.
2025-06-29 00:21:24 [DEBUG   ] root:719 - [Schema V1] Version check inside transaction confirmed version is 1.
2025-06-29 00:21:24 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:21:24 [INFO    ] root:722 - [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/media.db.
2025-06-29 00:21:24 [DEBUG   ] root:726 - [Schema V1] Applying FTS Tables...
2025-06-29 00:21:24 [INFO    ] root:729 - [Schema V1] FTS Tables created successfully.
2025-06-29 00:21:24 [INFO    ] root:771 - Database schema initialized/migrated to version 1.
2025-06-29 00:21:24 [DEBUG   ] root:474 - Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/media.db
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db...
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db.
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db...
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db.
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.ChaChaNotes_DB:160 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db
2025-06-29 00:21:24 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
2025-06-29 00:21:24 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: Media 107d6244-972f-462d-82d7-24ed12bd23c6 create v1 at 2025-06-29T07:21:24.910Z
2025-06-29 00:21:24 [DEBUG   ] root:919 - FTS update for media 1: sanitized content - null bytes replaced
2025-06-29 00:21:24 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 1
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword ',' UUID 097d3372-651a-431f-ab52-9d81af00de7a
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: Keywords 097d3372-651a-431f-ab52-9d81af00de7a create v1 at 2025-06-29T07:21:24.910Z
2025-06-29 00:21:24 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 1
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'e' UUID 4b1bb6ba-5947-4d09-99be-e227fc854ce8
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: Keywords 4b1bb6ba-5947-4d09-99be-e227fc854ce8 create v1 at 2025-06-29T07:21:24.910Z
2025-06-29 00:21:24 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 2
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'n' UUID 9ba8caf0-5fef-43e9-aa7d-7a4c900de1bf
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: Keywords 9ba8caf0-5fef-43e9-aa7d-7a4c900de1bf create v1 at 2025-06-29T07:21:24.910Z
2025-06-29 00:21:24 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 3
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'o' UUID 5a44d1dd-1c8d-455c-b528-8c44bb37f2d6
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: Keywords 5a44d1dd-1c8d-455c-b528-8c44bb37f2d6 create v1 at 2025-06-29T07:21:24.910Z
2025-06-29 00:21:24 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 4
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 's' UUID fb975125-32b5-49a3-aa70-b05b36c68e23
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: Keywords fb975125-32b5-49a3-aa70-b05b36c68e23 create v1 at 2025-06-29T07:21:24.910Z
2025-06-29 00:21:24 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 5
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 't' UUID c04b6189-314c-43b3-859a-eeca18cd19f0
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: Keywords c04b6189-314c-43b3-859a-eeca18cd19f0 create v1 at 2025-06-29T07:21:24.911Z
2025-06-29 00:21:24 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 6
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 107d6244-972f-462d-82d7-24ed12bd23c6_097d3372-651a-431f-ab52-9d81af00de7a link v1 at 2025-06-29T07:21:24.911Z
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 107d6244-972f-462d-82d7-24ed12bd23c6_4b1bb6ba-5947-4d09-99be-e227fc854ce8 link v1 at 2025-06-29T07:21:24.911Z
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 107d6244-972f-462d-82d7-24ed12bd23c6_9ba8caf0-5fef-43e9-aa7d-7a4c900de1bf link v1 at 2025-06-29T07:21:24.911Z
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 107d6244-972f-462d-82d7-24ed12bd23c6_5a44d1dd-1c8d-455c-b528-8c44bb37f2d6 link v1 at 2025-06-29T07:21:24.911Z
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 107d6244-972f-462d-82d7-24ed12bd23c6_fb975125-32b5-49a3-aa70-b05b36c68e23 link v1 at 2025-06-29T07:21:24.911Z
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: MediaKeywords 107d6244-972f-462d-82d7-24ed12bd23c6_c04b6189-314c-43b3-859a-eeca18cd19f0 link v1 at 2025-06-29T07:21:24.911Z
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 1. Added: 6, Removed: 0.
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 1, UUID d0c053cf-1fcb-44ae-8654-f159513db605
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: DocumentVersions d0c053cf-1fcb-44ae-8654-f159513db605 create v1 at 2025-06-29T07:21:24.911Z
2025-06-29 00:21:24 [DEBUG   ] root:652 - Committed transaction.
2025-06-29 00:21:24 [INFO    ] root:1899 - add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
2025-06-29 00:21:24 [DEBUG   ] root:647 - Started transaction.
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: Media d88ca57b-b54a-49db-a6e4-cc235e040343 create v1 at 2025-06-29T07:21:24.911Z
2025-06-29 00:21:24 [DEBUG   ] root:919 - FTS update for media 2: sanitized content - null bytes replaced
2025-06-29 00:21:24 [DEBUG   ] root:924 - Updated FTS (insert or replace) for Media ID 2
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword ',' already active.
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'e' already active.
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 'o' already active.
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 's' already active.
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keyword 't' already active.
2025-06-29 00:21:24 [INFO    ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Adding new keyword 'w' UUID 8b2d0338-d3f6-4afb-824e-89c34cff2a2b
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: Keywords 8b2d0338-d3f6-4afb-824e-89c34cff2a2b create v1 at 2025-06-29T07:21:24.912Z
2025-06-29 00:21:24 [DEBUG   ] root:973 - Updated FTS (insert or replace) for Keyword ID 7
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d88ca57b-b54a-49db-a6e4-cc235e040343_097d3372-651a-431f-ab52-9d81af00de7a link v1 at 2025-06-29T07:21:24.912Z
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d88ca57b-b54a-49db-a6e4-cc235e040343_4b1bb6ba-5947-4d09-99be-e227fc854ce8 link v1 at 2025-06-29T07:21:24.912Z
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d88ca57b-b54a-49db-a6e4-cc235e040343_5a44d1dd-1c8d-455c-b528-8c44bb37f2d6 link v1 at 2025-06-29T07:21:24.912Z
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d88ca57b-b54a-49db-a6e4-cc235e040343_fb975125-32b5-49a3-aa70-b05b36c68e23 link v1 at 2025-06-29T07:21:24.912Z
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d88ca57b-b54a-49db-a6e4-cc235e040343_c04b6189-314c-43b3-859a-eeca18cd19f0 link v1 at 2025-06-29T07:21:24.912Z
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: MediaKeywords d88ca57b-b54a-49db-a6e4-cc235e040343_8b2d0338-d3f6-4afb-824e-89c34cff2a2b link v1 at 2025-06-29T07:21:24.912Z
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Keywords updated media 2. Added: 6, Removed: 0.
2025-06-29 00:21:24 [DEBUG   ] tldw_chatbook.DB.Client_Media_DB_v2:160 - Creating document version 1 for media ID 2, UUID 97fafe8f-1275-42e3-8510-60ddffd660d7
2025-06-29 00:21:24 [DEBUG   ] root:891 - Logged sync event: DocumentVersions 97fafe8f-1275-42e3-8510-60ddffd660d7 create v1 at 2025-06-29T07:21:24.912Z
2025-06-29 00:21:24 [DEBUG   ] root:652 - Committed transaction.
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

491. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

492. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

493. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     tldw_chatbook.app:Logging_Config.py:160 Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
INFO     tldw_chatbook.app:Logging_Config.py:160 NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

494. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

495. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
WARNING  tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
INFO     tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Checking DB schema. Current: 1, Code supports: 1
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Database schema is up to date.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 Verified FTS tables exist.
DEBUG    tldw_chatbook.DB.Prompts_DB:Logging_Config.py:160 PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     tldw_chatbook.Prompt_Management.Prompts_Interop:Logging_Config.py:160 Prompts Interop Library initialized successfully.
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
INFO     tldw_chatbook.app:Logging_Config.py:160 Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x16a75e9f0>
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Found 3 distinct media types: ['article', 'podcast', 'video']
INFO     tldw_chatbook.app:Logging_Config.py:160 App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

496. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

497. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
DEBUG    tldw_chatbook.app:Logging_Config.py:160 ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

498. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
INFO     tldw_chatbook.app:Logging_Config.py:160 === STARTUP TIMING SUMMARY ===
INFO     tldw_chatbook.app:Logging_Config.py:160 Total initialization time: 0.007 seconds
INFO     tldw_chatbook.app:Logging_Config.py:160   basic_init: 0.002s (32.5%)
INFO     tldw_chatbook.app:Logging_Config.py:160   attribute_init: 0.000s (0.2%)
INFO     tldw_chatbook.app:Logging_Config.py:160   notes_service_init: 0.000s (3.2%)
INFO     tldw_chatbook.app:Logging_Config.py:160   providers_models: 0.003s (34.9%)
INFO     tldw_chatbook.app:Logging_Config.py:160   prompts_service_init: 0.001s (9.3%)
INFO     tldw_chatbook.app:Logging_Config.py:160   media_db_init: 0.001s (8.6%)
INFO     tldw_chatbook.app:Logging_Config.py:160 ==============================
----------------------------------------

499. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

500. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/media.db [Client ID: test_client_id]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/media.db [Client: test_client_id, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 0. Code supports: 1
INFO     root:Client_Media_DB_v2.py:680 Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/media.db...
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:694 [Schema V1] Applying Core Schema + Version Update...
DEBUG    root:Client_Media_DB_v2.py:696 [Schema V1] Core Schema script (incl. version update) executed.
DEBUG    root:Client_Media_DB_v2.py:707 [Schema V1] Media table structure validated successfully.
DEBUG    root:Client_Media_DB_v2.py:719 [Schema V1] Version check inside transaction confirmed version is 1.
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:722 [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/media.db.
DEBUG    root:Client_Media_DB_v2.py:726 [Schema V1] Applying FTS Tables...
INFO     root:Client_Media_DB_v2.py:729 [Schema V1] FTS Tables created successfully.
INFO     root:Client_Media_DB_v2.py:771 Database schema initialized/migrated to version 1.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/media.db
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db [Client ID: test_user]
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db (Journal: wal) for thread 8705548032
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction started (outermost) on thread 8705548032.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Full schema script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db...
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration script executed.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db.
INFO     tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 Transaction (outermost) committed successfully on thread 8705548032.
DEBUG    tldw_chatbook.DB.ChaChaNotes_DB:Logging_Config.py:160 CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-402/test_media_search_input_deboun0/db/chachanotes.db
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/one, title=Test Media One, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media 107d6244-972f-462d-82d7-24ed12bd23c6 create v1 at 2025-06-29T07:21:24.910Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 1: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword ',' UUID 097d3372-651a-431f-ab52-9d81af00de7a
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 097d3372-651a-431f-ab52-9d81af00de7a create v1 at 2025-06-29T07:21:24.910Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 1
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'e' UUID 4b1bb6ba-5947-4d09-99be-e227fc854ce8
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 4b1bb6ba-5947-4d09-99be-e227fc854ce8 create v1 at 2025-06-29T07:21:24.910Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 2
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'n' UUID 9ba8caf0-5fef-43e9-aa7d-7a4c900de1bf
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 9ba8caf0-5fef-43e9-aa7d-7a4c900de1bf create v1 at 2025-06-29T07:21:24.910Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 3
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'o' UUID 5a44d1dd-1c8d-455c-b528-8c44bb37f2d6
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 5a44d1dd-1c8d-455c-b528-8c44bb37f2d6 create v1 at 2025-06-29T07:21:24.910Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 4
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 's' UUID fb975125-32b5-49a3-aa70-b05b36c68e23
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords fb975125-32b5-49a3-aa70-b05b36c68e23 create v1 at 2025-06-29T07:21:24.910Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 5
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 't' UUID c04b6189-314c-43b3-859a-eeca18cd19f0
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords c04b6189-314c-43b3-859a-eeca18cd19f0 create v1 at 2025-06-29T07:21:24.911Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 6
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 107d6244-972f-462d-82d7-24ed12bd23c6_097d3372-651a-431f-ab52-9d81af00de7a link v1 at 2025-06-29T07:21:24.911Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 107d6244-972f-462d-82d7-24ed12bd23c6_4b1bb6ba-5947-4d09-99be-e227fc854ce8 link v1 at 2025-06-29T07:21:24.911Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 107d6244-972f-462d-82d7-24ed12bd23c6_9ba8caf0-5fef-43e9-aa7d-7a4c900de1bf link v1 at 2025-06-29T07:21:24.911Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 107d6244-972f-462d-82d7-24ed12bd23c6_5a44d1dd-1c8d-455c-b528-8c44bb37f2d6 link v1 at 2025-06-29T07:21:24.911Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 107d6244-972f-462d-82d7-24ed12bd23c6_fb975125-32b5-49a3-aa70-b05b36c68e23 link v1 at 2025-06-29T07:21:24.911Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords 107d6244-972f-462d-82d7-24ed12bd23c6_c04b6189-314c-43b3-859a-eeca18cd19f0 link v1 at 2025-06-29T07:21:24.911Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 1. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 1, UUID d0c053cf-1fcb-44ae-8654-f159513db605
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions d0c053cf-1fcb-44ae-8654-f159513db605 create v1 at 2025-06-29T07:21:24.911Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/two, title=Test Media Two, client=test_client_id
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media d88ca57b-b54a-49db-a6e4-cc235e040343 create v1 at 2025-06-29T07:21:24.911Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 2: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 2
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword ',' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'e' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 'o' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 's' already active.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keyword 't' already active.
INFO     tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Adding new keyword 'w' UUID 8b2d0338-d3f6-4afb-824e-89c34cff2a2b
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Keywords 8b2d0338-d3f6-4afb-824e-89c34cff2a2b create v1 at 2025-06-29T07:21:24.912Z
DEBUG    root:Client_Media_DB_v2.py:973 Updated FTS (insert or replace) for Keyword ID 7
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d88ca57b-b54a-49db-a6e4-cc235e040343_097d3372-651a-431f-ab52-9d81af00de7a link v1 at 2025-06-29T07:21:24.912Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d88ca57b-b54a-49db-a6e4-cc235e040343_4b1bb6ba-5947-4d09-99be-e227fc854ce8 link v1 at 2025-06-29T07:21:24.912Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d88ca57b-b54a-49db-a6e4-cc235e040343_5a44d1dd-1c8d-455c-b528-8c44bb37f2d6 link v1 at 2025-06-29T07:21:24.912Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d88ca57b-b54a-49db-a6e4-cc235e040343_fb975125-32b5-49a3-aa70-b05b36c68e23 link v1 at 2025-06-29T07:21:24.912Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d88ca57b-b54a-49db-a6e4-cc235e040343_c04b6189-314c-43b3-859a-eeca18cd19f0 link v1 at 2025-06-29T07:21:24.912Z
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: MediaKeywords d88ca57b-b54a-49db-a6e4-cc235e040343_8b2d0338-d3f6-4afb-824e-89c34cff2a2b link v1 at 2025-06-29T07:21:24.912Z
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Keywords updated media 2. Added: 6, Removed: 0.
DEBUG    tldw_chatbook.DB.Client_Media_DB_v2:Logging_Config.py:160 Creating document version 1 for media ID 2, UUID 97fafe8f-1275-42e3-8510-60ddffd660d7
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions 97fafe8f-1275-42e3-8510-60ddffd660d7 create v1 at 2025-06-29T07:21:24.912Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
----------------------------- Captured stderr call -----------------------------
----------------------------------------

501. !!! CRITICAL ERROR in RichLog processor: Event loop is closed
Traceback (most recent call last):
  File "/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/asyncio/queues.py", line 158, in get
    await getter
GeneratorExit
----------------------------------------

502. ERROR    root:metrics.py:99 Failed to log histogram app_compose_duration_seconds: No label names were set when constructing histogram:app_compose_duration_seconds
DEBUG    root:app.py:1329 App compose finished in 0.001 seconds
----------------------------------------

503. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

504. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 Composing ChatWindow UI
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
WARNING  tldw_chatbook.config:Logging_Config.py:160 Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
INFO     tldw_chatbook.config:Logging_Config.py:160 Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
INFO     tldw_chatbook.config:Logging_Config.py:160 Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
INFO     root:settings_sidebar.py:42 Sidebar chat: Received providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
DEBUG    tldw_chatbook.UI.Chat_Window:Logging_Config.py:160 'respond-for-me-button' composed.
DEBUG    tldw_chatbook.app:Logging_Config.py:160 Chat ephemeral state changed to: True
DEBUG    root:chat_right_sidebar.py:355 Character sidebar (id='chat-right-sidebar', prefix='chat') created with ephemeral state: True
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing CCPWindow UI
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing center pane
DEBUG    tldw_chatbook.UI.Conv_Char_Window:Logging_Config.py:160 Composing right pane
DEBUG    tldw_chatbook.UI.SearchRAGWindow:Logging_Config.py:160 Loaded 0 recent search queries
DEBUG    tldw_chatbook.UI.Ingest_Window:Logging_Config.py:160 Composing IngestWindow UI
INFO     root:Stats_screen.py:25 MetricsScreen initialized. Log path: /tmp/app_metrics.log
INFO     root:Stats_screen.py:76 MetricsScreen composing. Current metrics: {}
WARNING  root:Stats_screen.py:79 MetricsScreen compose: self.metrics is unexpectedly empty at compose time.
INFO     root:Stats_screen.py:93 MetricsScreen compose finished.
----------------------------------------

505. ERROR    asyncio:base_events.py:1833 Task was destroyed but it is pending!
task: <Task pending name='RichLogProcessor' coro=<RichLogHandler._process_log_queue() running at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Logging_Config.py:78> wait_for=<Future pending cb=[Task.task_wakeup()]>>
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:29 MetricsScreen on_mount: Calling load_metrics.
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Stats_screen.py:45 Attempting to load metrics from: /tmp/app_metrics.log
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
----------------------------------------

506. ERROR    root:Stats_screen.py:68 MetricsScreen: Log file not found at /tmp/app_metrics.log.
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     tldw_chatbook.UI.Coding_Window:Logging_Config.py:160 CodingWindow on_mount: UI composed
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 3, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 5, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=4,level=0,tokens=6), 4, 5, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=2,level=0,tokens=3), 2, 3, False
DEBUG    tldw_chatbook.UI.LLM_Management_Window:Logging_Config.py:160 LLMManagementWindow.on_mount called
INFO     tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 EvalsWindow on_mount: UI composed
----------------------------------------

507. ERROR    tldw_chatbook.UI.Evals_Window:Logging_Config.py:160 Error initializing evaluation system: cannot import name 'EvaluationOrchestrator' from 'tldw_chatbook.Evals' (/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Evals/__init__.py)
INFO     tldw_chatbook.RAG_Search.Services.embeddings_service:Logging_Config.py:160 ChromaDB initialized at /Users/appledev/.local/share/tldw_cli/chromadb
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting and initializing initial active sub-tab.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-chat display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-rag-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-creation display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-embeddings-management display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Setting view search-view-web-search display to False
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initial active sub-tab set to search-view-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Added active class to nav button search-nav-embeddings-creation
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Set display=True for active view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 SearchWindow.on_mount: Initializing view search-view-embeddings-creation
INFO     tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Initializing Embeddings Creation view.
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation provider select changed to: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Creation model select changed to: e5-small-v2 for provider: huggingface
DEBUG    tldw_chatbook.UI.SearchWindow:Logging_Config.py:160 Provider specific inputs visibility updated. Custom HF: False, Local API URL: False (Value: '', Disabled: False)
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.code:code.py:10 entering code: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.fence:fence.py:10 entering fence: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.blockquote:blockquote.py:13 entering blockquote: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.hr:hr.py:14 entering hr: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.list:list.py:102 entering list: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.reference:reference.py:10 entering reference: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.html_block:html_block.py:35 entering html_block: StateBlock(line=0,level=0,tokens=0), 0, 1, False
DEBUG    markdown_it.rules_block.heading:heading.py:13 entering heading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Logging_Config.py:137 --- _setup_logging START (from Logging_Config.py) ---
DEBUG    markdown_it.rules_block.lheading:lheading.py:10 entering lheading: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Logging_Config.py:145 Loguru: All pre-existing sinks removed.
DEBUG    markdown_it.rules_block.paragraph:paragraph.py:10 entering paragraph: StateBlock(line=0,level=0,tokens=0), 0, 1, False
INFO     root:Logging_Config.py:168 Loguru: Configured to forward its messages to standard Python logging system.
____________ TestTokenCounter.test_get_model_token_limit_by_prefix _____________
Tests/Chat/test_token_counter.py:55: in test_get_model_token_limit_by_prefix
    assert get_model_token_limit("claude-3-opus-custom") == 200000
E   AssertionError: assert 4096 == 200000
E    +  where 4096 = get_model_token_limit('claude-3-opus-custom')
=============================== warnings summary ===============================
.venv/lib/python3.12/site-packages/_hypothesis_pytestplugin.py:461
  /Users/appledev/Working/tldw_chatbook_dev/.venv/lib/python3.12/site-packages/_hypothesis_pytestplugin.py:461: UserWarning: Skipping collection of '.hypothesis' directory - this usually means you've explicitly set the `norecursedirs` pytest config option, replacing rather than extending the default ignores.
    warnings.warn(
----------------------------------------

508. ERROR Tests/Chat/test_chat_sidebar_media_search.py::test_media_search_initial_state
----------------------------------------

509. ERROR Tests/Chat/test_chat_sidebar_media_search.py::test_media_search_functionality
----------------------------------------

510. ERROR Tests/Chat/test_chat_sidebar_media_search.py::test_media_load_for_review
----------------------------------------

511. ERROR Tests/Chat/test_chat_sidebar_media_search.py::test_media_copy_buttons[chat-media-copy-title-button-title-Title copied to clipboard.]
----------------------------------------

512. ERROR Tests/Chat/test_chat_sidebar_media_search.py::test_media_copy_buttons[chat-media-copy-content-button-content-Content copied to clipboard.]
----------------------------------------

513. ERROR Tests/Chat/test_chat_sidebar_media_search.py::test_media_copy_buttons[chat-media-copy-author-button-author-Author copied to clipboard.]
----------------------------------------

514. ERROR Tests/Chat/test_chat_sidebar_media_search.py::test_media_copy_buttons[chat-media-copy-url-button-url-URL copied to clipboard.]
----------------------------------------

515. ERROR Tests/Chat/test_chat_sidebar_media_search.py::test_media_review_clearing_on_new_empty_search
----------------------------------------

516. ERROR Tests/Chat/test_chat_sidebar_media_search.py::test_media_search_input_debounced
----------------------------------------

517. FAILED Tests/Chat/test_chat_integration_APIs.py::test_provider_api_basic_call[koboldcpp]
----------------------------------------

518. FAILED Tests/Chat/test_chat_integration_APIs.py::test_provider_api_streaming_call[koboldcpp]
----------------------------------------

519. FAILED Tests/Chat/test_chat_mocked_apis.py::TestMockedChatAPIs::test_api_error_handling
----------------------------------------

520. FAILED Tests/Chat/test_chat_mocked_apis.py::TestMockedChatAPIs::test_chat_function_with_mock
----------------------------------------

521. FAILED Tests/Chat/test_chat_mocked_apis.py::TestMockedChatAPIs::test_provider_parameter_mapping
----------------------------------------

522. FAILED Tests/Chat/test_chat_mocked_apis.py::TestMockedStreamingAPIs::test_streaming_error_handling
----------------------------------------

523. FAILED Tests/Chat/test_chat_sidebar_media_search.py::test_media_search_initial_state
----------------------------------------

524. FAILED Tests/Chat/test_chat_sidebar_media_search.py::test_media_search_functionality
----------------------------------------

525. FAILED Tests/Chat/test_chat_sidebar_media_search.py::test_media_load_for_review
----------------------------------------

526. FAILED Tests/Chat/test_chat_sidebar_media_search.py::test_media_copy_buttons[chat-media-copy-title-button-title-Title copied to clipboard.]
----------------------------------------

527. FAILED Tests/Chat/test_chat_sidebar_media_search.py::test_media_copy_buttons[chat-media-copy-content-button-content-Content copied to clipboard.]
----------------------------------------

528. FAILED Tests/Chat/test_chat_sidebar_media_search.py::test_media_copy_buttons[chat-media-copy-author-button-author-Author copied to clipboard.]
----------------------------------------

529. FAILED Tests/Chat/test_chat_sidebar_media_search.py::test_media_copy_buttons[chat-media-copy-url-button-url-URL copied to clipboard.]
----------------------------------------

530. FAILED Tests/Chat/test_chat_sidebar_media_search.py::test_media_review_clearing_on_new_empty_search
----------------------------------------

531. FAILED Tests/Chat/test_chat_sidebar_media_search.py::test_media_search_input_debounced
----------------------------------------

532. FAILED Tests/Chat/test_token_counter.py::TestTokenCounter::test_get_model_token_limit_by_prefix
16 failed, 58 passed, 39 skipped, 9 warnings, 9 errors in 47.83s
----------------------------------------

533. Tests/Chat/test_chat_integration_APIs.py::test_provider_api_basic_call[koboldcpp]: .venv/lib/python3.12/site-packages/urllib3/connection.py:198: in _new_conn
    sock = connection.create_connection(
.venv/lib/python3.12/site-packages/urllib3/util/connection.py:85: in create_connection
    raise err
.venv/lib/python3.12/site-packages/urllib3/util/connection.py:73: in create_connection
    sock.connect(sa)
E   ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:
.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:787: in urlopen
    response = self._make_request(
.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:493: in _make_request
    conn.request(
.venv/lib/python3.12/site-packages/urllib3/connection.py:445: in request
    self.endheaders()
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/http/client.py:1333: in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/http/client.py:1093: in _send_output
    self.send(msg)
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/http/client.py:1037: in send
    self.connect()
.venv/lib/python3.12/site-packages/urllib3/connection.py:276: in connect
    self.sock = self._new_conn()
                ^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/urllib3/connection.py:213: in _new_conn
    raise NewConnectionError(
E   urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x16a64ebd0>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:
.venv/lib/python3.12/site-packages/requests/adapters.py:667: in send
    resp = conn.urlopen(
.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:871: in urlopen
    return self.urlopen(
.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:841: in urlopen
    retries = retries.increment(
.venv/lib/python3.12/site-packages/urllib3/util/retry.py:519: in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=5001): Max retries exceeded with url: /api/v1/generate (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x16a64ebd0>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:
tldw_chatbook/LLM_Calls/LLM_API_Calls_Local.py:546: in chat_with_kobold
    response = session.post(current_api_base_url, headers=headers, json=payload, timeout=timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/requests/sessions.py:637: in post
    return self.request("POST", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/requests/sessions.py:589: in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/requests/sessions.py:703: in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/requests/adapters.py:700: in send
    raise ConnectionError(e, request=request)
E   requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=5001): Max retries exceeded with url: /api/v1/generate (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x16a64ebd0>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:
Tests/Chat/test_chat_integration_APIs.py:181: in test_provider_api_basic_call
    response = chat_api_call(**params_for_call)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tldw_chatbook/Chat/Chat_Functions.py:686: in chat_api_call
    raise e_chat_direct  # Re-raise the specific error
    ^^^^^^^^^^^^^^^^^^^
tldw_chatbook/Chat/Chat_Functions.py:631: in chat_api_call
    response = handler(**call_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^
tldw_chatbook/LLM_Calls/LLM_API_Calls_Local.py:567: in chat_with_kobold
    raise ChatProviderError(provider="kobold", message=f"Network error calling KoboldAI (Native): {e_req}", status_code=503)
E   tldw_chatbook.Chat.Chat_Deps.ChatProviderError: Network error calling KoboldAI (Native): HTTPConnectionPool(host='localhost', port=5001): Max retries exceeded with url: /api/v1/generate (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x16a64ebd0>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:
Tests/Chat/test_chat_integration_APIs.py:190: in test_provider_api_basic_call
    pytest.warning(f"Provider {provider} returned a server error {e.status_code}: {e.message}")
    ^^^^^^^^^^^^^^
E   AttributeError: module 'pytest' has no attribute 'warning'
----------------------------------------

534. Tests/Chat/test_chat_integration_APIs.py::test_provider_api_streaming_call[koboldcpp]: .venv/lib/python3.12/site-packages/urllib3/connection.py:198: in _new_conn
    sock = connection.create_connection(
.venv/lib/python3.12/site-packages/urllib3/util/connection.py:85: in create_connection
    raise err
.venv/lib/python3.12/site-packages/urllib3/util/connection.py:73: in create_connection
    sock.connect(sa)
E   ConnectionRefusedError: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:
.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:787: in urlopen
    response = self._make_request(
.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:493: in _make_request
    conn.request(
.venv/lib/python3.12/site-packages/urllib3/connection.py:445: in request
    self.endheaders()
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/http/client.py:1333: in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/http/client.py:1093: in _send_output
    self.send(msg)
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/http/client.py:1037: in send
    self.connect()
.venv/lib/python3.12/site-packages/urllib3/connection.py:276: in connect
    self.sock = self._new_conn()
                ^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/urllib3/connection.py:213: in _new_conn
    raise NewConnectionError(
E   urllib3.exceptions.NewConnectionError: <urllib3.connection.HTTPConnection object at 0x16a75ecc0>: Failed to establish a new connection: [Errno 61] Connection refused

The above exception was the direct cause of the following exception:
.venv/lib/python3.12/site-packages/requests/adapters.py:667: in send
    resp = conn.urlopen(
.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:871: in urlopen
    return self.urlopen(
.venv/lib/python3.12/site-packages/urllib3/connectionpool.py:841: in urlopen
    retries = retries.increment(
.venv/lib/python3.12/site-packages/urllib3/util/retry.py:519: in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   urllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=5001): Max retries exceeded with url: /api/v1/generate (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x16a75ecc0>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:
tldw_chatbook/LLM_Calls/LLM_API_Calls_Local.py:546: in chat_with_kobold
    response = session.post(current_api_base_url, headers=headers, json=payload, timeout=timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/requests/sessions.py:637: in post
    return self.request("POST", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/requests/sessions.py:589: in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/requests/sessions.py:703: in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/requests/adapters.py:700: in send
    raise ConnectionError(e, request=request)
E   requests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=5001): Max retries exceeded with url: /api/v1/generate (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x16a75ecc0>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:
Tests/Chat/test_chat_integration_APIs.py:250: in test_provider_api_streaming_call
    response_generator = chat_api_call(**params_for_call)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tldw_chatbook/Chat/Chat_Functions.py:686: in chat_api_call
    raise e_chat_direct  # Re-raise the specific error
    ^^^^^^^^^^^^^^^^^^^
tldw_chatbook/Chat/Chat_Functions.py:631: in chat_api_call
    response = handler(**call_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^
tldw_chatbook/LLM_Calls/LLM_API_Calls_Local.py:567: in chat_with_kobold
    raise ChatProviderError(provider="kobold", message=f"Network error calling KoboldAI (Native): {e_req}", status_code=503)
E   tldw_chatbook.Chat.Chat_Deps.ChatProviderError: Network error calling KoboldAI (Native): HTTPConnectionPool(host='localhost', port=5001): Max retries exceeded with url: /api/v1/generate (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x16a75ecc0>: Failed to establish a new connection: [Errno 61] Connection refused'))

During handling of the above exception, another exception occurred:
Tests/Chat/test_chat_integration_APIs.py:255: in test_provider_api_streaming_call
    pytest.warning(f"Provider {provider} (streaming) returned server error {e.status_code}: {e.message}")
    ^^^^^^^^^^^^^^
E   AttributeError: module 'pytest' has no attribute 'warning'
----------------------------------------

535. Tests/Chat/test_chat_mocked_apis.py::TestMockedChatAPIs::test_api_error_handling: tldw_chatbook/LLM_Calls/LLM_API_Calls.py:335: in chat_with_openai
    response.raise_for_status()  # Raise HTTPError for 4xx/5xx AFTER retries
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1139: in __call__
    return self._mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1143: in _mock_call
    return self._execute_mock_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1198: in _execute_mock_call
    raise effect
E   Exception: Unauthorized

During handling of the above exception, another exception occurred:
Tests/Chat/test_chat_mocked_apis.py:151: in test_api_error_handling
    chat_api_call(
tldw_chatbook/Chat/Chat_Functions.py:686: in chat_api_call
    raise e_chat_direct  # Re-raise the specific error
    ^^^^^^^^^^^^^^^^^^^
tldw_chatbook/Chat/Chat_Functions.py:631: in chat_api_call
    response = handler(**call_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^
tldw_chatbook/LLM_Calls/LLM_API_Calls.py:363: in chat_with_openai
    raise ChatProviderError(provider="openai", message=f"Unexpected error: {e}")
E   tldw_chatbook.Chat.Chat_Deps.ChatProviderError: Unexpected error: Unauthorized
----------------------------------------

536. Tests/Chat/test_chat_mocked_apis.py::TestMockedChatAPIs::test_chat_function_with_mock: Tests/Chat/test_chat_mocked_apis.py:175: in test_chat_function_with_mock
    result = chat(
E   TypeError: chat() missing 4 required positional arguments: 'history', 'media_content', 'selected_parts', and 'custom_prompt'
----------------------------------------

537. Tests/Chat/test_chat_mocked_apis.py::TestMockedChatAPIs::test_provider_parameter_mapping: Tests/Chat/test_chat_mocked_apis.py:207: in test_provider_parameter_mapping
    assert openai_map["temperature"] == "temperature"
           ^^^^^^^^^^^^^^^^^^^^^^^^^
E   KeyError: 'temperature'
----------------------------------------

538. Tests/Chat/test_chat_mocked_apis.py::TestMockedStreamingAPIs::test_streaming_error_handling: Tests/Chat/test_chat_mocked_apis.py:290: in test_streaming_error_handling
    with pytest.raises(ChatAPIError):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE <class 'tldw_chatbook.Chat.Chat_Deps.ChatAPIError'>
----------------------------------------

539. Tests/Chat/test_chat_sidebar_media_search.py::test_media_search_initial_state: Tests/Chat/test_chat_sidebar_media_search.py:125: in test_media_search_initial_state
    collapsible = app.query_one("#chat-media-search-collapsible", Collapsible)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/textual/dom.py:1496: in query_one
    raise NoMatches(f"No nodes match {selector!r} on {self!r}")
E   textual.css.query.NoMatches: No nodes match '#chat-media-search-collapsible' on TldwCli(title='[B][N][S]  tldw CLI', classes={'-dark-mode'}, pseudo_classes={'dark', 'focus'})
----------------------------------------

540. Tests/Chat/test_chat_sidebar_media_search.py::test_media_search_functionality: Tests/Chat/test_chat_sidebar_media_search.py:188: in test_media_search_functionality
    assert "Test Media One" in str(label.renderable)
E   AssertionError: assert 'Test Media One' in 'Test Media Two (ID: Unknown ID)'
E    +  where 'Test Media Two (ID: Unknown ID)' = str('Test Media Two (ID: Unknown ID)')
E    +    where 'Test Media Two (ID: Unknown ID)' = Label().renderable
----------------------------------------

541. Tests/Chat/test_chat_sidebar_media_search.py::test_media_load_for_review: Tests/Chat/test_chat_sidebar_media_search.py:233: in test_media_load_for_review
    load_button = app.query_one("#chat-media-load-selected-button", Button)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/textual/dom.py:1496: in query_one
    raise NoMatches(f"No nodes match {selector!r} on {self!r}")
E   textual.css.query.NoMatches: No nodes match '#chat-media-load-selected-button' on TldwCli(title='[B][N][S]  tldw CLI', classes={'-dark-mode'}, pseudo_classes={'dark', 'focus'})
----------------------------------------

542. Tests/Chat/test_chat_sidebar_media_search.py::test_media_copy_buttons[chat-media-copy-title-button-title-Title copied to clipboard.]: Tests/Chat/test_chat_sidebar_media_search.py:287: in test_media_copy_buttons
    load_button = app.query_one("#chat-media-load-selected-button", Button)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/textual/dom.py:1496: in query_one
    raise NoMatches(f"No nodes match {selector!r} on {self!r}")
E   textual.css.query.NoMatches: No nodes match '#chat-media-load-selected-button' on TldwCli(title='[B][N][S]  tldw CLI', classes={'-dark-mode'}, pseudo_classes={'dark', 'focus'})
----------------------------------------

543. Tests/Chat/test_chat_sidebar_media_search.py::test_media_copy_buttons[chat-media-copy-content-button-content-Content copied to clipboard.]: Tests/Chat/test_chat_sidebar_media_search.py:287: in test_media_copy_buttons
    load_button = app.query_one("#chat-media-load-selected-button", Button)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/textual/dom.py:1496: in query_one
    raise NoMatches(f"No nodes match {selector!r} on {self!r}")
E   textual.css.query.NoMatches: No nodes match '#chat-media-load-selected-button' on TldwCli(title='[B][N][S]  tldw CLI', classes={'-dark-mode'}, pseudo_classes={'dark', 'focus'})
----------------------------------------

544. Tests/Chat/test_chat_sidebar_media_search.py::test_media_copy_buttons[chat-media-copy-author-button-author-Author copied to clipboard.]: Tests/Chat/test_chat_sidebar_media_search.py:287: in test_media_copy_buttons
    load_button = app.query_one("#chat-media-load-selected-button", Button)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/textual/dom.py:1496: in query_one
    raise NoMatches(f"No nodes match {selector!r} on {self!r}")
E   textual.css.query.NoMatches: No nodes match '#chat-media-load-selected-button' on TldwCli(title='[B][N][S]  tldw CLI', classes={'-dark-mode'}, pseudo_classes={'dark', 'focus'})
----------------------------------------

545. Tests/Chat/test_chat_sidebar_media_search.py::test_media_copy_buttons[chat-media-copy-url-button-url-URL copied to clipboard.]: Tests/Chat/test_chat_sidebar_media_search.py:287: in test_media_copy_buttons
    load_button = app.query_one("#chat-media-load-selected-button", Button)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/textual/dom.py:1496: in query_one
    raise NoMatches(f"No nodes match {selector!r} on {self!r}")
E   textual.css.query.NoMatches: No nodes match '#chat-media-load-selected-button' on TldwCli(title='[B][N][S]  tldw CLI', classes={'-dark-mode'}, pseudo_classes={'dark', 'focus'})
----------------------------------------

546. Tests/Chat/test_chat_sidebar_media_search.py::test_media_review_clearing_on_new_empty_search: Tests/Chat/test_chat_sidebar_media_search.py:341: in test_media_review_clearing_on_new_empty_search
    load_button = app.query_one("#chat-media-load-selected-button", Button)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/textual/dom.py:1496: in query_one
    raise NoMatches(f"No nodes match {selector!r} on {self!r}")
E   textual.css.query.NoMatches: No nodes match '#chat-media-load-selected-button' on TldwCli(title='[B][N][S]  tldw CLI', classes={'-dark-mode'}, pseudo_classes={'dark', 'focus'})
----------------------------------------

547. Tests/Chat/test_chat_sidebar_media_search.py::test_media_search_input_debounced: Tests/Chat/test_chat_sidebar_media_search.py:399: in test_media_search_input_debounced
    await pilot.type("t")
          ^^^^^^^^^^
E   AttributeError: 'Pilot' object has no attribute 'type'
----------------------------------------

548. Tests/Chat/test_token_counter.py::TestTokenCounter::test_get_model_token_limit_by_prefix: Tests/Chat/test_token_counter.py:55: in test_get_model_token_limit_by_prefix
    assert get_model_token_limit("claude-3-opus-custom") == 200000
E   AssertionError: assert 4096 == 200000
E    +  where 4096 = get_model_token_limit('claude-3-opus-custom')
----------------------------------------

================================================================================

Directory: Notes
Duration: 0.39s
Passed: 0, Failed: 0, Skipped: 0, Errors: 0

Failures:

1. ==================================== ERRORS ====================================
----------------------------------------

2. ____________ ERROR collecting Tests/Notes/test_notes_integration.py ____________
ImportError while importing test module '/Users/appledev/Working/tldw_chatbook_dev/Tests/Notes/test_notes_integration.py'.
Hint: make sure your test modules/packages have valid Python names.
Traceback:
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/importlib/__init__.py:90: in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Tests/Notes/test_notes_integration.py:14: in <module>
    from tldw_chatbook.Notes.Notes_Library import NotesLibrary
E   ImportError: cannot import name 'NotesLibrary' from 'tldw_chatbook.Notes.Notes_Library' (/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Notes/Notes_Library.py)
------------------------------- Captured stderr --------------------------------
2025-06-29 00:21:32.364 | DEBUG    | tldw_chatbook.config:<module>:29 - CRITICAL DEBUG: config.py module is being imported/executed NOW.
2025-06-29 00:21:32.364 | INFO     | tldw_chatbook.config:load_openai_mappings:130 - Attempting to load OpenAI TTS mappings from: /Users/appledev/Working/Config_Files/openai_tts_mappings.json
----------------------------------------

3. 2025-06-29 00:21:32.364 | ERROR    | tldw_chatbook.config:load_openai_mappings:135 - Failed to load OpenAI TTS mappings from /Users/appledev/Working/Config_Files/openai_tts_mappings.json: [Errno 2] No such file or directory: '/Users/appledev/Working/Config_Files/openai_tts_mappings.json'
2025-06-29 00:21:32.367 | INFO     | tldw_chatbook.config:load_cli_config_and_ensure_existence:1614 - Attempting to load CLI config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:32.369 | INFO     | tldw_chatbook.config:load_cli_config_and_ensure_existence:1620 - Successfully loaded and merged CLI config from /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:32.369 | DEBUG    | tldw_chatbook.config:load_cli_config_and_ensure_existence:1630 - load_cli_config_and_ensure_existence returning config with top-level keys: ['general', 'tldw_api', 'logging', 'database', 'api_endpoints', 'providers', 'api_settings', 'chat_defaults', 'character_defaults', 'Prompts', 'embedding_config', 'rag', 'rag_search']
2025-06-29 00:21:32.369 | DEBUG    | tldw_chatbook.config:load_cli_config_and_ensure_existence:1632 -   'api_settings' found with keys: ['openai', 'anthropic', 'cohere', 'deepseek', 'groq', 'google', 'huggingface', 'mistralai', 'openrouter', 'llama_cpp', 'oobabooga', 'koboldcpp', 'ollama', 'vllm', 'aphrodite', 'tabbyapi', 'custom', 'custom_2', 'local-llm', 'local_llamafile', 'local_llamacpp', 'local_vllm', 'local_ollama', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:21:32.369 | INFO     | tldw_chatbook.config:load_settings:207 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:32.369 | INFO     | tldw_chatbook.config:load_settings:208 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:32.369 | INFO     | tldw_chatbook.config:load_settings:217 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:32.369 | WARNING  | tldw_chatbook.config:load_settings:223 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:32.369 | INFO     | tldw_chatbook.config:load_settings:232 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:32.370 | INFO     | tldw_chatbook.config:load_settings:237 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:32.371 | INFO     | tldw_chatbook.config:load_settings:252 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:32.371 | INFO     | tldw_chatbook.config:<module>:1851 - Default API Endpoint (from config.py global scope): openai
2025-06-29 00:21:32.371 | DEBUG    | tldw_chatbook.config:<module>:1871 - CRITICAL DEBUG: CALLING initialize_all_databases() from config.py module level.
2025-06-29 00:21:32.372 | DEBUG    | tldw_chatbook.config:initialize_all_databases:1785 - CRITICAL DEBUG: INSIDE initialize_all_databases() NOW.
2025-06-29 00:21:32.372 | INFO     | tldw_chatbook.config:initialize_all_databases:1786 - Initializing CLI databases...
2025-06-29 00:21:32.372 | INFO     | tldw_chatbook.config:initialize_all_databases:1789 - Attempting to initialize ChaChaNotes_DB at: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:32.372 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:__init__:992 - Initializing CharactersRAGDB for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:21:32.372 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1051 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:21:32.372 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__enter__:4087 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:21:32.372 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1403 - Checking DB schema 'rag_char_chat_schema'. Current version: 5. Code supports: 5
2025-06-29 00:21:32.372 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1407 - Database schema 'rag_char_chat_schema' is up to date (Version 5).
2025-06-29 00:21:32.372 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__exit__:4114 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:21:32.372 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__init__:996 - CharactersRAGDB initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:32.372 | SUCCESS  | tldw_chatbook.config:initialize_all_databases:1792 - ChaChaNotes_DB initialized successfully at /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:32.372 | INFO     | tldw_chatbook.config:initialize_all_databases:1798 - Attempting to initialize Prompts_DB at: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:32.373 | INFO     | tldw_chatbook.DB.Prompts_DB:__init__:251 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:21:32.373 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_get_thread_connection:317 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:21:32.373 | INFO     | tldw_chatbook.DB.Prompts_DB:_initialize_schema:518 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:21:32.373 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_initialize_schema:521 - Database schema is up to date.
2025-06-29 00:21:32.373 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_initialize_schema:525 - Verified FTS tables exist.
2025-06-29 00:21:32.373 | DEBUG    | tldw_chatbook.DB.Prompts_DB:__init__:281 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:32.373 | SUCCESS  | tldw_chatbook.config:initialize_all_databases:1801 - Prompts_DB initialized successfully at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:32.373 | INFO     | tldw_chatbook.config:initialize_all_databases:1807 - Attempting to initialize Media_DB_v2 at: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:32.373 | SUCCESS  | tldw_chatbook.config:initialize_all_databases:1810 - Media_DB_v2 initialized successfully at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:32.373 | INFO     | tldw_chatbook.config:initialize_all_databases:1814 - CLI database initialization complete.
=============================== warnings summary ===============================
.venv/lib/python3.12/site-packages/_hypothesis_pytestplugin.py:461
  /Users/appledev/Working/tldw_chatbook_dev/.venv/lib/python3.12/site-packages/_hypothesis_pytestplugin.py:461: UserWarning: Skipping collection of '.hypothesis' directory - this usually means you've explicitly set the `norecursedirs` pytest config option, replacing rather than extending the default ignores.
    warnings.warn(
----------------------------------------

4. ERROR Tests/Notes/test_notes_integration.py
!!!!!!!!!!!!!!!!!!!! Interrupted: 1 error during collection !!!!!!!!!!!!!!!!!!!!
1 skipped, 1 warning, 1 error in 0.16s
----------------------------------------

================================================================================

Directory: LLM_Management
Duration: 5.43s
Passed: 27, Failed: 0, Skipped: 0, Errors: 0

================================================================================

Directory: Evals
Duration: 7.56s
Passed: 54, Failed: 84, Skipped: 0, Errors: 7

Failures:

1. ==================================== ERRORS ====================================
----------------------------------------

2. ____ ERROR at setup of TestDatabaseProperties.test_task_roundtrip_property _____
file /Users/appledev/Working/tldw_chatbook_dev/Tests/Evals/test_eval_properties.py, line 137
      @given(task_config_strategy())
      @settings(max_examples=20, deadline=None)
      def test_task_roundtrip_property(self, task_config, in_memory_db):
E       fixture 'task_config' not found
>       available fixtures: _class_event_loop, _function_event_loop, _module_event_loop, _package_event_loop, _session_event_loop, anyio_backend, anyio_backend_name, anyio_backend_options, async_setup, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, capteesys, class_mocker, doctest_namespace, eval_orchestrator, eval_runner, event_loop, event_loop_policy, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, in_memory_db, include_metadata_in_junit_xml, json_metadata, large_dataset_config, metadata, mock_failing_llm, mock_llm_interface, mock_successful_llm, mocker, module_mocker, monkeypatch, package_mocker, performance_test_samples, property_test_data, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, sample_code_config, sample_csv_dataset_file, sample_custom_task_file, sample_eleuther_task_file, sample_eval_results, sample_gsm8k_config, sample_task_config, session_mocker, task_loader, temp_db, temp_db_path, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.
----------------------------------------

3. ___ ERROR at setup of TestDatabaseProperties.test_multiple_tasks_uniqueness ____
file /Users/appledev/Working/tldw_chatbook_dev/Tests/Evals/test_eval_properties.py, line 160
      @given(st.lists(task_config_strategy(), min_size=1, max_size=10))
      @settings(max_examples=10, deadline=None)
      def test_multiple_tasks_uniqueness(self, task_configs, in_memory_db):
E       fixture 'task_configs' not found
>       available fixtures: _class_event_loop, _function_event_loop, _module_event_loop, _package_event_loop, _session_event_loop, anyio_backend, anyio_backend_name, anyio_backend_options, async_setup, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, capteesys, class_mocker, doctest_namespace, eval_orchestrator, eval_runner, event_loop, event_loop_policy, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, in_memory_db, include_metadata_in_junit_xml, json_metadata, large_dataset_config, metadata, mock_failing_llm, mock_llm_interface, mock_successful_llm, mocker, module_mocker, monkeypatch, package_mocker, performance_test_samples, property_test_data, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, sample_code_config, sample_csv_dataset_file, sample_custom_task_file, sample_eleuther_task_file, sample_eval_results, sample_gsm8k_config, sample_task_config, session_mocker, task_loader, temp_db, temp_db_path, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.
----------------------------------------

4. _______ ERROR at setup of TestDatabaseProperties.test_search_consistency _______
file /Users/appledev/Working/tldw_chatbook_dev/Tests/Evals/test_eval_properties.py, line 186
      @given(st.text(min_size=1, max_size=100))
      @settings(max_examples=20, deadline=None)
      def test_search_consistency(self, search_term, in_memory_db):
E       fixture 'search_term' not found
>       available fixtures: _class_event_loop, _function_event_loop, _module_event_loop, _package_event_loop, _session_event_loop, anyio_backend, anyio_backend_name, anyio_backend_options, async_setup, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, capteesys, class_mocker, doctest_namespace, eval_orchestrator, eval_runner, event_loop, event_loop_policy, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, in_memory_db, include_metadata_in_junit_xml, json_metadata, large_dataset_config, metadata, mock_failing_llm, mock_llm_interface, mock_successful_llm, mocker, module_mocker, monkeypatch, package_mocker, performance_test_samples, property_test_data, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, sample_code_config, sample_csv_dataset_file, sample_custom_task_file, sample_eleuther_task_file, sample_eval_results, sample_gsm8k_config, sample_task_config, session_mocker, task_loader, temp_db, temp_db_path, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.
----------------------------------------

5. _____ ERROR at setup of TestDatabaseProperties.test_pagination_properties ______
file /Users/appledev/Working/tldw_chatbook_dev/Tests/Evals/test_eval_properties.py, line 227
      @given(st.integers(min_value=1, max_value=100))
      @settings(max_examples=10, deadline=None)
      def test_pagination_properties(self, total_tasks, in_memory_db):
E       fixture 'total_tasks' not found
>       available fixtures: _class_event_loop, _function_event_loop, _module_event_loop, _package_event_loop, _session_event_loop, anyio_backend, anyio_backend_name, anyio_backend_options, async_setup, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, capteesys, class_mocker, doctest_namespace, eval_orchestrator, eval_runner, event_loop, event_loop_policy, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, in_memory_db, include_metadata_in_junit_xml, json_metadata, large_dataset_config, metadata, mock_failing_llm, mock_llm_interface, mock_successful_llm, mocker, module_mocker, monkeypatch, package_mocker, performance_test_samples, property_test_data, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, sample_code_config, sample_csv_dataset_file, sample_custom_task_file, sample_eleuther_task_file, sample_eval_results, sample_gsm8k_config, sample_task_config, session_mocker, task_loader, temp_db, temp_db_path, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.
----------------------------------------

6. _ ERROR at setup of TestConcurrencyProperties.test_concurrent_task_creation_uniqueness _
file /Users/appledev/Working/tldw_chatbook_dev/Tests/Evals/test_eval_properties.py, line 493
      @given(st.lists(st.text(min_size=1, max_size=50), min_size=2, max_size=10, unique=True))
      @settings(max_examples=10, deadline=None)
      def test_concurrent_task_creation_uniqueness(self, task_names, temp_db):
E       fixture 'task_names' not found
>       available fixtures: _class_event_loop, _function_event_loop, _module_event_loop, _package_event_loop, _session_event_loop, anyio_backend, anyio_backend_name, anyio_backend_options, async_setup, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, capteesys, class_mocker, doctest_namespace, eval_orchestrator, eval_runner, event_loop, event_loop_policy, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, in_memory_db, include_metadata_in_junit_xml, json_metadata, large_dataset_config, metadata, mock_failing_llm, mock_llm_interface, mock_successful_llm, mocker, module_mocker, monkeypatch, package_mocker, performance_test_samples, property_test_data, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, sample_code_config, sample_csv_dataset_file, sample_custom_task_file, sample_eleuther_task_file, sample_eval_results, sample_gsm8k_config, sample_task_config, session_mocker, task_loader, temp_db, temp_db_path, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.
----------------------------------------

7. ____ ERROR at setup of TestSystemInvariants.test_resource_cleanup_invariant ____
file /Users/appledev/Working/tldw_chatbook_dev/Tests/Evals/test_eval_properties.py, line 572
      @given(st.integers(min_value=1, max_value=50))
      @settings(max_examples=5, deadline=None)
      def test_resource_cleanup_invariant(self, num_operations, temp_db):
E       fixture 'num_operations' not found
>       available fixtures: _class_event_loop, _function_event_loop, _module_event_loop, _package_event_loop, _session_event_loop, anyio_backend, anyio_backend_name, anyio_backend_options, async_setup, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, capteesys, class_mocker, doctest_namespace, eval_orchestrator, eval_runner, event_loop, event_loop_policy, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, in_memory_db, include_metadata_in_junit_xml, json_metadata, large_dataset_config, metadata, mock_failing_llm, mock_llm_interface, mock_successful_llm, mocker, module_mocker, monkeypatch, package_mocker, performance_test_samples, property_test_data, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, sample_code_config, sample_csv_dataset_file, sample_custom_task_file, sample_eleuther_task_file, sample_eval_results, sample_gsm8k_config, sample_task_config, session_mocker, task_loader, temp_db, temp_db_path, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.
----------------------------------------

8. __ ERROR at setup of TestSystemInvariants.test_database_consistency_invariant __
file /Users/appledev/Working/tldw_chatbook_dev/Tests/Evals/test_eval_properties.py, line 606
      @given(st.lists(
          st.tuples(
              st.text(min_size=1, max_size=20),  # operation type
              st.dictionaries(st.text(), st.text(), max_size=3)  # operation data
          ),
          min_size=1,
          max_size=20
      ))
      @settings(max_examples=5, deadline=None)
      def test_database_consistency_invariant(self, operations, temp_db):
E       fixture 'operations' not found
>       available fixtures: _class_event_loop, _function_event_loop, _module_event_loop, _package_event_loop, _session_event_loop, anyio_backend, anyio_backend_name, anyio_backend_options, async_setup, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, capteesys, class_mocker, doctest_namespace, eval_orchestrator, eval_runner, event_loop, event_loop_policy, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, in_memory_db, include_metadata_in_junit_xml, json_metadata, large_dataset_config, metadata, mock_failing_llm, mock_llm_interface, mock_successful_llm, mocker, module_mocker, monkeypatch, package_mocker, performance_test_samples, property_test_data, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, sample_code_config, sample_csv_dataset_file, sample_custom_task_file, sample_eleuther_task_file, sample_eval_results, sample_gsm8k_config, sample_task_config, session_mocker, task_loader, temp_db, temp_db_path, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.
----------------------------------------

9. ERROR Tests/Evals/test_eval_properties.py::TestDatabaseProperties::test_task_roundtrip_property
----------------------------------------

10. ERROR Tests/Evals/test_eval_properties.py::TestDatabaseProperties::test_multiple_tasks_uniqueness
----------------------------------------

11. ERROR Tests/Evals/test_eval_properties.py::TestDatabaseProperties::test_search_consistency
----------------------------------------

12. ERROR Tests/Evals/test_eval_properties.py::TestDatabaseProperties::test_pagination_properties
----------------------------------------

13. ERROR Tests/Evals/test_eval_properties.py::TestConcurrencyProperties::test_concurrent_task_creation_uniqueness
----------------------------------------

14. ERROR Tests/Evals/test_eval_properties.py::TestSystemInvariants::test_resource_cleanup_invariant
----------------------------------------

15. ERROR Tests/Evals/test_eval_properties.py::TestSystemInvariants::test_database_consistency_invariant
----------------------------------------

16. FAILED Tests/Evals/test_eval_integration.py::TestEndToEndEvaluation::test_complete_evaluation_pipeline
----------------------------------------

17. FAILED Tests/Evals/test_eval_integration.py::TestEndToEndEvaluation::test_eleuther_task_integration
----------------------------------------

18. FAILED Tests/Evals/test_eval_integration.py::TestEndToEndEvaluation::test_csv_dataset_integration
----------------------------------------

19. FAILED Tests/Evals/test_eval_integration.py::TestMultiProviderIntegration::test_multiple_provider_evaluation
----------------------------------------

20. FAILED Tests/Evals/test_eval_integration.py::TestMultiProviderIntegration::test_provider_fallback_mechanism
----------------------------------------

21. FAILED Tests/Evals/test_eval_integration.py::TestSpecializedTaskIntegration::test_code_evaluation_integration
----------------------------------------

22. FAILED Tests/Evals/test_eval_integration.py::TestSpecializedTaskIntegration::test_safety_evaluation_integration
----------------------------------------

23. FAILED Tests/Evals/test_eval_integration.py::TestSpecializedTaskIntegration::test_multilingual_evaluation_integration
----------------------------------------

24. FAILED Tests/Evals/test_eval_integration.py::TestConcurrentEvaluations::test_concurrent_runs_same_task
----------------------------------------

25. FAILED Tests/Evals/test_eval_integration.py::TestConcurrentEvaluations::test_concurrent_task_creation
----------------------------------------

26. FAILED Tests/Evals/test_eval_integration.py::TestErrorRecoveryIntegration::test_partial_failure_recovery
----------------------------------------

27. FAILED Tests/Evals/test_eval_integration.py::TestErrorRecoveryIntegration::test_database_recovery_integration
----------------------------------------

28. FAILED Tests/Evals/test_eval_integration.py::TestPerformanceIntegration::test_large_scale_evaluation
----------------------------------------

29. FAILED Tests/Evals/test_eval_integration.py::TestPerformanceIntegration::test_memory_efficiency_integration
----------------------------------------

30. FAILED Tests/Evals/test_eval_properties.py::TestEvaluationProperties::test_exact_match_symmetry
----------------------------------------

31. FAILED Tests/Evals/test_eval_properties.py::TestEvaluationProperties::test_exact_match_reflexivity
----------------------------------------

32. FAILED Tests/Evals/test_eval_properties.py::TestEvaluationProperties::test_contains_answer_monotonicity
----------------------------------------

33. FAILED Tests/Evals/test_eval_properties.py::TestEvaluationProperties::test_metrics_aggregation_properties
----------------------------------------

34. FAILED Tests/Evals/test_eval_properties.py::TestEvaluationProperties::test_eval_result_invariants
----------------------------------------

35. FAILED Tests/Evals/test_eval_properties.py::TestTaskConfigurationProperties::test_generation_kwargs_validation
----------------------------------------

36. FAILED Tests/Evals/test_eval_properties.py::TestFileHandlingProperties::test_text_processing_robustness
----------------------------------------

37. FAILED Tests/Evals/test_eval_properties.py::TestConcurrencyProperties::test_evaluation_order_independence
----------------------------------------

38. FAILED Tests/Evals/test_eval_runner.py::TestEvalSampleResult::test_eval_result_with_error
----------------------------------------

39. FAILED Tests/Evals/test_eval_runner.py::TestEvalProgress::test_eval_progress_creation
----------------------------------------

40. FAILED Tests/Evals/test_eval_runner.py::TestEvalProgress::test_progress_percentage
----------------------------------------

41. FAILED Tests/Evals/test_eval_runner.py::TestEvalProgress::test_estimated_time_remaining
----------------------------------------

42. FAILED Tests/Evals/test_eval_runner.py::TestEvalRunnerInitialization::test_eval_runner_creation
----------------------------------------

43. FAILED Tests/Evals/test_eval_runner.py::TestEvalRunnerInitialization::test_eval_runner_with_config
----------------------------------------

44. FAILED Tests/Evals/test_eval_runner.py::TestBasicEvaluation::test_run_single_sample
----------------------------------------

45. FAILED Tests/Evals/test_eval_runner.py::TestBasicEvaluation::test_run_multiple_samples
----------------------------------------

46. FAILED Tests/Evals/test_eval_runner.py::TestBasicEvaluation::test_run_with_progress_callback
----------------------------------------

47. FAILED Tests/Evals/test_eval_runner.py::TestDifferentTaskTypes::test_question_answer_task
----------------------------------------

48. FAILED Tests/Evals/test_eval_runner.py::TestDifferentTaskTypes::test_multiple_choice_task
----------------------------------------

49. FAILED Tests/Evals/test_eval_runner.py::TestDifferentTaskTypes::test_text_generation_task
----------------------------------------

50. FAILED Tests/Evals/test_eval_runner.py::TestDifferentTaskTypes::test_code_generation_task
----------------------------------------

51. FAILED Tests/Evals/test_eval_runner.py::TestMetricsCalculation::test_exact_match_metric
----------------------------------------

52. FAILED Tests/Evals/test_eval_runner.py::TestMetricsCalculation::test_contains_answer_metric
----------------------------------------

53. FAILED Tests/Evals/test_eval_runner.py::TestMetricsCalculation::test_bleu_score_metric
----------------------------------------

54. FAILED Tests/Evals/test_eval_runner.py::TestMetricsCalculation::test_f1_score_metric
----------------------------------------

55. FAILED Tests/Evals/test_eval_runner.py::TestMetricsCalculation::test_code_execution_metric
----------------------------------------

56. FAILED Tests/Evals/test_eval_runner.py::TestMetricsCalculation::test_safety_metrics
----------------------------------------

57. FAILED Tests/Evals/test_eval_runner.py::TestErrorHandling::test_api_timeout_handling
----------------------------------------

58. FAILED Tests/Evals/test_eval_runner.py::TestErrorHandling::test_retry_mechanism
----------------------------------------

59. FAILED Tests/Evals/test_eval_runner.py::TestErrorHandling::test_partial_failure_handling
----------------------------------------

60. FAILED Tests/Evals/test_eval_runner.py::TestConcurrencyAndPerformance::test_concurrent_execution
----------------------------------------

61. FAILED Tests/Evals/test_eval_runner.py::TestConcurrencyAndPerformance::test_memory_efficient_streaming
----------------------------------------

62. FAILED Tests/Evals/test_eval_runner.py::TestConcurrencyAndPerformance::test_cancellation_support
----------------------------------------

63. FAILED Tests/Evals/test_eval_runner.py::TestAdvancedFeatures::test_few_shot_prompting
----------------------------------------

64. FAILED Tests/Evals/test_eval_runner.py::TestAdvancedFeatures::test_custom_prompt_templates
----------------------------------------

65. FAILED Tests/Evals/test_eval_runner.py::TestAdvancedFeatures::test_response_filtering
----------------------------------------

66. FAILED Tests/Evals/test_eval_runner.py::TestSpecializedEvaluations::test_multilingual_evaluation
----------------------------------------

67. FAILED Tests/Evals/test_eval_runner.py::TestSpecializedEvaluations::test_math_evaluation
----------------------------------------

68. FAILED Tests/Evals/test_eval_runner.py::TestSpecializedEvaluations::test_safety_evaluation
----------------------------------------

69. FAILED Tests/Evals/test_evals_db.py::TestDatasetOperations::test_get_dataset
----------------------------------------

70. FAILED Tests/Evals/test_evals_db.py::TestRunOperations::test_create_run - Typ...
----------------------------------------

71. FAILED Tests/Evals/test_evals_db.py::TestRunOperations::test_get_run - TypeEr...
----------------------------------------

72. FAILED Tests/Evals/test_evals_db.py::TestRunOperations::test_update_run_status
----------------------------------------

73. FAILED Tests/Evals/test_evals_db.py::TestResultOperations::test_store_result
----------------------------------------

74. FAILED Tests/Evals/test_evals_db.py::TestResultOperations::test_get_results_for_run
----------------------------------------

75. FAILED Tests/Evals/test_evals_db.py::TestMetricsOperations::test_store_run_metrics
----------------------------------------

76. FAILED Tests/Evals/test_evals_db.py::TestMetricsOperations::test_get_run_metrics
----------------------------------------

77. FAILED Tests/Evals/test_evals_db.py::TestSearchOperations::test_search_datasets
----------------------------------------

78. FAILED Tests/Evals/test_evals_db.py::TestErrorHandling::test_foreign_key_violation
----------------------------------------

79. FAILED Tests/Evals/test_evals_db.py::TestErrorHandling::test_concurrent_modification
----------------------------------------

80. FAILED Tests/Evals/test_evals_db.py::TestThreadSafety::test_concurrent_read_write
----------------------------------------

81. FAILED Tests/Evals/test_task_loader.py::TestEleutherFormatLoading::test_load_eleuther_with_templates
----------------------------------------

82. FAILED Tests/Evals/test_task_loader.py::TestEleutherFormatLoading::test_load_eleuther_complex_config
----------------------------------------

83. FAILED Tests/Evals/test_task_loader.py::TestCustomFormatLoading::test_load_custom_with_fewshot
----------------------------------------

84. FAILED Tests/Evals/test_task_loader.py::TestHuggingFaceFormatLoading::test_load_huggingface_basic
----------------------------------------

85. FAILED Tests/Evals/test_task_loader.py::TestHuggingFaceFormatLoading::test_load_huggingface_with_config
----------------------------------------

86. FAILED Tests/Evals/test_task_loader.py::TestTaskValidation::test_validate_missing_required_fields
----------------------------------------

87. FAILED Tests/Evals/test_task_loader.py::TestTaskValidation::test_validate_generation_kwargs
----------------------------------------

88. FAILED Tests/Evals/test_task_loader.py::TestTaskValidation::test_validate_code_task_requirements
----------------------------------------

89. FAILED Tests/Evals/test_task_loader.py::TestErrorHandling::test_invalid_yaml_syntax
----------------------------------------

90. FAILED Tests/Evals/test_task_loader.py::TestErrorHandling::test_invalid_json_syntax
----------------------------------------

91. FAILED Tests/Evals/test_task_loader.py::TestFormatConversion::test_eleuther_to_custom_conversion
----------------------------------------

92. FAILED Tests/Evals/test_task_loader.py::TestFormatConversion::test_custom_to_eleuther_conversion
----------------------------------------

93. FAILED Tests/Evals/test_task_loader.py::TestTaskTemplateGeneration::test_generate_basic_template
----------------------------------------

94. FAILED Tests/Evals/test_task_loader.py::TestTaskTemplateGeneration::test_generate_code_template
----------------------------------------

95. FAILED Tests/Evals/test_task_loader.py::TestTaskTemplateGeneration::test_generate_eleuther_template
----------------------------------------

96. FAILED Tests/Evals/test_task_loader.py::TestUtilityFunctions::test_detect_file_format
----------------------------------------

97. FAILED Tests/Evals/test_task_loader.py::TestUtilityFunctions::test_normalize_task_type
----------------------------------------

98. FAILED Tests/Evals/test_task_loader.py::TestUtilityFunctions::test_validate_dataset_path
----------------------------------------

99. FAILED Tests/Evals/test_task_loader.py::TestUtilityFunctions::test_merge_generation_kwargs
84 failed, 54 passed, 2 warnings, 7 errors in 6.72s
----------------------------------------

100. Tests/Evals/test_eval_integration.py::TestEndToEndEvaluation::test_complete_evaluation_pipeline: Tests/Evals/test_eval_integration.py:91: in test_complete_evaluation_pipeline
    with patch.object(orchestrator, '_create_llm_interface', return_value=mock_llm):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1467: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1437: in get_original
    raise AttributeError(
E   AttributeError: <tldw_chatbook.Evals.eval_orchestrator.EvaluationOrchestrator object at 0x10d410fb0> does not have the attribute '_create_llm_interface'
----------------------------------------

101. Tests/Evals/test_eval_integration.py::TestEndToEndEvaluation::test_eleuther_task_integration: Tests/Evals/test_eval_integration.py:165: in test_eleuther_task_integration
    task_id = await orchestrator.create_task_from_file(str(task_file), 'eleuther')
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tldw_chatbook/Evals/eval_orchestrator.py:71: in create_task_from_file
    raise ValueError(f"Task validation failed: {validation_issues}")
E   ValueError: Task validation failed: ['doc_to_choice required for classification tasks']
----------------------------------------

102. Tests/Evals/test_eval_integration.py::TestEndToEndEvaluation::test_csv_dataset_integration: Tests/Evals/test_eval_integration.py:209: in test_csv_dataset_integration
    task_id = await orchestrator.create_task_from_file(str(csv_file), 'csv')
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tldw_chatbook/Evals/eval_orchestrator.py:74: in create_task_from_file
    task_id = self.db.create_task(
tldw_chatbook/DB/Evals_DB.py:328: in create_task
    raise InputError(f"Invalid config_format: {config_format}")
E   tldw_chatbook.DB.Evals_DB.InputError: Invalid config_format: csv
----------------------------------------

103. Tests/Evals/test_eval_integration.py::TestMultiProviderIntegration::test_multiple_provider_evaluation: Tests/Evals/test_eval_integration.py:286: in test_multiple_provider_evaluation
    with patch.object(orchestrator, '_create_llm_interface', return_value=mock_llm):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1467: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1437: in get_original
    raise AttributeError(
E   AttributeError: <tldw_chatbook.Evals.eval_orchestrator.EvaluationOrchestrator object at 0x10d4809b0> does not have the attribute '_create_llm_interface'
----------------------------------------

104. Tests/Evals/test_eval_integration.py::TestMultiProviderIntegration::test_provider_fallback_mechanism: Tests/Evals/test_eval_integration.py:350: in test_provider_fallback_mechanism
    with patch.object(orchestrator, '_create_llm_interface', side_effect=mock_llm_factory):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1467: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1437: in get_original
    raise AttributeError(
E   AttributeError: <tldw_chatbook.Evals.eval_orchestrator.EvaluationOrchestrator object at 0x10d4104d0> does not have the attribute '_create_llm_interface'
----------------------------------------

105. Tests/Evals/test_eval_integration.py::TestSpecializedTaskIntegration::test_code_evaluation_integration: Tests/Evals/test_eval_integration.py:378: in test_code_evaluation_integration
    task_id = orchestrator.db.create_task(
tldw_chatbook/DB/Evals_DB.py:325: in create_task
    raise InputError(f"Invalid task_type: {task_type}")
E   tldw_chatbook.DB.Evals_DB.InputError: Invalid task_type: code_generation
----------------------------------------

106. Tests/Evals/test_eval_integration.py::TestSpecializedTaskIntegration::test_safety_evaluation_integration: Tests/Evals/test_eval_integration.py:432: in test_safety_evaluation_integration
    task_id = orchestrator.db.create_task(
tldw_chatbook/DB/Evals_DB.py:325: in create_task
    raise InputError(f"Invalid task_type: {task_type}")
E   tldw_chatbook.DB.Evals_DB.InputError: Invalid task_type: safety_check
----------------------------------------

107. Tests/Evals/test_eval_integration.py::TestSpecializedTaskIntegration::test_multilingual_evaluation_integration: Tests/Evals/test_eval_integration.py:534: in test_multilingual_evaluation_integration
    with patch.object(orchestrator, '_create_llm_interface', return_value=mock_llm):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1467: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1437: in get_original
    raise AttributeError(
E   AttributeError: <tldw_chatbook.Evals.eval_orchestrator.EvaluationOrchestrator object at 0x10d496300> does not have the attribute '_create_llm_interface'
----------------------------------------

108. Tests/Evals/test_eval_integration.py::TestConcurrentEvaluations::test_concurrent_runs_same_task: Tests/Evals/test_eval_integration.py:607: in test_concurrent_runs_same_task
    run_ids = await asyncio.gather(*tasks)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Tests/Evals/test_eval_integration.py:594: in run_evaluation_with_mock
    with patch.object(orchestrator, '_create_llm_interface', return_value=mock_llm):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1467: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1437: in get_original
    raise AttributeError(
E   AttributeError: <tldw_chatbook.Evals.eval_orchestrator.EvaluationOrchestrator object at 0x10d4952b0> does not have the attribute '_create_llm_interface'
----------------------------------------

109. Tests/Evals/test_eval_integration.py::TestConcurrentEvaluations::test_concurrent_task_creation: Tests/Evals/test_eval_integration.py:675: in test_concurrent_task_creation
    run_ids = await asyncio.gather(*tasks)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Tests/Evals/test_eval_integration.py:662: in create_and_run_task
    with patch.object(orchestrator, '_create_llm_interface', return_value=mock_llm):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1467: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1437: in get_original
    raise AttributeError(
E   AttributeError: <tldw_chatbook.Evals.eval_orchestrator.EvaluationOrchestrator object at 0x10d412510> does not have the attribute '_create_llm_interface'
----------------------------------------

110. Tests/Evals/test_eval_integration.py::TestErrorRecoveryIntegration::test_partial_failure_recovery: Tests/Evals/test_eval_integration.py:726: in test_partial_failure_recovery
    with patch.object(orchestrator, '_create_llm_interface', return_value=mock_llm):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1467: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1437: in get_original
    raise AttributeError(
E   AttributeError: <tldw_chatbook.Evals.eval_orchestrator.EvaluationOrchestrator object at 0x10d4e8fe0> does not have the attribute '_create_llm_interface'
----------------------------------------

111. Tests/Evals/test_eval_integration.py::TestErrorRecoveryIntegration::test_database_recovery_integration: Tests/Evals/test_eval_integration.py:787: in test_database_recovery_integration
    with patch.object(orchestrator, '_create_llm_interface', return_value=mock_llm):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1467: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1437: in get_original
    raise AttributeError(
E   AttributeError: <tldw_chatbook.Evals.eval_orchestrator.EvaluationOrchestrator object at 0x10d48fc80> does not have the attribute '_create_llm_interface'
----------------------------------------

112. Tests/Evals/test_eval_integration.py::TestPerformanceIntegration::test_large_scale_evaluation: Tests/Evals/test_eval_integration.py:839: in test_large_scale_evaluation
    with patch.object(orchestrator, '_create_llm_interface', return_value=mock_llm):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1467: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1437: in get_original
    raise AttributeError(
E   AttributeError: <tldw_chatbook.Evals.eval_orchestrator.EvaluationOrchestrator object at 0x10d48f680> does not have the attribute '_create_llm_interface'
----------------------------------------

113. Tests/Evals/test_eval_integration.py::TestPerformanceIntegration::test_memory_efficiency_integration: Tests/Evals/test_eval_integration.py:899: in test_memory_efficiency_integration
    with patch.object(orchestrator, '_create_llm_interface', return_value=mock_llm):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1467: in __enter__
    original, local = self.get_original()
                      ^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1437: in get_original
    raise AttributeError(
E   AttributeError: <tldw_chatbook.Evals.eval_orchestrator.EvaluationOrchestrator object at 0x10d48ecc0> does not have the attribute '_create_llm_interface'
----------------------------------------

114. Tests/Evals/test_eval_properties.py::TestDatabaseProperties::test_task_roundtrip_property: No details available
----------------------------------------

115. Tests/Evals/test_eval_properties.py::TestDatabaseProperties::test_multiple_tasks_uniqueness: No details available
----------------------------------------

116. Tests/Evals/test_eval_properties.py::TestDatabaseProperties::test_search_consistency: No details available
----------------------------------------

117. Tests/Evals/test_eval_properties.py::TestDatabaseProperties::test_pagination_properties: No details available
----------------------------------------

118. Tests/Evals/test_eval_properties.py::TestEvaluationProperties::test_exact_match_symmetry: Tests/Evals/test_eval_properties.py:276: in test_exact_match_symmetry
    @settings(max_examples=50, deadline=None)
               ^^^^^^^
Tests/Evals/test_eval_properties.py:279: in test_exact_match_symmetry
    runner = EvalRunner(llm_interface=AsyncMock())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
E   Falsifying example: test_exact_match_symmetry(
E       self=<Tests.Evals.test_eval_properties.TestEvaluationProperties object at 0x10d30f9e0>,
E       text1='',
E       text2='',
E   )
----------------------------------------

119. Tests/Evals/test_eval_properties.py::TestEvaluationProperties::test_exact_match_reflexivity: Tests/Evals/test_eval_properties.py:287: in test_exact_match_reflexivity
    @settings(max_examples=30, deadline=None)
               ^^^^^^^
Tests/Evals/test_eval_properties.py:290: in test_exact_match_reflexivity
    runner = EvalRunner(llm_interface=AsyncMock())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
E   Falsifying example: test_exact_match_reflexivity(
E       self=<Tests.Evals.test_eval_properties.TestEvaluationProperties object at 0x10d30f5f0>,
E       text='',
E   )
----------------------------------------

120. Tests/Evals/test_eval_properties.py::TestEvaluationProperties::test_contains_answer_monotonicity: Tests/Evals/test_eval_properties.py:296: in test_contains_answer_monotonicity
    @settings(max_examples=50, deadline=None)
               ^^^^^^^
Tests/Evals/test_eval_properties.py:299: in test_contains_answer_monotonicity
    runner = EvalRunner(llm_interface=AsyncMock())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
E   Falsifying example: test_contains_answer_monotonicity(
E       self=<Tests.Evals.test_eval_properties.TestEvaluationProperties object at 0x10d30f230>,
E       answer='',
E       response='',
E   )
----------------------------------------

121. Tests/Evals/test_eval_properties.py::TestEvaluationProperties::test_metrics_aggregation_properties: Tests/Evals/test_eval_properties.py:314: in test_metrics_aggregation_properties
    @settings(max_examples=30, deadline=None)
               ^^^^^^^
Tests/Evals/test_eval_properties.py:317: in test_metrics_aggregation_properties
    runner = EvalRunner(llm_interface=AsyncMock())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
E   Falsifying example: test_metrics_aggregation_properties(
E       self=<Tests.Evals.test_eval_properties.TestEvaluationProperties object at 0x10d30c7d0>,
E       scores=[0.0],
E   )
----------------------------------------

122. Tests/Evals/test_eval_properties.py::TestEvaluationProperties::test_eval_result_invariants: Tests/Evals/test_eval_properties.py:337: in test_eval_result_invariants
    @settings(max_examples=20, deadline=None)
               ^^^^^^^
Tests/Evals/test_eval_properties.py:98: in eval_result_strategy
    return EvalSampleResult(
E   TypeError: EvalSampleResult.__init__() got an unexpected keyword argument 'error'
E   while generating 'eval_result' from eval_result_strategy()
----------------------------------------

123. Tests/Evals/test_eval_properties.py::TestTaskConfigurationProperties::test_generation_kwargs_validation: + Exception Group Traceback (most recent call last):
  |   File "/Users/appledev/Working/tldw_chatbook_dev/Tests/Evals/test_eval_properties.py", line 383, in test_generation_kwargs_validation
  |     keys=st.sampled_from(["temperature", "max_tokens", "top_p", "top_k"]),
  |            ^^^^^^^
  |   File "/Users/appledev/Working/tldw_chatbook_dev/.venv/lib/python3.12/site-packages/hypothesis/core.py", line 2047, in wrapped_test
  |     raise the_error_hypothesis_found
  | ExceptionGroup: Hypothesis found 3 distinct failures. (3 sub-exceptions)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/Users/appledev/Working/tldw_chatbook_dev/Tests/Evals/test_eval_properties.py", line 412, in test_generation_kwargs_validation
    |     assert any("top_p" in issue.lower() for issue in issues)
    | AssertionError: assert False
    |  +  where False = any(<generator object TestTaskConfigurationProperties.test_generation_kwargs_validation.<locals>.<genexpr> at 0x10d6c1560>)
    | Falsifying example: test_generation_kwargs_validation(
    |     self=<Tests.Evals.test_eval_properties.TestTaskConfigurationProperties object at 0x10d30e840>,
    |     generation_kwargs={'top_p': -1.0},
    | )
    +---------------- 2 ----------------
    | Traceback (most recent call last):
    |   File "/Users/appledev/Working/tldw_chatbook_dev/Tests/Evals/test_eval_properties.py", line 410, in test_generation_kwargs_validation
    |     assert any("max_tokens" in issue.lower() for issue in issues)
    | AssertionError: assert False
    |  +  where False = any(<generator object TestTaskConfigurationProperties.test_generation_kwargs_validation.<locals>.<genexpr> at 0x10d6c0a00>)
    | Falsifying example: test_generation_kwargs_validation(
    |     self=<Tests.Evals.test_eval_properties.TestTaskConfigurationProperties object at 0x10d30e840>,
    |     generation_kwargs={'max_tokens': 0.0},
    | )
    +---------------- 3 ----------------
    | Traceback (most recent call last):
    |   File "/Users/appledev/Working/tldw_chatbook_dev/Tests/Evals/test_eval_properties.py", line 408, in test_generation_kwargs_validation
    |     assert any("temperature" in issue.lower() for issue in issues)
    | AssertionError: assert False
    |  +  where False = any(<generator object TestTaskConfigurationProperties.test_generation_kwargs_validation.<locals>.<genexpr> at 0x10d593440>)
    | Falsifying example: test_generation_kwargs_validation(
    |     self=<Tests.Evals.test_eval_properties.TestTaskConfigurationProperties object at 0x10d30e840>,
    |     generation_kwargs={'temperature': -1.0},
    | )
    +------------------------------------
----------------------------------------

124. Tests/Evals/test_eval_properties.py::TestFileHandlingProperties::test_text_processing_robustness: Tests/Evals/test_eval_properties.py:464: in test_text_processing_robustness
    @settings(max_examples=20, deadline=None)
               ^^^^^^^
Tests/Evals/test_eval_properties.py:467: in test_text_processing_robustness
    runner = EvalRunner(llm_interface=AsyncMock())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
E   Falsifying example: test_text_processing_robustness(
E       self=<Tests.Evals.test_eval_properties.TestFileHandlingProperties object at 0x10d2f2930>,
E       text_input='0',
E   )
----------------------------------------

125. Tests/Evals/test_eval_properties.py::TestConcurrencyProperties::test_concurrent_task_creation_uniqueness: No details available
----------------------------------------

126. Tests/Evals/test_eval_properties.py::TestConcurrencyProperties::test_evaluation_order_independence: Tests/Evals/test_eval_properties.py:533: in test_evaluation_order_independence
    @settings(max_examples=5, deadline=None)
               ^^^^^^^
Tests/Evals/test_eval_properties.py:552: in test_evaluation_order_independence
    runner = EvalRunner(llm_interface=mock_llm)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
E   Falsifying example: test_evaluation_order_independence(
E       self=<Tests.Evals.test_eval_properties.TestConcurrencyProperties object at 0x10d33cef0>,
E       samples=[{'id': '0',
E         'question': '0',
E         'answer': '',
E         'category': 'math',
E         'difficulty': 'easy'}],
E   )
----------------------------------------

127. Tests/Evals/test_eval_properties.py::TestSystemInvariants::test_resource_cleanup_invariant: No details available
----------------------------------------

128. Tests/Evals/test_eval_properties.py::TestSystemInvariants::test_database_consistency_invariant: No details available
----------------------------------------

129. Tests/Evals/test_eval_runner.py::TestEvalSampleResult::test_eval_result_with_error: Tests/Evals/test_eval_runner.py:47: in test_eval_result_with_error
    result = EvalSampleResult(
E   TypeError: EvalSampleResult.__init__() got an unexpected keyword argument 'error'
----------------------------------------

130. Tests/Evals/test_eval_runner.py::TestEvalProgress::test_eval_progress_creation: Tests/Evals/test_eval_runner.py:66: in test_eval_progress_creation
    progress = EvalProgress(
E   TypeError: EvalProgress.__init__() got an unexpected keyword argument 'total_samples'
----------------------------------------

131. Tests/Evals/test_eval_runner.py::TestEvalProgress::test_progress_percentage: Tests/Evals/test_eval_runner.py:80: in test_progress_percentage
    progress = EvalProgress(
E   TypeError: EvalProgress.__init__() got an unexpected keyword argument 'total_samples'
----------------------------------------

132. Tests/Evals/test_eval_runner.py::TestEvalProgress::test_estimated_time_remaining: Tests/Evals/test_eval_runner.py:95: in test_estimated_time_remaining
    progress = EvalProgress(
E   TypeError: EvalProgress.__init__() got an unexpected keyword argument 'total_samples'
----------------------------------------

133. Tests/Evals/test_eval_runner.py::TestEvalRunnerInitialization::test_eval_runner_creation: Tests/Evals/test_eval_runner.py:111: in test_eval_runner_creation
    runner = EvalRunner(llm_interface=mock_llm_interface)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

134. Tests/Evals/test_eval_runner.py::TestEvalRunnerInitialization::test_eval_runner_with_config: Tests/Evals/test_eval_runner.py:119: in test_eval_runner_with_config
    runner = EvalRunner(
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

135. Tests/Evals/test_eval_runner.py::TestBasicEvaluation::test_run_single_sample: Tests/Evals/test_eval_runner.py:136: in test_run_single_sample
    runner = EvalRunner(llm_interface=mock_llm_interface)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

136. Tests/Evals/test_eval_runner.py::TestBasicEvaluation::test_run_multiple_samples: Tests/Evals/test_eval_runner.py:154: in test_run_multiple_samples
    runner = EvalRunner(llm_interface=mock_llm_interface)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

137. Tests/Evals/test_eval_runner.py::TestBasicEvaluation::test_run_with_progress_callback: Tests/Evals/test_eval_runner.py:173: in test_run_with_progress_callback
    runner = EvalRunner(llm_interface=mock_llm_interface)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

138. Tests/Evals/test_eval_runner.py::TestDifferentTaskTypes::test_question_answer_task: Tests/Evals/test_eval_runner.py:210: in test_question_answer_task
    runner = EvalRunner(llm_interface=mock_llm_interface)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

139. Tests/Evals/test_eval_runner.py::TestDifferentTaskTypes::test_multiple_choice_task: Tests/Evals/test_eval_runner.py:237: in test_multiple_choice_task
    runner = EvalRunner(llm_interface=mock_llm_interface)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

140. Tests/Evals/test_eval_runner.py::TestDifferentTaskTypes::test_text_generation_task: Tests/Evals/test_eval_runner.py:265: in test_text_generation_task
    runner = EvalRunner(llm_interface=mock_llm_interface)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

141. Tests/Evals/test_eval_runner.py::TestDifferentTaskTypes::test_code_generation_task: Tests/Evals/test_eval_runner.py:293: in test_code_generation_task
    runner = EvalRunner(llm_interface=mock_llm_interface)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

142. Tests/Evals/test_eval_runner.py::TestMetricsCalculation::test_exact_match_metric: Tests/Evals/test_eval_runner.py:317: in test_exact_match_metric
    runner = EvalRunner(llm_interface=AsyncMock())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

143. Tests/Evals/test_eval_runner.py::TestMetricsCalculation::test_contains_answer_metric: Tests/Evals/test_eval_runner.py:333: in test_contains_answer_metric
    runner = EvalRunner(llm_interface=AsyncMock())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

144. Tests/Evals/test_eval_runner.py::TestMetricsCalculation::test_bleu_score_metric: Tests/Evals/test_eval_runner.py:349: in test_bleu_score_metric
    runner = EvalRunner(llm_interface=AsyncMock())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

145. Tests/Evals/test_eval_runner.py::TestMetricsCalculation::test_f1_score_metric: Tests/Evals/test_eval_runner.py:365: in test_f1_score_metric
    runner = EvalRunner(llm_interface=AsyncMock())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

146. Tests/Evals/test_eval_runner.py::TestMetricsCalculation::test_code_execution_metric: Tests/Evals/test_eval_runner.py:381: in test_code_execution_metric
    runner = EvalRunner(llm_interface=AsyncMock())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

147. Tests/Evals/test_eval_runner.py::TestMetricsCalculation::test_safety_metrics: Tests/Evals/test_eval_runner.py:399: in test_safety_metrics
    runner = EvalRunner(llm_interface=AsyncMock())
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

148. Tests/Evals/test_eval_runner.py::TestErrorHandling::test_api_timeout_handling: Tests/Evals/test_eval_runner.py:417: in test_api_timeout_handling
    runner = EvalRunner(
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

149. Tests/Evals/test_eval_runner.py::TestErrorHandling::test_retry_mechanism: Tests/Evals/test_eval_runner.py:446: in test_retry_mechanism
    runner = EvalRunner(
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

150. Tests/Evals/test_eval_runner.py::TestErrorHandling::test_partial_failure_handling: Tests/Evals/test_eval_runner.py:476: in test_partial_failure_handling
    runner = EvalRunner(llm_interface=mock_llm)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

151. Tests/Evals/test_eval_runner.py::TestConcurrencyAndPerformance::test_concurrent_execution: Tests/Evals/test_eval_runner.py:513: in test_concurrent_execution
    runner = EvalRunner(
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

152. Tests/Evals/test_eval_runner.py::TestConcurrencyAndPerformance::test_memory_efficient_streaming: Tests/Evals/test_eval_runner.py:538: in test_memory_efficient_streaming
    runner = EvalRunner(llm_interface=mock_llm_interface)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

153. Tests/Evals/test_eval_runner.py::TestConcurrencyAndPerformance::test_cancellation_support: Tests/Evals/test_eval_runner.py:562: in test_cancellation_support
    runner = EvalRunner(llm_interface=mock_llm_interface)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

154. Tests/Evals/test_eval_runner.py::TestAdvancedFeatures::test_few_shot_prompting: Tests/Evals/test_eval_runner.py:597: in test_few_shot_prompting
    runner = EvalRunner(llm_interface=mock_llm_interface)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

155. Tests/Evals/test_eval_runner.py::TestAdvancedFeatures::test_custom_prompt_templates: Tests/Evals/test_eval_runner.py:628: in test_custom_prompt_templates
    runner = EvalRunner(llm_interface=mock_llm_interface)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

156. Tests/Evals/test_eval_runner.py::TestAdvancedFeatures::test_response_filtering: Tests/Evals/test_eval_runner.py:664: in test_response_filtering
    runner = EvalRunner(llm_interface=mock_llm_interface)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

157. Tests/Evals/test_eval_runner.py::TestSpecializedEvaluations::test_multilingual_evaluation: Tests/Evals/test_eval_runner.py:697: in test_multilingual_evaluation
    runner = EvalRunner(llm_interface=mock_llm_interface)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

158. Tests/Evals/test_eval_runner.py::TestSpecializedEvaluations::test_math_evaluation: Tests/Evals/test_eval_runner.py:736: in test_math_evaluation
    runner = EvalRunner(llm_interface=mock_llm_interface)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

159. Tests/Evals/test_eval_runner.py::TestSpecializedEvaluations::test_safety_evaluation: Tests/Evals/test_eval_runner.py:765: in test_safety_evaluation
    runner = EvalRunner(llm_interface=mock_llm_interface)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: EvalRunner.__init__() got an unexpected keyword argument 'llm_interface'
----------------------------------------

160. Tests/Evals/test_evals_db.py::TestDatasetOperations::test_get_dataset: Tests/Evals/test_evals_db.py:222: in test_get_dataset
    assert dataset['format'] == "local"
E   AssertionError: assert 'custom' == 'local'
E     
E     - local
E     + custom
----------------------------------------

161. Tests/Evals/test_evals_db.py::TestRunOperations::test_create_run: Tests/Evals/test_evals_db.py:286: in test_create_run
    run_id = in_memory_db.create_run(
E   TypeError: EvalsDB.create_run() got an unexpected keyword argument 'config'
----------------------------------------

162. Tests/Evals/test_evals_db.py::TestRunOperations::test_get_run: Tests/Evals/test_evals_db.py:306: in test_get_run
    run_id = in_memory_db.create_run(
E   TypeError: EvalsDB.create_run() got an unexpected keyword argument 'config'
----------------------------------------

163. Tests/Evals/test_evals_db.py::TestRunOperations::test_update_run_status: Tests/Evals/test_evals_db.py:327: in test_update_run_status
    run_id = in_memory_db.create_run(
E   TypeError: EvalsDB.create_run() got an unexpected keyword argument 'config'
----------------------------------------

164. Tests/Evals/test_evals_db.py::TestResultOperations::test_store_result: Tests/Evals/test_evals_db.py:353: in test_store_result
    run_id = in_memory_db.create_run(
E   TypeError: EvalsDB.create_run() got an unexpected keyword argument 'config'
----------------------------------------

165. Tests/Evals/test_evals_db.py::TestResultOperations::test_get_results_for_run: Tests/Evals/test_evals_db.py:381: in test_get_results_for_run
    run_id = in_memory_db.create_run(
E   TypeError: EvalsDB.create_run() got an unexpected keyword argument 'config'
----------------------------------------

166. Tests/Evals/test_evals_db.py::TestMetricsOperations::test_store_run_metrics: Tests/Evals/test_evals_db.py:419: in test_store_run_metrics
    run_id = in_memory_db.create_run(
E   TypeError: EvalsDB.create_run() got an unexpected keyword argument 'config'
----------------------------------------

167. Tests/Evals/test_evals_db.py::TestMetricsOperations::test_get_run_metrics: Tests/Evals/test_evals_db.py:450: in test_get_run_metrics
    run_id = in_memory_db.create_run(
E   TypeError: EvalsDB.create_run() got an unexpected keyword argument 'config'
----------------------------------------

168. Tests/Evals/test_evals_db.py::TestSearchOperations::test_search_datasets: Tests/Evals/test_evals_db.py:514: in test_search_datasets
    assert len(results) == 1
E   assert 0 == 1
E    +  where 0 = len([])
----------------------------------------

169. Tests/Evals/test_evals_db.py::TestErrorHandling::test_foreign_key_violation: Tests/Evals/test_evals_db.py:539: in test_foreign_key_violation
    in_memory_db.create_run(
E   TypeError: EvalsDB.create_run() got an unexpected keyword argument 'config'
----------------------------------------

170. Tests/Evals/test_evals_db.py::TestErrorHandling::test_concurrent_modification: Tests/Evals/test_evals_db.py:563: in test_concurrent_modification
    assert not success  # Should fail due to version mismatch
    ^^^^^^^^^^^^^^^^^^
E   assert not True
----------------------------------------

171. Tests/Evals/test_evals_db.py::TestThreadSafety::test_concurrent_read_write: Tests/Evals/test_evals_db.py:642: in test_concurrent_read_write
    assert len(write_results) == 5
E   assert 0 == 5
E    +  where 0 = len([])
----------------------------------------

172. Tests/Evals/test_task_loader.py::TestEleutherFormatLoading::test_load_eleuther_with_templates: Tests/Evals/test_task_loader.py:151: in test_load_eleuther_with_templates
    assert config.task_type == "generate_until"
E   AssertionError: assert 'generation' == 'generate_until'
E     
E     - generate_until
E     + generation
----------------------------------------

173. Tests/Evals/test_task_loader.py::TestEleutherFormatLoading::test_load_eleuther_complex_config: Tests/Evals/test_task_loader.py:189: in test_load_eleuther_complex_config
    assert "filter_list" in config.metadata
E   AssertionError: assert 'filter_list' in {'format': 'eleuther', 'original_config': {'dataset_name': 'gsm8k', 'fewshot_split': 'train', 'filter_list': [{'filter... 'regex_pattern': '####\\s*(\\d+)'}], 'generation_kwargs': {'max_tokens': 200, 'temperature': 0.0, 'top_p': 1.0}, ...}}
E    +  where {'format': 'eleuther', 'original_config': {'dataset_name': 'gsm8k', 'fewshot_split': 'train', 'filter_list': [{'filter... 'regex_pattern': '####\\s*(\\d+)'}], 'generation_kwargs': {'max_tokens': 200, 'temperature': 0.0, 'top_p': 1.0}, ...}} = TaskConfig(name='gsm8k_sample', description='Eleuther task: gsm8k_sample', task_type='generation', dataset_name='gsm8k...type': 'generate_until', 'task': 'gsm8k_sample', 'test_split': 'test', 'until': ['Q:', '\n\n']}, 'format': 'eleuther'}).metadata
----------------------------------------

174. Tests/Evals/test_task_loader.py::TestCustomFormatLoading::test_load_custom_with_fewshot: Tests/Evals/test_task_loader.py:248: in test_load_custom_with_fewshot
    assert config.metadata.get("fewshot_split") == "train"
E   AssertionError: assert None == 'train'
E    +  where None = <built-in method get of dict object at 0x10d721740>('fewshot_split')
E    +    where <built-in method get of dict object at 0x10d721740> = {'format': 'custom'}.get
E    +      where {'format': 'custom'} = TaskConfig(name='Few-shot Task', description='Task with few-shot examples', task_type='text_generation', dataset_name=...metric='bleu', filter_list=[], doc_to_text=None, doc_to_target=None, doc_to_choice=None, metadata={'format': 'custom'}).metadata
----------------------------------------

175. Tests/Evals/test_task_loader.py::TestHuggingFaceFormatLoading::test_load_huggingface_basic: /opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1393: in patched
    with self.decoration_helper(patched,
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1375: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py:526: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1451: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'tldw_chatbook' has no attribute 'App_Functions'
----------------------------------------

176. Tests/Evals/test_task_loader.py::TestHuggingFaceFormatLoading::test_load_huggingface_with_config: /opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1393: in patched
    with self.decoration_helper(patched,
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1375: in decoration_helper
    arg = exit_stack.enter_context(patching)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py:526: in enter_context
    result = _enter(cm)
             ^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/unittest/mock.py:1451: in __enter__
    self.target = self.getter()
                  ^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/pkgutil.py:528: in resolve_name
    result = getattr(result, p)
             ^^^^^^^^^^^^^^^^^^
E   AttributeError: module 'tldw_chatbook' has no attribute 'App_Functions'
----------------------------------------

177. Tests/Evals/test_task_loader.py::TestTaskValidation::test_validate_missing_required_fields: Tests/Evals/test_task_loader.py:483: in test_validate_missing_required_fields
    assert any("metric" in issue for issue in issues)
E   assert False
E    +  where False = any(<generator object TestTaskValidation.test_validate_missing_required_fields.<locals>.<genexpr> at 0x10d5faa80>)
----------------------------------------

178. Tests/Evals/test_task_loader.py::TestTaskValidation::test_validate_generation_kwargs: Tests/Evals/test_task_loader.py:521: in test_validate_generation_kwargs
    assert any("temperature" in issue for issue in issues)
E   assert False
E    +  where False = any(<generator object TestTaskValidation.test_validate_generation_kwargs.<locals>.<genexpr> at 0x10d8cc6c0>)
----------------------------------------

179. Tests/Evals/test_task_loader.py::TestTaskValidation::test_validate_code_task_requirements: Tests/Evals/test_task_loader.py:540: in test_validate_code_task_requirements
    assert any("metric" in issue for issue in issues)
E   assert False
E    +  where False = any(<generator object TestTaskValidation.test_validate_code_task_requirements.<locals>.<genexpr> at 0x10d9918a0>)
----------------------------------------

180. Tests/Evals/test_task_loader.py::TestErrorHandling::test_invalid_yaml_syntax: Tests/Evals/test_task_loader.py:565: in test_invalid_yaml_syntax
    loader.load_task(str(yaml_file), 'eleuther')
tldw_chatbook/Evals/task_loader.py:105: in load_task
    return self._load_eleuther_task(source)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tldw_chatbook/Evals/task_loader.py:160: in _load_eleuther_task
    config_data = yaml.safe_load(f)
                  ^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/yaml/__init__.py:125: in safe_load
    return load(stream, SafeLoader)
           ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/yaml/__init__.py:81: in load
    return loader.get_single_data()
           ^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/yaml/constructor.py:49: in get_single_data
    node = self.get_single_node()
           ^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/yaml/composer.py:36: in get_single_node
    document = self.compose_document()
               ^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/yaml/composer.py:55: in compose_document
    node = self.compose_node(None, None)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/yaml/composer.py:84: in compose_node
    node = self.compose_mapping_node(anchor)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/yaml/composer.py:133: in compose_mapping_node
    item_value = self.compose_node(node, item_key)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/yaml/composer.py:82: in compose_node
    node = self.compose_sequence_node(anchor)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/yaml/composer.py:110: in compose_sequence_node
    while not self.check_event(SequenceEndEvent):
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/yaml/parser.py:98: in check_event
    self.current_event = self.state()
                         ^^^^^^^^^^^^
.venv/lib/python3.12/site-packages/yaml/parser.py:483: in parse_flow_sequence_entry
    raise ParserError("while parsing a flow sequence", self.marks[-1],
E   yaml.parser.ParserError: while parsing a flow sequence
E     in "/private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-403/test_invalid_yaml_syntax0/invalid.yaml", line 3, column 23
E   expected ',' or ']', but got '<stream end>'
E     in "/private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-403/test_invalid_yaml_syntax0/invalid.yaml", line 4, column 9
----------------------------------------

181. Tests/Evals/test_task_loader.py::TestErrorHandling::test_invalid_json_syntax: Tests/Evals/test_task_loader.py:577: in test_invalid_json_syntax
    loader.load_task(str(json_file), 'custom')
tldw_chatbook/Evals/task_loader.py:107: in load_task
    return self._load_custom_task(source)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tldw_chatbook/Evals/task_loader.py:256: in _load_custom_task
    config_data = json.load(f)
                  ^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/json/__init__.py:293: in load
    return loads(fp.read(),
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/json/__init__.py:346: in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/json/decoder.py:338: in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/json/decoder.py:356: in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
E   json.decoder.JSONDecodeError: Expecting value: line 1 column 29 (char 28)
----------------------------------------

182. Tests/Evals/test_task_loader.py::TestFormatConversion::test_eleuther_to_custom_conversion: Tests/Evals/test_task_loader.py:631: in test_eleuther_to_custom_conversion
    custom_dict = loader.convert_to_custom_format(config)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'TaskLoader' object has no attribute 'convert_to_custom_format'. Did you mean: '_convert_to_eleuther_format'?
----------------------------------------

183. Tests/Evals/test_task_loader.py::TestFormatConversion::test_custom_to_eleuther_conversion: Tests/Evals/test_task_loader.py:641: in test_custom_to_eleuther_conversion
    eleuther_dict = loader.convert_to_eleuther_format(sample_task_config)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'TaskLoader' object has no attribute 'convert_to_eleuther_format'. Did you mean: '_convert_to_eleuther_format'?
----------------------------------------

184. Tests/Evals/test_task_loader.py::TestTaskTemplateGeneration::test_generate_basic_template: Tests/Evals/test_task_loader.py:654: in test_generate_basic_template
    template = loader.generate_template("question_answer")
               ^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'TaskLoader' object has no attribute 'generate_template'
----------------------------------------

185. Tests/Evals/test_task_loader.py::TestTaskTemplateGeneration::test_generate_code_template: Tests/Evals/test_task_loader.py:665: in test_generate_code_template
    template = loader.generate_template("code_generation")
               ^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'TaskLoader' object has no attribute 'generate_template'
----------------------------------------

186. Tests/Evals/test_task_loader.py::TestTaskTemplateGeneration::test_generate_eleuther_template: Tests/Evals/test_task_loader.py:675: in test_generate_eleuther_template
    template = loader.generate_eleuther_template("multiple_choice")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'TaskLoader' object has no attribute 'generate_eleuther_template'
----------------------------------------

187. Tests/Evals/test_task_loader.py::TestUtilityFunctions::test_detect_file_format: Tests/Evals/test_task_loader.py:692: in test_detect_file_format
    assert loader._detect_file_format(str(yaml_file)) == "eleuther"
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'TaskLoader' object has no attribute '_detect_file_format'. Did you mean: '_detect_format'?
----------------------------------------

188. Tests/Evals/test_task_loader.py::TestUtilityFunctions::test_normalize_task_type: Tests/Evals/test_task_loader.py:711: in test_normalize_task_type
    assert loader._normalize_task_type("multiple_choice") == "multiple_choice"
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'TaskLoader' object has no attribute '_normalize_task_type'
----------------------------------------

189. Tests/Evals/test_task_loader.py::TestUtilityFunctions::test_validate_dataset_path: Tests/Evals/test_task_loader.py:721: in test_validate_dataset_path
    assert loader._validate_dataset_path("local_file.csv") == True
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'TaskLoader' object has no attribute '_validate_dataset_path'
----------------------------------------

190. Tests/Evals/test_task_loader.py::TestUtilityFunctions::test_merge_generation_kwargs: Tests/Evals/test_task_loader.py:735: in test_merge_generation_kwargs
    merged = loader._merge_generation_kwargs(defaults, overrides)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'TaskLoader' object has no attribute '_merge_generation_kwargs'
----------------------------------------

================================================================================

Directory: Widgets
Duration: 2.24s
Passed: 23, Failed: 0, Skipped: 0, Errors: 0

================================================================================

Directory: UI
Duration: 4.66s
Passed: 0, Failed: 0, Skipped: 0, Errors: 0

================================================================================

Directory: integration
Duration: 4.92s
Passed: 24, Failed: 5, Skipped: 0, Errors: 12

Failures:

1. ==================================== ERRORS ====================================
----------------------------------------

2. ___ ERROR at setup of TestChatImageIntegration.test_attach_image_button_flow ___
Tests/integration/test_chat_image_integration_real.py:86: in real_app_with_image_support
    app.media_db = MediaDatabase(str(db_dir / "media.db"))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: MediaDatabase.__init__() missing 1 required positional argument: 'client_id'
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:21:58,262 [DEBUG] asyncio:64 - Using selector: KqueueSelector
2025-06-29 00:21:58,262 [DEBUG] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

3. 2025-06-29 00:21:58,263 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

4. 2025-06-29 00:21:58,263 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

5. 2025-06-29 00:21:58,263 [ERROR] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:21:58.265 | INFO     | tldw_chatbook.config:load_settings:207 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.265 | INFO     | tldw_chatbook.config:load_settings:208 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.265 | INFO     | tldw_chatbook.config:load_settings:217 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:58.265 | WARNING  | tldw_chatbook.config:load_settings:223 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:58.265 | INFO     | tldw_chatbook.config:load_settings:232 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.266 | INFO     | tldw_chatbook.config:load_settings:237 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.267 | INFO     | tldw_chatbook.config:load_settings:252 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:58.267 | INFO     | tldw_chatbook.app:__init__:973 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.267 | INFO     | tldw_chatbook.app:__init__:980 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.267 | INFO     | tldw_chatbook.app:__init__:981 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:58,267 [INFO] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:58,268 [INFO] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.268 | INFO     | tldw_chatbook.app:__init__:990 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

6. 2025-06-29 00:21:58,268 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

7. 2025-06-29 00:21:58,268 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58,268 [DEBUG] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:21:58.268 | INFO     | tldw_chatbook.config:load_settings:207 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.268 | INFO     | tldw_chatbook.config:load_settings:208 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.268 | INFO     | tldw_chatbook.config:load_settings:217 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:58.268 | WARNING  | tldw_chatbook.config:load_settings:223 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:58.268 | INFO     | tldw_chatbook.config:load_settings:232 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.269 | INFO     | tldw_chatbook.config:load_settings:237 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.270 | INFO     | tldw_chatbook.config:load_settings:252 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:58,270 [INFO] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:21:58,270 [INFO] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:21:58.270 | INFO     | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:105 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:21:58.270 | INFO     | tldw_chatbook.DB.Prompts_DB:__init__:251 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:21:58.270 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_get_thread_connection:317 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:21:58.270 | INFO     | tldw_chatbook.DB.Prompts_DB:_initialize_schema:518 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:21:58.271 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_initialize_schema:521 - Database schema is up to date.
2025-06-29 00:21:58.271 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_initialize_schema:525 - Verified FTS tables exist.
2025-06-29 00:21:58.271 | DEBUG    | tldw_chatbook.DB.Prompts_DB:__init__:281 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:58.271 | INFO     | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:110 - Prompts Interop Library initialized successfully.
2025-06-29 00:21:58,271 [INFO] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:58,271 [INFO] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:21:58,271 [DEBUG] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:21:58,271 [INFO] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:21:58,271 [DEBUG] root:750 - Database schema is up to date.
2025-06-29 00:21:58,271 [DEBUG] root:755 - Verified FTS tables exist.
2025-06-29 00:21:58,271 [DEBUG] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.271 | INFO     | tldw_chatbook.app:__init__:1057 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.271 | DEBUG    | tldw_chatbook.app:__init__:1059 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x144012900>
2025-06-29 00:21:58.271 | DEBUG    | tldw_chatbook.app:__init__:1061 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.271 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:get_distinct_media_types:3417 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:21:58,271 [DEBUG] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:21:58.271 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:get_distinct_media_types:3431 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:21:58.271 | INFO     | tldw_chatbook.app:__init__:1075 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

8. 2025-06-29 00:21:58,271 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

9. 2025-06-29 00:21:58,271 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58.271 | DEBUG    | tldw_chatbook.app:__init__:1089 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:21:58.271 | DEBUG    | tldw_chatbook.app:__init__:1090 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:21:58,271 [INFO] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:21:58,271 [INFO] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

10. 2025-06-29 00:21:58,271 [ERROR] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:21:58.271 | INFO     | tldw_chatbook.app:__init__:1133 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:21:58.271 | INFO     | tldw_chatbook.app:__init__:1134 - Total initialization time: 0.009 seconds
2025-06-29 00:21:58.271 | INFO     | tldw_chatbook.app:__init__:1138 -   basic_init: 0.002s (27.0%)
2025-06-29 00:21:58.271 | INFO     | tldw_chatbook.app:__init__:1138 -   attribute_init: 0.000s (0.2%)
2025-06-29 00:21:58.271 | INFO     | tldw_chatbook.app:__init__:1138 -   notes_service_init: 0.000s (2.7%)
2025-06-29 00:21:58.271 | INFO     | tldw_chatbook.app:__init__:1138 -   providers_models: 0.002s (27.3%)
2025-06-29 00:21:58.271 | INFO     | tldw_chatbook.app:__init__:1138 -   prompts_service_init: 0.000s (5.2%)
2025-06-29 00:21:58.271 | INFO     | tldw_chatbook.app:__init__:1138 -   media_db_init: 0.001s (6.5%)
2025-06-29 00:21:58.271 | INFO     | tldw_chatbook.app:__init__:1139 - ==============================
----------------------------------------

11. 2025-06-29 00:21:58,272 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

12. 2025-06-29 00:21:58,272 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58.272 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:__init__:992 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_attach_image_button_flow0/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:21:58.272 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1051 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_attach_image_button_flow0/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:21:58.272 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__enter__:4087 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:21:58.272 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1403 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:21:58.272 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1322 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_attach_image_button_flow0/db/chachanotes.db...
2025-06-29 00:21:58.278 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1326 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:21:58.279 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1332 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_attach_image_button_flow0/db/chachanotes.db.
2025-06-29 00:21:58.279 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1357 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_attach_image_button_flow0/db/chachanotes.db...
2025-06-29 00:21:58.284 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1361 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:21:58.284 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1369 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_attach_image_button_flow0/db/chachanotes.db.
2025-06-29 00:21:58.284 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1432 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:21:58.284 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__exit__:4114 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:21:58.284 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__init__:996 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_attach_image_button_flow0/db/chachanotes.db
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

13. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

14. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

15. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
----------------------------------------

16. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

17. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
----------------------------------------

18. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

19. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

20. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
----------------------------------------

21. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

22. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

23. _ ERROR at setup of TestChatImageIntegration.test_image_path_submission_success _
Tests/integration/test_chat_image_integration_real.py:86: in real_app_with_image_support
    app.media_db = MediaDatabase(str(db_dir / "media.db"))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: MediaDatabase.__init__() missing 1 required positional argument: 'client_id'
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:21:58,288 [DEBUG] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

24. 2025-06-29 00:21:58,289 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

25. 2025-06-29 00:21:58,289 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

26. 2025-06-29 00:21:58,289 [ERROR] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:21:58.289 | INFO     | tldw_chatbook.config:load_settings:207 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.289 | INFO     | tldw_chatbook.config:load_settings:208 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.289 | INFO     | tldw_chatbook.config:load_settings:217 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:58.289 | WARNING  | tldw_chatbook.config:load_settings:223 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:58.289 | INFO     | tldw_chatbook.config:load_settings:232 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.291 | INFO     | tldw_chatbook.config:load_settings:237 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.291 | INFO     | tldw_chatbook.config:load_settings:252 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:58.291 | INFO     | tldw_chatbook.app:__init__:973 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.291 | INFO     | tldw_chatbook.app:__init__:980 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.291 | INFO     | tldw_chatbook.app:__init__:981 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:58,292 [INFO] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:58,292 [INFO] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.292 | INFO     | tldw_chatbook.app:__init__:990 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

27. 2025-06-29 00:21:58,292 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

28. 2025-06-29 00:21:58,292 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58,292 [DEBUG] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:21:58.292 | INFO     | tldw_chatbook.config:load_settings:207 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.292 | INFO     | tldw_chatbook.config:load_settings:208 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.292 | INFO     | tldw_chatbook.config:load_settings:217 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:58.292 | WARNING  | tldw_chatbook.config:load_settings:223 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:58.292 | INFO     | tldw_chatbook.config:load_settings:232 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.295 | INFO     | tldw_chatbook.config:load_settings:237 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.295 | INFO     | tldw_chatbook.config:load_settings:252 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:58,296 [INFO] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:21:58,296 [INFO] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:21:58.296 | WARNING  | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:92 - Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
2025-06-29 00:21:58.296 | INFO     | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:105 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:21:58.296 | INFO     | tldw_chatbook.DB.Prompts_DB:__init__:251 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:21:58.296 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_get_thread_connection:317 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:21:58.296 | INFO     | tldw_chatbook.DB.Prompts_DB:_initialize_schema:518 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:21:58.296 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_initialize_schema:521 - Database schema is up to date.
2025-06-29 00:21:58.296 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_initialize_schema:525 - Verified FTS tables exist.
2025-06-29 00:21:58.296 | DEBUG    | tldw_chatbook.DB.Prompts_DB:__init__:281 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:58.296 | INFO     | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:110 - Prompts Interop Library initialized successfully.
2025-06-29 00:21:58,296 [INFO] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:58,296 [INFO] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:21:58,296 [DEBUG] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:21:58,296 [INFO] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:21:58,296 [DEBUG] root:750 - Database schema is up to date.
2025-06-29 00:21:58,296 [DEBUG] root:755 - Verified FTS tables exist.
2025-06-29 00:21:58,296 [DEBUG] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.296 | INFO     | tldw_chatbook.app:__init__:1057 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.296 | DEBUG    | tldw_chatbook.app:__init__:1059 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x143ff1c70>
2025-06-29 00:21:58.296 | DEBUG    | tldw_chatbook.app:__init__:1061 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.296 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:get_distinct_media_types:3417 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:21:58,297 [DEBUG] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:21:58.297 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:get_distinct_media_types:3431 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:21:58.297 | INFO     | tldw_chatbook.app:__init__:1075 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

29. 2025-06-29 00:21:58,297 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

30. 2025-06-29 00:21:58,297 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58.297 | DEBUG    | tldw_chatbook.app:__init__:1089 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:21:58.297 | DEBUG    | tldw_chatbook.app:__init__:1090 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:21:58,297 [INFO] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:21:58,297 [INFO] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

31. 2025-06-29 00:21:58,297 [ERROR] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:21:58.297 | INFO     | tldw_chatbook.app:__init__:1133 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:21:58.297 | INFO     | tldw_chatbook.app:__init__:1134 - Total initialization time: 0.008 seconds
2025-06-29 00:21:58.297 | INFO     | tldw_chatbook.app:__init__:1138 -   basic_init: 0.002s (26.7%)
2025-06-29 00:21:58.297 | INFO     | tldw_chatbook.app:__init__:1138 -   attribute_init: 0.000s (0.2%)
2025-06-29 00:21:58.297 | INFO     | tldw_chatbook.app:__init__:1138 -   notes_service_init: 0.000s (2.2%)
2025-06-29 00:21:58.297 | INFO     | tldw_chatbook.app:__init__:1138 -   providers_models: 0.004s (49.6%)
2025-06-29 00:21:58.297 | INFO     | tldw_chatbook.app:__init__:1138 -   prompts_service_init: 0.000s (5.0%)
2025-06-29 00:21:58.297 | INFO     | tldw_chatbook.app:__init__:1138 -   media_db_init: 0.000s (6.0%)
2025-06-29 00:21:58.297 | INFO     | tldw_chatbook.app:__init__:1139 - ==============================
----------------------------------------

32. 2025-06-29 00:21:58,297 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

33. 2025-06-29 00:21:58,297 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58.297 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:__init__:992 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_path_submission_suc0/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:21:58.297 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1051 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_path_submission_suc0/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:21:58.297 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__enter__:4087 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:21:58.297 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1403 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:21:58.298 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1322 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_path_submission_suc0/db/chachanotes.db...
2025-06-29 00:21:58.303 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1326 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:21:58.303 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1332 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_path_submission_suc0/db/chachanotes.db.
2025-06-29 00:21:58.303 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1357 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_path_submission_suc0/db/chachanotes.db...
2025-06-29 00:21:58.309 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1361 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:21:58.309 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1369 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_path_submission_suc0/db/chachanotes.db.
2025-06-29 00:21:58.309 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1432 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:21:58.309 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__exit__:4114 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:21:58.309 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__init__:996 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_path_submission_suc0/db/chachanotes.db
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

34. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

35. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

36. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
----------------------------------------

37. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

38. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
----------------------------------------

39. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

40. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

41. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
----------------------------------------

42. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

43. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

44. _ ERROR at setup of TestChatImageIntegration.test_image_path_submission_invalid_file _
Tests/integration/test_chat_image_integration_real.py:86: in real_app_with_image_support
    app.media_db = MediaDatabase(str(db_dir / "media.db"))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: MediaDatabase.__init__() missing 1 required positional argument: 'client_id'
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:21:58,313 [DEBUG] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

45. 2025-06-29 00:21:58,313 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

46. 2025-06-29 00:21:58,313 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

47. 2025-06-29 00:21:58,313 [ERROR] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:21:58.313 | INFO     | tldw_chatbook.config:load_settings:207 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.313 | INFO     | tldw_chatbook.config:load_settings:208 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.313 | INFO     | tldw_chatbook.config:load_settings:217 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:58.313 | WARNING  | tldw_chatbook.config:load_settings:223 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:58.313 | INFO     | tldw_chatbook.config:load_settings:232 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.315 | INFO     | tldw_chatbook.config:load_settings:237 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.315 | INFO     | tldw_chatbook.config:load_settings:252 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:58.316 | INFO     | tldw_chatbook.app:__init__:973 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.316 | INFO     | tldw_chatbook.app:__init__:980 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.316 | INFO     | tldw_chatbook.app:__init__:981 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:58,316 [INFO] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:58,316 [INFO] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.316 | INFO     | tldw_chatbook.app:__init__:990 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

48. 2025-06-29 00:21:58,316 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

49. 2025-06-29 00:21:58,316 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58,316 [DEBUG] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:21:58.316 | INFO     | tldw_chatbook.config:load_settings:207 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.316 | INFO     | tldw_chatbook.config:load_settings:208 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.316 | INFO     | tldw_chatbook.config:load_settings:217 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:58.316 | WARNING  | tldw_chatbook.config:load_settings:223 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:58.316 | INFO     | tldw_chatbook.config:load_settings:232 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.317 | INFO     | tldw_chatbook.config:load_settings:237 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.318 | INFO     | tldw_chatbook.config:load_settings:252 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:58,318 [INFO] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:21:58,318 [INFO] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:21:58.318 | WARNING  | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:92 - Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
2025-06-29 00:21:58.318 | INFO     | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:105 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:21:58.318 | INFO     | tldw_chatbook.DB.Prompts_DB:__init__:251 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:21:58.318 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_get_thread_connection:317 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:21:58.318 | INFO     | tldw_chatbook.DB.Prompts_DB:_initialize_schema:518 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:21:58.318 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_initialize_schema:521 - Database schema is up to date.
2025-06-29 00:21:58.318 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_initialize_schema:525 - Verified FTS tables exist.
2025-06-29 00:21:58.318 | DEBUG    | tldw_chatbook.DB.Prompts_DB:__init__:281 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:58.319 | INFO     | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:110 - Prompts Interop Library initialized successfully.
2025-06-29 00:21:58,319 [INFO] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:58,319 [INFO] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:21:58,319 [DEBUG] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:21:58,319 [INFO] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:21:58,319 [DEBUG] root:750 - Database schema is up to date.
2025-06-29 00:21:58,319 [DEBUG] root:755 - Verified FTS tables exist.
2025-06-29 00:21:58,319 [DEBUG] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.319 | INFO     | tldw_chatbook.app:__init__:1057 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.319 | DEBUG    | tldw_chatbook.app:__init__:1059 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x144047680>
2025-06-29 00:21:58.319 | DEBUG    | tldw_chatbook.app:__init__:1061 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.319 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:get_distinct_media_types:3417 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:21:58,319 [DEBUG] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:21:58.319 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:get_distinct_media_types:3431 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:21:58.319 | INFO     | tldw_chatbook.app:__init__:1075 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

50. 2025-06-29 00:21:58,319 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

51. 2025-06-29 00:21:58,319 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58.319 | DEBUG    | tldw_chatbook.app:__init__:1089 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:21:58.319 | DEBUG    | tldw_chatbook.app:__init__:1090 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:21:58,319 [INFO] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:21:58,319 [INFO] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

52. 2025-06-29 00:21:58,319 [ERROR] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:21:58.319 | INFO     | tldw_chatbook.app:__init__:1133 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:21:58.319 | INFO     | tldw_chatbook.app:__init__:1134 - Total initialization time: 0.006 seconds
2025-06-29 00:21:58.319 | INFO     | tldw_chatbook.app:__init__:1138 -   basic_init: 0.002s (35.9%)
2025-06-29 00:21:58.319 | INFO     | tldw_chatbook.app:__init__:1138 -   attribute_init: 0.000s (0.2%)
2025-06-29 00:21:58.319 | INFO     | tldw_chatbook.app:__init__:1138 -   notes_service_init: 0.000s (2.9%)
2025-06-29 00:21:58.319 | INFO     | tldw_chatbook.app:__init__:1138 -   providers_models: 0.002s (36.2%)
2025-06-29 00:21:58.319 | INFO     | tldw_chatbook.app:__init__:1138 -   prompts_service_init: 0.000s (5.8%)
2025-06-29 00:21:58.319 | INFO     | tldw_chatbook.app:__init__:1138 -   media_db_init: 0.000s (7.7%)
2025-06-29 00:21:58.319 | INFO     | tldw_chatbook.app:__init__:1139 - ==============================
----------------------------------------

53. 2025-06-29 00:21:58,319 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

54. 2025-06-29 00:21:58,319 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58.319 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:__init__:992 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_path_submission_inv0/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:21:58.320 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1051 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_path_submission_inv0/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:21:58.320 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__enter__:4087 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:21:58.320 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1403 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:21:58.320 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1322 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_path_submission_inv0/db/chachanotes.db...
2025-06-29 00:21:58.326 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1326 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:21:58.326 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1332 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_path_submission_inv0/db/chachanotes.db.
2025-06-29 00:21:58.326 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1357 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_path_submission_inv0/db/chachanotes.db...
2025-06-29 00:21:58.331 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1361 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:21:58.331 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1369 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_path_submission_inv0/db/chachanotes.db.
2025-06-29 00:21:58.331 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1432 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:21:58.331 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__exit__:4114 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:21:58.331 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__init__:996 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_path_submission_inv0/db/chachanotes.db
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

55. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

56. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

57. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
----------------------------------------

58. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

59. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
----------------------------------------

60. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

61. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

62. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
----------------------------------------

63. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

64. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

65. ____ ERROR at setup of TestChatImageIntegration.test_clear_image_attachment ____
Tests/integration/test_chat_image_integration_real.py:86: in real_app_with_image_support
    app.media_db = MediaDatabase(str(db_dir / "media.db"))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: MediaDatabase.__init__() missing 1 required positional argument: 'client_id'
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:21:58,335 [DEBUG] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

66. 2025-06-29 00:21:58,335 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

67. 2025-06-29 00:21:58,335 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

68. 2025-06-29 00:21:58,335 [ERROR] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:21:58.336 | INFO     | tldw_chatbook.config:load_settings:207 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.336 | INFO     | tldw_chatbook.config:load_settings:208 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.336 | INFO     | tldw_chatbook.config:load_settings:217 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:58.336 | WARNING  | tldw_chatbook.config:load_settings:223 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:58.336 | INFO     | tldw_chatbook.config:load_settings:232 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.337 | INFO     | tldw_chatbook.config:load_settings:237 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.338 | INFO     | tldw_chatbook.config:load_settings:252 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:58.338 | INFO     | tldw_chatbook.app:__init__:973 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.338 | INFO     | tldw_chatbook.app:__init__:980 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.338 | INFO     | tldw_chatbook.app:__init__:981 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:58,338 [INFO] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:58,338 [INFO] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.338 | INFO     | tldw_chatbook.app:__init__:990 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

69. 2025-06-29 00:21:58,338 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

70. 2025-06-29 00:21:58,338 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58,338 [DEBUG] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:21:58.338 | INFO     | tldw_chatbook.config:load_settings:207 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.338 | INFO     | tldw_chatbook.config:load_settings:208 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.338 | INFO     | tldw_chatbook.config:load_settings:217 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:58.338 | WARNING  | tldw_chatbook.config:load_settings:223 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:58.338 | INFO     | tldw_chatbook.config:load_settings:232 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.339 | INFO     | tldw_chatbook.config:load_settings:237 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.340 | INFO     | tldw_chatbook.config:load_settings:252 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:58,340 [INFO] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:21:58,340 [INFO] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:21:58.340 | WARNING  | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:92 - Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
2025-06-29 00:21:58.340 | INFO     | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:105 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:21:58.340 | INFO     | tldw_chatbook.DB.Prompts_DB:__init__:251 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:21:58.341 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_get_thread_connection:317 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:21:58.341 | INFO     | tldw_chatbook.DB.Prompts_DB:_initialize_schema:518 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:21:58.341 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_initialize_schema:521 - Database schema is up to date.
2025-06-29 00:21:58.341 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_initialize_schema:525 - Verified FTS tables exist.
2025-06-29 00:21:58.341 | DEBUG    | tldw_chatbook.DB.Prompts_DB:__init__:281 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:58.341 | INFO     | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:110 - Prompts Interop Library initialized successfully.
2025-06-29 00:21:58,341 [INFO] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:58,341 [INFO] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:21:58,341 [DEBUG] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:21:58,341 [INFO] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:21:58,341 [DEBUG] root:750 - Database schema is up to date.
2025-06-29 00:21:58,341 [DEBUG] root:755 - Verified FTS tables exist.
2025-06-29 00:21:58,341 [DEBUG] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.341 | INFO     | tldw_chatbook.app:__init__:1057 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.341 | DEBUG    | tldw_chatbook.app:__init__:1059 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x144071910>
2025-06-29 00:21:58.341 | DEBUG    | tldw_chatbook.app:__init__:1061 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.341 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:get_distinct_media_types:3417 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:21:58,341 [DEBUG] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:21:58.341 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:get_distinct_media_types:3431 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:21:58.341 | INFO     | tldw_chatbook.app:__init__:1075 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

71. 2025-06-29 00:21:58,341 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

72. 2025-06-29 00:21:58,341 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58.341 | DEBUG    | tldw_chatbook.app:__init__:1089 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:21:58.341 | DEBUG    | tldw_chatbook.app:__init__:1090 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:21:58,341 [INFO] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:21:58,341 [INFO] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

73. 2025-06-29 00:21:58,341 [ERROR] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:21:58.341 | INFO     | tldw_chatbook.app:__init__:1133 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:21:58.341 | INFO     | tldw_chatbook.app:__init__:1134 - Total initialization time: 0.006 seconds
2025-06-29 00:21:58.341 | INFO     | tldw_chatbook.app:__init__:1138 -   basic_init: 0.002s (34.9%)
2025-06-29 00:21:58.341 | INFO     | tldw_chatbook.app:__init__:1138 -   attribute_init: 0.000s (0.3%)
2025-06-29 00:21:58.341 | INFO     | tldw_chatbook.app:__init__:1138 -   notes_service_init: 0.000s (2.9%)
2025-06-29 00:21:58.341 | INFO     | tldw_chatbook.app:__init__:1138 -   providers_models: 0.002s (35.7%)
2025-06-29 00:21:58.341 | INFO     | tldw_chatbook.app:__init__:1138 -   prompts_service_init: 0.000s (6.0%)
2025-06-29 00:21:58.341 | INFO     | tldw_chatbook.app:__init__:1138 -   media_db_init: 0.001s (8.1%)
2025-06-29 00:21:58.341 | INFO     | tldw_chatbook.app:__init__:1139 - ==============================
----------------------------------------

74. 2025-06-29 00:21:58,341 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

75. 2025-06-29 00:21:58,341 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58.342 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:__init__:992 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_clear_image_attachment0/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:21:58.342 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1051 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_clear_image_attachment0/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:21:58.342 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__enter__:4087 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:21:58.342 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1403 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:21:58.342 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1322 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_clear_image_attachment0/db/chachanotes.db...
2025-06-29 00:21:58.348 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1326 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:21:58.348 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1332 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_clear_image_attachment0/db/chachanotes.db.
2025-06-29 00:21:58.348 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1357 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_clear_image_attachment0/db/chachanotes.db...
2025-06-29 00:21:58.353 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1361 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:21:58.353 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1369 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_clear_image_attachment0/db/chachanotes.db.
2025-06-29 00:21:58.353 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1432 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:21:58.353 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__exit__:4114 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:21:58.353 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__init__:996 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_clear_image_attachment0/db/chachanotes.db
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

76. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

77. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

78. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
----------------------------------------

79. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

80. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
----------------------------------------

81. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

82. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

83. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
----------------------------------------

84. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

85. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

86. ___ ERROR at setup of TestChatImageIntegration.test_send_message_with_image ____
Tests/integration/test_chat_image_integration_real.py:86: in real_app_with_image_support
    app.media_db = MediaDatabase(str(db_dir / "media.db"))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: MediaDatabase.__init__() missing 1 required positional argument: 'client_id'
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:21:58,357 [DEBUG] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

87. 2025-06-29 00:21:58,357 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

88. 2025-06-29 00:21:58,357 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

89. 2025-06-29 00:21:58,357 [ERROR] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:21:58.357 | INFO     | tldw_chatbook.config:load_settings:207 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.357 | INFO     | tldw_chatbook.config:load_settings:208 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.357 | INFO     | tldw_chatbook.config:load_settings:217 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:58.357 | WARNING  | tldw_chatbook.config:load_settings:223 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:58.357 | INFO     | tldw_chatbook.config:load_settings:232 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.359 | INFO     | tldw_chatbook.config:load_settings:237 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.359 | INFO     | tldw_chatbook.config:load_settings:252 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:58.360 | INFO     | tldw_chatbook.app:__init__:973 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.360 | INFO     | tldw_chatbook.app:__init__:980 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.360 | INFO     | tldw_chatbook.app:__init__:981 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:58,360 [INFO] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:58,360 [INFO] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.360 | INFO     | tldw_chatbook.app:__init__:990 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

90. 2025-06-29 00:21:58,360 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

91. 2025-06-29 00:21:58,360 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58,360 [DEBUG] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:21:58.360 | INFO     | tldw_chatbook.config:load_settings:207 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.360 | INFO     | tldw_chatbook.config:load_settings:208 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.360 | INFO     | tldw_chatbook.config:load_settings:217 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:58.360 | WARNING  | tldw_chatbook.config:load_settings:223 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:58.360 | INFO     | tldw_chatbook.config:load_settings:232 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.361 | INFO     | tldw_chatbook.config:load_settings:237 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.362 | INFO     | tldw_chatbook.config:load_settings:252 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:58,362 [INFO] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:21:58,362 [INFO] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:21:58.362 | WARNING  | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:92 - Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
2025-06-29 00:21:58.362 | INFO     | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:105 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:21:58.362 | INFO     | tldw_chatbook.DB.Prompts_DB:__init__:251 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:21:58.362 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_get_thread_connection:317 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:21:58.362 | INFO     | tldw_chatbook.DB.Prompts_DB:_initialize_schema:518 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:21:58.362 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_initialize_schema:521 - Database schema is up to date.
2025-06-29 00:21:58.362 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_initialize_schema:525 - Verified FTS tables exist.
2025-06-29 00:21:58.362 | DEBUG    | tldw_chatbook.DB.Prompts_DB:__init__:281 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:58.362 | INFO     | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:110 - Prompts Interop Library initialized successfully.
2025-06-29 00:21:58,362 [INFO] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:58,363 [INFO] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:21:58,363 [DEBUG] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:21:58,363 [INFO] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:21:58,363 [DEBUG] root:750 - Database schema is up to date.
2025-06-29 00:21:58,363 [DEBUG] root:755 - Verified FTS tables exist.
2025-06-29 00:21:58,363 [DEBUG] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.363 | INFO     | tldw_chatbook.app:__init__:1057 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.363 | DEBUG    | tldw_chatbook.app:__init__:1059 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x14409f470>
2025-06-29 00:21:58.363 | DEBUG    | tldw_chatbook.app:__init__:1061 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.363 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:get_distinct_media_types:3417 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:21:58,363 [DEBUG] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:21:58.363 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:get_distinct_media_types:3431 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:21:58.363 | INFO     | tldw_chatbook.app:__init__:1075 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

92. 2025-06-29 00:21:58,363 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

93. 2025-06-29 00:21:58,363 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58.363 | DEBUG    | tldw_chatbook.app:__init__:1089 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:21:58.363 | DEBUG    | tldw_chatbook.app:__init__:1090 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:21:58,363 [INFO] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:21:58,363 [INFO] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

94. 2025-06-29 00:21:58,363 [ERROR] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:21:58.363 | INFO     | tldw_chatbook.app:__init__:1133 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:21:58.363 | INFO     | tldw_chatbook.app:__init__:1134 - Total initialization time: 0.006 seconds
2025-06-29 00:21:58.363 | INFO     | tldw_chatbook.app:__init__:1138 -   basic_init: 0.002s (34.9%)
2025-06-29 00:21:58.363 | INFO     | tldw_chatbook.app:__init__:1138 -   attribute_init: 0.000s (0.3%)
2025-06-29 00:21:58.363 | INFO     | tldw_chatbook.app:__init__:1138 -   notes_service_init: 0.000s (2.9%)
2025-06-29 00:21:58.363 | INFO     | tldw_chatbook.app:__init__:1138 -   providers_models: 0.002s (36.9%)
2025-06-29 00:21:58.363 | INFO     | tldw_chatbook.app:__init__:1138 -   prompts_service_init: 0.000s (6.6%)
2025-06-29 00:21:58.363 | INFO     | tldw_chatbook.app:__init__:1138 -   media_db_init: 0.000s (7.7%)
2025-06-29 00:21:58.363 | INFO     | tldw_chatbook.app:__init__:1139 - ==============================
----------------------------------------

95. 2025-06-29 00:21:58,363 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

96. 2025-06-29 00:21:58,363 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58.363 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:__init__:992 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_send_message_with_image0/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:21:58.364 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1051 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_send_message_with_image0/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:21:58.364 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__enter__:4087 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:21:58.364 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1403 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:21:58.364 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1322 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_send_message_with_image0/db/chachanotes.db...
2025-06-29 00:21:58.370 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1326 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:21:58.370 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1332 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_send_message_with_image0/db/chachanotes.db.
2025-06-29 00:21:58.370 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1357 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_send_message_with_image0/db/chachanotes.db...
2025-06-29 00:21:58.375 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1361 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:21:58.375 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1369 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_send_message_with_image0/db/chachanotes.db.
2025-06-29 00:21:58.375 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1432 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:21:58.375 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__exit__:4114 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:21:58.375 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__init__:996 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_send_message_with_image0/db/chachanotes.db
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

97. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

98. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

99. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
----------------------------------------

100. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

101. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
----------------------------------------

102. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

103. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

104. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
----------------------------------------

105. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

106. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

107. ________ ERROR at setup of TestChatImageIntegration.test_image_resizing ________
Tests/integration/test_chat_image_integration_real.py:86: in real_app_with_image_support
    app.media_db = MediaDatabase(str(db_dir / "media.db"))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: MediaDatabase.__init__() missing 1 required positional argument: 'client_id'
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:21:58,379 [DEBUG] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

108. 2025-06-29 00:21:58,379 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

109. 2025-06-29 00:21:58,379 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

110. 2025-06-29 00:21:58,379 [ERROR] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:21:58.380 | INFO     | tldw_chatbook.config:load_settings:207 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.380 | INFO     | tldw_chatbook.config:load_settings:208 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.380 | INFO     | tldw_chatbook.config:load_settings:217 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:58.380 | WARNING  | tldw_chatbook.config:load_settings:223 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:58.380 | INFO     | tldw_chatbook.config:load_settings:232 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.381 | INFO     | tldw_chatbook.config:load_settings:237 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.382 | INFO     | tldw_chatbook.config:load_settings:252 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:58.382 | INFO     | tldw_chatbook.app:__init__:973 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.382 | INFO     | tldw_chatbook.app:__init__:980 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.382 | INFO     | tldw_chatbook.app:__init__:981 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:58,382 [INFO] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:58,382 [INFO] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.382 | INFO     | tldw_chatbook.app:__init__:990 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

111. 2025-06-29 00:21:58,382 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

112. 2025-06-29 00:21:58,382 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58,382 [DEBUG] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:21:58.382 | INFO     | tldw_chatbook.config:load_settings:207 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.382 | INFO     | tldw_chatbook.config:load_settings:208 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.382 | INFO     | tldw_chatbook.config:load_settings:217 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:58.382 | WARNING  | tldw_chatbook.config:load_settings:223 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:58.382 | INFO     | tldw_chatbook.config:load_settings:232 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.383 | INFO     | tldw_chatbook.config:load_settings:237 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.384 | INFO     | tldw_chatbook.config:load_settings:252 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:58,384 [INFO] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:21:58,384 [INFO] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:21:58.384 | WARNING  | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:92 - Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
2025-06-29 00:21:58.384 | INFO     | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:105 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:21:58.384 | INFO     | tldw_chatbook.DB.Prompts_DB:__init__:251 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:21:58.385 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_get_thread_connection:317 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:21:58.385 | INFO     | tldw_chatbook.DB.Prompts_DB:_initialize_schema:518 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:21:58.385 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_initialize_schema:521 - Database schema is up to date.
2025-06-29 00:21:58.385 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_initialize_schema:525 - Verified FTS tables exist.
2025-06-29 00:21:58.385 | DEBUG    | tldw_chatbook.DB.Prompts_DB:__init__:281 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:58.385 | INFO     | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:110 - Prompts Interop Library initialized successfully.
2025-06-29 00:21:58,385 [INFO] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:58,385 [INFO] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:21:58,385 [DEBUG] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:21:58,385 [INFO] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:21:58,385 [DEBUG] root:750 - Database schema is up to date.
2025-06-29 00:21:58,385 [DEBUG] root:755 - Verified FTS tables exist.
2025-06-29 00:21:58,385 [DEBUG] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.385 | INFO     | tldw_chatbook.app:__init__:1057 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.385 | DEBUG    | tldw_chatbook.app:__init__:1059 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x144063fe0>
2025-06-29 00:21:58.385 | DEBUG    | tldw_chatbook.app:__init__:1061 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.385 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:get_distinct_media_types:3417 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:21:58,385 [DEBUG] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:21:58.385 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:get_distinct_media_types:3431 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:21:58.385 | INFO     | tldw_chatbook.app:__init__:1075 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

113. 2025-06-29 00:21:58,385 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

114. 2025-06-29 00:21:58,385 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58.385 | DEBUG    | tldw_chatbook.app:__init__:1089 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:21:58.385 | DEBUG    | tldw_chatbook.app:__init__:1090 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:21:58,385 [INFO] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:21:58,385 [INFO] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

115. 2025-06-29 00:21:58,385 [ERROR] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:21:58.385 | INFO     | tldw_chatbook.app:__init__:1133 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:21:58.385 | INFO     | tldw_chatbook.app:__init__:1134 - Total initialization time: 0.006 seconds
2025-06-29 00:21:58.385 | INFO     | tldw_chatbook.app:__init__:1138 -   basic_init: 0.002s (35.4%)
2025-06-29 00:21:58.385 | INFO     | tldw_chatbook.app:__init__:1138 -   attribute_init: 0.000s (0.2%)
2025-06-29 00:21:58.385 | INFO     | tldw_chatbook.app:__init__:1138 -   notes_service_init: 0.000s (2.7%)
2025-06-29 00:21:58.385 | INFO     | tldw_chatbook.app:__init__:1138 -   providers_models: 0.002s (35.0%)
2025-06-29 00:21:58.385 | INFO     | tldw_chatbook.app:__init__:1138 -   prompts_service_init: 0.000s (6.4%)
2025-06-29 00:21:58.385 | INFO     | tldw_chatbook.app:__init__:1138 -   media_db_init: 0.001s (7.8%)
2025-06-29 00:21:58.385 | INFO     | tldw_chatbook.app:__init__:1139 - ==============================
----------------------------------------

116. 2025-06-29 00:21:58,385 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

117. 2025-06-29 00:21:58,386 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58.386 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:__init__:992 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_resizing0/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:21:58.386 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1051 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_resizing0/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:21:58.386 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__enter__:4087 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:21:58.386 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1403 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:21:58.386 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1322 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_resizing0/db/chachanotes.db...
2025-06-29 00:21:58.392 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1326 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:21:58.392 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1332 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_resizing0/db/chachanotes.db.
2025-06-29 00:21:58.392 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1357 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_resizing0/db/chachanotes.db...
2025-06-29 00:21:58.397 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1361 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:21:58.397 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1369 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_resizing0/db/chachanotes.db.
2025-06-29 00:21:58.397 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1432 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:21:58.397 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__exit__:4114 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:21:58.397 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__init__:996 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_resizing0/db/chachanotes.db
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

118. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

119. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

120. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
----------------------------------------

121. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

122. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
----------------------------------------

123. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

124. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

125. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
----------------------------------------

126. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

127. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

128. ____ ERROR at setup of TestChatImageIntegration.test_unsupported_file_type _____
Tests/integration/test_chat_image_integration_real.py:86: in real_app_with_image_support
    app.media_db = MediaDatabase(str(db_dir / "media.db"))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: MediaDatabase.__init__() missing 1 required positional argument: 'client_id'
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:21:58,401 [DEBUG] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

129. 2025-06-29 00:21:58,401 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

130. 2025-06-29 00:21:58,401 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

131. 2025-06-29 00:21:58,401 [ERROR] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:21:58.402 | INFO     | tldw_chatbook.config:load_settings:207 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.402 | INFO     | tldw_chatbook.config:load_settings:208 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.402 | INFO     | tldw_chatbook.config:load_settings:217 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:58.402 | WARNING  | tldw_chatbook.config:load_settings:223 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:58.402 | INFO     | tldw_chatbook.config:load_settings:232 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.403 | INFO     | tldw_chatbook.config:load_settings:237 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.404 | INFO     | tldw_chatbook.config:load_settings:252 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:58.404 | INFO     | tldw_chatbook.app:__init__:973 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.404 | INFO     | tldw_chatbook.app:__init__:980 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.404 | INFO     | tldw_chatbook.app:__init__:981 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:58,404 [INFO] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:58,404 [INFO] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.404 | INFO     | tldw_chatbook.app:__init__:990 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

132. 2025-06-29 00:21:58,404 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

133. 2025-06-29 00:21:58,404 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58,404 [DEBUG] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:21:58.404 | INFO     | tldw_chatbook.config:load_settings:207 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.404 | INFO     | tldw_chatbook.config:load_settings:208 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.404 | INFO     | tldw_chatbook.config:load_settings:217 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:58.404 | WARNING  | tldw_chatbook.config:load_settings:223 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:58.404 | INFO     | tldw_chatbook.config:load_settings:232 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.405 | INFO     | tldw_chatbook.config:load_settings:237 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.406 | INFO     | tldw_chatbook.config:load_settings:252 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:58,406 [INFO] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:21:58,406 [INFO] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:21:58.406 | WARNING  | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:92 - Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
2025-06-29 00:21:58.406 | INFO     | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:105 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:21:58.406 | INFO     | tldw_chatbook.DB.Prompts_DB:__init__:251 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:21:58.406 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_get_thread_connection:317 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:21:58.406 | INFO     | tldw_chatbook.DB.Prompts_DB:_initialize_schema:518 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:21:58.406 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_initialize_schema:521 - Database schema is up to date.
2025-06-29 00:21:58.407 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_initialize_schema:525 - Verified FTS tables exist.
2025-06-29 00:21:58.407 | DEBUG    | tldw_chatbook.DB.Prompts_DB:__init__:281 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:58.407 | INFO     | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:110 - Prompts Interop Library initialized successfully.
2025-06-29 00:21:58,407 [INFO] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:58,407 [INFO] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:21:58,407 [DEBUG] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:21:58,407 [INFO] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:21:58,407 [DEBUG] root:750 - Database schema is up to date.
2025-06-29 00:21:58,407 [DEBUG] root:755 - Verified FTS tables exist.
2025-06-29 00:21:58,407 [DEBUG] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.407 | INFO     | tldw_chatbook.app:__init__:1057 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.407 | DEBUG    | tldw_chatbook.app:__init__:1059 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x144041be0>
2025-06-29 00:21:58.407 | DEBUG    | tldw_chatbook.app:__init__:1061 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.407 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:get_distinct_media_types:3417 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:21:58,407 [DEBUG] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:21:58.407 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:get_distinct_media_types:3431 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:21:58.407 | INFO     | tldw_chatbook.app:__init__:1075 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

134. 2025-06-29 00:21:58,407 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

135. 2025-06-29 00:21:58,407 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58.407 | DEBUG    | tldw_chatbook.app:__init__:1089 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:21:58.407 | DEBUG    | tldw_chatbook.app:__init__:1090 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:21:58,407 [INFO] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:21:58,407 [INFO] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

136. 2025-06-29 00:21:58,407 [ERROR] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:21:58.407 | INFO     | tldw_chatbook.app:__init__:1133 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:21:58.407 | INFO     | tldw_chatbook.app:__init__:1134 - Total initialization time: 0.006 seconds
2025-06-29 00:21:58.407 | INFO     | tldw_chatbook.app:__init__:1138 -   basic_init: 0.002s (35.6%)
2025-06-29 00:21:58.407 | INFO     | tldw_chatbook.app:__init__:1138 -   attribute_init: 0.000s (0.2%)
2025-06-29 00:21:58.407 | INFO     | tldw_chatbook.app:__init__:1138 -   notes_service_init: 0.000s (2.8%)
2025-06-29 00:21:58.407 | INFO     | tldw_chatbook.app:__init__:1138 -   providers_models: 0.002s (36.5%)
2025-06-29 00:21:58.407 | INFO     | tldw_chatbook.app:__init__:1138 -   prompts_service_init: 0.000s (5.8%)
2025-06-29 00:21:58.407 | INFO     | tldw_chatbook.app:__init__:1138 -   media_db_init: 0.001s (8.4%)
2025-06-29 00:21:58.407 | INFO     | tldw_chatbook.app:__init__:1139 - ==============================
----------------------------------------

137. 2025-06-29 00:21:58,407 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

138. 2025-06-29 00:21:58,407 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58.407 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:__init__:992 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_unsupported_file_type0/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:21:58.408 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1051 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_unsupported_file_type0/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:21:58.408 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__enter__:4087 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:21:58.408 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1403 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:21:58.408 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1322 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_unsupported_file_type0/db/chachanotes.db...
2025-06-29 00:21:58.414 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1326 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:21:58.414 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1332 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_unsupported_file_type0/db/chachanotes.db.
2025-06-29 00:21:58.414 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1357 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_unsupported_file_type0/db/chachanotes.db...
2025-06-29 00:21:58.419 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1361 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:21:58.419 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1369 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_unsupported_file_type0/db/chachanotes.db.
2025-06-29 00:21:58.419 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1432 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:21:58.419 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__exit__:4114 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:21:58.419 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__init__:996 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_unsupported_file_type0/db/chachanotes.db
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

139. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

140. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

141. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
----------------------------------------

142. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

143. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
----------------------------------------

144. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

145. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

146. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
----------------------------------------

147. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

148. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

149. ____ ERROR at setup of TestChatImageIntegration.test_image_preview_display _____
Tests/integration/test_chat_image_integration_real.py:86: in real_app_with_image_support
    app.media_db = MediaDatabase(str(db_dir / "media.db"))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: MediaDatabase.__init__() missing 1 required positional argument: 'client_id'
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:21:58,423 [DEBUG] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

150. 2025-06-29 00:21:58,423 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

151. 2025-06-29 00:21:58,423 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

152. 2025-06-29 00:21:58,423 [ERROR] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:21:58.423 | INFO     | tldw_chatbook.config:load_settings:207 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.423 | INFO     | tldw_chatbook.config:load_settings:208 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.423 | INFO     | tldw_chatbook.config:load_settings:217 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:58.424 | WARNING  | tldw_chatbook.config:load_settings:223 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:58.424 | INFO     | tldw_chatbook.config:load_settings:232 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.425 | INFO     | tldw_chatbook.config:load_settings:237 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.425 | INFO     | tldw_chatbook.config:load_settings:252 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:58.426 | INFO     | tldw_chatbook.app:__init__:973 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.426 | INFO     | tldw_chatbook.app:__init__:980 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.426 | INFO     | tldw_chatbook.app:__init__:981 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:58,426 [INFO] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:58,426 [INFO] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.426 | INFO     | tldw_chatbook.app:__init__:990 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

153. 2025-06-29 00:21:58,426 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

154. 2025-06-29 00:21:58,426 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58,426 [DEBUG] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:21:58.426 | INFO     | tldw_chatbook.config:load_settings:207 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.426 | INFO     | tldw_chatbook.config:load_settings:208 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.426 | INFO     | tldw_chatbook.config:load_settings:217 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:58.426 | WARNING  | tldw_chatbook.config:load_settings:223 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:58.426 | INFO     | tldw_chatbook.config:load_settings:232 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.433 | INFO     | tldw_chatbook.config:load_settings:237 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.434 | INFO     | tldw_chatbook.config:load_settings:252 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:58,434 [INFO] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:21:58,434 [INFO] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:21:58.434 | WARNING  | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:92 - Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
2025-06-29 00:21:58.434 | INFO     | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:105 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:21:58.434 | INFO     | tldw_chatbook.DB.Prompts_DB:__init__:251 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:21:58.435 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_get_thread_connection:317 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:21:58.435 | INFO     | tldw_chatbook.DB.Prompts_DB:_initialize_schema:518 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:21:58.435 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_initialize_schema:521 - Database schema is up to date.
2025-06-29 00:21:58.435 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_initialize_schema:525 - Verified FTS tables exist.
2025-06-29 00:21:58.435 | DEBUG    | tldw_chatbook.DB.Prompts_DB:__init__:281 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:58.435 | INFO     | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:110 - Prompts Interop Library initialized successfully.
2025-06-29 00:21:58,435 [INFO] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:58,435 [INFO] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:21:58,435 [DEBUG] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:21:58,435 [INFO] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:21:58,435 [DEBUG] root:750 - Database schema is up to date.
2025-06-29 00:21:58,435 [DEBUG] root:755 - Verified FTS tables exist.
2025-06-29 00:21:58,435 [DEBUG] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.435 | INFO     | tldw_chatbook.app:__init__:1057 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.435 | DEBUG    | tldw_chatbook.app:__init__:1059 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x144040cb0>
2025-06-29 00:21:58.435 | DEBUG    | tldw_chatbook.app:__init__:1061 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.435 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:get_distinct_media_types:3417 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:21:58,435 [DEBUG] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:21:58.435 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:get_distinct_media_types:3431 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:21:58.435 | INFO     | tldw_chatbook.app:__init__:1075 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

155. 2025-06-29 00:21:58,435 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

156. 2025-06-29 00:21:58,435 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58.435 | DEBUG    | tldw_chatbook.app:__init__:1089 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:21:58.435 | DEBUG    | tldw_chatbook.app:__init__:1090 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:21:58,435 [INFO] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:21:58,435 [INFO] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

157. 2025-06-29 00:21:58,436 [ERROR] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:21:58.436 | INFO     | tldw_chatbook.app:__init__:1133 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:21:58.436 | INFO     | tldw_chatbook.app:__init__:1134 - Total initialization time: 0.013 seconds
2025-06-29 00:21:58.436 | INFO     | tldw_chatbook.app:__init__:1138 -   basic_init: 0.002s (17.3%)
2025-06-29 00:21:58.436 | INFO     | tldw_chatbook.app:__init__:1138 -   attribute_init: 0.000s (0.1%)
2025-06-29 00:21:58.436 | INFO     | tldw_chatbook.app:__init__:1138 -   notes_service_init: 0.000s (1.4%)
2025-06-29 00:21:58.436 | INFO     | tldw_chatbook.app:__init__:1138 -   providers_models: 0.008s (67.5%)
2025-06-29 00:21:58.436 | INFO     | tldw_chatbook.app:__init__:1138 -   prompts_service_init: 0.000s (3.4%)
2025-06-29 00:21:58.436 | INFO     | tldw_chatbook.app:__init__:1138 -   media_db_init: 0.001s (4.1%)
2025-06-29 00:21:58.436 | INFO     | tldw_chatbook.app:__init__:1139 - ==============================
----------------------------------------

158. 2025-06-29 00:21:58,436 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

159. 2025-06-29 00:21:58,436 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58.436 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:__init__:992 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_preview_display0/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:21:58.436 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1051 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_preview_display0/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:21:58.436 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__enter__:4087 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:21:58.436 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1403 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:21:58.436 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1322 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_preview_display0/db/chachanotes.db...
2025-06-29 00:21:58.442 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1326 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:21:58.442 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1332 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_preview_display0/db/chachanotes.db.
2025-06-29 00:21:58.442 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1357 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_preview_display0/db/chachanotes.db...
2025-06-29 00:21:58.447 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1361 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:21:58.447 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1369 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_preview_display0/db/chachanotes.db.
2025-06-29 00:21:58.448 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1432 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:21:58.448 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__exit__:4114 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:21:58.448 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__init__:996 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_image_preview_display0/db/chachanotes.db
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

160. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

161. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

162. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
----------------------------------------

163. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

164. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
----------------------------------------

165. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

166. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

167. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
----------------------------------------

168. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

169. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

170. _ ERROR at setup of TestChatImageIntegration.test_multiple_image_attachments_not_allowed _
Tests/integration/test_chat_image_integration_real.py:86: in real_app_with_image_support
    app.media_db = MediaDatabase(str(db_dir / "media.db"))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: MediaDatabase.__init__() missing 1 required positional argument: 'client_id'
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:21:58,451 [DEBUG] asyncio:64 - Using selector: KqueueSelector
----------------------------------------

171. 2025-06-29 00:21:58,452 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

172. 2025-06-29 00:21:58,452 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

173. 2025-06-29 00:21:58,452 [ERROR] root:85 - Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
2025-06-29 00:21:58.452 | INFO     | tldw_chatbook.config:load_settings:207 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.452 | INFO     | tldw_chatbook.config:load_settings:208 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.452 | INFO     | tldw_chatbook.config:load_settings:217 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:58.452 | WARNING  | tldw_chatbook.config:load_settings:223 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:58.452 | INFO     | tldw_chatbook.config:load_settings:232 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.453 | INFO     | tldw_chatbook.config:load_settings:237 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.454 | INFO     | tldw_chatbook.config:load_settings:252 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:58.454 | INFO     | tldw_chatbook.app:__init__:973 - Unified ChaChaNotes DB file path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.455 | INFO     | tldw_chatbook.app:__init__:980 - Notes for user 'default_user' will use the unified DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.455 | INFO     | tldw_chatbook.app:__init__:981 - Base directory to be passed to NotesInteropService: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:58,455 [INFO] tldw_chatbook.Notes.Notes_Library:46 - NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
2025-06-29 00:21:58,455 [INFO] tldw_chatbook.Notes.Notes_Library:54 - NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
2025-06-29 00:21:58.455 | INFO     | tldw_chatbook.app:__init__:990 - NotesInteropService successfully initialized for user 'default_user'.
----------------------------------------

174. 2025-06-29 00:21:58,455 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

175. 2025-06-29 00:21:58,455 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58,455 [DEBUG] root:1007 - __INIT__: Attempting to get providers and models...
2025-06-29 00:21:58.455 | INFO     | tldw_chatbook.config:load_settings:207 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.455 | INFO     | tldw_chatbook.config:load_settings:208 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook
2025-06-29 00:21:58.455 | INFO     | tldw_chatbook.config:load_settings:217 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml
2025-06-29 00:21:58.455 | WARNING  | tldw_chatbook.config:load_settings:223 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-06-29 00:21:58.455 | INFO     | tldw_chatbook.config:load_settings:232 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.456 | INFO     | tldw_chatbook.config:load_settings:237 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-06-29 00:21:58.457 | INFO     | tldw_chatbook.config:load_settings:252 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-06-29 00:21:58,457 [INFO] root:1011 - __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-06-29 00:21:58,457 [INFO] root:1026 - App __init__: Determined initial tab value: chat
2025-06-29 00:21:58.457 | WARNING  | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:92 - Prompts interop library already initialized with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db'. Re-initializing with DB: '/Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db', Client ID: 'tldw_tui_client_v1'.
2025-06-29 00:21:58.457 | INFO     | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:105 - Initializing Prompts Interop Library. DB Path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db, Client ID: tldw_tui_client_v1
2025-06-29 00:21:58.457 | INFO     | tldw_chatbook.DB.Prompts_DB:__init__:251 - Initializing PromptsDatabase object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client ID: tldw_tui_client_v1]
2025-06-29 00:21:58.457 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_get_thread_connection:317 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db [Client: tldw_tui_client_v1, Thread: MainThread]
2025-06-29 00:21:58.457 | INFO     | tldw_chatbook.DB.Prompts_DB:_initialize_schema:518 - Checking DB schema. Current: 1, Code supports: 1
2025-06-29 00:21:58.457 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_initialize_schema:521 - Database schema is up to date.
2025-06-29 00:21:58.457 | DEBUG    | tldw_chatbook.DB.Prompts_DB:_initialize_schema:525 - Verified FTS tables exist.
2025-06-29 00:21:58.457 | DEBUG    | tldw_chatbook.DB.Prompts_DB:__init__:281 - PromptsDatabase initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:58.457 | INFO     | tldw_chatbook.Prompt_Management.Prompts_Interop:initialize_interop:110 - Prompts Interop Library initialized successfully.
2025-06-29 00:21:58,457 [INFO] root:1040 - Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
2025-06-29 00:21:58,457 [INFO] root:444 - Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
2025-06-29 00:21:58,458 [DEBUG] root:510 - Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
2025-06-29 00:21:58,458 [INFO] root:747 - Checking DB schema. Current version: 1. Code supports: 1
2025-06-29 00:21:58,458 [DEBUG] root:750 - Database schema is up to date.
2025-06-29 00:21:58,458 [DEBUG] root:755 - Verified FTS tables exist.
2025-06-29 00:21:58,458 [DEBUG] root:474 - Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.458 | INFO     | tldw_chatbook.app:__init__:1057 - Media_DB_v2 initialized successfully for client 'tldw_cli_local_instance_v1' at /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.458 | DEBUG    | tldw_chatbook.app:__init__:1059 - ULTRA EARLY APP INIT: self.media_db instance: <tldw_chatbook.DB.Client_Media_DB_v2.MediaDatabase object at 0x144061880>
2025-06-29 00:21:58.458 | DEBUG    | tldw_chatbook.app:__init__:1061 - ULTRA EARLY APP INIT: self.media_db.db_path_str: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
2025-06-29 00:21:58.458 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:get_distinct_media_types:3417 - Fetching distinct media types from DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db (deleted=False, trash=False)
2025-06-29 00:21:58,458 [DEBUG] root:565 - Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
2025-06-29 00:21:58.458 | INFO     | tldw_chatbook.DB.Client_Media_DB_v2:get_distinct_media_types:3431 - Found 3 distinct media types: ['article', 'podcast', 'video']
2025-06-29 00:21:58.458 | INFO     | tldw_chatbook.app:__init__:1075 - App __init__: Pre-fetched 4 media types for UI.
----------------------------------------

176. 2025-06-29 00:21:58,458 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

177. 2025-06-29 00:21:58,458 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58.458 | DEBUG    | tldw_chatbook.app:__init__:1089 - ULTRA EARLY APP INIT: self._media_types_for_ui VALUE: ['All Media', 'article', 'podcast', 'video']
2025-06-29 00:21:58.458 | DEBUG    | tldw_chatbook.app:__init__:1090 - ULTRA EARLY APP INIT: self._media_types_for_ui TYPE: <class 'list'>
2025-06-29 00:21:58,458 [INFO] root:1104 - Assigned prompts_interop.get_db_instance() to self.prompts_db
2025-06-29 00:21:58,458 [INFO] root:1117 - Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

178. 2025-06-29 00:21:58,458 [ERROR] root:99 - Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
2025-06-29 00:21:58.458 | INFO     | tldw_chatbook.app:__init__:1133 - === STARTUP TIMING SUMMARY ===
2025-06-29 00:21:58.458 | INFO     | tldw_chatbook.app:__init__:1134 - Total initialization time: 0.006 seconds
2025-06-29 00:21:58.458 | INFO     | tldw_chatbook.app:__init__:1138 -   basic_init: 0.002s (36.0%)
2025-06-29 00:21:58.458 | INFO     | tldw_chatbook.app:__init__:1138 -   attribute_init: 0.000s (0.3%)
2025-06-29 00:21:58.458 | INFO     | tldw_chatbook.app:__init__:1138 -   notes_service_init: 0.000s (3.1%)
2025-06-29 00:21:58.458 | INFO     | tldw_chatbook.app:__init__:1138 -   providers_models: 0.002s (35.4%)
2025-06-29 00:21:58.458 | INFO     | tldw_chatbook.app:__init__:1138 -   prompts_service_init: 0.000s (5.7%)
2025-06-29 00:21:58.458 | INFO     | tldw_chatbook.app:__init__:1138 -   media_db_init: 0.000s (7.4%)
2025-06-29 00:21:58.458 | INFO     | tldw_chatbook.app:__init__:1139 - ==============================
----------------------------------------

179. 2025-06-29 00:21:58,458 [ERROR] root:114 - Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

180. 2025-06-29 00:21:58,458 [ERROR] root:114 - Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
2025-06-29 00:21:58.458 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:__init__:992 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_multiple_image_attachment0/db/chachanotes.db [Client ID: test_user]
2025-06-29 00:21:58.459 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1051 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_multiple_image_attachment0/db/chachanotes.db (Journal: wal) for thread 8705548032
2025-06-29 00:21:58.459 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__enter__:4087 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:21:58.459 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1403 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:21:58.459 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1322 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_multiple_image_attachment0/db/chachanotes.db...
2025-06-29 00:21:58.465 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1326 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:21:58.465 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1332 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_multiple_image_attachment0/db/chachanotes.db.
2025-06-29 00:21:58.465 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1357 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_multiple_image_attachment0/db/chachanotes.db...
2025-06-29 00:21:58.470 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1361 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:21:58.470 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1369 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_multiple_image_attachment0/db/chachanotes.db.
2025-06-29 00:21:58.470 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1432 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:21:58.470 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__exit__:4114 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:21:58.470 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__init__:996 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/pytest-of-appledev/pytest-405/test_multiple_image_attachment0/db/chachanotes.db
------------------------------ Captured log setup ------------------------------
DEBUG    asyncio:selector_events.py:64 Using selector: KqueueSelector
----------------------------------------

181. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

182. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

183. ERROR    root:metrics.py:85 Failed to log counter app_startup_initiated: No label names were set when constructing counter:app_startup_initiated
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:46 NotesInteropService: Ensured base directory exists: /Users/appledev/.local/share/tldw_cli/default_user
INFO     tldw_chatbook.Notes.Notes_Library:Notes_Library.py:54 NotesInteropService initialized with unified DB template: /Users/appledev/.local/share/tldw_cli/default_user/tldw_chatbook_ChaChaNotes.db
----------------------------------------

184. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

185. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
DEBUG    root:app.py:1007 __INIT__: Attempting to get providers and models...
INFO     root:app.py:1011 __INIT__: Successfully retrieved providers_models. Count: 26. Keys: ['OpenAI', 'Anthropic', 'Cohere', 'DeepSeek', 'Groq', 'Google', 'HuggingFace', 'MistralAI', 'OpenRouter', 'Llama_cpp', 'koboldcpp', 'Oobabooga', 'Ollama', 'vLLM', 'Custom', 'Custom_2', 'TabbyAPI', 'Aphrodite', 'local-llm', 'local_llamacpp', 'local_llamafile', 'local_ollama', 'local_vllm', 'local_onnx', 'local_transformers', 'local_mlx_lm']
INFO     root:app.py:1026 App __init__: Determined initial tab value: chat
INFO     root:app.py:1040 Prompts Interop Service initialized with DB: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_prompts.db
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client ID: tldw_cli_local_instance_v1]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db [Client: tldw_cli_local_instance_v1, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 1. Code supports: 1
DEBUG    root:Client_Media_DB_v2.py:750 Database schema is up to date.
DEBUG    root:Client_Media_DB_v2.py:755 Verified FTS tables exist.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /Users/appledev/.local/share/tldw_cli/default_user/tldw_cli_media_v2.db
DEBUG    root:Client_Media_DB_v2.py:565 Executing Query: SELECT DISTINCT type FROM Media WHERE type IS NOT NULL AND type != '' AND deleted = 0 AND is_trash = 0 ORDER BY type ASC... Params: None...
----------------------------------------

186. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

187. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
INFO     root:app.py:1104 Assigned prompts_interop.get_db_instance() to self.prompts_db
INFO     root:app.py:1117 Assigned global_db_instance to self.chachanotes_db as fallback.
----------------------------------------

188. ERROR    root:metrics.py:99 Failed to log histogram app_startup_total_duration_seconds: No label names were set when constructing histogram:app_startup_total_duration_seconds
----------------------------------------

189. ERROR    root:metrics.py:114 Failed to log gauge process_memory_mb: No label names were set when constructing gauge:process_memory_mb
----------------------------------------

190. ERROR    root:metrics.py:114 Failed to log gauge process_cpu_percent: No label names were set when constructing gauge:process_cpu_percent
----------------------------------------

191. _ ERROR at setup of TestFileOperationErrorHandling.test_prepare_files_with_missing_files _
file /Users/appledev/Working/tldw_chatbook_dev/Tests/integration/test_file_operations_with_validation.py, line 241
      def test_prepare_files_with_missing_files(self, temp_upload_dir):
E       fixture 'temp_upload_dir' not found
>       available fixtures: _class_event_loop, _function_event_loop, _module_event_loop, _package_event_loop, _session_event_loop, anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, capteesys, class_mocker, doctest_namespace, event_loop_policy, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, include_metadata_in_junit_xml, json_metadata, metadata, mocker, module_mocker, monkeypatch, package_mocker, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, session_mocker, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.
----------------------------------------

192. _ ERROR at setup of TestFileOperationErrorHandling.test_prepare_files_error_recovery _
file /Users/appledev/Working/tldw_chatbook_dev/Tests/integration/test_file_operations_with_validation.py, line 257
      def test_prepare_files_error_recovery(self, temp_upload_dir):
E       fixture 'temp_upload_dir' not found
>       available fixtures: _class_event_loop, _function_event_loop, _module_event_loop, _package_event_loop, _session_event_loop, anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, capteesys, class_mocker, doctest_namespace, event_loop_policy, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, include_metadata_in_junit_xml, json_metadata, metadata, mocker, module_mocker, monkeypatch, package_mocker, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, session_mocker, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.
----------------------------------------

193. _ ERROR at setup of TestFileOperationErrorHandling.test_hidden_file_validation _
file /Users/appledev/Working/tldw_chatbook_dev/Tests/integration/test_file_operations_with_validation.py, line 278
      def test_hidden_file_validation(self, temp_upload_dir):
E       fixture 'temp_upload_dir' not found
>       available fixtures: _class_event_loop, _function_event_loop, _module_event_loop, _package_event_loop, _session_event_loop, anyio_backend, anyio_backend_name, anyio_backend_options, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, capteesys, class_mocker, doctest_namespace, event_loop_policy, free_tcp_port, free_tcp_port_factory, free_udp_port, free_udp_port_factory, include_metadata_in_junit_xml, json_metadata, metadata, mocker, module_mocker, monkeypatch, package_mocker, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, session_mocker, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, unused_tcp_port, unused_tcp_port_factory, unused_udp_port, unused_udp_port_factory
>       use 'pytest --fixtures [testpath]' for help on them.
----------------------------------------

194. 2025-06-29 00:21:58.663 | ERROR    | tldw_chatbook.Character_Chat.Character_Chat_Lib:load_chat_history_from_file_and_save_to_db:1908 - Character 'TestCharacter' from chat log '/private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp3vigqav1/chat_history.json' not found in the database.
___ TestCharacterChatFileOperations.test_load_chat_history_with_invalid_path ___
Tests/integration/test_file_operations_with_validation.py:83: in test_load_chat_history_with_invalid_path
    with pytest.raises(ValueError, match="outside the allowed directory"):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE <class 'ValueError'>
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:21:58.667 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:__init__:992 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp75l3c30t/test.db [Client ID: test_client]
2025-06-29 00:21:58.667 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1051 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp75l3c30t/test.db (Journal: wal) for thread 8705548032
2025-06-29 00:21:58.667 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__enter__:4087 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:21:58.667 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1403 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:21:58.667 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1322 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp75l3c30t/test.db...
2025-06-29 00:21:58.673 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1326 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:21:58.673 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1332 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp75l3c30t/test.db.
2025-06-29 00:21:58.673 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1357 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp75l3c30t/test.db...
2025-06-29 00:21:58.678 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1361 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:21:58.678 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1369 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp75l3c30t/test.db.
2025-06-29 00:21:58.678 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1432 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:21:58.678 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__exit__:4114 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:21:58.678 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__init__:996 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp75l3c30t/test.db
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:21:58.679 | WARNING  | tldw_chatbook.Utils.path_validation:validate_path:43 - Path traversal attempt detected: /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpqy7hjz5a.json -> /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpqy7hjz5a.json
----------------------------------------

195. 2025-06-29 00:21:58.679 | ERROR    | tldw_chatbook.Utils.path_validation:validate_path:54 - Path validation error for '/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpqy7hjz5a.json': Path '/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpqy7hjz5a.json' is outside the allowed directory
----------------------------------------

196. 2025-06-29 00:21:58.679 | ERROR    | tldw_chatbook.Character_Chat.Character_Chat_Lib:load_chat_history_from_file_and_save_to_db:1845 - Invalid chat history file path '/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpqy7hjz5a.json': Path '/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpqy7hjz5a.json' is outside the allowed directory
__ TestCharacterChatFileOperations.test_load_chat_history_with_path_traversal __
Tests/integration/test_file_operations_with_validation.py:97: in test_load_chat_history_with_path_traversal
    with pytest.raises(ValueError, match="outside the allowed directory"):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE <class 'ValueError'>
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:21:58.682 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:__init__:992 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp6q_c0q5y/test.db [Client ID: test_client]
2025-06-29 00:21:58.682 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1051 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp6q_c0q5y/test.db (Journal: wal) for thread 8705548032
2025-06-29 00:21:58.682 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__enter__:4087 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:21:58.682 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1403 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:21:58.682 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1322 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp6q_c0q5y/test.db...
2025-06-29 00:21:58.688 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1326 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:21:58.688 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1332 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp6q_c0q5y/test.db.
2025-06-29 00:21:58.688 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1357 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp6q_c0q5y/test.db...
2025-06-29 00:21:58.693 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1361 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:21:58.693 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1369 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp6q_c0q5y/test.db.
2025-06-29 00:21:58.693 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1432 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:21:58.693 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__exit__:4114 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:21:58.693 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__init__:996 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp6q_c0q5y/test.db
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:21:58.694 | WARNING  | tldw_chatbook.Utils.path_validation:validate_path:43 - Path traversal attempt detected: ../../../etc/passwd -> /private/var/folders/qc/etc/passwd
----------------------------------------

197. 2025-06-29 00:21:58.694 | ERROR    | tldw_chatbook.Utils.path_validation:validate_path:54 - Path validation error for '../../../etc/passwd': Path '../../../etc/passwd' is outside the allowed directory
----------------------------------------

198. 2025-06-29 00:21:58.694 | ERROR    | tldw_chatbook.Character_Chat.Character_Chat_Lib:load_chat_history_from_file_and_save_to_db:1845 - Invalid chat history file path '../../../etc/passwd': Path '../../../etc/passwd' is outside the allowed directory
___ TestCharacterChatFileOperations.test_load_chat_history_from_file_object ____
Tests/integration/test_file_operations_with_validation.py:120: in test_load_chat_history_from_file_object
    assert conv_id == "conv_123"
E   AssertionError: assert None == 'conv_123'
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:21:58.697 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:__init__:992 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp54c4tx9v/test.db [Client ID: test_client]
2025-06-29 00:21:58.697 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1051 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp54c4tx9v/test.db (Journal: wal) for thread 8705548032
2025-06-29 00:21:58.698 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__enter__:4087 - Transaction started (outermost) on thread 8705548032.
2025-06-29 00:21:58.698 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1403 - Checking DB schema 'rag_char_chat_schema'. Current version: 0. Code supports: 5
2025-06-29 00:21:58.698 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1322 - Applying schema Version 4 for 'rag_char_chat_schema' to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp54c4tx9v/test.db...
2025-06-29 00:21:58.703 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1326 - [rag_char_chat_schema V4] Full schema script executed.
2025-06-29 00:21:58.703 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_apply_schema_v4:1332 - [rag_char_chat_schema V4] Schema 4 applied and version confirmed for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp54c4tx9v/test.db.
2025-06-29 00:21:58.703 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1357 - Migrating schema from V4 to V5 for 'rag_char_chat_schema' in DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp54c4tx9v/test.db...
2025-06-29 00:21:58.708 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1361 - [rag_char_chat_schema V4→V5] Migration script executed.
2025-06-29 00:21:58.709 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_migrate_from_v4_to_v5:1369 - [rag_char_chat_schema V4→V5] Migration completed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp54c4tx9v/test.db.
2025-06-29 00:21:58.709 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:_initialize_schema:1432 - Database schema 'rag_char_chat_schema' successfully initialized/migrated to version 5.
2025-06-29 00:21:58.709 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__exit__:4114 - Transaction (outermost) committed successfully on thread 8705548032.
2025-06-29 00:21:58.709 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:__init__:996 - CharactersRAGDB initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp54c4tx9v/test.db
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:21:58.709 | DEBUG    | tldw_chatbook.DB.ChaChaNotes_DB:execute_query:1201 - Executing SQL (script=False): SELECT * FROM character_cards WHERE name = ? AND deleted = 0... Params: ('TestCharacter',)...
----------------------------------------

199. 2025-06-29 00:21:58.709 | ERROR    | tldw_chatbook.Character_Chat.Character_Chat_Lib:load_chat_history_from_file_and_save_to_db:1908 - Character 'TestCharacter' from chat log 'chat_log_stream' not found in the database.
=============================== warnings summary ===============================
.venv/lib/python3.12/site-packages/_hypothesis_pytestplugin.py:461
  /Users/appledev/Working/tldw_chatbook_dev/.venv/lib/python3.12/site-packages/_hypothesis_pytestplugin.py:461: UserWarning: Skipping collection of '.hypothesis' directory - this usually means you've explicitly set the `norecursedirs` pytest config option, replacing rather than extending the default ignores.
    warnings.warn(
----------------------------------------

200. ERROR Tests/integration/test_chat_image_integration_real.py::TestChatImageIntegration::test_attach_image_button_flow
----------------------------------------

201. ERROR Tests/integration/test_chat_image_integration_real.py::TestChatImageIntegration::test_image_path_submission_success
----------------------------------------

202. ERROR Tests/integration/test_chat_image_integration_real.py::TestChatImageIntegration::test_image_path_submission_invalid_file
----------------------------------------

203. ERROR Tests/integration/test_chat_image_integration_real.py::TestChatImageIntegration::test_clear_image_attachment
----------------------------------------

204. ERROR Tests/integration/test_chat_image_integration_real.py::TestChatImageIntegration::test_send_message_with_image
----------------------------------------

205. ERROR Tests/integration/test_chat_image_integration_real.py::TestChatImageIntegration::test_image_resizing
----------------------------------------

206. ERROR Tests/integration/test_chat_image_integration_real.py::TestChatImageIntegration::test_unsupported_file_type
----------------------------------------

207. ERROR Tests/integration/test_chat_image_integration_real.py::TestChatImageIntegration::test_image_preview_display
----------------------------------------

208. ERROR Tests/integration/test_chat_image_integration_real.py::TestChatImageIntegration::test_multiple_image_attachments_not_allowed
----------------------------------------

209. ERROR Tests/integration/test_file_operations_with_validation.py::TestFileOperationErrorHandling::test_prepare_files_with_missing_files
----------------------------------------

210. ERROR Tests/integration/test_file_operations_with_validation.py::TestFileOperationErrorHandling::test_prepare_files_error_recovery
----------------------------------------

211. ERROR Tests/integration/test_file_operations_with_validation.py::TestFileOperationErrorHandling::test_hidden_file_validation
----------------------------------------

212. FAILED Tests/integration/test_chat_image_unit.py::TestChatMessageImageIntegration::test_image_render_mode_switching
----------------------------------------

213. FAILED Tests/integration/test_file_operations_with_validation.py::TestCharacterChatFileOperations::test_load_chat_history_with_valid_path
----------------------------------------

214. FAILED Tests/integration/test_file_operations_with_validation.py::TestCharacterChatFileOperations::test_load_chat_history_with_invalid_path
----------------------------------------

215. FAILED Tests/integration/test_file_operations_with_validation.py::TestCharacterChatFileOperations::test_load_chat_history_with_path_traversal
----------------------------------------

216. FAILED Tests/integration/test_file_operations_with_validation.py::TestCharacterChatFileOperations::test_load_chat_history_from_file_object
5 failed, 24 passed, 2 warnings, 12 errors in 3.70s
----------------------------------------

217. Tests/integration/test_chat_image_integration_real.py::TestChatImageIntegration::test_attach_image_button_flow: No details available
----------------------------------------

218. Tests/integration/test_chat_image_integration_real.py::TestChatImageIntegration::test_image_path_submission_success: No details available
----------------------------------------

219. Tests/integration/test_chat_image_integration_real.py::TestChatImageIntegration::test_image_path_submission_invalid_file: No details available
----------------------------------------

220. Tests/integration/test_chat_image_integration_real.py::TestChatImageIntegration::test_clear_image_attachment: No details available
----------------------------------------

221. Tests/integration/test_chat_image_integration_real.py::TestChatImageIntegration::test_send_message_with_image: No details available
----------------------------------------

222. Tests/integration/test_chat_image_integration_real.py::TestChatImageIntegration::test_image_resizing: No details available
----------------------------------------

223. Tests/integration/test_chat_image_integration_real.py::TestChatImageIntegration::test_unsupported_file_type: No details available
----------------------------------------

224. Tests/integration/test_chat_image_integration_real.py::TestChatImageIntegration::test_image_preview_display: No details available
----------------------------------------

225. Tests/integration/test_chat_image_integration_real.py::TestChatImageIntegration::test_multiple_image_attachments_not_allowed: No details available
----------------------------------------

226. Tests/integration/test_chat_image_unit.py::TestChatMessageImageIntegration::test_image_render_mode_switching: Tests/integration/test_chat_image_unit.py:289: in test_image_render_mode_switching
    assert message._image_widget.remove_children.call_count == 2
E   AssertionError: assert 4 == 2
E    +  where 4 = <Mock name='mock.remove_children' id='5437494896'>.call_count
E    +    where <Mock name='mock.remove_children' id='5437494896'> = <Mock id='5437494416'>.remove_children
E    +      where <Mock id='5437494416'> = ChatMessageEnhanced()._image_widget
----------------------------------------

227. Tests/integration/test_file_operations_with_validation.py::TestCharacterChatFileOperations::test_load_chat_history_with_valid_path: Tests/integration/test_file_operations_with_validation.py:69: in test_load_chat_history_with_valid_path
    assert conv_id == "conv_123"
E   AssertionError: assert None == 'conv_123'
----------------------------------------

228. Tests/integration/test_file_operations_with_validation.py::TestCharacterChatFileOperations::test_load_chat_history_with_invalid_path: Tests/integration/test_file_operations_with_validation.py:83: in test_load_chat_history_with_invalid_path
    with pytest.raises(ValueError, match="outside the allowed directory"):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE <class 'ValueError'>
----------------------------------------

229. Tests/integration/test_file_operations_with_validation.py::TestCharacterChatFileOperations::test_load_chat_history_with_path_traversal: Tests/integration/test_file_operations_with_validation.py:97: in test_load_chat_history_with_path_traversal
    with pytest.raises(ValueError, match="outside the allowed directory"):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE <class 'ValueError'>
----------------------------------------

230. Tests/integration/test_file_operations_with_validation.py::TestCharacterChatFileOperations::test_load_chat_history_from_file_object: Tests/integration/test_file_operations_with_validation.py:120: in test_load_chat_history_from_file_object
    assert conv_id == "conv_123"
E   AssertionError: assert None == 'conv_123'
----------------------------------------

231. Tests/integration/test_file_operations_with_validation.py::TestFileOperationErrorHandling::test_prepare_files_with_missing_files: No details available
----------------------------------------

232. Tests/integration/test_file_operations_with_validation.py::TestFileOperationErrorHandling::test_prepare_files_error_recovery: No details available
----------------------------------------

233. Tests/integration/test_file_operations_with_validation.py::TestFileOperationErrorHandling::test_hidden_file_validation: No details available
----------------------------------------

================================================================================

Directory: unit
Duration: 0.49s
Passed: 2, Failed: 0, Skipped: 0, Errors: 0

================================================================================

Directory: RAG_Search
Duration: 40.03s
Passed: 92, Failed: 16, Skipped: 1, Errors: 0

Failures:

1. 2025-06-29 00:22:10.805 | ERROR    | tldw_chatbook.RAG_Search.Services.embeddings_service:get_or_create_collection:1021 - Error getting/creating collection collection_a: Validation error: metadata: Metadata cannot be empty
__________ TestLegacyCompatibility.test_chromadb_manager_integration ___________
Tests/RAG_Search/test_embeddings_integration.py:270: in test_chromadb_manager_integration
    manager = ChromaDBManager("test_user", user_config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tldw_chatbook/Embeddings/Chroma_Lib.py:250: in __init__
    f"(Provider: {default_model_spec.provider if default_model_spec else 'N/A'}). "
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'dict' object has no attribute 'provider'
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:22:10.810 | INFO     | tldw_chatbook.Embeddings.Chroma_Lib:__init__:128 - Found a valid, structured [embedding_config] at the top level.
2025-06-29 00:22:10.810 | INFO     | tldw_chatbook.Embeddings.Chroma_Lib:__init__:170 - Using new embeddings service with compatibility layer
2025-06-29 00:22:10.810 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:688 - Using in-memory vector store
2025-06-29 00:22:10.810 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:initialize_from_config:776 - Set default embedding provider: test-model
2025-06-29 00:22:10.810 | INFO     | tldw_chatbook.Embeddings.Chroma_Lib:__init__:207 - ChromaDBManager for user 'test_user' path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpuhrhdpt5/test_user/chroma_storage
_______ TestProviderSpecificIntegration.test_provider_switching_workflow _______
Tests/RAG_Search/test_embeddings_integration.py:448: in test_provider_switching_workflow
    assert slow_time > fast_time  # Slow provider should take longer
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   assert 4.0531158447265625e-06 > 6.9141387939453125e-06
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:22:10.834 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set fast as current provider
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:22:10.835 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: fast
2025-06-29 00:22:10.835 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: slow
__________ TestVectorStorePerformance.test_search_performance_scaling __________
Tests/RAG_Search/test_embeddings_performance.py:252: in test_search_performance_scaling
    assert time_ratio < size_ratio * 0.5
E   assert 49.87932502759817 < (50.0 * 0.5)
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:22:12.639 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test as current provider
2025-06-29 00:22:12.674 | DEBUG    | tldw_chatbook.RAG_Search.Services.embeddings_service:_add_documents_batch:1123 - Successfully added 100/100 documents in batches
2025-06-29 00:22:12.857 | DEBUG    | tldw_chatbook.RAG_Search.Services.embeddings_service:_add_documents_batch:1123 - Successfully added 500/500 documents in batches
2025-06-29 00:22:13.259 | DEBUG    | tldw_chatbook.RAG_Search.Services.embeddings_service:_add_documents_batch:1123 - Successfully added 1000/1000 documents in batches
2025-06-29 00:22:15.272 | DEBUG    | tldw_chatbook.RAG_Search.Services.embeddings_service:_add_documents_batch:1123 - Successfully added 5000/5000 documents in batches
__________________ TestMemoryPerformance.test_memory_cleanup ___________________
Tests/RAG_Search/test_embeddings_performance.py:465: in test_memory_cleanup
    assert memory_released > 0.8  # At least 80% of memory released
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   assert -0.0 > 0.8
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:22:18.727 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test as current provider
2025-06-29 00:22:19.216 | DEBUG    | tldw_chatbook.RAG_Search.Services.embeddings_service:_add_documents_batch:1123 - Successfully added 1000/1000 documents in batches
2025-06-29 00:22:19.304 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:delete_collection:1177 - Deleted collection: temp_collection
2025-06-29 00:22:19.304 | DEBUG    | tldw_chatbook.RAG_Search.Services.embeddings_service:_cleanup_providers:1369 - Cleaned up provider: test
_________ TestEmbeddingProperties.test_embedding_dimension_consistency _________
Tests/RAG_Search/test_embeddings_properties.py:100: in test_embedding_dimension_consistency
    texts=text_batch(min_size=1, max_size=5),
           ^^^^^^^
Tests/RAG_Search/test_embeddings_properties.py:112: in test_embedding_dimension_consistency
    assert all(len(emb) == dimension for emb in embeddings)
E   assert False
E    +  where False = all(<generator object TestEmbeddingProperties.test_embedding_dimension_consistency.<locals>.<genexpr> at 0x16b226420>)
E   Falsifying example: test_embedding_dimension_consistency(
E       self=<test_embeddings_properties.TestEmbeddingProperties object at 0x168493e90>,
E       texts=[''],
E       dimension=128,
E   )
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:22:19.815 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test as current provider
2025-06-29 00:22:19.820 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test as current provider
_______________ TestEmbeddingProperties.test_provider_isolation ________________
Tests/RAG_Search/test_embeddings_properties.py:152: in test_provider_isolation
    texts=text_batch(),
           ^^^^^^^
Tests/RAG_Search/test_embeddings_properties.py:174: in test_provider_isolation
    assert all(len(emb) == dimensions[i % len(dimensions)]
E   assert False
E    +  where False = all(<generator object TestEmbeddingProperties.test_provider_isolation.<locals>.<genexpr> at 0x16b14fe40>)
E   Falsifying example: test_provider_isolation(
E       self=<test_embeddings_properties.TestEmbeddingProperties object at 0x168608800>,
E       texts=[''],
E       num_providers=2,
E   )
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:22:20.051 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set provider_0 as current provider
2025-06-29 00:22:20.051 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: provider_0
2025-06-29 00:22:20.051 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: provider_1
2025-06-29 00:22:20.055 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set provider_0 as current provider
2025-06-29 00:22:20.055 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: provider_0
2025-06-29 00:22:20.055 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: provider_1
__________ TestCompatibilityProperties.test_config_parsing_robustness __________
Tests/RAG_Search/test_embeddings_properties.py:510: in test_config_parsing_robustness
    config=st.fixed_dictionaries({
           ^^^^^^^
Tests/RAG_Search/test_embeddings_properties.py:534: in test_config_parsing_robustness
    with patch('tldw_chatbook.RAG_Search.Services.embeddings_service.HuggingFaceProvider'):
         ^^^^^
E   NameError: name 'patch' is not defined
E   Falsifying example: test_config_parsing_robustness(
E       self=<test_embeddings_properties.TestCompatibilityProperties object at 0x1684d9610>,
E       config={'default_model_id': '0',
E        'models': {'0': {'provider': 'huggingface',
E          'model_name_or_path': '0',
E          'dimension': 128}}},
E   )
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:22:20.428 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:688 - Using in-memory vector store
2025-06-29 00:22:20.432 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:688 - Using in-memory vector store
_____________________ TestEmbeddingServiceStateful.runTest _____________________
.venv/lib/python3.12/site-packages/hypothesis/stateful.py:476: in runTest
    run_state_machine_as_test(cls, settings=self.settings)
.venv/lib/python3.12/site-packages/hypothesis/stateful.py:258: in run_state_machine_as_test
    state_machine_test(state_machine_factory)
.venv/lib/python3.12/site-packages/hypothesis/stateful.py:115: in run_state_machine
    @given(st.data())
               ^^^^^^^
E   hypothesis.errors.FailedHealthCheck: Rules should return None if they have no target bundle, but EmbeddingServiceStateMachine.add_provider returned '0'
E   See https://hypothesis.readthedocs.io/en/latest/reference/api.html#hypothesis.HealthCheck for more information about this. If you want to disable just this health check, add HealthCheck.return_value to the suppress_health_check settings for this test.
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:22:20.448 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set 0 as current provider
---------------------------------- Hypothesis ----------------------------------
You can add @seed(39064267244956134912858496707726106652) to this test or run pytest with --hypothesis-seed=39064267244956134912858496707726106652 to reproduce this failure.
__________ TestRealChromaDBIntegration.test_chromadb_real_persistence __________
Tests/RAG_Search/test_embeddings_real_integration.py:290: in test_chromadb_real_persistence
    service1 = EmbeddingsService(persist_directory=str(persist_dir))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tldw_chatbook/RAG_Search/Services/embeddings_service.py:657: in __init__
    persist_directory.mkdir(parents=True, exist_ok=True)
    ^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'str' object has no attribute 'mkdir'
___________ TestRealCacheIntegration.test_embeddings_with_real_cache ___________
Tests/RAG_Search/test_embeddings_real_integration.py:418: in test_embeddings_with_real_cache
    stats = cache_service.get_stats()
            ^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'CacheService' object has no attribute 'get_stats'
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:22:26.035 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpd8r_ri7d/vector_store
2025-06-29 00:22:26.035 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set compat_sentence-transformers_all-MiniLM-L6-v2 as current provider
2025-06-29 00:22:26.035 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:initialize_embedding_model:835 - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
______ TestRealMemoryManagement.test_memory_cleanup_with_real_embeddings _______
Tests/RAG_Search/test_embeddings_real_integration.py:431: in test_memory_cleanup_with_real_embeddings
    memory_service = MemoryManagementService()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: MemoryManagementService.__init__() missing 1 required positional argument: 'embeddings_service'
________________ TestRealErrorHandling.test_invalid_model_name _________________
Tests/RAG_Search/test_embeddings_real_integration.py:477: in test_invalid_model_name
    assert not success
E   assert not True
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:22:26.050 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp_imj_5hb/vector_store
2025-06-29 00:22:26.050 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set compat_hf_invalid_model_name_that_doesnt_exist as current provider
2025-06-29 00:22:26.050 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:initialize_embedding_model:835 - Initialized embedding model: invalid/model/name/that/doesnt/exist
=============================== warnings summary ===============================
.venv/lib/python3.12/site-packages/jieba/_compat.py:18
  /Users/appledev/Working/tldw_chatbook_dev/.venv/lib/python3.12/site-packages/jieba/_compat.py:18: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html
    import pkg_resources
----------------------------------------

2. FAILED Tests/RAG_Search/test_embeddings_compatibility.py::TestLegacyAPICompatibility::test_model_id_parameter
----------------------------------------

3. FAILED Tests/RAG_Search/test_embeddings_compatibility.py::TestChromaDBManagerCompatibility::test_chromadb_manager_with_new_service
----------------------------------------

4. FAILED Tests/RAG_Search/test_embeddings_compatibility.py::TestBehaviorCompatibility::test_error_handling_compatibility
----------------------------------------

5. FAILED Tests/RAG_Search/test_embeddings_integration.py::TestChromaDBIntegration::test_chromadb_collection_management
----------------------------------------

6. FAILED Tests/RAG_Search/test_embeddings_integration.py::TestLegacyCompatibility::test_chromadb_manager_integration
----------------------------------------

7. FAILED Tests/RAG_Search/test_embeddings_integration.py::TestProviderSpecificIntegration::test_provider_switching_workflow
----------------------------------------

8. FAILED Tests/RAG_Search/test_embeddings_performance.py::TestVectorStorePerformance::test_search_performance_scaling
----------------------------------------

9. FAILED Tests/RAG_Search/test_embeddings_performance.py::TestMemoryPerformance::test_memory_cleanup
----------------------------------------

10. FAILED Tests/RAG_Search/test_embeddings_properties.py::TestEmbeddingProperties::test_embedding_dimension_consistency
----------------------------------------

11. FAILED Tests/RAG_Search/test_embeddings_properties.py::TestEmbeddingProperties::test_provider_isolation
----------------------------------------

12. FAILED Tests/RAG_Search/test_embeddings_properties.py::TestCompatibilityProperties::test_config_parsing_robustness
----------------------------------------

13. FAILED Tests/RAG_Search/test_embeddings_properties.py::TestEmbeddingServiceStateful::runTest
----------------------------------------

14. FAILED Tests/RAG_Search/test_embeddings_real_integration.py::TestRealChromaDBIntegration::test_chromadb_real_persistence
----------------------------------------

15. FAILED Tests/RAG_Search/test_embeddings_real_integration.py::TestRealCacheIntegration::test_embeddings_with_real_cache
----------------------------------------

16. FAILED Tests/RAG_Search/test_embeddings_real_integration.py::TestRealMemoryManagement::test_memory_cleanup_with_real_embeddings
----------------------------------------

17. FAILED Tests/RAG_Search/test_embeddings_real_integration.py::TestRealErrorHandling::test_invalid_model_name
16 failed, 92 passed, 1 skipped, 2 warnings in 35.30s
----------------------------------------

18. Tests/RAG_Search/test_embeddings_compatibility.py::TestLegacyAPICompatibility::test_model_id_parameter: Tests/RAG_Search/test_embeddings_compatibility.py:102: in test_model_id_parameter
    assert len(embedding2) == 1536
E   assert 384 == 1536
E    +  where 384 = len([0.886, 0.887, 0.888, 0.889, 0.89, 0.891, ...])
----------------------------------------

19. Tests/RAG_Search/test_embeddings_compatibility.py::TestChromaDBManagerCompatibility::test_chromadb_manager_with_new_service: Tests/RAG_Search/test_embeddings_compatibility.py:151: in test_chromadb_manager_with_new_service
    manager = ChromaDBManager("test_user", user_config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tldw_chatbook/Embeddings/Chroma_Lib.py:250: in __init__
    f"(Provider: {default_model_spec.provider if default_model_spec else 'N/A'}). "
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'dict' object has no attribute 'provider'
----------------------------------------

20. Tests/RAG_Search/test_embeddings_compatibility.py::TestBehaviorCompatibility::test_error_handling_compatibility: Tests/RAG_Search/test_embeddings_compatibility.py:304: in test_error_handling_compatibility
    with pytest.raises(RuntimeError):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   Failed: DID NOT RAISE <class 'RuntimeError'>
----------------------------------------

21. Tests/RAG_Search/test_embeddings_integration.py::TestChromaDBIntegration::test_chromadb_collection_management: Tests/RAG_Search/test_embeddings_integration.py:239: in test_chromadb_collection_management
    assert info is not None
E   assert None is not None
----------------------------------------

22. Tests/RAG_Search/test_embeddings_integration.py::TestLegacyCompatibility::test_chromadb_manager_integration: Tests/RAG_Search/test_embeddings_integration.py:270: in test_chromadb_manager_integration
    manager = ChromaDBManager("test_user", user_config)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tldw_chatbook/Embeddings/Chroma_Lib.py:250: in __init__
    f"(Provider: {default_model_spec.provider if default_model_spec else 'N/A'}). "
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'dict' object has no attribute 'provider'
----------------------------------------

23. Tests/RAG_Search/test_embeddings_integration.py::TestProviderSpecificIntegration::test_provider_switching_workflow: Tests/RAG_Search/test_embeddings_integration.py:448: in test_provider_switching_workflow
    assert slow_time > fast_time  # Slow provider should take longer
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   assert 4.0531158447265625e-06 > 6.9141387939453125e-06
----------------------------------------

24. Tests/RAG_Search/test_embeddings_performance.py::TestVectorStorePerformance::test_search_performance_scaling: Tests/RAG_Search/test_embeddings_performance.py:252: in test_search_performance_scaling
    assert time_ratio < size_ratio * 0.5
E   assert 49.87932502759817 < (50.0 * 0.5)
----------------------------------------

25. Tests/RAG_Search/test_embeddings_performance.py::TestMemoryPerformance::test_memory_cleanup: Tests/RAG_Search/test_embeddings_performance.py:465: in test_memory_cleanup
    assert memory_released > 0.8  # At least 80% of memory released
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   assert -0.0 > 0.8
----------------------------------------

26. Tests/RAG_Search/test_embeddings_properties.py::TestEmbeddingProperties::test_embedding_dimension_consistency: Tests/RAG_Search/test_embeddings_properties.py:100: in test_embedding_dimension_consistency
    texts=text_batch(min_size=1, max_size=5),
           ^^^^^^^
Tests/RAG_Search/test_embeddings_properties.py:112: in test_embedding_dimension_consistency
    assert all(len(emb) == dimension for emb in embeddings)
E   assert False
E    +  where False = all(<generator object TestEmbeddingProperties.test_embedding_dimension_consistency.<locals>.<genexpr> at 0x16b226420>)
E   Falsifying example: test_embedding_dimension_consistency(
E       self=<test_embeddings_properties.TestEmbeddingProperties object at 0x168493e90>,
E       texts=[''],
E       dimension=128,
E   )
----------------------------------------

27. Tests/RAG_Search/test_embeddings_properties.py::TestEmbeddingProperties::test_provider_isolation: Tests/RAG_Search/test_embeddings_properties.py:152: in test_provider_isolation
    texts=text_batch(),
           ^^^^^^^
Tests/RAG_Search/test_embeddings_properties.py:174: in test_provider_isolation
    assert all(len(emb) == dimensions[i % len(dimensions)]
E   assert False
E    +  where False = all(<generator object TestEmbeddingProperties.test_provider_isolation.<locals>.<genexpr> at 0x16b14fe40>)
E   Falsifying example: test_provider_isolation(
E       self=<test_embeddings_properties.TestEmbeddingProperties object at 0x168608800>,
E       texts=[''],
E       num_providers=2,
E   )
----------------------------------------

28. Tests/RAG_Search/test_embeddings_properties.py::TestCompatibilityProperties::test_config_parsing_robustness: Tests/RAG_Search/test_embeddings_properties.py:510: in test_config_parsing_robustness
    config=st.fixed_dictionaries({
           ^^^^^^^
Tests/RAG_Search/test_embeddings_properties.py:534: in test_config_parsing_robustness
    with patch('tldw_chatbook.RAG_Search.Services.embeddings_service.HuggingFaceProvider'):
         ^^^^^
E   NameError: name 'patch' is not defined
E   Falsifying example: test_config_parsing_robustness(
E       self=<test_embeddings_properties.TestCompatibilityProperties object at 0x1684d9610>,
E       config={'default_model_id': '0',
E        'models': {'0': {'provider': 'huggingface',
E          'model_name_or_path': '0',
E          'dimension': 128}}},
E   )
----------------------------------------

29. Tests/RAG_Search/test_embeddings_properties.py::TestEmbeddingServiceStateful::runTest: .venv/lib/python3.12/site-packages/hypothesis/stateful.py:476: in runTest
    run_state_machine_as_test(cls, settings=self.settings)
.venv/lib/python3.12/site-packages/hypothesis/stateful.py:258: in run_state_machine_as_test
    state_machine_test(state_machine_factory)
.venv/lib/python3.12/site-packages/hypothesis/stateful.py:115: in run_state_machine
    @given(st.data())
               ^^^^^^^
E   hypothesis.errors.FailedHealthCheck: Rules should return None if they have no target bundle, but EmbeddingServiceStateMachine.add_provider returned '0'
E   See https://hypothesis.readthedocs.io/en/latest/reference/api.html#hypothesis.HealthCheck for more information about this. If you want to disable just this health check, add HealthCheck.return_value to the suppress_health_check settings for this test.
----------------------------------------

30. Tests/RAG_Search/test_embeddings_real_integration.py::TestRealChromaDBIntegration::test_chromadb_real_persistence: Tests/RAG_Search/test_embeddings_real_integration.py:290: in test_chromadb_real_persistence
    service1 = EmbeddingsService(persist_directory=str(persist_dir))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tldw_chatbook/RAG_Search/Services/embeddings_service.py:657: in __init__
    persist_directory.mkdir(parents=True, exist_ok=True)
    ^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'str' object has no attribute 'mkdir'
----------------------------------------

31. Tests/RAG_Search/test_embeddings_real_integration.py::TestRealCacheIntegration::test_embeddings_with_real_cache: Tests/RAG_Search/test_embeddings_real_integration.py:418: in test_embeddings_with_real_cache
    stats = cache_service.get_stats()
            ^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'CacheService' object has no attribute 'get_stats'
----------------------------------------

32. Tests/RAG_Search/test_embeddings_real_integration.py::TestRealMemoryManagement::test_memory_cleanup_with_real_embeddings: Tests/RAG_Search/test_embeddings_real_integration.py:431: in test_memory_cleanup_with_real_embeddings
    memory_service = MemoryManagementService()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: MemoryManagementService.__init__() missing 1 required positional argument: 'embeddings_service'
----------------------------------------

33. Tests/RAG_Search/test_embeddings_real_integration.py::TestRealErrorHandling::test_invalid_model_name: Tests/RAG_Search/test_embeddings_real_integration.py:477: in test_invalid_model_name
    assert not success
E   assert not True
----------------------------------------

================================================================================

Directory: RAG
Duration: 14.68s
Passed: 227, Failed: 8, Skipped: 2, Errors: 27

Failures:

1. ==================================== ERRORS ====================================
----------------------------------------

2. _ ERROR at setup of TestEmbeddingsRealIntegration.test_embeddings_with_memory_manager _
Tests/RAG/test_embeddings_integration_real.py:64: in real_memory_manager
    return MemoryManagementService(
E   TypeError: MemoryManagementService.__init__() got an unexpected keyword argument 'storage_path'
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:22:46.125 | DEBUG    | tldw_chatbook.RAG_Search.Services.embeddings_service:_cleanup_providers:1369 - Cleaned up provider: test_provider
2025-06-29 00:22:46.132 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpwgmbbdrg/embeddings
2025-06-29 00:22:46.132 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpwgmbbdrg/embeddings
2025-06-29 00:22:46.132 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpwgmbbdrg/embeddings
2025-06-29 00:22:46.132 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpwgmbbdrg/embeddings
2025-06-29 00:22:46.132 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpwgmbbdrg/embeddings
2025-06-29 00:22:46.132 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpwgmbbdrg/embeddings
2025-06-29 00:22:46.132 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test_provider as current provider
2025-06-29 00:22:46.132 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test_provider as current provider
2025-06-29 00:22:46.132 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test_provider as current provider
2025-06-29 00:22:46.132 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test_provider as current provider
2025-06-29 00:22:46.132 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test_provider as current provider
2025-06-29 00:22:46.132 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test_provider as current provider
2025-06-29 00:22:46.132 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: test_provider
2025-06-29 00:22:46.132 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: test_provider
2025-06-29 00:22:46.132 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: test_provider
2025-06-29 00:22:46.132 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: test_provider
2025-06-29 00:22:46.132 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: test_provider
2025-06-29 00:22:46.132 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: test_provider
----------------------------------------

3. _ ERROR at setup of TestEmbeddingsRealIntegration.test_memory_cleanup_integration _
Tests/RAG/test_embeddings_integration_real.py:64: in real_memory_manager
    return MemoryManagementService(
E   TypeError: MemoryManagementService.__init__() got an unexpected keyword argument 'storage_path'
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:22:46.135 | DEBUG    | tldw_chatbook.RAG_Search.Services.embeddings_service:_cleanup_providers:1369 - Cleaned up provider: test_provider
2025-06-29 00:22:46.142 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpdomhriwf/embeddings
2025-06-29 00:22:46.142 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpdomhriwf/embeddings
2025-06-29 00:22:46.142 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpdomhriwf/embeddings
2025-06-29 00:22:46.142 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpdomhriwf/embeddings
2025-06-29 00:22:46.142 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpdomhriwf/embeddings
2025-06-29 00:22:46.142 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpdomhriwf/embeddings
2025-06-29 00:22:46.142 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test_provider as current provider
2025-06-29 00:22:46.142 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test_provider as current provider
2025-06-29 00:22:46.142 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test_provider as current provider
2025-06-29 00:22:46.142 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test_provider as current provider
2025-06-29 00:22:46.142 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test_provider as current provider
2025-06-29 00:22:46.142 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test_provider as current provider
2025-06-29 00:22:46.142 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: test_provider
2025-06-29 00:22:46.142 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: test_provider
2025-06-29 00:22:46.142 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: test_provider
2025-06-29 00:22:46.142 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: test_provider
2025-06-29 00:22:46.142 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: test_provider
2025-06-29 00:22:46.142 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: test_provider
----------------------------------------

4. _ ERROR at setup of TestEmbeddingsRealIntegration.test_mixed_operations_stress_test _
Tests/RAG/test_embeddings_integration_real.py:64: in real_memory_manager
    return MemoryManagementService(
E   TypeError: MemoryManagementService.__init__() got an unexpected keyword argument 'storage_path'
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:22:46.200 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpxg_hmy5o/embeddings
2025-06-29 00:22:46.200 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpxg_hmy5o/embeddings
2025-06-29 00:22:46.200 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpxg_hmy5o/embeddings
2025-06-29 00:22:46.200 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpxg_hmy5o/embeddings
2025-06-29 00:22:46.200 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpxg_hmy5o/embeddings
2025-06-29 00:22:46.200 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpxg_hmy5o/embeddings
2025-06-29 00:22:46.200 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test_provider as current provider
2025-06-29 00:22:46.200 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test_provider as current provider
2025-06-29 00:22:46.200 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test_provider as current provider
2025-06-29 00:22:46.200 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test_provider as current provider
2025-06-29 00:22:46.200 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test_provider as current provider
2025-06-29 00:22:46.200 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test_provider as current provider
2025-06-29 00:22:46.200 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: test_provider
2025-06-29 00:22:46.200 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: test_provider
2025-06-29 00:22:46.200 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: test_provider
2025-06-29 00:22:46.200 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: test_provider
2025-06-29 00:22:46.200 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: test_provider
2025-06-29 00:22:46.200 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: test_provider
----------------------------------------

5. ____ ERROR at setup of TestRealIndexingService.test_real_index_media_items _____
Tests/RAG/test_indexing_service_integration.py:140: in real_embeddings_service
    service = EmbeddingsService(persist_directory=str(temp_dirs['embeddings']))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tldw_chatbook/RAG_Search/Services/embeddings_service.py:657: in __init__
    persist_directory.mkdir(parents=True, exist_ok=True)
    ^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'str' object has no attribute 'mkdir'
----------------------------------------

6. ___ ERROR at setup of TestRealIndexingService.test_real_index_conversations ____
Tests/RAG/test_indexing_service_integration.py:140: in real_embeddings_service
    service = EmbeddingsService(persist_directory=str(temp_dirs['embeddings']))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tldw_chatbook/RAG_Search/Services/embeddings_service.py:657: in __init__
    persist_directory.mkdir(parents=True, exist_ok=True)
    ^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'str' object has no attribute 'mkdir'
----------------------------------------

7. _______ ERROR at setup of TestRealIndexingService.test_real_index_notes ________
Tests/RAG/test_indexing_service_integration.py:140: in real_embeddings_service
    service = EmbeddingsService(persist_directory=str(temp_dirs['embeddings']))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tldw_chatbook/RAG_Search/Services/embeddings_service.py:657: in __init__
    persist_directory.mkdir(parents=True, exist_ok=True)
    ^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'str' object has no attribute 'mkdir'
----------------------------------------

8. ____ ERROR at setup of TestRealIndexingService.test_real_progress_callback _____
Tests/RAG/test_indexing_service_integration.py:140: in real_embeddings_service
    service = EmbeddingsService(persist_directory=str(temp_dirs['embeddings']))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tldw_chatbook/RAG_Search/Services/embeddings_service.py:657: in __init__
    persist_directory.mkdir(parents=True, exist_ok=True)
    ^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'str' object has no attribute 'mkdir'
----------------------------------------

9. ___ ERROR at setup of TestRealIndexingService.test_real_incremental_indexing ___
Tests/RAG/test_indexing_service_integration.py:140: in real_embeddings_service
    service = EmbeddingsService(persist_directory=str(temp_dirs['embeddings']))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tldw_chatbook/RAG_Search/Services/embeddings_service.py:657: in __init__
    persist_directory.mkdir(parents=True, exist_ok=True)
    ^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'str' object has no attribute 'mkdir'
----------------------------------------

10. ______ ERROR at setup of TestRealIndexingService.test_real_error_handling ______
Tests/RAG/test_indexing_service_integration.py:140: in real_embeddings_service
    service = EmbeddingsService(persist_directory=str(temp_dirs['embeddings']))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tldw_chatbook/RAG_Search/Services/embeddings_service.py:657: in __init__
    persist_directory.mkdir(parents=True, exist_ok=True)
    ^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'str' object has no attribute 'mkdir'
----------------------------------------

11. _____ ERROR at setup of TestRealIndexingService.test_real_chunking_quality _____
Tests/RAG/test_indexing_service_integration.py:140: in real_embeddings_service
    service = EmbeddingsService(persist_directory=str(temp_dirs['embeddings']))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tldw_chatbook/RAG_Search/Services/embeddings_service.py:657: in __init__
    persist_directory.mkdir(parents=True, exist_ok=True)
    ^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'str' object has no attribute 'mkdir'
----------------------------------------

12. ___ ERROR at setup of TestRealIndexingService.test_real_concurrent_indexing ____
Tests/RAG/test_indexing_service_integration.py:140: in real_embeddings_service
    service = EmbeddingsService(persist_directory=str(temp_dirs['embeddings']))
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tldw_chatbook/RAG_Search/Services/embeddings_service.py:657: in __init__
    persist_directory.mkdir(parents=True, exist_ok=True)
    ^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'str' object has no attribute 'mkdir'
----------------------------------------

13. _ ERROR at setup of TestRealMemoryManagementService.test_real_collection_stats _
Tests/RAG/test_memory_management_service_integration.py:51: in real_embeddings_service
    vector_store = ChromaDBStore(persist_directory=str(temp_dir))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: ChromaDBStore.__init__() got an unexpected keyword argument 'persist_directory'
----------------------------------------

14. _ ERROR at setup of TestRealMemoryManagementService.test_real_thread_safe_operations _
Tests/RAG/test_memory_management_service_integration.py:51: in real_embeddings_service
    vector_store = ChromaDBStore(persist_directory=str(temp_dir))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: ChromaDBStore.__init__() got an unexpected keyword argument 'persist_directory'
----------------------------------------

15. _ ERROR at setup of TestRealMemoryManagementService.test_real_cleanup_old_documents _
Tests/RAG/test_memory_management_service_integration.py:51: in real_embeddings_service
    vector_store = ChromaDBStore(persist_directory=str(temp_dir))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: ChromaDBStore.__init__() got an unexpected keyword argument 'persist_directory'
----------------------------------------

16. _ ERROR at setup of TestRealMemoryManagementService.test_real_collection_size_limits _
Tests/RAG/test_memory_management_service_integration.py:51: in real_embeddings_service
    vector_store = ChromaDBStore(persist_directory=str(temp_dir))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: ChromaDBStore.__init__() got an unexpected keyword argument 'persist_directory'
----------------------------------------

17. _ ERROR at setup of TestRealMemoryManagementService.test_real_automatic_cleanup _
Tests/RAG/test_memory_management_service_integration.py:51: in real_embeddings_service
    vector_store = ChromaDBStore(persist_directory=str(temp_dir))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: ChromaDBStore.__init__() got an unexpected keyword argument 'persist_directory'
----------------------------------------

18. _ ERROR at setup of TestRealMemoryManagementService.test_real_memory_usage_tracking _
Tests/RAG/test_memory_management_service_integration.py:51: in real_embeddings_service
    vector_store = ChromaDBStore(persist_directory=str(temp_dir))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: ChromaDBStore.__init__() got an unexpected keyword argument 'persist_directory'
----------------------------------------

19. _ ERROR at setup of TestRealMemoryManagementService.test_real_collection_deletion _
Tests/RAG/test_memory_management_service_integration.py:51: in real_embeddings_service
    vector_store = ChromaDBStore(persist_directory=str(temp_dir))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: ChromaDBStore.__init__() got an unexpected keyword argument 'persist_directory'
----------------------------------------

20. _ ERROR at setup of TestRealMemoryManagementService.test_real_concurrent_cleanup_operations _
Tests/RAG/test_memory_management_service_integration.py:51: in real_embeddings_service
    vector_store = ChromaDBStore(persist_directory=str(temp_dir))
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: ChromaDBStore.__init__() got an unexpected keyword argument 'persist_directory'
----------------------------------------

21. ______ ERROR at setup of TestRAGIntegration.test_plain_rag_with_reranking ______
/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/DB/ChaChaNotes_DB.py:1039: in _get_thread_connection
    ???
E   sqlite3.OperationalError: unable to open database file
----------------------------------------

22. 2025-06-29 00:22:50.987 | ERROR    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1054 - Failed to connect to database /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db: unable to open database file
----------------------------------------

23. 2025-06-29 00:22:50.987 | ERROR    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1054 - Failed to connect to database /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db: unable to open database file
----------------------------------------

24. 2025-06-29 00:22:50.987 | ERROR    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1054 - Failed to connect to database /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db: unable to open database file
----------------------------------------

25. 2025-06-29 00:22:50.987 | ERROR    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1054 - Failed to connect to database /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db: unable to open database file
----------------------------------------

26. 2025-06-29 00:22:50.987 | ERROR    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1054 - Failed to connect to database /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db: unable to open database file
----------------------------------------

27. 2025-06-29 00:22:50.987 | ERROR    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1054 - Failed to connect to database /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db: unable to open database file
2025-06-29 00:22:50.987 | CRITICAL | tldw_chatbook.DB.ChaChaNotes_DB:__init__:998 - FATAL: DB Initialization failed for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db: Failed to connect to database '/private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db': unable to open database file
2025-06-29 00:22:50.987 | CRITICAL | tldw_chatbook.DB.ChaChaNotes_DB:__init__:998 - FATAL: DB Initialization failed for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db: Failed to connect to database '/private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db': unable to open database file
2025-06-29 00:22:50.987 | CRITICAL | tldw_chatbook.DB.ChaChaNotes_DB:__init__:998 - FATAL: DB Initialization failed for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db: Failed to connect to database '/private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db': unable to open database file
2025-06-29 00:22:50.987 | CRITICAL | tldw_chatbook.DB.ChaChaNotes_DB:__init__:998 - FATAL: DB Initialization failed for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db: Failed to connect to database '/private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db': unable to open database file
2025-06-29 00:22:50.987 | CRITICAL | tldw_chatbook.DB.ChaChaNotes_DB:__init__:998 - FATAL: DB Initialization failed for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db: Failed to connect to database '/private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db': unable to open database file
2025-06-29 00:22:50.987 | CRITICAL | tldw_chatbook.DB.ChaChaNotes_DB:__init__:998 - FATAL: DB Initialization failed for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db: Failed to connect to database '/private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db': unable to open database file
------------------------------ Captured log setup ------------------------------
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp9wn6g58y/media.db [Client ID: test_client]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp9wn6g58y/media.db [Client: test_client, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 0. Code supports: 1
INFO     root:Client_Media_DB_v2.py:680 Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp9wn6g58y/media.db...
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:694 [Schema V1] Applying Core Schema + Version Update...
DEBUG    root:Client_Media_DB_v2.py:696 [Schema V1] Core Schema script (incl. version update) executed.
DEBUG    root:Client_Media_DB_v2.py:707 [Schema V1] Media table structure validated successfully.
DEBUG    root:Client_Media_DB_v2.py:719 [Schema V1] Version check inside transaction confirmed version is 1.
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:722 [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp9wn6g58y/media.db.
DEBUG    root:Client_Media_DB_v2.py:726 [Schema V1] Applying FTS Tables...
INFO     root:Client_Media_DB_v2.py:729 [Schema V1] FTS Tables created successfully.
INFO     root:Client_Media_DB_v2.py:771 Database schema initialized/migrated to version 1.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp9wn6g58y/media.db
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/python-programming-guide, title=Python Programming Guide, client=test_client
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media dcea558f-f418-421f-bf9d-c6c497d47321 create v1 at 2025-06-29T07:22:50.985Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 1: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 1
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions dc9916ad-c35b-4161-ae0c-d29fb6e02122 create v1 at 2025-06-29T07:22:50.985Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/machine-learning-basics, title=Machine Learning Basics, client=test_client
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media 16c6a165-9e0d-4838-b6d0-2ca562cf307f create v1 at 2025-06-29T07:22:50.985Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 2: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 2
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions 7e704c6f-4a92-45be-8d65-e00378afd256 create v1 at 2025-06-29T07:22:50.986Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/web-development-tutorial, title=Web Development Tutorial, client=test_client
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media 97f68e4d-a6d9-4d12-934c-91048f6815c0 create v1 at 2025-06-29T07:22:50.986Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 3: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 3
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions adea4903-e889-487d-a4dd-485e846fa26f create v1 at 2025-06-29T07:22:50.986Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
----------------------------------------

28. ____ ERROR at teardown of TestRAGIntegration.test_plain_rag_with_reranking _____
/Users/appledev/Working/tldw_chatbook_dev/Tests/RAG/test_rag_integration.py:45: in temp_dirs
    ???
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/shutil.py:759: in rmtree
    ???
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/shutil.py:703: in _rmtree_safe_fd
    ???
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/shutil.py:674: in _rmtree_safe_fd
    ???
E   OSError: [Errno 24] Too many open files: '/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp9wn6g58y'
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:22:50,980 [INFO] root:444 - Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp9wn6g58y/media.db [Client ID: test_client]
2025-06-29 00:22:50,980 [DEBUG] root:510 - Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp9wn6g58y/media.db [Client: test_client, Thread: MainThread]
2025-06-29 00:22:50,980 [INFO] root:747 - Checking DB schema. Current version: 0. Code supports: 1
2025-06-29 00:22:50,980 [INFO] root:680 - Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp9wn6g58y/media.db...
2025-06-29 00:22:50,980 [DEBUG] root:647 - Started transaction.
2025-06-29 00:22:50,980 [DEBUG] root:694 - [Schema V1] Applying Core Schema + Version Update...
2025-06-29 00:22:50,984 [DEBUG] root:696 - [Schema V1] Core Schema script (incl. version update) executed.
2025-06-29 00:22:50,984 [DEBUG] root:707 - [Schema V1] Media table structure validated successfully.
2025-06-29 00:22:50,984 [DEBUG] root:719 - [Schema V1] Version check inside transaction confirmed version is 1.
2025-06-29 00:22:50,984 [DEBUG] root:652 - Committed transaction.
2025-06-29 00:22:50,984 [INFO] root:722 - [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp9wn6g58y/media.db.
2025-06-29 00:22:50,984 [DEBUG] root:726 - [Schema V1] Applying FTS Tables...
2025-06-29 00:22:50,985 [INFO] root:729 - [Schema V1] FTS Tables created successfully.
2025-06-29 00:22:50,985 [INFO] root:771 - Database schema initialized/migrated to version 1.
2025-06-29 00:22:50,985 [DEBUG] root:474 - Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp9wn6g58y/media.db
2025-06-29 00:22:50,985 [INFO] root:1899 - add_media_with_keywords: url=http://example.com/python-programming-guide, title=Python Programming Guide, client=test_client
2025-06-29 00:22:50,985 [DEBUG] root:647 - Started transaction.
2025-06-29 00:22:50,985 [DEBUG] root:891 - Logged sync event: Media dcea558f-f418-421f-bf9d-c6c497d47321 create v1 at 2025-06-29T07:22:50.985Z
2025-06-29 00:22:50,985 [DEBUG] root:919 - FTS update for media 1: sanitized content - null bytes replaced
2025-06-29 00:22:50,985 [DEBUG] root:924 - Updated FTS (insert or replace) for Media ID 1
2025-06-29 00:22:50.985 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:update_keywords_for_media:2305 - No keyword changes media 1.
2025-06-29 00:22:50.985 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:create_document_version:2187 - Creating document version 1 for media ID 1, UUID dc9916ad-c35b-4161-ae0c-d29fb6e02122
2025-06-29 00:22:50,985 [DEBUG] root:891 - Logged sync event: DocumentVersions dc9916ad-c35b-4161-ae0c-d29fb6e02122 create v1 at 2025-06-29T07:22:50.985Z
2025-06-29 00:22:50,985 [DEBUG] root:652 - Committed transaction.
2025-06-29 00:22:50,985 [INFO] root:1899 - add_media_with_keywords: url=http://example.com/machine-learning-basics, title=Machine Learning Basics, client=test_client
2025-06-29 00:22:50,985 [DEBUG] root:647 - Started transaction.
2025-06-29 00:22:50,985 [DEBUG] root:891 - Logged sync event: Media 16c6a165-9e0d-4838-b6d0-2ca562cf307f create v1 at 2025-06-29T07:22:50.985Z
2025-06-29 00:22:50,986 [DEBUG] root:919 - FTS update for media 2: sanitized content - null bytes replaced
2025-06-29 00:22:50,986 [DEBUG] root:924 - Updated FTS (insert or replace) for Media ID 2
2025-06-29 00:22:50.986 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:update_keywords_for_media:2305 - No keyword changes media 2.
2025-06-29 00:22:50.986 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:create_document_version:2187 - Creating document version 1 for media ID 2, UUID 7e704c6f-4a92-45be-8d65-e00378afd256
2025-06-29 00:22:50,986 [DEBUG] root:891 - Logged sync event: DocumentVersions 7e704c6f-4a92-45be-8d65-e00378afd256 create v1 at 2025-06-29T07:22:50.986Z
2025-06-29 00:22:50,986 [DEBUG] root:652 - Committed transaction.
2025-06-29 00:22:50,986 [INFO] root:1899 - add_media_with_keywords: url=http://example.com/web-development-tutorial, title=Web Development Tutorial, client=test_client
2025-06-29 00:22:50,986 [DEBUG] root:647 - Started transaction.
2025-06-29 00:22:50,986 [DEBUG] root:891 - Logged sync event: Media 97f68e4d-a6d9-4d12-934c-91048f6815c0 create v1 at 2025-06-29T07:22:50.986Z
2025-06-29 00:22:50,986 [DEBUG] root:919 - FTS update for media 3: sanitized content - null bytes replaced
2025-06-29 00:22:50,986 [DEBUG] root:924 - Updated FTS (insert or replace) for Media ID 3
2025-06-29 00:22:50.986 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:update_keywords_for_media:2305 - No keyword changes media 3.
2025-06-29 00:22:50.986 | DEBUG    | tldw_chatbook.DB.Client_Media_DB_v2:create_document_version:2187 - Creating document version 1 for media ID 3, UUID adea4903-e889-487d-a4dd-485e846fa26f
2025-06-29 00:22:50,986 [DEBUG] root:891 - Logged sync event: DocumentVersions adea4903-e889-487d-a4dd-485e846fa26f create v1 at 2025-06-29T07:22:50.986Z
2025-06-29 00:22:50,986 [DEBUG] root:652 - Committed transaction.
2025-06-29 00:22:50.986 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:__init__:992 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db [Client ID: test_client]
2025-06-29 00:22:50.986 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:__init__:992 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db [Client ID: test_client]
2025-06-29 00:22:50.986 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:__init__:992 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db [Client ID: test_client]
2025-06-29 00:22:50.986 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:__init__:992 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db [Client ID: test_client]
2025-06-29 00:22:50.986 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:__init__:992 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db [Client ID: test_client]
2025-06-29 00:22:50.986 | INFO     | tldw_chatbook.DB.ChaChaNotes_DB:__init__:992 - Initializing CharactersRAGDB for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db [Client ID: test_client]
----------------------------------------

29. 2025-06-29 00:22:50.987 | ERROR    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1054 - Failed to connect to database /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db: unable to open database file
----------------------------------------

30. 2025-06-29 00:22:50.987 | ERROR    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1054 - Failed to connect to database /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db: unable to open database file
----------------------------------------

31. 2025-06-29 00:22:50.987 | ERROR    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1054 - Failed to connect to database /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db: unable to open database file
----------------------------------------

32. 2025-06-29 00:22:50.987 | ERROR    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1054 - Failed to connect to database /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db: unable to open database file
----------------------------------------

33. 2025-06-29 00:22:50.987 | ERROR    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1054 - Failed to connect to database /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db: unable to open database file
----------------------------------------

34. 2025-06-29 00:22:50.987 | ERROR    | tldw_chatbook.DB.ChaChaNotes_DB:_get_thread_connection:1054 - Failed to connect to database /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db: unable to open database file
2025-06-29 00:22:50.987 | CRITICAL | tldw_chatbook.DB.ChaChaNotes_DB:__init__:998 - FATAL: DB Initialization failed for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db: Failed to connect to database '/private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db': unable to open database file
2025-06-29 00:22:50.987 | CRITICAL | tldw_chatbook.DB.ChaChaNotes_DB:__init__:998 - FATAL: DB Initialization failed for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db: Failed to connect to database '/private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db': unable to open database file
2025-06-29 00:22:50.987 | CRITICAL | tldw_chatbook.DB.ChaChaNotes_DB:__init__:998 - FATAL: DB Initialization failed for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db: Failed to connect to database '/private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db': unable to open database file
2025-06-29 00:22:50.987 | CRITICAL | tldw_chatbook.DB.ChaChaNotes_DB:__init__:998 - FATAL: DB Initialization failed for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db: Failed to connect to database '/private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db': unable to open database file
2025-06-29 00:22:50.987 | CRITICAL | tldw_chatbook.DB.ChaChaNotes_DB:__init__:998 - FATAL: DB Initialization failed for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db: Failed to connect to database '/private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db': unable to open database file
2025-06-29 00:22:50.987 | CRITICAL | tldw_chatbook.DB.ChaChaNotes_DB:__init__:998 - FATAL: DB Initialization failed for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db: Failed to connect to database '/private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp8kfuhsk6/chachanotes.db': unable to open database file
------------------------------ Captured log setup ------------------------------
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp9wn6g58y/media.db [Client ID: test_client]
DEBUG    root:Client_Media_DB_v2.py:510 Opened/Reopened SQLite connection to /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp9wn6g58y/media.db [Client: test_client, Thread: MainThread]
INFO     root:Client_Media_DB_v2.py:747 Checking DB schema. Current version: 0. Code supports: 1
INFO     root:Client_Media_DB_v2.py:680 Applying initial schema (Version 1) to DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp9wn6g58y/media.db...
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:694 [Schema V1] Applying Core Schema + Version Update...
DEBUG    root:Client_Media_DB_v2.py:696 [Schema V1] Core Schema script (incl. version update) executed.
DEBUG    root:Client_Media_DB_v2.py:707 [Schema V1] Media table structure validated successfully.
DEBUG    root:Client_Media_DB_v2.py:719 [Schema V1] Version check inside transaction confirmed version is 1.
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:722 [Schema V1] Core Schema V1 (incl. version update) applied and committed successfully for DB: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp9wn6g58y/media.db.
DEBUG    root:Client_Media_DB_v2.py:726 [Schema V1] Applying FTS Tables...
INFO     root:Client_Media_DB_v2.py:729 [Schema V1] FTS Tables created successfully.
INFO     root:Client_Media_DB_v2.py:771 Database schema initialized/migrated to version 1.
DEBUG    root:Client_Media_DB_v2.py:474 Database initialization completed successfully for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp9wn6g58y/media.db
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/python-programming-guide, title=Python Programming Guide, client=test_client
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media dcea558f-f418-421f-bf9d-c6c497d47321 create v1 at 2025-06-29T07:22:50.985Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 1: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 1
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions dc9916ad-c35b-4161-ae0c-d29fb6e02122 create v1 at 2025-06-29T07:22:50.985Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/machine-learning-basics, title=Machine Learning Basics, client=test_client
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media 16c6a165-9e0d-4838-b6d0-2ca562cf307f create v1 at 2025-06-29T07:22:50.985Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 2: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 2
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions 7e704c6f-4a92-45be-8d65-e00378afd256 create v1 at 2025-06-29T07:22:50.986Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
INFO     root:Client_Media_DB_v2.py:1899 add_media_with_keywords: url=http://example.com/web-development-tutorial, title=Web Development Tutorial, client=test_client
DEBUG    root:Client_Media_DB_v2.py:647 Started transaction.
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: Media 97f68e4d-a6d9-4d12-934c-91048f6815c0 create v1 at 2025-06-29T07:22:50.986Z
DEBUG    root:Client_Media_DB_v2.py:919 FTS update for media 3: sanitized content - null bytes replaced
DEBUG    root:Client_Media_DB_v2.py:924 Updated FTS (insert or replace) for Media ID 3
DEBUG    root:Client_Media_DB_v2.py:891 Logged sync event: DocumentVersions adea4903-e889-487d-a4dd-485e846fa26f create v1 at 2025-06-29T07:22:50.986Z
DEBUG    root:Client_Media_DB_v2.py:652 Committed transaction.
----------------------------------------

35. _________ ERROR at setup of TestRAGIntegration.test_full_rag_pipeline __________
tldw_chatbook/DB/Client_Media_DB_v2.py:499: in _get_thread_connection
    conn = sqlite3.connect(
E   sqlite3.OperationalError: unable to open database file
----------------------------------------

36. 2025-06-29 00:22:50,989 [ERROR] root:512 - Failed to connect to database at /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp2x6541df/media.db: unable to open database file
Traceback (most recent call last):
  File "/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/DB/Client_Media_DB_v2.py", line 499, in _get_thread_connection
    conn = sqlite3.connect(
           ^^^^^^^^^^^^^^^^
sqlite3.OperationalError: unable to open database file
2025-06-29 00:22:50,991 [CRITICAL] root:459 - FATAL: DB Initialization failed for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp2x6541df/media.db: Failed to connect to database '/private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp2x6541df/media.db': unable to open database file
Traceback (most recent call last):
  File "/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/DB/Client_Media_DB_v2.py", line 499, in _get_thread_connection
    conn = sqlite3.connect(
           ^^^^^^^^^^^^^^^^
sqlite3.OperationalError: unable to open database file
----------------------------------------

37. 2025-06-29 00:22:50,991 [ERROR] root:478 - Database initialization block finished for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp2x6541df/media.db, but failed.
------------------------------ Captured log setup ------------------------------
INFO     root:Client_Media_DB_v2.py:444 Initializing Database object for path: /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp2x6541df/media.db [Client ID: test_client]
----------------------------------------

38. ERROR    root:Client_Media_DB_v2.py:512 Failed to connect to database at /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp2x6541df/media.db: unable to open database file
Traceback (most recent call last):
  File "/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/DB/Client_Media_DB_v2.py", line 499, in _get_thread_connection
    conn = sqlite3.connect(
           ^^^^^^^^^^^^^^^^
sqlite3.OperationalError: unable to open database file
CRITICAL root:Client_Media_DB_v2.py:459 FATAL: DB Initialization failed for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp2x6541df/media.db: Failed to connect to database '/private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp2x6541df/media.db': unable to open database file
Traceback (most recent call last):
  File "/Users/appledev/Working/tldw_chatbook_dev/tldw_chatbook/DB/Client_Media_DB_v2.py", line 499, in _get_thread_connection
    conn = sqlite3.connect(
           ^^^^^^^^^^^^^^^^
sqlite3.OperationalError: unable to open database file
----------------------------------------

39. ERROR    root:Client_Media_DB_v2.py:478 Database initialization block finished for /private/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp2x6541df/media.db, but failed.
----------------------------------------

40. __ ERROR at setup of TestRealServiceFactory.test_create_real_indexing_service __
Tests/RAG/test_service_factory_integration.py:58: in real_media_db
    db = MediaDatabase(str(db_path))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: MediaDatabase.__init__() missing 1 required positional argument: 'client_id'
----------------------------------------

41. _ ERROR at setup of TestRealServiceFactory.test_create_complete_real_rag_services _
Tests/RAG/test_service_factory_integration.py:58: in real_media_db
    db = MediaDatabase(str(db_path))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: MediaDatabase.__init__() missing 1 required positional argument: 'client_id'
----------------------------------------

42. ____ ERROR at setup of TestRealServiceFactory.test_end_to_end_rag_workflow _____
Tests/RAG/test_service_factory_integration.py:58: in real_media_db
    db = MediaDatabase(str(db_path))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: MediaDatabase.__init__() missing 1 required positional argument: 'client_id'
----------------------------------------

43. _ ERROR at setup of TestRealServiceFactory.test_service_factory_without_embeddings _
Tests/RAG/test_service_factory_integration.py:58: in real_media_db
    db = MediaDatabase(str(db_path))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: MediaDatabase.__init__() missing 1 required positional argument: 'client_id'
----------------------------------------

44. ___ ERROR at teardown of TestRealServiceFactory.test_service_reconfiguration ___
Tests/RAG/test_service_factory_integration.py:51: in temp_dirs
    shutil.rmtree(base_dir)
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/shutil.py:759: in rmtree
    _rmtree_safe_fd(stack, onexc)
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/shutil.py:703: in _rmtree_safe_fd
    onexc(func, path, err)
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/shutil.py:686: in _rmtree_safe_fd
    with os.scandir(topfd) as scandir_it:
         ^^^^^^^^^^^^^^^^^
E   OSError: [Errno 24] Too many open files: '/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpj1gfm7f3/data'
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:22:54.919 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:675 - ChromaDB LRU cache configured with 2147483648 bytes limit
2025-06-29 00:22:54.919 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:675 - ChromaDB LRU cache configured with 2147483648 bytes limit
2025-06-29 00:22:54.919 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:675 - ChromaDB LRU cache configured with 2147483648 bytes limit
2025-06-29 00:22:54.919 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:675 - ChromaDB LRU cache configured with 2147483648 bytes limit
2025-06-29 00:22:54.919 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:675 - ChromaDB LRU cache configured with 2147483648 bytes limit
2025-06-29 00:22:54.919 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:675 - ChromaDB LRU cache configured with 2147483648 bytes limit
2025-06-29 00:22:54,919 [DEBUG] chromadb.config:359 - Starting component System
2025-06-29 00:22:54,919 [DEBUG] chromadb.config:359 - Starting component Posthog
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpj1gfm7f3/embeddings
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpj1gfm7f3/embeddings
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpj1gfm7f3/embeddings
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpj1gfm7f3/embeddings
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpj1gfm7f3/embeddings
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpj1gfm7f3/embeddings
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=4, batch_size=32, parallel=True
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=4, batch_size=32, parallel=True
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=4, batch_size=32, parallel=True
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=4, batch_size=32, parallel=True
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=4, batch_size=32, parallel=True
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=4, batch_size=32, parallel=True
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.memory_management_service:__init__:135 - Configuring ChromaDB LRU cache with 2147483648 bytes limit
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.memory_management_service:__init__:135 - Configuring ChromaDB LRU cache with 2147483648 bytes limit
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.memory_management_service:__init__:135 - Configuring ChromaDB LRU cache with 2147483648 bytes limit
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.memory_management_service:__init__:135 - Configuring ChromaDB LRU cache with 2147483648 bytes limit
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.memory_management_service:__init__:135 - Configuring ChromaDB LRU cache with 2147483648 bytes limit
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.memory_management_service:__init__:135 - Configuring ChromaDB LRU cache with 2147483648 bytes limit
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.service_factory:create_embeddings_service:105 - Created embeddings service with memory management at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpj1gfm7f3/embeddings
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.service_factory:create_embeddings_service:105 - Created embeddings service with memory management at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpj1gfm7f3/embeddings
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.service_factory:create_embeddings_service:105 - Created embeddings service with memory management at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpj1gfm7f3/embeddings
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.service_factory:create_embeddings_service:105 - Created embeddings service with memory management at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpj1gfm7f3/embeddings
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.service_factory:create_embeddings_service:105 - Created embeddings service with memory management at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpj1gfm7f3/embeddings
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.service_factory:create_embeddings_service:105 - Created embeddings service with memory management at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpj1gfm7f3/embeddings
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set compat_sentence-transformers_all-MiniLM-L6-v2 as current provider
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set compat_sentence-transformers_all-MiniLM-L6-v2 as current provider
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set compat_sentence-transformers_all-MiniLM-L6-v2 as current provider
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set compat_sentence-transformers_all-MiniLM-L6-v2 as current provider
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set compat_sentence-transformers_all-MiniLM-L6-v2 as current provider
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set compat_sentence-transformers_all-MiniLM-L6-v2 as current provider
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:initialize_embedding_model:835 - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:initialize_embedding_model:835 - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:initialize_embedding_model:835 - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:initialize_embedding_model:835 - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:initialize_embedding_model:835 - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:initialize_embedding_model:835 - Initialized embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:initialize_embedding_model:835 - Initialized embedding model: sentence-transformers/all-mpnet-base-v2
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:initialize_embedding_model:835 - Initialized embedding model: sentence-transformers/all-mpnet-base-v2
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:initialize_embedding_model:835 - Initialized embedding model: sentence-transformers/all-mpnet-base-v2
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:initialize_embedding_model:835 - Initialized embedding model: sentence-transformers/all-mpnet-base-v2
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:initialize_embedding_model:835 - Initialized embedding model: sentence-transformers/all-mpnet-base-v2
2025-06-29 00:22:54.926 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:initialize_embedding_model:835 - Initialized embedding model: sentence-transformers/all-mpnet-base-v2
------------------------------ Captured log call -------------------------------
DEBUG    chromadb.config:config.py:359 Starting component System
DEBUG    chromadb.config:config.py:359 Starting component Posthog
--------------------------- Captured stderr teardown ---------------------------
2025-06-29 00:22:54.927 | DEBUG    | tldw_chatbook.RAG_Search.Services.embeddings_service:_cleanup_providers:1369 - Cleaned up provider: test_provider
----------------------------------------

45. _____ ERROR at setup of TestRealServiceFactory.test_service_error_recovery _____
Tests/RAG/test_service_factory_integration.py:58: in real_media_db
    db = MediaDatabase(str(db_path))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   TypeError: MediaDatabase.__init__() missing 1 required positional argument: 'client_id'
----------------------------------------

46. ___ ERROR at teardown of TestRealServiceFactory.test_service_error_recovery ____
Tests/RAG/test_service_factory_integration.py:51: in temp_dirs
    shutil.rmtree(base_dir)
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/shutil.py:759: in rmtree
    _rmtree_safe_fd(stack, onexc)
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/shutil.py:703: in _rmtree_safe_fd
    onexc(func, path, err)
/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/shutil.py:686: in _rmtree_safe_fd
    with os.scandir(topfd) as scandir_it:
         ^^^^^^^^^^^^^^^^^
E   OSError: [Errno 24] Too many open files: '/var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpzwpnf4js/data'
=================================== FAILURES ===================================
________ TestEmbeddingsRealIntegration.test_embeddings_with_real_cache _________
Tests/RAG/test_embeddings_integration_real.py:76: in test_embeddings_with_real_cache
    assert all(isinstance(emb, list) and len(emb) == 384 for emb in embeddings1)
E   assert False
E    +  where False = all(<generator object TestEmbeddingsRealIntegration.test_embeddings_with_real_cache.<locals>.<genexpr> at 0x151356a40>)
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:22:46.076 | DEBUG    | tldw_chatbook.RAG_Search.Services.embeddings_service:_cleanup_providers:1369 - Cleaned up provider: test
2025-06-29 00:22:46.083 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpl3r1nls6/embeddings
2025-06-29 00:22:46.083 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpl3r1nls6/embeddings
2025-06-29 00:22:46.083 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpl3r1nls6/embeddings
2025-06-29 00:22:46.083 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpl3r1nls6/embeddings
2025-06-29 00:22:46.083 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpl3r1nls6/embeddings
2025-06-29 00:22:46.083 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpl3r1nls6/embeddings
2025-06-29 00:22:46.083 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test_provider as current provider
2025-06-29 00:22:46.083 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test_provider as current provider
2025-06-29 00:22:46.083 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test_provider as current provider
2025-06-29 00:22:46.083 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test_provider as current provider
2025-06-29 00:22:46.083 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test_provider as current provider
2025-06-29 00:22:46.083 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:add_provider:794 - Set test_provider as current provider
2025-06-29 00:22:46.083 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: test_provider
2025-06-29 00:22:46.083 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: test_provider
2025-06-29 00:22:46.083 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: test_provider
2025-06-29 00:22:46.083 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: test_provider
2025-06-29 00:22:46.083 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: test_provider
2025-06-29 00:22:46.083 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:set_provider:803 - Switched to provider: test_provider
______ TestEmbeddingsPerformance.test_parallel_vs_sequential_performance _______
Tests/RAG/test_embeddings_performance.py:239: in test_parallel_vs_sequential_performance
    performance_embeddings_service.embedding_model.encode.reset_mock()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'function' object has no attribute 'reset_mock'
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:22:46.920 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpo0thcsj2
2025-06-29 00:22:46.920 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpo0thcsj2
2025-06-29 00:22:46.920 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpo0thcsj2
2025-06-29 00:22:46.920 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpo0thcsj2
2025-06-29 00:22:46.920 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpo0thcsj2
2025-06-29 00:22:46.920 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpo0thcsj2
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:22:46.921 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=4, batch_size=50, parallel=False
2025-06-29 00:22:46.921 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=4, batch_size=50, parallel=False
2025-06-29 00:22:46.921 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=4, batch_size=50, parallel=False
2025-06-29 00:22:46.921 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=4, batch_size=50, parallel=False
2025-06-29 00:22:46.921 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=4, batch_size=50, parallel=False
2025-06-29 00:22:46.921 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=4, batch_size=50, parallel=False
2025-06-29 00:22:46.921 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=4, batch_size=50, parallel=True
2025-06-29 00:22:46.921 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=4, batch_size=50, parallel=True
2025-06-29 00:22:46.921 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=4, batch_size=50, parallel=True
2025-06-29 00:22:46.921 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=4, batch_size=50, parallel=True
2025-06-29 00:22:46.921 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=4, batch_size=50, parallel=True
2025-06-29 00:22:46.921 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=4, batch_size=50, parallel=True
___________ TestEmbeddingsPerformance.test_stress_test_executor_pool ___________
Tests/RAG/test_embeddings_performance.py:461: in test_stress_test_executor_pool
    embeddings = performance_embeddings_service._create_embeddings_parallel(texts)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tldw_chatbook/RAG_Search/Services/embeddings_service.py:966: in _create_embeddings_parallel
    raise ValueError("No embedding provider available")
E   ValueError: No embedding provider available
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:22:47.568 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpz_q3l7uh
2025-06-29 00:22:47.568 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpz_q3l7uh
2025-06-29 00:22:47.568 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpz_q3l7uh
2025-06-29 00:22:47.568 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpz_q3l7uh
2025-06-29 00:22:47.568 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpz_q3l7uh
2025-06-29 00:22:47.568 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpz_q3l7uh
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:22:47.568 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=2, batch_size=10, parallel=True
2025-06-29 00:22:47.568 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=2, batch_size=10, parallel=True
2025-06-29 00:22:47.568 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=2, batch_size=10, parallel=True
2025-06-29 00:22:47.568 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=2, batch_size=10, parallel=True
2025-06-29 00:22:47.568 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=2, batch_size=10, parallel=True
2025-06-29 00:22:47.568 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=2, batch_size=10, parallel=True
_________ TestEmbeddingsProperties.test_batch_processing_completeness __________
Tests/RAG/test_embeddings_properties.py:197: in test_batch_processing_completeness
    texts=st.lists(st.text(min_size=1), min_size=1, max_size=30),
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Tests/RAG/test_embeddings_properties.py:208: in test_batch_processing_completeness
    original_encode = property_embeddings_service.embedding_model.encode.side_effect
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'function' object has no attribute 'side_effect'
E   Falsifying example: test_batch_processing_completeness(
E       self=<Tests.RAG.test_embeddings_properties.TestEmbeddingsProperties object at 0x147dae390>,
E       property_embeddings_service=<tldw_chatbook.RAG_Search.Services.embeddings_service.EmbeddingsService object at 0x151256420>,
E       texts=['1'],
E       batch_size=1,  # or any other generated value
E   )
---------------------------- Captured stderr setup -----------------------------
2025-06-29 00:22:47.934 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmprc1l3iwf
2025-06-29 00:22:47.934 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmprc1l3iwf
2025-06-29 00:22:47.934 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmprc1l3iwf
2025-06-29 00:22:47.934 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmprc1l3iwf
2025-06-29 00:22:47.934 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmprc1l3iwf
2025-06-29 00:22:47.934 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmprc1l3iwf
______________________ TestEmbeddingsStateMachine.runTest ______________________
.venv/lib/python3.12/site-packages/hypothesis/stateful.py:476: in runTest
    run_state_machine_as_test(cls, settings=self.settings)
.venv/lib/python3.12/site-packages/hypothesis/stateful.py:258: in run_state_machine_as_test
    state_machine_test(state_machine_factory)
.venv/lib/python3.12/site-packages/hypothesis/stateful.py:115: in run_state_machine
    @given(st.data())
               ^^^^^^^
Tests/RAG/test_embeddings_properties.py:427: in search_collection
    assert 'documents' in results
E   AssertionError: assert 'documents' in <MagicMock name='chromadb.PersistentClient().get_collection().query()' id='5733252176'>
E   Falsifying example:
E   state = EmbeddingsStateMachine()
E   state.collections_have_valid_counts()
E   state.documents_added_matches_collections()
E   state.embeddings_count_increases()
E   state.create_embeddings(texts=['0'])
E   state.collections_have_valid_counts()
E   state.documents_added_matches_collections()
E   state.embeddings_count_increases()
E   collection_names_0 = state.create_collection(name='0')
E   state.collections_have_valid_counts()
E   state.documents_added_matches_collections()
E   state.embeddings_count_increases()
E   state.search_collection(collection=collection_names_0)
E   state.teardown()
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:22:48.435 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp6vtmmnji
2025-06-29 00:22:48.435 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp6vtmmnji
2025-06-29 00:22:48.435 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp6vtmmnji
2025-06-29 00:22:48.435 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp6vtmmnji
2025-06-29 00:22:48.435 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp6vtmmnji
2025-06-29 00:22:48.435 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp6vtmmnji
2025-06-29 00:22:48.437 | DEBUG    | tldw_chatbook.RAG_Search.Services.embeddings_service:get_or_create_collection:1018 - Got collection: 0
2025-06-29 00:22:48.445 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpood0w29y
2025-06-29 00:22:48.445 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpood0w29y
2025-06-29 00:22:48.445 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpood0w29y
2025-06-29 00:22:48.445 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpood0w29y
2025-06-29 00:22:48.445 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpood0w29y
2025-06-29 00:22:48.445 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpood0w29y
2025-06-29 00:22:48.446 | DEBUG    | tldw_chatbook.RAG_Search.Services.embeddings_service:get_or_create_collection:1018 - Got collection: 0
___________ TestRealServiceFactory.test_create_real_chunking_service ___________
Tests/RAG/test_service_factory_integration.py:184: in test_create_real_chunking_service
    assert all(len(chunk) <= service.chunk_size for chunk in chunks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Tests/RAG/test_service_factory_integration.py:184: in <genexpr>
    assert all(len(chunk) <= service.chunk_size for chunk in chunks)
                             ^^^^^^^^^^^^^^^^^^
E   AttributeError: 'ChunkingService' object has no attribute 'chunk_size'
--------------------------- Captured stderr teardown ---------------------------
2025-06-29 00:22:54.885 | DEBUG    | tldw_chatbook.RAG_Search.Services.embeddings_service:_cleanup_providers:1369 - Cleaned up provider: compat_sentence-transformers_all-MiniLM-L6-v2
____________ TestRealServiceFactory.test_create_real_cache_service _____________
Tests/RAG/test_service_factory_integration.py:223: in test_create_real_cache_service
    service.set(key, value)
    ^^^^^^^^^^^
E   AttributeError: 'CacheService' object has no attribute 'set'
______ TestRealServiceFactory.test_create_real_memory_management_service _______
Tests/RAG/test_service_factory_integration.py:242: in test_create_real_memory_management_service
    initial_usage = service.get_memory_usage()
                    ^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'MemoryManagementService' object has no attribute 'get_memory_usage'
----------------------------- Captured stderr call -----------------------------
2025-06-29 00:22:54.897 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:675 - ChromaDB LRU cache configured with 2147483648 bytes limit
2025-06-29 00:22:54.897 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:675 - ChromaDB LRU cache configured with 2147483648 bytes limit
2025-06-29 00:22:54.897 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:675 - ChromaDB LRU cache configured with 2147483648 bytes limit
2025-06-29 00:22:54.897 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:675 - ChromaDB LRU cache configured with 2147483648 bytes limit
2025-06-29 00:22:54.897 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:675 - ChromaDB LRU cache configured with 2147483648 bytes limit
2025-06-29 00:22:54.897 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:675 - ChromaDB LRU cache configured with 2147483648 bytes limit
2025-06-29 00:22:54,897 [DEBUG] chromadb.config:359 - Starting component System
2025-06-29 00:22:54,897 [DEBUG] chromadb.config:359 - Starting component Posthog
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpxpn0vfb_/embeddings
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpxpn0vfb_/embeddings
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpxpn0vfb_/embeddings
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpxpn0vfb_/embeddings
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpxpn0vfb_/embeddings
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:__init__:682 - ChromaDB initialized at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpxpn0vfb_/embeddings
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=4, batch_size=32, parallel=True
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=4, batch_size=32, parallel=True
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=4, batch_size=32, parallel=True
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=4, batch_size=32, parallel=True
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=4, batch_size=32, parallel=True
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.embeddings_service:configure_performance:1268 - Performance configured: workers=4, batch_size=32, parallel=True
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.memory_management_service:__init__:135 - Configuring ChromaDB LRU cache with 2147483648 bytes limit
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.memory_management_service:__init__:135 - Configuring ChromaDB LRU cache with 2147483648 bytes limit
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.memory_management_service:__init__:135 - Configuring ChromaDB LRU cache with 2147483648 bytes limit
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.memory_management_service:__init__:135 - Configuring ChromaDB LRU cache with 2147483648 bytes limit
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.memory_management_service:__init__:135 - Configuring ChromaDB LRU cache with 2147483648 bytes limit
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.memory_management_service:__init__:135 - Configuring ChromaDB LRU cache with 2147483648 bytes limit
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.service_factory:create_embeddings_service:105 - Created embeddings service with memory management at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpxpn0vfb_/embeddings
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.service_factory:create_embeddings_service:105 - Created embeddings service with memory management at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpxpn0vfb_/embeddings
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.service_factory:create_embeddings_service:105 - Created embeddings service with memory management at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpxpn0vfb_/embeddings
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.service_factory:create_embeddings_service:105 - Created embeddings service with memory management at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpxpn0vfb_/embeddings
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.service_factory:create_embeddings_service:105 - Created embeddings service with memory management at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpxpn0vfb_/embeddings
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.service_factory:create_embeddings_service:105 - Created embeddings service with memory management at /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpxpn0vfb_/embeddings
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.memory_management_service:__init__:135 - Configuring ChromaDB LRU cache with 2147483648 bytes limit
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.memory_management_service:__init__:135 - Configuring ChromaDB LRU cache with 2147483648 bytes limit
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.memory_management_service:__init__:135 - Configuring ChromaDB LRU cache with 2147483648 bytes limit
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.memory_management_service:__init__:135 - Configuring ChromaDB LRU cache with 2147483648 bytes limit
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.memory_management_service:__init__:135 - Configuring ChromaDB LRU cache with 2147483648 bytes limit
2025-06-29 00:22:54.903 | INFO     | tldw_chatbook.RAG_Search.Services.memory_management_service:__init__:135 - Configuring ChromaDB LRU cache with 2147483648 bytes limit
------------------------------ Captured log call -------------------------------
DEBUG    chromadb.config:config.py:359 Starting component System
DEBUG    chromadb.config:config.py:359 Starting component Posthog
_____________ TestRealServiceFactory.test_service_reconfiguration ______________
Tests/RAG/test_service_factory_integration.py:370: in test_service_reconfiguration
    assert dim1 != dim2  # MiniLM: 384, MPNet: 768
    ^^^^^^^^^^^^^^^^^^^
E   assert 2 != 2
----------------------------------------

47. ERROR Tests/RAG/test_embeddings_integration_real.py::TestEmbeddingsRealIntegration::test_embeddings_with_memory_manager
----------------------------------------

48. ERROR Tests/RAG/test_embeddings_integration_real.py::TestEmbeddingsRealIntegration::test_memory_cleanup_integration
----------------------------------------

49. ERROR Tests/RAG/test_embeddings_integration_real.py::TestEmbeddingsRealIntegration::test_mixed_operations_stress_test
----------------------------------------

50. ERROR Tests/RAG/test_indexing_service_integration.py::TestRealIndexingService::test_real_index_media_items
----------------------------------------

51. ERROR Tests/RAG/test_indexing_service_integration.py::TestRealIndexingService::test_real_index_conversations
----------------------------------------

52. ERROR Tests/RAG/test_indexing_service_integration.py::TestRealIndexingService::test_real_index_notes
----------------------------------------

53. ERROR Tests/RAG/test_indexing_service_integration.py::TestRealIndexingService::test_real_progress_callback
----------------------------------------

54. ERROR Tests/RAG/test_indexing_service_integration.py::TestRealIndexingService::test_real_incremental_indexing
----------------------------------------

55. ERROR Tests/RAG/test_indexing_service_integration.py::TestRealIndexingService::test_real_error_handling
----------------------------------------

56. ERROR Tests/RAG/test_indexing_service_integration.py::TestRealIndexingService::test_real_chunking_quality
----------------------------------------

57. ERROR Tests/RAG/test_indexing_service_integration.py::TestRealIndexingService::test_real_concurrent_indexing
----------------------------------------

58. ERROR Tests/RAG/test_memory_management_service_integration.py::TestRealMemoryManagementService::test_real_collection_stats
----------------------------------------

59. ERROR Tests/RAG/test_memory_management_service_integration.py::TestRealMemoryManagementService::test_real_thread_safe_operations
----------------------------------------

60. ERROR Tests/RAG/test_memory_management_service_integration.py::TestRealMemoryManagementService::test_real_cleanup_old_documents
----------------------------------------

61. ERROR Tests/RAG/test_memory_management_service_integration.py::TestRealMemoryManagementService::test_real_collection_size_limits
----------------------------------------

62. ERROR Tests/RAG/test_memory_management_service_integration.py::TestRealMemoryManagementService::test_real_automatic_cleanup
----------------------------------------

63. ERROR Tests/RAG/test_memory_management_service_integration.py::TestRealMemoryManagementService::test_real_memory_usage_tracking
----------------------------------------

64. ERROR Tests/RAG/test_memory_management_service_integration.py::TestRealMemoryManagementService::test_real_collection_deletion
----------------------------------------

65. ERROR Tests/RAG/test_memory_management_service_integration.py::TestRealMemoryManagementService::test_real_concurrent_cleanup_operations
----------------------------------------

66. ERROR Tests/RAG/test_rag_integration.py::TestRAGIntegration::test_plain_rag_with_reranking
----------------------------------------

67. ERROR Tests/RAG/test_rag_integration.py::TestRAGIntegration::test_plain_rag_with_reranking
----------------------------------------

68. ERROR Tests/RAG/test_rag_integration.py::TestRAGIntegration::test_full_rag_pipeline
----------------------------------------

69. ERROR Tests/RAG/test_service_factory_integration.py::TestRealServiceFactory::test_create_real_indexing_service
----------------------------------------

70. ERROR Tests/RAG/test_service_factory_integration.py::TestRealServiceFactory::test_create_complete_real_rag_services
----------------------------------------

71. ERROR Tests/RAG/test_service_factory_integration.py::TestRealServiceFactory::test_end_to_end_rag_workflow
----------------------------------------

72. ERROR Tests/RAG/test_service_factory_integration.py::TestRealServiceFactory::test_service_factory_without_embeddings
----------------------------------------

73. ERROR Tests/RAG/test_service_factory_integration.py::TestRealServiceFactory::test_service_reconfiguration
----------------------------------------

74. ERROR Tests/RAG/test_service_factory_integration.py::TestRealServiceFactory::test_service_error_recovery
----------------------------------------

75. ERROR Tests/RAG/test_service_factory_integration.py::TestRealServiceFactory::test_service_error_recovery
----------------------------------------

76. FAILED Tests/RAG/test_embeddings_integration_real.py::TestEmbeddingsRealIntegration::test_embeddings_with_real_cache
----------------------------------------

77. FAILED Tests/RAG/test_embeddings_performance.py::TestEmbeddingsPerformance::test_parallel_vs_sequential_performance
----------------------------------------

78. FAILED Tests/RAG/test_embeddings_performance.py::TestEmbeddingsPerformance::test_stress_test_executor_pool
----------------------------------------

79. FAILED Tests/RAG/test_embeddings_properties.py::TestEmbeddingsProperties::test_batch_processing_completeness
----------------------------------------

80. FAILED Tests/RAG/test_embeddings_properties.py::TestEmbeddingsStateMachine::runTest
----------------------------------------

81. FAILED Tests/RAG/test_service_factory_integration.py::TestRealServiceFactory::test_create_real_chunking_service
----------------------------------------

82. FAILED Tests/RAG/test_service_factory_integration.py::TestRealServiceFactory::test_create_real_cache_service
----------------------------------------

83. FAILED Tests/RAG/test_service_factory_integration.py::TestRealServiceFactory::test_create_real_memory_management_service
----------------------------------------

84. FAILED Tests/RAG/test_service_factory_integration.py::TestRealServiceFactory::test_service_reconfiguration
9 failed, 227 passed, 2 skipped, 2 warnings, 29 errors in 9.36s
----------------------------------------

85. Tests/RAG/test_embeddings_integration_real.py::TestEmbeddingsRealIntegration::test_embeddings_with_real_cache: Tests/RAG/test_embeddings_integration_real.py:76: in test_embeddings_with_real_cache
    assert all(isinstance(emb, list) and len(emb) == 384 for emb in embeddings1)
E   assert False
E    +  where False = all(<generator object TestEmbeddingsRealIntegration.test_embeddings_with_real_cache.<locals>.<genexpr> at 0x151356a40>)
----------------------------------------

86. Tests/RAG/test_embeddings_integration_real.py::TestEmbeddingsRealIntegration::test_embeddings_with_memory_manager: No details available
----------------------------------------

87. Tests/RAG/test_embeddings_integration_real.py::TestEmbeddingsRealIntegration::test_memory_cleanup_integration: No details available
----------------------------------------

88. Tests/RAG/test_embeddings_integration_real.py::TestEmbeddingsRealIntegration::test_mixed_operations_stress_test: No details available
----------------------------------------

89. Tests/RAG/test_embeddings_performance.py::TestEmbeddingsPerformance::test_parallel_vs_sequential_performance: Tests/RAG/test_embeddings_performance.py:239: in test_parallel_vs_sequential_performance
    performance_embeddings_service.embedding_model.encode.reset_mock()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'function' object has no attribute 'reset_mock'
----------------------------------------

90. Tests/RAG/test_embeddings_performance.py::TestEmbeddingsPerformance::test_stress_test_executor_pool: Tests/RAG/test_embeddings_performance.py:461: in test_stress_test_executor_pool
    embeddings = performance_embeddings_service._create_embeddings_parallel(texts)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
tldw_chatbook/RAG_Search/Services/embeddings_service.py:966: in _create_embeddings_parallel
    raise ValueError("No embedding provider available")
E   ValueError: No embedding provider available
----------------------------------------

91. Tests/RAG/test_embeddings_properties.py::TestEmbeddingsProperties::test_batch_processing_completeness: Tests/RAG/test_embeddings_properties.py:197: in test_batch_processing_completeness
    texts=st.lists(st.text(min_size=1), min_size=1, max_size=30),
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Tests/RAG/test_embeddings_properties.py:208: in test_batch_processing_completeness
    original_encode = property_embeddings_service.embedding_model.encode.side_effect
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'function' object has no attribute 'side_effect'
E   Falsifying example: test_batch_processing_completeness(
E       self=<Tests.RAG.test_embeddings_properties.TestEmbeddingsProperties object at 0x147dae390>,
E       property_embeddings_service=<tldw_chatbook.RAG_Search.Services.embeddings_service.EmbeddingsService object at 0x151256420>,
E       texts=['1'],
E       batch_size=1,  # or any other generated value
E   )
----------------------------------------

92. Tests/RAG/test_embeddings_properties.py::TestEmbeddingsStateMachine::runTest: .venv/lib/python3.12/site-packages/hypothesis/stateful.py:476: in runTest
    run_state_machine_as_test(cls, settings=self.settings)
.venv/lib/python3.12/site-packages/hypothesis/stateful.py:258: in run_state_machine_as_test
    state_machine_test(state_machine_factory)
.venv/lib/python3.12/site-packages/hypothesis/stateful.py:115: in run_state_machine
    @given(st.data())
               ^^^^^^^
Tests/RAG/test_embeddings_properties.py:427: in search_collection
    assert 'documents' in results
E   AssertionError: assert 'documents' in <MagicMock name='chromadb.PersistentClient().get_collection().query()' id='5733252176'>
E   Falsifying example:
E   state = EmbeddingsStateMachine()
E   state.collections_have_valid_counts()
E   state.documents_added_matches_collections()
E   state.embeddings_count_increases()
E   state.create_embeddings(texts=['0'])
E   state.collections_have_valid_counts()
E   state.documents_added_matches_collections()
E   state.embeddings_count_increases()
E   collection_names_0 = state.create_collection(name='0')
E   state.collections_have_valid_counts()
E   state.documents_added_matches_collections()
E   state.embeddings_count_increases()
E   state.search_collection(collection=collection_names_0)
E   state.teardown()
----------------------------------------

93. Tests/RAG/test_indexing_service_integration.py::TestRealIndexingService::test_real_index_media_items: No details available
----------------------------------------

94. Tests/RAG/test_indexing_service_integration.py::TestRealIndexingService::test_real_index_conversations: No details available
----------------------------------------

95. Tests/RAG/test_indexing_service_integration.py::TestRealIndexingService::test_real_index_notes: No details available
----------------------------------------

96. Tests/RAG/test_indexing_service_integration.py::TestRealIndexingService::test_real_progress_callback: No details available
----------------------------------------

97. Tests/RAG/test_indexing_service_integration.py::TestRealIndexingService::test_real_incremental_indexing: No details available
----------------------------------------

98. Tests/RAG/test_indexing_service_integration.py::TestRealIndexingService::test_real_error_handling: No details available
----------------------------------------

99. Tests/RAG/test_indexing_service_integration.py::TestRealIndexingService::test_real_chunking_quality: No details available
----------------------------------------

100. Tests/RAG/test_indexing_service_integration.py::TestRealIndexingService::test_real_concurrent_indexing: No details available
----------------------------------------

101. Tests/RAG/test_memory_management_service_integration.py::TestRealMemoryManagementService::test_real_collection_stats: No details available
----------------------------------------

102. Tests/RAG/test_memory_management_service_integration.py::TestRealMemoryManagementService::test_real_thread_safe_operations: No details available
----------------------------------------

103. Tests/RAG/test_memory_management_service_integration.py::TestRealMemoryManagementService::test_real_cleanup_old_documents: No details available
----------------------------------------

104. Tests/RAG/test_memory_management_service_integration.py::TestRealMemoryManagementService::test_real_collection_size_limits: No details available
----------------------------------------

105. Tests/RAG/test_memory_management_service_integration.py::TestRealMemoryManagementService::test_real_automatic_cleanup: No details available
----------------------------------------

106. Tests/RAG/test_memory_management_service_integration.py::TestRealMemoryManagementService::test_real_memory_usage_tracking: No details available
----------------------------------------

107. Tests/RAG/test_memory_management_service_integration.py::TestRealMemoryManagementService::test_real_collection_deletion: No details available
----------------------------------------

108. Tests/RAG/test_memory_management_service_integration.py::TestRealMemoryManagementService::test_real_concurrent_cleanup_operations: No details available
----------------------------------------

109. Tests/RAG/test_rag_integration.py::TestRAGIntegration::test_plain_rag_with_reranking: No details available
----------------------------------------

110. Tests/RAG/test_rag_integration.py::TestRAGIntegration::test_full_rag_pipeline: No details available
----------------------------------------

111. Tests/RAG/test_service_factory_integration.py::TestRealServiceFactory::test_create_real_chunking_service: Tests/RAG/test_service_factory_integration.py:184: in test_create_real_chunking_service
    assert all(len(chunk) <= service.chunk_size for chunk in chunks)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Tests/RAG/test_service_factory_integration.py:184: in <genexpr>
    assert all(len(chunk) <= service.chunk_size for chunk in chunks)
                             ^^^^^^^^^^^^^^^^^^
E   AttributeError: 'ChunkingService' object has no attribute 'chunk_size'
----------------------------------------

112. Tests/RAG/test_service_factory_integration.py::TestRealServiceFactory::test_create_real_indexing_service: No details available
----------------------------------------

113. Tests/RAG/test_service_factory_integration.py::TestRealServiceFactory::test_create_real_cache_service: Tests/RAG/test_service_factory_integration.py:223: in test_create_real_cache_service
    service.set(key, value)
    ^^^^^^^^^^^
E   AttributeError: 'CacheService' object has no attribute 'set'
----------------------------------------

114. Tests/RAG/test_service_factory_integration.py::TestRealServiceFactory::test_create_real_memory_management_service: Tests/RAG/test_service_factory_integration.py:242: in test_create_real_memory_management_service
    initial_usage = service.get_memory_usage()
                    ^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'MemoryManagementService' object has no attribute 'get_memory_usage'
----------------------------------------

115. Tests/RAG/test_service_factory_integration.py::TestRealServiceFactory::test_create_complete_real_rag_services: No details available
----------------------------------------

116. Tests/RAG/test_service_factory_integration.py::TestRealServiceFactory::test_end_to_end_rag_workflow: No details available
----------------------------------------

117. Tests/RAG/test_service_factory_integration.py::TestRealServiceFactory::test_service_factory_without_embeddings: No details available
----------------------------------------

118. Tests/RAG/test_service_factory_integration.py::TestRealServiceFactory::test_service_reconfiguration: Tests/RAG/test_service_factory_integration.py:370: in test_service_reconfiguration
    assert dim1 != dim2  # MiniLM: 384, MPNet: 768
    ^^^^^^^^^^^^^^^^^^^
E   assert 2 != 2

During handling of the above exception, another exception occurred:
Tests/RAG/test_service_factory_integration.py:373: in test_service_reconfiguration
    assert dim1 == 384  # MiniLM dimension
    ^^^^^^^^^^^^^^^^^^
E   assert 2 == 384
----------------------------------------

119. Tests/RAG/test_service_factory_integration.py::TestRealServiceFactory::test_service_error_recovery: No details available
----------------------------------------

================================================================================

ANALYSIS AND RECOMMENDATIONS
================================================================================

Common Failure Patterns:
  - Database Issues: 141 occurrences
  - Attribute Errors: 60 occurrences
  - Assertion Failures: 15 occurrences
  - Key Errors: 2 occurrences
  - Import Errors: 1 occurrences

Recommendations:
  - Check that all dependencies are installed correctly
  - Verify PYTHONPATH includes the project root
  - Ensure test databases are properly initialized
  - Check for database migration issues

/* ========================================
 * LAYOUT: Sidebars
 * ======================================== 
 * Generic sidebar patterns and collapsible behavior
 * Used across multiple features
 * ======================================== */

/* ----------------------------------------
 * Enhanced Sidebar Styles
 * ---------------------------------------- */

/* Enhanced sidebar container */
.enhanced-sidebar {
    height: 100%;
    background: $boost;
}

/* Sidebar header with improved visibility */
.sidebar-header {
    height: 4;
    padding: 1;
    background: $primary 20%;
    border-bottom: thick $primary;
    align: center middle;
}

.sidebar-title {
    text-style: bold;
    color: $text;
    text-align: center;
}

/* Preset bar for quick configuration */
.preset-bar {
    height: 3;
    padding: 0 1;
    background: $surface 15%;
    border-bottom: solid $surface-lighten-1;
    align: left middle;
}

.preset-button {
    width: auto;
    min-width: 10;
    margin: 0 1;
    padding: 0 1;
    background: $surface;
    border: tall $surface-lighten-1;
}

.preset-button.active {
    background: $primary 30%;
    border: tall $primary;
    text-style: bold;
}

.preset-button:hover {
    background: $primary 15%;
}

/* Search container with better visibility */
.search-container {
    height: 4;
    padding: 1;
    background: $surface 10%;
    border-bottom: solid $surface-lighten-1;
}

.search-input {
    width: 100%;
    border: round $accent;
    background: $background;
}

/* ----------------------------------------
 * Visual Grouping & Organization
 * ---------------------------------------- */

/* Quick Actions Bar */
.quick-actions-bar {
    height: 3;
    padding: 0 1;
    margin-bottom: 1;
    background: $primary 10%;
    border-bottom: solid $primary;
}

.quick-action-btn {
    width: auto;
    margin: 0 1;
    padding: 0 1;
}

/* Search Input */
.sidebar-search-input {
    width: 100%;
    margin: 1 0;
    border: round $accent;
}

/* Group Headers */
.group-header {
    text-style: bold;
    color: $text-muted;
    margin: 1 0;
    padding: 0 1;
}

/* Section Dividers */
.sidebar-section-divider {
    height: 1;
    margin: 2 0;
    border-top: solid $primary 30%;
    opacity: 50%;
}

/* Settings Groups with Enhanced Visibility */
.settings-group {
    padding-left: 1;
    margin: 1 0;
}

/* Improved contrast - from 5% to 15-20% */
.primary-group {
    background: $success 15%;
}

.secondary-group {
    background: $primary 15%;
}

.advanced-group {
    background: $warning 15%;
}

/* Enhanced setting groups with clear visual hierarchy */
.setting-group {
    margin: 1 0;
    padding: 1;
    /* border-radius: 2; - not supported in TCSS, use border: round instead */
}

.setting-group-essential {
    border-left: thick $success;
    background: $success 15%;
}

.setting-group-common {
    border-left: thick $primary;
    background: $primary 15%;
}

.setting-group-advanced {
    border-left: thick $warning;
    background: $warning 15%;
}

/* Priority Indicators */
.priority-high > CollapsibleTitle {
    text-style: bold;
    border-left: thick $success;
    padding-left: 1;
}

/* Nested indentation */
.settings-group .settings-collapsible {
    margin-left: 1;
}

/* Fix for Collapsible widgets in sidebars */
.settings-collapsible {
    height: auto;
    min-height: 3;  /* Ensure title is visible */
}

.settings-collapsible CollapsibleTitle {
    height: auto;
    min-height: 1;
    padding: 0 1;
}

.settings-collapsible Contents {
    height: auto;
    padding: 1;
}

/* Ensure checkboxes and other controls are visible */
.settings-collapsible Checkbox {
    height: auto;
    min-height: 1;
    margin: 0 0 1 0;
}

.settings-collapsible Input {
    height: auto;
    min-height: 3;
    margin: 0 0 1 0;
}

.settings-collapsible Select {
    height: auto;
    min-height: 3;
    margin: 0 0 1 0;
}

/* Sidebar Styling */
/* Generic .sidebar (used by #chat-left-sidebar and potentially others) */
.sidebar {
    dock: left;
    width: 35%; /* Set to 35% of screen width */
    min-width: 25; /* Minimum width to prevent it becoming unusable */
    max-width: 100; /* Maximum width (optional) */
    background: $boost;
    padding: 1 2;
    border-right: thick $background-darken-1;
    height: 100%;
    overflow-y: auto;
    overflow-x: hidden;
}
/* Collapsed state for the existing left sidebar */
.sidebar.collapsed {
    width: 0 !important;
    min-width: 0 !important; /* Ensure min-width is also 0 */
    border-right: none !important;
    padding: 0 !important;
    overflow: hidden !important;
    display: none; /* ensures it doesn't grab focus */
}

/* Right sidebar (chat-right-sidebar) */
#chat-right-sidebar {
    dock: right;
    width: 25%;  /* Default width, will be dynamically updated */
    min-width: 15%; /* Minimum width - absolute units work better */
    max-width: 50%; /* Maximum width */
    background: $boost;
    padding: 1 2;
    border-left: thick $background-darken-1; /* Border on the left */
    height: 100%;
    overflow-y: auto;
    overflow-x: hidden;
}

/* Collapsed state for the new right sidebar */
#chat-right-sidebar.collapsed {
    width: 0 !important;
    min-width: 0 !important; /* Ensure min-width is also 0 */
    border-left: none !important;
    padding: 0 !important;
    overflow: hidden !important;
    display: none; /* Ensures it doesn't take space or grab focus */
}

/* Common sidebar elements */
.sidebar-title { text-style: bold underline; margin-bottom: 1; width: 100%; text-align: center; }

/* Sidebar header with resize controls */
.sidebar-header-with-resize {
    height: 2;
    align: left middle;
    margin-bottom: 1;
}

.sidebar-header-with-resize .flex-grow {
    width: 1fr;
}

/* Sidebar resize buttons */
.sidebar-resize-button {
    width: 8;
    min-width: 8;
    height: 3;
    padding: 0 1;
    margin: 0 1;
    text-align: center;
    background: $primary;
    color: $text;
    text-style: bold;
    border: tall $primary;
}

.sidebar-resize-button:hover {
    background: $primary-lighten-1;
    color: $text;
    text-style: bold;
}

.sidebar-resize-button:focus {
    background: $primary-lighten-2;
    color: $text;
    text-style: bold;
    border: tall $primary-lighten-2;
}
.sidebar-label { margin-top: 1; text-style: bold; }
.sidebar-input { width: 100%; margin-bottom: 1; }
.sidebar-textarea { 
    width: 100%; 
    height: 5;  /* Default height for text areas */
    border: round $surface; 
    margin-bottom: 1; 
}

/* Notes content header and expand button */
.notes-content-header {
    height: 2;
    align: left middle;
    margin-bottom: 0;
}

.notes-content-label {
    width: auto;
}

.notes-expand-button {
    width: auto;
    min-width: 12;
    height: 3;
    margin-left: 1;
    padding: 0 2;
    color: $text;
    background: $surface;
    text-style: bold;
    text-align: center;
}

/* Ensure button text is visible */
#chat-notes-expand-button {
    color: $text !important;
}

/* General sidebar button styling */
.sidebar-button {
    width: 100%;
    height: 3;
    margin: 1 0;
    padding: 0 2;
    text-align: center;
}

/* Notes textarea states */
.notes-textarea-normal {
    height: 10;
}

.notes-textarea-expanded {
    height: 25;
    border: round $accent;
}
.sidebar Select { 
    width: 100%; 
    margin-bottom: 1; 
    border: round $primary-lighten-2;
}

.prompt-display-textarea {
    height: 7; /* Example height */
    border: round $primary-lighten-2;
    background: $primary-background;
}

.sidebar-listview {
    height: 10; /* Example height for listviews in sidebars */
    border: round $primary-lighten-2;
    background: $primary-background;
}

/* World Books specific styling */
.worldbook-association-controls {
    height: 3;
    align: center middle;
    margin: 1 0;
}

.worldbook-priority-select {
    width: 30%;
    min-width: 15;
    margin-left: 1;
}

#chat-worldbook-available-listview {
    height: 5;
    border: round $primary-lighten-2;
    background: $primary-background;
    margin-bottom: 1;
}

#chat-worldbook-active-listview {
    height: 5;
    border: round $accent;
    background: $primary-background;
    margin-bottom: 1;
}

#chat-worldbook-details-display {
    height: 8;
    border: round $secondary;
    background: $primary-background;
    /* font-size: 11; - not supported in TCSS */
}

/* Chat Dictionaries specific styling */
#chat-dictionary-available-listview {
    height: 5;
    border: round $primary-lighten-2;
    background: $primary-background;
    margin-bottom: 1;
}

#chat-dictionary-active-listview {
    height: 5;
    border: round $accent-lighten-1;
    background: $primary-background;
    margin-bottom: 1;
}

#chat-dictionary-details-display {
    height: 8;
    border: round $secondary-lighten-1;
    background: $primary-background;
}

/* Enhanced sidebar sections with UX improvements */
.sidebar-section-collapsible {
    margin-bottom: 1;
    border: round $surface-lighten-1;
    background: $surface;
}

.sidebar-section-collapsible:focus-within {
    border: round $accent;
    background: $surface-lighten-1;
}

/* Section loading state */
.section-loading {
    align: center middle;
    height: 3;
}

.loading-fade {
    opacity: 50%;
}

/* Keyboard navigation indicators */
.sidebar *:focus {
    outline: solid $accent;
}

/* Search mode indicator */
.sidebar.search-active {
    border: solid $warning;
}

/* Focus states for accessibility */
.sidebar Button:focus {
    outline: solid $accent;
}

.sidebar Select:focus {
    outline: solid $accent;
}

.sidebar Input:focus {
    outline: solid $accent;
}

/* ----------------------------------------
 * Enhanced Sidebar Components
 * ---------------------------------------- */

/* Tab content styling */
.tab-content {
    padding: 1;
    height: 100%;
}

/* Setting labels and inputs with better spacing */
.setting-label {
    margin-top: 1;
    margin-bottom: 0;
    text-style: bold;
    color: $text-muted;
}

.setting-input {
    width: 100%;
    margin-bottom: 1;
    border: round $primary-lighten-1;
}

.setting-input:focus {
    border: round $accent;
    background: $background 10%;
}

/* Modified settings indicator */
.setting-modified {
    border: solid $accent !important;
    background: $accent 10% !important;
}

/* Temperature visual indicator */
.temperature-container {
    height: 3;
    align: left middle;
}

.temperature-input {
    width: 70%;
}

.temp-indicator {
    width: 30%;
    text-align: center;
    padding-left: 1;
}

/* System prompt styling */
.system-prompt-input {
    width: 100%;
    height: 8;
    border: round $surface;
    margin-bottom: 1;
    background: $background 5%;
}

/* New chat buttons */
.new-chat-buttons {
    height: 3;
    margin: 1 0;
    align: center middle;
}

.primary-button {
    width: 45%;
    margin: 0 1;
}

.secondary-button {
    width: 45%;
    margin: 0 1;
}

/* Info display fields */
.info-display {
    width: 100%;
    margin-bottom: 1;
    background: $surface 20%;
    color: $text-muted;
}

/* Checkbox styling */
.streaming-toggle, .advanced-toggle {
    margin: 1 0;
    padding: 0 1;
}

/* TabbedContent customization */
TabbedContent {
    height: 100%;
}

TabbedContent > TabPane {
    padding: 0;
}

TabbedContent Tabs {
    background: $surface 10%;
    height: 3;
}

TabbedContent Tab {
    padding: 0 1;
}

TabbedContent Tab.active {
    background: $primary 20%;
    text-style: bold;
}

/* Search results styling */
.search-results {
    padding: 1;
}

.search-result-item {
    margin: 1 0;
    padding: 1;
    background: $surface 10%;
    border: round $surface-lighten-1;
}

.search-result-item:hover {
    background: $primary 10%;
    border: round $primary;
}

/* Highlight matched text in search */
.search-highlight {
    background: $warning 30%;
    text-style: bold;
}

/* Loading indicator for lazy tabs */
.tab-loading {
    align: center middle;
    height: 10;
}

.loading-spinner {
    color: $primary;
    text-style: bold;
}

/* Reset button styling */
.reset-button {
    width: auto;
    min-width: 3;
    height: 2;
    padding: 0 1;
    background: $warning 20%;
    border: tall $warning;
}

.reset-button:hover {
    background: $warning 30%;
}

/* Note: Textual doesn't support @media queries for responsive design
   These rules would need to be applied programmatically based on screen size */

/* --- End of Sidebar Styling --- */

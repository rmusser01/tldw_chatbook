============================= test session starts ==============================
platform darwin -- Python 3.12.11, pytest-8.4.1, pluggy-1.6.0 -- /Users/appledev/Working/tldw_chatbook/.venv/bin/python
cachedir: .pytest_cache
rootdir: /Users/appledev/Working/tldw_chatbook
configfile: pyproject.toml
plugins: anyio-4.9.0, asyncio-1.1.0, xdist-3.8.0, timeout-2.4.0, mock-3.14.1
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
timeout: 300.0s
timeout method: thread
timeout func_only: False
collecting ... 2025-07-27 00:12:31.998 | DEBUG    | tldw_chatbook.config:<module>:30 - CRITICAL DEBUG: config.py module is being imported/executed NOW.
2025-07-27 00:12:31.998 | INFO     | tldw_chatbook.config:load_openai_mappings:308 - Attempting to load OpenAI TTS mappings from: /Users/appledev/Working/Config_Files/openai_tts_mappings.json
2025-07-27 00:12:31.998 | ERROR    | tldw_chatbook.config:load_openai_mappings:313 - Failed to load OpenAI TTS mappings from /Users/appledev/Working/Config_Files/openai_tts_mappings.json: [Errno 2] No such file or directory: '/Users/appledev/Working/Config_Files/openai_tts_mappings.json'
2025-07-27 00:12:32.003 | INFO     | tldw_chatbook.config:load_cli_config_and_ensure_existence:2499 - Attempting to load CLI config from: /Users/appledev/.config/tldw_cli/config.toml
2025-07-27 00:12:32.007 | INFO     | tldw_chatbook.config:load_cli_config_and_ensure_existence:2505 - Successfully loaded and merged CLI config from /Users/appledev/.config/tldw_cli/config.toml
2025-07-27 00:12:32.007 | DEBUG    | tldw_chatbook.config:load_cli_config_and_ensure_existence:2518 - load_cli_config_and_ensure_existence returning config with top-level keys: ['general', 'tldw_api', 'splash_screen', 'logging', 'database', 'media_cleanup', 'api_endpoints', 'providers', 'api_settings', 'chat_defaults', 'chat', 'character_defaults', 'notes', 'Prompts', 'prompts', 'embedding_config', 'rag', 'rag_search', 'model_capabilities', 'SearchEngines', 'media_processing', 'transcription', 'diarization', 'local_ingestion', 'mcp', 'subscriptions', 'USER_DB_BASE_DIR', 'filepicker', 'app_tts', 'tts_settings']
2025-07-27 00:12:32.007 | DEBUG    | tldw_chatbook.config:load_cli_config_and_ensure_existence:2520 -   'api_settings' found with keys: ['openai', 'anthropic', 'cohere', 'deepseek', 'groq', 'google', 'huggingface', 'mistralai', 'openrouter', 'moonshot', 'llama_cpp', 'oobabooga', 'koboldcpp', 'ollama', 'vllm', 'aphrodite', 'tabbyapi', 'custom', 'custom_2', 'local-llm', 'local_llamafile', 'local_llamacpp', 'local_vllm', 'local_ollama', 'local_onnx', 'local_transformers', 'local_mlx_lm']
2025-07-27 00:12:32.007 | INFO     | tldw_chatbook.config:load_settings:535 - Determined ACTUAL_PROJECT_ROOT for general paths: /Users/appledev/Working/tldw_chatbook/tldw_chatbook
2025-07-27 00:12:32.007 | INFO     | tldw_chatbook.config:load_settings:536 - Determined APP_COMPONENT_ROOT for config files: /Users/appledev/Working/tldw_chatbook/tldw_chatbook
2025-07-27 00:12:32.007 | INFO     | tldw_chatbook.config:load_settings:545 - Attempting to load primary TOML config from: /Users/appledev/Working/tldw_chatbook/tldw_chatbook/Config_Files/config.toml
2025-07-27 00:12:32.007 | WARNING  | tldw_chatbook.config:load_settings:551 - Primary TOML Config file not found at /Users/appledev/Working/tldw_chatbook/tldw_chatbook/Config_Files/config.toml. Proceeding without it.
2025-07-27 00:12:32.007 | INFO     | tldw_chatbook.config:load_settings:560 - Attempting to load user-specific CLI TOML config for overrides from: /Users/appledev/.config/tldw_cli/config.toml
2025-07-27 00:12:32.012 | INFO     | tldw_chatbook.config:load_settings:565 - Successfully loaded user-specific CLI TOML config from: /Users/appledev/.config/tldw_cli/config.toml
2025-07-27 00:12:32.015 | INFO     | tldw_chatbook.config:load_settings:580 - Merged all configurations: CLI Defaults < Primary Config < User CLI Config.
2025-07-27 00:12:32.015 | DEBUG    | tldw_chatbook.config:load_settings:581 - load_settings: Configuration loaded from disk (cache miss or forced reload)
2025-07-27 00:12:32.015 | DEBUG    | tldw_chatbook.config:load_settings:679 - No macOS-specific STT providers found, using faster-whisper as default
2025-07-27 00:12:32.027 | DEBUG    | tldw_chatbook.config:load_settings:1255 - Ensured chat dictionaries folder exists: /Users/appledev/.local/share/tldw_cli/default_user/chat_dicts
2025-07-27 00:12:32.027 | DEBUG    | tldw_chatbook.config:load_settings:1262 - load_settings: Configuration cached for future use
2025-07-27 00:12:32.027 | INFO     | tldw_chatbook.config:<module>:3210 - Default API Endpoint (from config.py global scope): openai
2025-07-27 00:12:32.027 | DEBUG    | tldw_chatbook.config:<module>:3230 - CRITICAL DEBUG: Database initialization is now lazy - will initialize on first access
collected 16 items

Tests/TTS/test_higgs_validation.py::TestHiggsValidation::test_backend_initialization 2025-07-27 00:12:32.715 | INFO     | tldw_chatbook.TTS.backends.higgs:_create_default_profiles:1196 - Created 6 default voice profiles
2025-07-27 00:12:32.715 | INFO     | tldw_chatbook.TTS.backends.higgs:__init__:226 - Loaded 6 voice profiles from /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp6qyo0v46/voice_profiles.json
2025-07-27 00:12:32.715 | INFO     | tldw_chatbook.TTS.backends.higgs:__init__:249 - HiggsAudioTTSBackend initialized with device: cpu, model: test-model
PASSED
Tests/TTS/test_higgs_validation.py::TestHiggsValidation::test_model_loading 2025-07-27 00:12:32.775 | INFO     | tldw_chatbook.TTS.backends.higgs:_create_default_profiles:1196 - Created 6 default voice profiles
2025-07-27 00:12:32.775 | INFO     | tldw_chatbook.TTS.backends.higgs:__init__:226 - Loaded 6 voice profiles from /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp0vfkdly3/voice_profiles.json
2025-07-27 00:12:32.775 | INFO     | tldw_chatbook.TTS.backends.higgs:__init__:249 - HiggsAudioTTSBackend initialized with device: cpu, model: test-model
2025-07-27 00:12:32.776 | INFO     | tldw_chatbook.TTS.backends.higgs:load_model:310 - 🔍 Step 2/4: Checking HiggsAudioServeEngine parameters...
2025-07-27 00:12:32.776 | INFO     | tldw_chatbook.TTS.backends.higgs:load_model:315 - ✓ Step 2/4: Found 2 supported parameters
2025-07-27 00:12:32.776 | DEBUG    | tldw_chatbook.TTS.backends.higgs:load_model:328 - HiggsAudioServeEngine does not support audio_tokenizer_name_or_path parameter, skipping
2025-07-27 00:12:32.776 | DEBUG    | tldw_chatbook.TTS.backends.higgs:load_model:335 - HiggsAudioServeEngine does not support dtype parameter, skipping
2025-07-27 00:12:32.776 | DEBUG    | tldw_chatbook.TTS.backends.higgs:load_model:342 - HiggsAudioServeEngine does not support enable_flash_attn parameter, skipping
2025-07-27 00:12:32.776 | INFO     | tldw_chatbook.TTS.backends.higgs:load_model:346 - 🔄 Step 3/4: Loading model (this may take a while on first run)...
2025-07-27 00:12:32.776 | INFO     | tldw_chatbook.TTS.backends.higgs:load_model:347 - 📥 Model path: test-model
2025-07-27 00:12:32.776 | INFO     | tldw_chatbook.TTS.backends.higgs:load_model:348 - 🎵 Audio tokenizer: default
2025-07-27 00:12:32.776 | INFO     | tldw_chatbook.TTS.backends.higgs:load_model:349 - ⏳ Running in background thread to keep UI responsive...
2025-07-27 00:12:32.777 | INFO     | tldw_chatbook.TTS.backends.higgs:load_model:389 - ✓ Step 3/4: Model loaded successfully in 0.0s
2025-07-27 00:12:32.777 | INFO     | tldw_chatbook.TTS.backends.higgs:load_model:391 - 🏁 Step 4/4: Finalizing initialization...
2025-07-27 00:12:32.777 | INFO     | tldw_chatbook.TTS.backends.higgs:load_model:393 - ✓ Step 4/4: Higgs Audio ready on cpu
PASSED
Tests/TTS/test_higgs_validation.py::TestHiggsValidation::test_streaming_generation 2025-07-27 00:12:32.841 | INFO     | tldw_chatbook.TTS.backends.higgs:_create_default_profiles:1196 - Created 6 default voice profiles
2025-07-27 00:12:32.842 | INFO     | tldw_chatbook.TTS.backends.higgs:__init__:226 - Loaded 6 voice profiles from /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp3zzfg4p7/voice_profiles.json
2025-07-27 00:12:32.842 | INFO     | tldw_chatbook.TTS.backends.higgs:__init__:249 - HiggsAudioTTSBackend initialized with device: cpu, model: test-model
2025-07-27 00:12:32.845 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:446 - ────────────────────────────────────────────────────────────
2025-07-27 00:12:32.845 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:447 - 🎤 STARTING TTS GENERATION
2025-07-27 00:12:32.845 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:448 - 📝 Text length: 22 characters
2025-07-27 00:12:32.845 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:449 - 🗣️  Voice: Professional Female
2025-07-27 00:12:32.845 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:450 - 🌐 Language: en
2025-07-27 00:12:32.845 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:451 - 📀 Format: pcm
2025-07-27 00:12:32.845 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:452 - ────────────────────────────────────────────────────────────
2025-07-27 00:12:32.846 | ERROR    | tldw_chatbook.TTS.backends.higgs:_generate_single_speaker_stream:648 - HiggsAudioTTSBackend: Single speaker generation failed: 'HiggsAudioTTSBackend' object has no attribute '_Message'
2025-07-27 00:12:32.846 | ERROR    | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:474 - ════════════════════════════════════════════════════════════
2025-07-27 00:12:32.846 | ERROR    | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:475 - ❌ GENERATION FAILED
2025-07-27 00:12:32.846 | ERROR    | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:476 - 🚨 Error: 'HiggsAudioTTSBackend' object has no attribute '_Message'
2025-07-27 00:12:32.846 | ERROR    | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:477 - ════════════════════════════════════════════════════════════
2025-07-27 00:12:32.846 | ERROR    | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:478 - HiggsAudioTTSBackend: Error during generation: 'HiggsAudioTTSBackend' object has no attribute '_Message'
PASSED
Tests/TTS/test_higgs_validation.py::TestHiggsValidation::test_voice_profile_creation 2025-07-27 00:12:32.909 | INFO     | tldw_chatbook.TTS.backends.higgs:_create_default_profiles:1196 - Created 6 default voice profiles
2025-07-27 00:12:32.909 | INFO     | tldw_chatbook.TTS.backends.higgs:__init__:226 - Loaded 6 voice profiles from /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpbm_wl_w2/voice_profiles.json
2025-07-27 00:12:32.909 | INFO     | tldw_chatbook.TTS.backends.higgs:__init__:249 - HiggsAudioTTSBackend initialized with device: cpu, model: test-model
2025-07-27 00:12:32.927 | INFO     | tldw_chatbook.TTS.backends.higgs:create_voice_profile:1259 - Created voice profile 'test_voice' from /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpbm_wl_w2/test_reference.wav
PASSED
Tests/TTS/test_higgs_validation.py::TestHiggsValidation::test_multi_speaker_parsing 2025-07-27 00:12:32.989 | INFO     | tldw_chatbook.TTS.backends.higgs:_create_default_profiles:1196 - Created 6 default voice profiles
2025-07-27 00:12:32.989 | INFO     | tldw_chatbook.TTS.backends.higgs:__init__:226 - Loaded 6 voice profiles from /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpa3ud7wx7/voice_profiles.json
2025-07-27 00:12:32.989 | INFO     | tldw_chatbook.TTS.backends.higgs:__init__:249 - HiggsAudioTTSBackend initialized with device: cpu, model: test-model
PASSED
Tests/TTS/test_higgs_validation.py::TestHiggsValidation::test_multi_speaker_generation 2025-07-27 00:12:33.042 | INFO     | tldw_chatbook.TTS.backends.higgs:_create_default_profiles:1196 - Created 6 default voice profiles
2025-07-27 00:12:33.042 | INFO     | tldw_chatbook.TTS.backends.higgs:__init__:226 - Loaded 6 voice profiles from /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp0xl9w__j/voice_profiles.json
2025-07-27 00:12:33.042 | INFO     | tldw_chatbook.TTS.backends.higgs:__init__:249 - HiggsAudioTTSBackend initialized with device: cpu, model: test-model
2025-07-27 00:12:33.042 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:446 - ────────────────────────────────────────────────────────────
2025-07-27 00:12:33.042 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:447 - 🎤 STARTING TTS GENERATION
2025-07-27 00:12:33.042 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:448 - 📝 Text length: 52 characters
2025-07-27 00:12:33.042 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:449 - 🗣️  Voice: Storyteller Male
2025-07-27 00:12:33.042 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:450 - 🌐 Language: en
2025-07-27 00:12:33.042 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:451 - 📀 Format: pcm
2025-07-27 00:12:33.042 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:452 - ────────────────────────────────────────────────────────────
2025-07-27 00:12:33.042 | INFO     | tldw_chatbook.TTS.backends.higgs:_generate_multi_speaker_stream:668 - HiggsAudioTTSBackend: Generating multi-speaker dialog with 2 sections
2025-07-27 00:12:33.042 | INFO     | tldw_chatbook.TTS.backends.higgs:_prepare_voice_config:1015 - Using default voice for: Alice
2025-07-27 00:12:33.042 | DEBUG    | tldw_chatbook.TTS.backends.higgs:_generate_multi_speaker_stream:681 - Section 1: Speaker='Alice', Voice=Default Higgs Voice
2025-07-27 00:12:33.042 | ERROR    | tldw_chatbook.TTS.backends.higgs:_generate_multi_speaker_stream:771 - HiggsAudioTTSBackend: Multi-speaker generation failed: 'HiggsAudioTTSBackend' object has no attribute '_Message'
2025-07-27 00:12:33.043 | ERROR    | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:474 - ════════════════════════════════════════════════════════════
2025-07-27 00:12:33.043 | ERROR    | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:475 - ❌ GENERATION FAILED
2025-07-27 00:12:33.043 | ERROR    | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:476 - 🚨 Error: 'HiggsAudioTTSBackend' object has no attribute '_Message'
2025-07-27 00:12:33.043 | ERROR    | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:477 - ════════════════════════════════════════════════════════════
2025-07-27 00:12:33.043 | ERROR    | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:478 - HiggsAudioTTSBackend: Error during generation: 'HiggsAudioTTSBackend' object has no attribute '_Message'
PASSED
Tests/TTS/test_higgs_validation.py::TestHiggsValidation::test_voice_mapping 2025-07-27 00:12:33.126 | INFO     | tldw_chatbook.TTS.backends.higgs:_create_default_profiles:1196 - Created 6 default voice profiles
2025-07-27 00:12:33.127 | INFO     | tldw_chatbook.TTS.backends.higgs:__init__:226 - Loaded 6 voice profiles from /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp97qp3f0m/voice_profiles.json
2025-07-27 00:12:33.127 | INFO     | tldw_chatbook.TTS.backends.higgs:__init__:249 - HiggsAudioTTSBackend initialized with device: cpu, model: test-model
PASSED
Tests/TTS/test_higgs_validation.py::TestHiggsValidation::test_progress_tracking 2025-07-27 00:12:33.203 | INFO     | tldw_chatbook.TTS.backends.higgs:_create_default_profiles:1196 - Created 6 default voice profiles
2025-07-27 00:12:33.204 | INFO     | tldw_chatbook.TTS.backends.higgs:__init__:226 - Loaded 6 voice profiles from /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp2ym2oym2/voice_profiles.json
2025-07-27 00:12:33.204 | INFO     | tldw_chatbook.TTS.backends.higgs:__init__:249 - HiggsAudioTTSBackend initialized with device: cpu, model: test-model
2025-07-27 00:12:33.204 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:446 - ────────────────────────────────────────────────────────────
2025-07-27 00:12:33.204 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:447 - 🎤 STARTING TTS GENERATION
2025-07-27 00:12:33.204 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:448 - 📝 Text length: 22 characters
2025-07-27 00:12:33.204 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:449 - 🗣️  Voice: Professional Female
2025-07-27 00:12:33.204 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:450 - 🌐 Language: en
2025-07-27 00:12:33.204 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:451 - 📀 Format: pcm
2025-07-27 00:12:33.204 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:452 - ────────────────────────────────────────────────────────────
2025-07-27 00:12:33.204 | ERROR    | tldw_chatbook.TTS.backends.higgs:_generate_single_speaker_stream:648 - HiggsAudioTTSBackend: Single speaker generation failed: 'HiggsAudioTTSBackend' object has no attribute '_Message'
2025-07-27 00:12:33.204 | ERROR    | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:474 - ════════════════════════════════════════════════════════════
2025-07-27 00:12:33.204 | ERROR    | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:475 - ❌ GENERATION FAILED
2025-07-27 00:12:33.204 | ERROR    | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:476 - 🚨 Error: 'HiggsAudioTTSBackend' object has no attribute '_Message'
2025-07-27 00:12:33.204 | ERROR    | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:477 - ════════════════════════════════════════════════════════════
2025-07-27 00:12:33.204 | ERROR    | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:478 - HiggsAudioTTSBackend: Error during generation: 'HiggsAudioTTSBackend' object has no attribute '_Message'
FAILED
Tests/TTS/test_higgs_validation.py::TestHiggsValidation::test_error_handling 2025-07-27 00:12:33.264 | INFO     | tldw_chatbook.TTS.backends.higgs:_create_default_profiles:1196 - Created 6 default voice profiles
2025-07-27 00:12:33.264 | INFO     | tldw_chatbook.TTS.backends.higgs:__init__:226 - Loaded 6 voice profiles from /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmp_sdb8_27/voice_profiles.json
2025-07-27 00:12:33.264 | INFO     | tldw_chatbook.TTS.backends.higgs:__init__:249 - HiggsAudioTTSBackend initialized with device: cpu, model: test-model
2025-07-27 00:12:33.265 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:422 - ⚠️  Model not loaded, initializing now...
2025-07-27 00:12:33.265 | INFO     | tldw_chatbook.TTS.backends.higgs:initialize:253 - ════════════════════════════════════════════════════════════════════════════════
2025-07-27 00:12:33.265 | INFO     | tldw_chatbook.TTS.backends.higgs:initialize:254 - 🚀 HIGGS AUDIO INITIALIZATION STARTED
2025-07-27 00:12:33.265 | INFO     | tldw_chatbook.TTS.backends.higgs:initialize:255 - 📦 Model: test-model
2025-07-27 00:12:33.265 | INFO     | tldw_chatbook.TTS.backends.higgs:initialize:256 - 🖥️  Device: cpu
2025-07-27 00:12:33.265 | INFO     | tldw_chatbook.TTS.backends.higgs:initialize:257 - ════════════════════════════════════════════════════════════════════════════════
2025-07-27 00:12:33.265 | INFO     | tldw_chatbook.TTS.backends.higgs:load_model:272 - 📚 Step 1/4: Importing Higgs Audio modules...
2025-07-27 00:12:35.420 | INFO     | tldw_chatbook.TTS.backends.higgs:load_model:283 - ✓ Step 1/4: Higgs Audio modules imported successfully
2025-07-27 00:12:35.420 | INFO     | tldw_chatbook.TTS.backends.higgs:load_model:310 - 🔍 Step 2/4: Checking HiggsAudioServeEngine parameters...
2025-07-27 00:12:35.420 | INFO     | tldw_chatbook.TTS.backends.higgs:load_model:315 - ✓ Step 2/4: Found 7 supported parameters
2025-07-27 00:12:35.420 | DEBUG    | tldw_chatbook.TTS.backends.higgs:load_model:326 - HiggsAudioServeEngine supports audio_tokenizer_name_or_path parameter
2025-07-27 00:12:35.420 | DEBUG    | tldw_chatbook.TTS.backends.higgs:load_model:335 - HiggsAudioServeEngine does not support dtype parameter, skipping
2025-07-27 00:12:35.420 | DEBUG    | tldw_chatbook.TTS.backends.higgs:load_model:342 - HiggsAudioServeEngine does not support enable_flash_attn parameter, skipping
2025-07-27 00:12:35.420 | INFO     | tldw_chatbook.TTS.backends.higgs:load_model:346 - 🔄 Step 3/4: Loading model (this may take a while on first run)...
2025-07-27 00:12:35.420 | INFO     | tldw_chatbook.TTS.backends.higgs:load_model:347 - 📥 Model path: test-model
2025-07-27 00:12:35.420 | INFO     | tldw_chatbook.TTS.backends.higgs:load_model:348 - 🎵 Audio tokenizer: bosonai/higgs-audio-v2-tokenizer
2025-07-27 00:12:35.420 | INFO     | tldw_chatbook.TTS.backends.higgs:load_model:349 - ⏳ Running in background thread to keep UI responsive...
2025-07-27 00:12:35.655 | ERROR    | tldw_chatbook.TTS.backends.higgs:load_model:396 - ════════════════════════════════════════════════════════════════════════════════
2025-07-27 00:12:35.655 | ERROR    | tldw_chatbook.TTS.backends.higgs:load_model:397 - ❌ HIGGS AUDIO INITIALIZATION FAILED
2025-07-27 00:12:35.655 | ERROR    | tldw_chatbook.TTS.backends.higgs:load_model:398 - 🚨 Error: test-model is not a local folder and is not a valid model identifier listed on 'https://huggingface.co/models'
If this is a private repository, make sure to pass a token having permission to this repo either by logging in with `huggingface-cli login` or by passing `token=<your_token>`
2025-07-27 00:12:35.655 | ERROR    | tldw_chatbook.TTS.backends.higgs:load_model:399 - ════════════════════════════════════════════════════════════════════════════════
2025-07-27 00:12:35.655 | ERROR    | tldw_chatbook.TTS.backends.higgs:load_model:400 - Failed to load Higgs Audio model: test-model is not a local folder and is not a valid model identifier listed on 'https://huggingface.co/models'
If this is a private repository, make sure to pass a token having permission to this repo either by logging in with `huggingface-cli login` or by passing `token=<your_token>`
PASSED
Tests/TTS/test_higgs_validation.py::TestHiggsValidation::test_performance_metrics 2025-07-27 00:12:35.831 | INFO     | tldw_chatbook.TTS.backends.higgs:_create_default_profiles:1196 - Created 6 default voice profiles
2025-07-27 00:12:35.831 | INFO     | tldw_chatbook.TTS.backends.higgs:__init__:226 - Loaded 6 voice profiles from /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpkpct2l98/voice_profiles.json
2025-07-27 00:12:35.831 | INFO     | tldw_chatbook.TTS.backends.higgs:__init__:249 - HiggsAudioTTSBackend initialized with device: cpu, model: test-model
2025-07-27 00:12:35.831 | INFO     | tldw_chatbook.TTS.backends.higgs:_prepare_voice_config:1015 - Using default voice for: default
2025-07-27 00:12:35.831 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:446 - ────────────────────────────────────────────────────────────
2025-07-27 00:12:35.831 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:447 - 🎤 STARTING TTS GENERATION
2025-07-27 00:12:35.831 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:448 - 📝 Text length: 24 characters
2025-07-27 00:12:35.831 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:449 - 🗣️  Voice: Default Higgs Voice
2025-07-27 00:12:35.831 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:450 - 🌐 Language: en
2025-07-27 00:12:35.831 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:451 - 📀 Format: pcm
2025-07-27 00:12:35.831 | INFO     | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:452 - ────────────────────────────────────────────────────────────
2025-07-27 00:12:35.831 | ERROR    | tldw_chatbook.TTS.backends.higgs:_generate_single_speaker_stream:648 - HiggsAudioTTSBackend: Single speaker generation failed: 'HiggsAudioTTSBackend' object has no attribute '_Message'
2025-07-27 00:12:35.831 | ERROR    | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:474 - ════════════════════════════════════════════════════════════
2025-07-27 00:12:35.831 | ERROR    | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:475 - ❌ GENERATION FAILED
2025-07-27 00:12:35.831 | ERROR    | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:476 - 🚨 Error: 'HiggsAudioTTSBackend' object has no attribute '_Message'
2025-07-27 00:12:35.831 | ERROR    | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:477 - ════════════════════════════════════════════════════════════
2025-07-27 00:12:35.831 | ERROR    | tldw_chatbook.TTS.backends.higgs:generate_speech_stream:478 - HiggsAudioTTSBackend: Error during generation: 'HiggsAudioTTSBackend' object has no attribute '_Message'
FAILED
Tests/TTS/test_higgs_validation.py::TestHiggsVoiceManager::test_profile_creation 2025-07-27 00:12:37.769 | INFO     | tldw_chatbook.TTS.backends.higgs_voice_manager:create_profile:176 - Created voice profile 'test_voice'
PASSED
Tests/TTS/test_higgs_validation.py::TestHiggsVoiceManager::test_profile_listing 2025-07-27 00:12:38.038 | INFO     | tldw_chatbook.TTS.backends.higgs_voice_manager:create_profile:176 - Created voice profile 'voice_0'
2025-07-27 00:12:38.040 | INFO     | tldw_chatbook.TTS.backends.higgs_voice_manager:create_profile:176 - Created voice profile 'voice_1'
2025-07-27 00:12:38.042 | INFO     | tldw_chatbook.TTS.backends.higgs_voice_manager:create_profile:176 - Created voice profile 'voice_2'
PASSED
Tests/TTS/test_higgs_validation.py::TestHiggsVoiceManager::test_profile_update 2025-07-27 00:12:38.229 | INFO     | tldw_chatbook.TTS.backends.higgs_voice_manager:create_profile:176 - Created voice profile 'update_test'
PASSED
Tests/TTS/test_higgs_validation.py::TestHiggsVoiceManager::test_profile_deletion 2025-07-27 00:12:38.437 | INFO     | tldw_chatbook.TTS.backends.higgs_voice_manager:create_profile:176 - Created voice profile 'delete_test'
2025-07-27 00:12:38.438 | INFO     | tldw_chatbook.TTS.backends.higgs_voice_manager:delete_profile:245 - Deleted voice profile 'delete_test'
PASSED
Tests/TTS/test_higgs_validation.py::TestHiggsVoiceManager::test_profile_export_import 2025-07-27 00:12:38.657 | INFO     | tldw_chatbook.TTS.backends.higgs_voice_manager:create_profile:176 - Created voice profile 'export_test'
2025-07-27 00:12:38.658 | INFO     | tldw_chatbook.TTS.backends.higgs_voice_manager:export_profile:350 - Exported profile 'export_test' to /var/folders/qc/m53gw5bs70q_xf10fz52dlmw0000gn/T/tmpj9z6ddhr/higgs_voice_export_test
2025-07-27 00:12:38.658 | INFO     | tldw_chatbook.TTS.backends.higgs_voice_manager:delete_profile:245 - Deleted voice profile 'export_test'
2025-07-27 00:12:38.658 | INFO     | tldw_chatbook.TTS.backends.higgs_voice_manager:import_profile:431 - Imported voice profile 'imported_test'
PASSED
Tests/TTS/test_higgs_validation.py::TestHiggsVoiceManager::test_backup_restore 2025-07-27 00:12:38.885 | INFO     | tldw_chatbook.TTS.backends.higgs_voice_manager:create_profile:176 - Created voice profile 'backup_test_1'
2025-07-27 00:12:38.889 | INFO     | tldw_chatbook.TTS.backends.higgs_voice_manager:create_profile:176 - Created voice profile 'backup_test_2'
2025-07-27 00:12:38.890 | INFO     | tldw_chatbook.TTS.backends.higgs_voice_manager:delete_profile:245 - Deleted voice profile 'backup_test_2'
PASSED

=================================== FAILURES ===================================
__________________ TestHiggsValidation.test_progress_tracking __________________
Tests/TTS/test_higgs_validation.py:299: in test_progress_tracking
    assert len(progress_updates) > 0
E   assert 0 > 0
E    +  where 0 = len([])
_________________ TestHiggsValidation.test_performance_metrics _________________
Tests/TTS/test_higgs_validation.py:363: in test_performance_metrics
    assert stats['total_generations'] >= 1
E   assert 0 >= 1
=============================== warnings summary ===============================
.venv/lib/python3.12/site-packages/pydub/utils.py:14
  /Users/appledev/Working/tldw_chatbook/.venv/lib/python3.12/site-packages/pydub/utils.py:14: DeprecationWarning: 'audioop' is deprecated and slated for removal in Python 3.13
    import audioop

Tests/TTS/test_higgs_validation.py::TestHiggsValidation::test_error_handling
  /Users/appledev/Working/tldw_chatbook/.venv/lib/python3.12/site-packages/google/protobuf/internal/well_known_types.py:92: DeprecationWarning: datetime.datetime.utcfromtimestamp() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.fromtimestamp(timestamp, datetime.UTC).
    _EPOCH_DATETIME = datetime.utcfromtimestamp(0)

Tests/TTS/test_higgs_validation.py::TestHiggsVoiceManager::test_profile_creation
  /Users/appledev/Working/tldw_chatbook/.venv/lib/python3.12/site-packages/audioread/rawread.py:16: DeprecationWarning: 'aifc' is deprecated and slated for removal in Python 3.13
    import aifc

Tests/TTS/test_higgs_validation.py::TestHiggsVoiceManager::test_profile_creation
  /Users/appledev/Working/tldw_chatbook/.venv/lib/python3.12/site-packages/audioread/rawread.py:19: DeprecationWarning: 'sunau' is deprecated and slated for removal in Python 3.13
    import sunau

Tests/TTS/test_higgs_validation.py::TestHiggsVoiceManager::test_profile_creation
Tests/TTS/test_higgs_validation.py::TestHiggsVoiceManager::test_profile_creation
Tests/TTS/test_higgs_validation.py::TestHiggsVoiceManager::test_profile_listing
Tests/TTS/test_higgs_validation.py::TestHiggsVoiceManager::test_profile_update
Tests/TTS/test_higgs_validation.py::TestHiggsVoiceManager::test_profile_deletion
Tests/TTS/test_higgs_validation.py::TestHiggsVoiceManager::test_profile_export_import
Tests/TTS/test_higgs_validation.py::TestHiggsVoiceManager::test_backup_restore
  /Users/appledev/Working/tldw_chatbook/.venv/lib/python3.12/site-packages/librosa/core/spectrum.py:266: UserWarning: n_fft=2048 is too large for input signal of length=4
    warnings.warn(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED Tests/TTS/test_higgs_validation.py::TestHiggsValidation::test_progress_tracking
FAILED Tests/TTS/test_higgs_validation.py::TestHiggsValidation::test_performance_metrics
================== 2 failed, 14 passed, 11 warnings in 7.30s ===================
